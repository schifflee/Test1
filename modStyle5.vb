Option Compare Text

Imports System.Data
Imports System.Data.OleDb
Imports System.Data.SqlClient
Imports System.Windows.Forms
Imports System.ComponentModel.PropertyDescriptorCollection
Imports Word = Microsoft.Office.Interop.Word
Imports Microsoft.VisualBasic
Imports System.IO

Module modStyle5

    Sub MT_IncurredSamples_38(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal idTR As Int64)

        Dim numNomConc As Decimal
        Dim var1, var2, var3, var4, var5, var10
        Dim dvDo as system.data.dataview
        Dim strTName As String
        Dim intDo As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim Count10 As Short
        Dim strDo As String
        Dim bool As Boolean
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim tbl1 As System.Data.DataTable
        Dim dv1 as system.data.dataview
        Dim rows1() As DataRow
        Dim intRows1 As Short
        Dim strF1 As String
        Dim tbl2 As System.Data.DataTable
        Dim dv2 as system.data.dataview
        Dim rows2() As DataRow
        Dim intRows2 As Short
        Dim strF2 As String
        Dim tbl3 As System.Data.DataTable
        Dim dv3 as system.data.dataview
        Dim rows3() As DataRow
        Dim intRows3 As Short
        Dim strF3 As String
        Dim intTableID As Short
        Dim tbl4 As System.Data.DataTable
        Dim dv4 as system.data.dataview
        Dim rows4() As DataRow
        Dim intRows4 As Short
        Dim strF4 As String
        Dim strS As String
        Dim intNumRuns As Short
        Dim dv as system.data.dataview
        Dim tblNumRuns As System.Data.DataTable
        Dim tblLevels As System.Data.DataTable
        Dim intNumLevels As Short
        Dim intTblRows As Short
        Dim wrdSelection As Microsoft.Office.Interop.Word.Selection
        Dim strF As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim int4 As Short
        Dim int10 As Short
        Dim intRowsX As Short
        Dim tblX As System.Data.DataTable
        Dim varNom
        Dim strConcUnits As String
        Dim intLeg As Short
        Dim ctQCLegend As Short
        Dim ctDilLeg As Short
        Dim strA As String
        Dim strB As String

        Dim ctLegend As Short
        Dim fontsize
        Dim boolPro As Boolean

        Dim varConc

        Dim hi, lo
        Dim rows10() As DataRow
        Dim rows11() As DataRow
        Dim intRowsAnal As Short
        Dim arrFP(2, 20) 'FlagPercent array: 1=hi, 2=lo
        Dim strFP As String
        Dim numMean As Decimal
        Dim numBias As Decimal
        Dim numSD As Decimal
        Dim tblZ As System.Data.DataTable
        Dim dvAn as system.data.dataview
        Dim tblAnGo As New System.Data.DataTable
        Dim p1, p2, p3, p4, p5, p6, p7, p8, p9, p10
        Dim strM As String
        Dim fonts
        Dim numDF As Decimal
        Dim DilFactor
        Dim strF2a As String
        Dim strTempInfo As String
        Dim rowsX() As DataRow
        Dim intLegStart As Short
        Dim boolJustTable As Boolean

        Dim intExp As Short
        Dim ctExp As Short
        Dim int8 As Short
        Dim intStart As Short

        Dim rows2E() As DataRow
        Dim nE As Short
        Dim nI As Short
        Dim boolOutHeadE As Boolean = False
        Dim boolOutHeadI As Boolean = False
        Dim boolDeleteRows As Boolean = False

        Dim tblRID As System.Data.DataTable
        Dim numRID As Short
        Dim ctTbl As Short
        Dim varAnal, varIS
        Dim v1, v2, vU

        Dim strMatrix As String
        Dim intGroup As Short

        Dim numPrec As Single
        Dim numTheor As Single

        Dim strTNameO As String

        Dim charFCID As String
        strF = "ID_TBLREPORTTABLE = " & idTR
        Dim rowsTR() As DataRow = tblReportTable.Select(strF)
        var1 = rowsTR(0).Item("CHARFCID")
        charFCID = NZ(var1, "NA")

        boolJustTable = False

        Cursor.Current = Cursors.WaitCursor

        '''wdd.visible = True

        fontsize = wd.ActiveDocument.Styles("Normal").Font.Size ' wd.Selection.Font.Size
        fonts = fontsize ' wd.Selection.Font.Size

        With wd

            intTableID = 38

            Dim strWRunId As String = GetWatsonColH(intTableID)

            dvDo = frmH.dgvReportTableConfiguration.DataSource
            strF = "id_tblconfigreporttables = " & intTableID
            intDo = FindRowDVNumByCol(intTableID, dvDo, "id_tblconfigreporttables")

            '***
            intDo = FindRowDVNumByCol(idTR, dvDo, "ID_TBLREPORTTABLE")

            'Get table name
            var1 = dvDo(intDo).Item("CHARHEADINGTEXT")
            strTName = NZ(var1, "[NONE]")

            strTNameO = strTName

            'get Temperature info
            var1 = dvDo(intDo).Item("CHARSTABILITYPERIOD")
            strTempInfo = NZ(var1, "[NONE]")

            '***

            ctPB = ctPB + 1
            If ctPB > frmH.pb1.Maximum Then
                ctPB = 1
            End If
            frmH.pb1.Value = ctPB
            frmH.pb1.Refresh()

            tbl1 = tblAnalysisResultsHome
            tbl2 = tblAssignedSamples
            tbl3 = tblAssignedSamplesHelper
            tbl4 = tblAnalytesHome

            Dim tbl5 As System.Data.DataTable
            tbl5 = tblTableProperties
            strF = "ID_TBLREPORTTABLE = " & idTR


            'ensure data has been entered
            strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR
            rowsX = tbl2.Select(strF)

            strF = "IsIntStd = 'No'"
            strS = "INTORDER ASC, IsIntStd ASC, AnalyteDescription ASC"
            rows11 = tblAnalytesHome.Select(strF, strS)
            intRowsAnal = rows11.Length

            ctTbl = 0
            For Count1 = 1 To intRowsAnal

                boolJustTable = False

                Dim arrLegend(4, 20)

                strTName = strTNameO

                ctLegend = 0

                Dim int11 As Short
                If boolSTATSDIFFCOL Then
                    int11 = 2
                Else
                    int11 = 1
                End If

                'for legend stuff

                intExp = 0
                ctExp = 0

                intLeg = 0
                ctQCLegend = 0
                ctDilLeg = 0
                ctLegend = 0
                strA = ""
                strB = ""
                arrLegend.Clear(arrLegend, 0, arrLegend.Length)
                arrFP.Clear(arrFP, 0, arrFP.Length)
                intLegStart = 96


                'check if table is to be generated
                strDo = rows11(Count1 - 1).Item("ANALYTEDESCRIPTION")

                If UseAnalyte(CStr(strDo)) Then
                Else
                    GoTo next1
                End If

                bool = dvDo.Item(intDo).Item(strDo) 'find boolean value of dvDo column

                Dim strAnalC As String
                Dim strAnal As String
                Dim intAnalyteID As Int32

                Dim strM1 As String
                If bool Then 'continue

                    ctTbl = ctTbl + 1

                    intTCur = intTCur + 1

                    If boolUseGroups Then
                        intGroups = tblAnalyteGroups.Rows(Count1 - 1).Item("INTGROUP")
                        strMatrix = tblAnalyteGroups.Rows(Count1 - 1).Item("MATRIX")
                        strAnalC = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                        gstrAnal = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C") ' arrAnalytes(1, Count1)
                        strAnal = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION") ' arrAnalytes(1, Count1)
                        intAnalyteID = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEID")
                    Else
                        strAnalC = arrAnalytes(14, Count1)
                        gstrAnal = arrAnalytes(1, Count1)
                        strAnal = arrAnalytes(1, Count1)
                    End If

                    'ensure data has been entered
                    strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ID_TBLREPORTTABLE = " & idTR
                    rowsX = tbl2.Select(strF)
                    If rowsX.Length = 0 Then
                        'strM = "Creating Summary of " & strTempInfo & " Final Extract Stability Table ...."
                        strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                        frmH.lblProgress.Text = strM
                        frmH.Refresh()
                        'MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
                        boolJustTable = True
                        'page setup according to configuration
                        str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                        'insert page break
                        'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                        Call InsertPageBreak(wd)
                        Call PageSetup(wd, str1) 'L=Landscape, P=Portrait
                        GoTo end1
                    Else
                        boolJustTable = False
                    End If

                    'page setup according to configuration
                    str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                    'insert page break
                    'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                    Call InsertPageBreak(wd)
                    Call PageSetup(wd, str1) 'L=Landscape, P=Portrait

                    'ReDim arrBCQCs(8, 50) '1=LevelNumber, 2=NomConcentration, 3=ID, 4=FlagPercent, 5=Hello, 6=Lo, 7=#ofReplicates, 8=ASSAYID
                    strM = "Creating Summary of " & strTempInfo & " Final Extract Stability Table For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                    strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                    strM1 = strM
                    frmH.lblProgress.Text = strM
                    frmH.Refresh()

                    'get strConcUnits
                    int1 = FindRowDV("ULOQ Units", frmH.dgvWatsonAnalRef.DataSource)
                    strConcUnits = NZ(frmH.dgvWatsonAnalRef(Count1, int1).Value, "ng/mL")

                    int1 = FindRowDV("Alternate Calibr/QC Std Units", frmH.dgvStudyConfig.DataSource)
                    str1 = NZ(frmH.dgvStudyConfig(1, int1).Value, "")

                    If Len(str1) = 0 Or StrComp(str1, "[None]", CompareMethod.Text) = 0 Then
                    Else
                        strConcUnits = str1
                    End If

                    'setup tables


                    var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    var4 = tbl4.Rows.Item(Count1 - 1).Item("ANALYTEID")

                    Dim vAnalyteIndex
                    Dim vMasterAssayID
                    Dim vAnalyteID
                    vAnalyteID = var4
                    vMasterAssayID = var2
                    vAnalyteIndex = var1

                    strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                    strF2 = strF2 & "ANALYTEID = " & var4 & " AND "
                    strF2 = strF2 & "MASTERASSAYID = " & var2 ' & " AND "
                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    rows2 = tbl2.Select(strF2, strS)
                    int1 = rows2.Length 'debug
                    dv2 = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows) 'tbl2 = tblAssignedSamples
                    int1 = dv2.Count 'debug

                    'find number of runs used
                    tblNumRuns = dv2.ToTable("a", True, "RUNID")
                    intNumRuns = tblNumRuns.Rows.Count

                    'var1 = dv2(0).Item("RUNID") 'DEBUG


                    'find number of different Run Identifiers
                    tblRID = dv2.ToTable("b", True, "RUNID")
                    numRID = tblRID.Rows.Count

                    're-establis tblLevels to get charhelper2's
                    tblRID = dv2.ToTable("b", True, "RUNID", "CHARHELPER2")

                    'establish table of level numbers
                    'must be sorted by nomconc!
                    'make new dv
                    Dim dvNL As New DataView(tbl2, strF2, "NOMCONC", DataViewRowState.CurrentRows)
                    tblLevels = dvNL.ToTable("b", True, "NOMCONC")
                    intNumLevels = tblLevels.Rows.Count

                    're-establisH tblLevels to get charhelper1's
                    tblLevels = dvNL.ToTable("b", True, "NOMCONC", "CHARHELPER1")

                    'establish combo table of level numbers and run identifiers
                    Dim tblLevelsRID As System.Data.DataTable
                    Dim intNumLevelsRID As Short

                    'find number of table rows to generate
                    intRowsX = 0

                    boolOutHeadE = False
                    boolOutHeadI = False
                    boolDeleteRows = False

                    'generate table
                    intTblRows = 0
                    intTblRows = intTblRows + 3 'for header
                    intTblRows = intTblRows + 2 'for blank row
                    intTblRows = intTblRows + dv2.Count

                    wrdSelection = wd.Selection()

                    Dim intCols As Short
                    'get intcols from tblreportdata
                    Dim tblH As System.Data.DataTable
                    Dim rowsH() As DataRow

                    tblH = tblReportTableHeaderConfig
                    strF = "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND BOOLINCLUDE <> 0 AND ID_TBLSTUDIES = " & id_tblStudies
                    strS = "INTORDER ASC"
                    rowsH = tblH.Select(strF)
                    intCols = rowsH.Length

                    Dim wtbl As Word.Table


                    Try

                        '20180913 LEE:
                        Call IncrNextTableNumber(wd)

                        If boolPlaceHolder Then
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=1, NumColumns:=1, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        Else
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=intTblRows, NumColumns:=intCols, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        End If

                        .Selection.Tables.Item(1).Select()
                        wtbl = .Selection.Tables.Item(1)

                        Call SetCellPaddingZero(.Selection.Tables.Item(1))

                        ''wdd.visible = True

                        .Selection.Tables.Item(1).Rows.AllowBreakAcrossPages = False
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                        .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                        .Selection.Tables.Item(1).Columns.PreferredWidth = Microsoft.Office.Interop.Word.WdPreferredWidthType.wdPreferredWidthPoints
                        '.Selection.Tables.Item(1).Columns.Item(1).Width = 86

                        .Selection.Tables.Item(1).Select()



                        'remove border, but leave top and bottom
                        '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderLeft).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderRight).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderHorizontal).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderVertical).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalDown).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalUp).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter

                        'border top and bottom of range
                        .Selection.Tables.Item(1).Cell(1, 1).Select()

                        If boolPlaceHolder Then

                            .Selection.Tables.Item(1).Select()
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone

                            strA = arrAnalytes(14, Count1)
                            strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, False)
                            Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                            'Note: strTName is byRef and will return Table, number, caption, label

                            Call MoveOneCellDown(wd)

                            .Selection.TypeParagraph()
                            .Selection.TypeParagraph()

                            'enter a table record in tblTableN
                            'ctTableN = ctTableN + 1
                            Dim dtblr1 As DataRow = tblTableN.NewRow
                            dtblr1.BeginEdit()
                            dtblr1.Item("TableNumber") = ctTableN
                            dtblr1.Item("AnalyteName") = arrAnalytes(1, Count1)
                            dtblr1.Item("TableName") = strTNameO
                            dtblr1.Item("TableID") = intTableID
                            dtblr1.Item("CHARFCID") = charFCID
                            dtblr1.Item("TableNameNew") = strTName
                            tblTableN.Rows.Add(dtblr1)

                            GoTo next1
                        End If

                        .Selection.Tables.Item(1).Select()
                        Call GlobalTableParaFormat(wd)

                        '20171220 LEE: Do not set table size, use the style default table
                        '.Selection.Font.Size = fontsize - 1
                        .Selection.Tables.Item(1).Cell(1, 1).Select()


                        '.Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=2, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        wtbl.Cell(1, 1).Select()
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        '''wdd.visible = True

                        'strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                        strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC, NOMCONC ASC"
                        dv2.Sort = strS
                        'enter headings
                        Dim intID As Int64
                        Dim boolRA As Boolean = False
                        For Count3 = 1 To intCols
                            boolRA = False
                            str1 = NZ(rowsH(Count3 - 1).Item("CHARUSERLABEL"), "")
                            str2 = Replace(str1, " ", ChrW(10), 1, -1, CompareMethod.Text)
                            wtbl.Cell(1, Count3).Select()

                            intID = rowsH(Count3 - 1).Item("ID_TBLCONFIGHEADERLOOKUP")
                            Select Case intID
                                Case 183, 188
                                    str2 = str2 & ChrW(10) & "(" & strConcUnits & ")"
                            End Select

                            Select Case intID
                                Case 185, 186, 187, 189, 191
                                    boolRA = True
                            End Select

                            .Selection.TypeText(str2)
                            If boolRA Then
                                .Selection.SelectColumn()
                                .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                                wtbl.Cell(1, Count3).Select()
                                .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                            End If

                        Next
                        Dim intAArea As Int32 = 0
                        Dim intISArea As Int32 = 0
                        Dim aConc As Double
                        Dim intRow As Short
                        Dim tblDV As System.Data.DataTable = dv2.ToTable
                        Dim rowsDV() As DataRow
                        Dim totRec As Single
                        Dim intRowO As Short
                        Dim arrConc
                        Dim n
                        'legend
                        '86: Control wo/IS
                        '87: Control w/IS
                        '88: Fortified tissue - half tolerance
                        '89: Fortified tissue - tolerance
                        '90: Fortified tissue - twice tolerance

                        '''wdd.visible = True

                        intRow = 1
                        For Count4 = 1 To 1
                            intRow = intRow + 1
                            Select Case Count4
                                Case 1
                                    str1 = "Incurred Sample"


                            End Select
                            'strF = "CHARHELPER1 = '" & str1 & "'"
                            'wtbl.Cell(intRow, 2).Select()
                            '.Selection.TypeText(str1 & " samples")

                            'Select Case Count4
                            '    Case 1
                            '    Case Else
                            '        wtbl.Cell(intRow - 1, 1).Select()
                            '        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                            '        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                            'End Select

                            intRowO = intRow + 1

                            Erase rowsDV
                            strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                            'rowsDV = tblDV.Select(strF, strS)
                            'totRec = 0
                            'ReDim arrConc(rowsDV.Length)
                            dv2.Sort = strS

                            'Select Case Count4
                            '    Case 1
                            '    Case Else
                            '        wtbl.Cell(intRow + 1, 1).Select()
                            '        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                            '        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                            'End Select

                            For Count2 = 1 To dv2.Count
                                intRow = intRow + 1
                                intAArea = 0
                                intISArea = 0
                                'enter columnar data
                                For Count3 = 1 To intCols
                                    intID = rowsH(Count3 - 1).Item("ID_TBLCONFIGHEADERLOOKUP")
                                    Select Case intID
                                        Case 192 'Watson Run ID
                                            var1 = NZ(dv2(Count2 - 1).Item("RUNID"), "")
                                        Case 193 'Sample Description
                                            var1 = NZ(dv2(Count2 - 1).Item("SAMPLENAME"), "")
                                            boolSampleName01 = True
                                            If boolSampleName01 Then
                                                var1 = SampleName(CStr(var1))
                                            End If
                                        Case 194 'Sequence ID
                                            var1 = NZ(dv2(Count2 - 1).Item("RUNSAMPLEORDERNUMBER"), "")
                                        Case 195 'Sample Type
                                            var2 = NZ(dv2(Count2 - 1).Item("RUNSAMPLEKIND"), "")
                                            var1 = Replace(var2, " ", ChrW(160), 1, -1, CompareMethod.Text)
                                        Case 196 'Nominal Conc.
                                            var1 = "NA"
                                        Case 197 'RT (min)
                                            var1 = NZ(dv2(Count2 - 1).Item("ANALYTEPEAKRETENTIONTIME"), "")
                                        Case 198 'Analyte Area
                                            var1 = NZ(dv2(Count2 - 1).Item("ANALYTEAREA"), "")
                                            If Len(var1) = 0 Then
                                                intAArea = -1
                                            Else
                                                intAArea = RoundToDecimalRAFZ(var1, 0)
                                            End If
                                        Case 199 'Int. Std. Area
                                            var1 = NZ(dv2(Count2 - 1).Item("INTERNALSTANDARDAREA"), "")
                                            If Len(var1) = 0 Then
                                                intISArea = 1
                                            Else
                                                intISArea = RoundToDecimalRAFZ(var1, 0)
                                            End If
                                        Case 200 'Peak Area Ratio
                                            If intAArea = -1 Then
                                                var1 = ""
                                            Else
                                                If intISArea = 0 Then
                                                    intISArea = 1
                                                End If
                                                var2 = intAArea / intISArea
                                                var1 = Format(RoundToDecimalRAFZ(var2, 5), "0.00000")
                                            End If

                                        Case 201 'Calc. Conc.
                                            var2 = NZ(dv2(Count2 - 1).Item("CONCENTRATION"), 0)
                                            var3 = NZ(dv2(Count2 - 1).Item("ALIQUOTFACTOR"), 1)
                                            var4 = var2 'raw uncorrected concentration
                                            If boolLUseSigFigs Then
                                                var1 = SigFigOrDecString(var4, LSigFig, False)
                                            Else
                                                var1 = RoundToDecimalRAFZ(var4, LSigFig)
                                            End If

                                            aConc = var1
                                            'arrConc(Count2) = aConc

                                        Case 202 'Final Vol (mL)
                                            var1 = ""
                                        Case 203 'Exact Sample Weight
                                            'var1 = ""
                                            var1 = Format(RoundToDecimalRAFZ(NZ(dv2(Count2 - 1).Item("ALIQUOTFACTOR"), 1), 4), "0.0000")
                                        Case 204 'Actual Conc.
                                            var1 = SigFigOrDecString(aConc, LSigFig, False)

                                            var2 = NZ(dv2(Count2 - 1).Item("CONCENTRATION"), 0)
                                            var3 = RoundToDecimalRAFZ(NZ(dv2(Count2 - 1).Item("ALIQUOTFACTOR"), 1), 4)
                                            var4 = var2 * var3 'NOTE: Intervet requires Conc * DF
                                            var1 = SigFigOrDecString(var4, LSigFig, False)
                                            aConc = var1
                                        Case 205 'Reported Conc. same as Actual Conc
                                            var1 = SigFigOrDecString(aConc, LSigFig, False)

                                            var2 = NZ(dv2(Count2 - 1).Item("CONCENTRATION"), 0)
                                            var3 = RoundToDecimalRAFZ(NZ(dv2(Count2 - 1).Item("ALIQUOTFACTOR"), 1), 4)
                                            var4 = var2 * var3 'NOTE: Intervet requires Conc * DF
                                            If boolLUseSigFigs Then
                                                var1 = SigFigOrDecString(var4, LSigFig, False)
                                            Else
                                                var1 = RoundToDecimalRAFZ(var4, LSigFig)
                                            End If
                                            aConc = var1

                                    End Select

                                    wtbl.Cell(intRow, Count3).Select()
                                    .Selection.TypeText(CStr(var1))

                                Next
                            Next


                            autofitContent(wd, 2)

                        Next

                        'LEGEND
                        'ANALYTEID
                        'STUDYID
                        'STUDYNAME
                        'RUNTYPEID
                        'RUNID
                        'RUNSAMPLEORDERNUMBER
                        'ASSAYDATETIME
                        'ASSAYLEVEL
                        'ELIMINATEDFLAG
                        'SAMPLENAME
                        'ALIQUOTFACTOR
                        'RUNSAMPLEKIND
                        'ASSAYID
                        'MASTERASSAYID
                        'ANALYTEINDEX
                        'CONCENTRATION
                        'RUNANALYTEREGRESSIONSTATUS
                        'ANALYTEHEIGHT
                        'ANALYTEAREA
                        'INTERNALSTANDARDHEIGHT
                        'INTERNALSTANDARDAREA
                        'INTERNALSTDNAME
                        'SAMPLETYPEKEY
                        'SAMPLETYPEID
                        'ANALYTEPEAKRETENTIONTIME
                        'INTERNALSTANDARDRETENTIONTIME 

                        GoTo skip2


                        For Count2 = 0 To intNumLevels - 1
                            var1 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                            var2 = tblLevels.Rows.Item(Count2).Item("CHARHELPER1")

                            '******determine if the level is a diln level
                            Dim strE As String
                            var3 = var2 ' & ChrW(10) & var1 & " " & strConcUnits
                            var3 = ReturnStdQC(var2.ToString)
                            .Selection.TypeText(Text:=var3)

                            dv2.RowFilter = ""
                            strF = strF2 & " AND NOMCONC = " & CDbl(var1)
                            dv2.RowFilter = strF
                            'check for aliquot factor
                            Dim numDS As Single
                            If dv2.Count = 0 Then

                            Else
                                numDS = dv2(0).Item("ALIQUOTFACTOR")
                                If numDS <> 1 Then
                                    'record legend
                                    intLeg = intLeg + 1
                                    ctDilLeg = ctDilLeg + 1
                                    ctLegend = ctLegend + 1
                                    'configure first legend item
                                    'var3 = Format(1 / CDec(numDS), "0")
                                    var3 = GetDilnFactor(CDec(numDS)) '20190220 LEE
                                    strA = Chr(96 + intLeg) 'debugging
                                    arrLegend(1, intLeg) = Chr(96 + intLeg) 'a,b,c,etc
                                    'var: units
                                    Dim strAN As String = GetAN(var3)

                                    If boolLUseSigFigs Then
                                        'arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & DisplayNum(SigFigOrDec(Val(var1), LSigFig, False), LSigFig, False) & " " & strConcUnits & "; a 1:" & var3 & " dilution with blank matrix was performed prior to extraction and analysis."
                                        arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & DisplayNum(SigFigOrDec(Val(var1), LSigFig, False), LSigFig, False) & " " & strConcUnits & "; " & strAN & " " & var3 & "-fold dilution with blank matrix was performed prior to extraction and analysis."
                                    Else
                                        'arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & Format(CDbl(Val(var1)), GetRegrDecStr(LSigFig)) & " " & strConcUnits & "; a 1:" & var3 & " dilution with blank matrix was performed prior to extraction and analysis."
                                        arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & Format(CDbl(Val(var1)), GetRegrDecStr(LSigFig)) & " " & strConcUnits & "; " & strAN & " " & var3 & "-fold dilution with blank matrix was performed prior to extraction and analysis."
                                    End If


                                    arrLegend(3, intLeg) = True
                                    arrLegend(4, intLeg) = True

                                    'enter superscript
                                    .Selection.Font.Bold = True
                                    Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                    .Selection.Font.Bold = False
                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic

                                End If

                            End If
                            '.Selection.TypeText(strE)

                            '******

                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            If boolSTATSDIFFCOL Then
                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            End If

                        Next


                        'Enter nom. conc. row titles
                        .Selection.Tables.Item(1).Cell(3, 2).Select()

                        For Count2 = 0 To intNumLevels - 1
                            'var1 = arrBCQCs(3, Count2)
                            If boolLUseSigFigs Then
                                var1 = CStr(DisplayNum(SigFigOrDec(tblLevels.Rows.Item(Count2).Item("NOMCONC"), LSigFig, False), LSigFig, False))
                            Else
                                var1 = CStr(Format(tblLevels.Rows.Item(Count2).Item("NOMCONC"), GetRegrDecStr(LSigFig)))
                            End If

                            var3 = var1 & " " & strConcUnits
                            .Selection.TypeText(Text:=var3)
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            If boolSTATSDIFFCOL Then
                                .Selection.TypeText(Text:=ReturnDiffLabel)
                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            End If

                        Next

                        .Selection.Tables.Item(1).Cell(3, 1).Select()
                        'bottom border this row
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        'enter Watson Run ID column header
                        .Selection.Tables.Item(1).Cell(3, 1).Select()

                        If BOOLINCLUDEDATE Then
                            .Selection.Tables.Item(1).Cell(2, 1).Select()
                            .Selection.TypeText(strWRunId)
                            .Selection.Tables.Item(1).Cell(3, 1).Select()
                            '.Selection.TypeText("(Analysis Date)")
                            '20180420 LEE:
                            .Selection.TypeText("(" & GetAnalysisDateLabel(intTableID) & ")")
                        Else
                            .Selection.TypeText(strWRunId)
                        End If

                        'begin entering data'
                        intStart = 5
                        int1 = 5 'row position counter
                        Dim boolExit As Boolean = False

                        For Count2 = 0 To intNumRuns - 1

                            ''legend

                            ''find number of runs used
                            'tblNumRuns = dv2.ToTable("a", True, "RUNID")
                            'intNumRuns = tblNumRuns.Rows.Count

                            ''find number of different Run Identifiers
                            'tblRID = dv2.ToTable("b", True, "RUNID")
                            'numRID = tblRID.Rows.Count

                            ''re-establish tblLevels to get charhelper2's
                            'tblRID = dv2.ToTable("b", True, "RUNID", "CHARHELPER2")

                            ''end legend


                            .Selection.Tables.Item(1).Cell(intStart, 1).Select()
                            'enter runid
                            var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")

                            frmH.lblProgress.Text = strM1 & ChrW(10) & "Processing Run ID " & var10
                            frmH.Refresh()

                            Dim strH As String
                            Dim rowsG() As DataRow
                            Dim intG As Short
                            strF = "RUNID = " & var10
                            rowsG = tblRID.Select(strF, "RUNID ASC")
                            intG = rowsG.Length
                            strH = "[NONE]"
                            If intG = 0 Then
                                strH = "[NONE]"
                            Else
                                strH = NZ(rowsG(0).Item("CHARHELPER2"), "[NONE]")
                            End If

                            .Selection.TypeText(CStr(var10))
                            int1 = intStart
                            If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                            Else
                                int1 = int1 + 1
                                .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1)
                                .Selection.TypeText(strH)
                                .Selection.MoveUp(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1)
                            End If
                            If BOOLINCLUDEDATE Then
                                int1 = int1 + 1
                                .Selection.Tables.Item(1).Cell(int1, 1).Select()
                                str1 = GetDateFromRunID(NZ(var10, 0), LDateFormat, intGroup, idTR)
                                .Selection.TypeText("(" & str1 & ")")
                                .Selection.Tables.Item(1).Cell(intStart, 1).Select()
                            End If
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)

                            'must first determine if there are any outliers
                            intExp = 0

                            For Count3 = 0 To intNumLevels - 1

                                varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")
                                'start evaluating data
                                dv2.RowFilter = strF2
                                'don't know why, but must make a long filter here or
                                'both analytes get returned in dv2.rowfilter
                                If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND (CHARHELPER2 IS NULL OR CHARHELPER2 = '')"
                                Else
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND CHARHELPER2 = '" & strH & "'"
                                End If
                                'strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom
                                ''''''''console.writeline(strF)
                                dv2.RowFilter = strF
                                int2 = dv2.Count 'debugging

                                Erase rows1

                                Dim tbl2SA As System.Data.DataTable = dv2.ToTable
                                strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                rows2 = tbl2SA.Select(strF)
                                int3 = rows2.Length
                                intRowsX = int3 'new introwsx

                                'evaluate data
                                For Count4 = 0 To intRowsX - 1 'int3 - 1
                                    var1 = NZ(rows2(Count4).Item("ELIMINATEDFLAG"), "N")
                                    var2 = NZ(rows2(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                    If StrComp(var1, "Y", CompareMethod.Text) = 0 Or var2 = -1 Then
                                        intExp = intExp + 1
                                        boolExit = True
                                        Exit For
                                    End If
                                Next

                                If boolExit Then
                                    Exit For
                                End If

                            Next

                            Dim boolEnterDiff As Boolean
                            Dim int12 As Short
                            int12 = -1
                            'start filling in data by columns
                            For Count3 = 0 To (intNumLevels * int11) - 1 Step int11
                                int12 = int12 + 1
                                varNom = tblLevels.Rows.Item(int12).Item("NOMCONC")

                                strF = "CONCENTRATION = " & varNom & " AND ANALYTEID = " & vAnalyteID & " AND MASTERASSAYID = " & vMasterAssayID & " AND ANALYTEINDEX = " & vAnalyteIndex & " AND CONCENTRATION = " & varNom & " AND RUNID = " & var10
                                'rows10 = tblBCQCs.Select(strF)
                                rows10 = tblQCRunIDs.Select(strF, "LEVELNUMBER ASC")
                                Dim intRC As Short
                                intRC = rows10.Length
                                If intRC = 0 Then
                                    var1 = 15
                                Else
                                    var1 = CDec(NZ(rows10(0).Item("ANALYTEFLAGPERCENT"), 15))
                                    var1 = NZ(var1, 15)
                                End If


                                var2 = var1
                                arrFP(1, int12) = var1
                                arrFP(2, int12) = var2
                                Call SetHighAndLowCriteria(varNom, var1, var1, hi, lo)

                                v1 = var1
                                v2 = var2
                                vU = 0

                                'start entering data
                                dv2.RowFilter = strF2
                                'don't know why, but must make a long filter here or
                                'both analytes get returned in dv2.rowfilter
                                If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND (CHARHELPER2 IS NULL OR CHARHELPER2 = '')"
                                Else
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND CHARHELPER2 = '" & strH & "'"
                                End If
                                dv2.RowFilter = strF
                                ''''''''console.writeline(strF)
                                int2 = dv2.Count
                                nI = int2

                                'create rows1 from tbl1 which will contain all data
                                strF = ""
                                Erase rows1

                                Dim tbl2s As System.Data.DataTable = dv2.ToTable
                                rows2 = tbl2s.Select("RUNID > -1")
                                int3 = rows2.Length

                                ''debugging
                                Dim CountE As Short
                                Dim CountF As Short
                                Dim CountG As Short
                                Dim strCCC As String

                                'now do rows2E
                                strF = ""

                                Erase rows2E

                                If gAllowExclSamples And LAllowExclSamples Then
                                    'rows2E = tbl2s.Select("ELIMINATEDFLAG = 'N' AND BOOLEXCLSAMPLE = 0")
                                    rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL) AND BOOLEXCLSAMPLE = 0")
                                    '(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)
                                Else
                                    'rows2E = tbl2s.Select("ELIMINATEDFLAG = 'N'")
                                    rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)")
                                End If

                                nE = rows2E.Length

                                'enter data
                                For Count4 = 0 To intRowsX - 1 'int3 - 1
                                    boolEnterDiff = False
                                    If Count4 = 0 Then
                                        'enter charhelper2
                                        str1 = NZ(dv2(0).Item("CHARHELPER2"), "")
                                        .Selection.Tables.Item(1).Cell(intStart + Count4 + 1, 1).Select()
                                        .Selection.TypeText(str1)
                                        vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                        v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                        v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                    End If
                                    .Selection.Tables.Item(1).Cell(intStart + Count4, Count3 + 2).Select()
                                    If Count4 > int3 - 1 Then

                                        If boolQCNA Then
                                            str1 = "NA"
                                        Else
                                            str1 = ""
                                        End If

                                        .Selection.TypeText(str1)
                                        boolEnterDiff = False
                                    Else
                                        var1 = rows2(Count4).Item("CONCENTRATION")
                                        varConc = var1
                                        varAnal = NZ(rows2(Count4).Item("ANALYTEAREA"), 0)
                                        varIS = NZ(rows2(Count4).Item("INTERNALSTANDARDAREA"), 0)

                                        var1 = NZ(var1, 0)
                                        numDF = rows2(Count4).Item("ALIQUOTFACTOR")
                                        var1 = var1 / numDF
                                        If boolRCConc Then
                                            If boolLUseSigFigs Then
                                                var2 = SigFigOrDec(var1, LSigFig, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If

                                        ElseIf boolRCPA Then
                                            If boolLUseSigFigsArea Then
                                                var2 = SigFigOrDec(varAnal / numDF, LSigFigArea, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(varAnal / numDF, LSigFigArea)
                                            End If

                                        ElseIf boolRCPARatio Then
                                            If varIS = 0 Then
                                                var2 = varAnal
                                            Else
                                                var2 = varAnal / varIS
                                            End If
                                            'var2 = RoundToDecimalRAFZ(var2 / numDF, 5)
                                            If boolLUseSigFigsAreaRatio Then
                                                var2 = SigFigAreaRatio(var2, LSigFigAreaRatio, True, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(var2, LSigFigArea)
                                            End If
                                        Else
                                            If boolLUseSigFigs Then
                                                var2 = SigFigOrDec(var1, LSigFig, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If

                                        End If

                                        var1 = NZ(rows2(Count4).Item("ELIMINATEDFLAG"), "N")

                                        Dim vE
                                        vE = dv2(Count4).Item("BOOLEXCLSAMPLE")

                                        If IsDBNull(varConc) Then

                                            boolEnterDiff = True 'FALSE
                                            intExp = intExp + 1
                                            intLeg = intLeg + 1
                                            strA = ChrW(intLeg + intLegStart)

                                            var1 = "Y"

                                            str1 = "No Value."

                                            'Add to Legend Array
                                            ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                            ''''''wdd.visible = True

                                            If boolRedBoldFont Then
                                                .Selection.Font.Bold = True
                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            End If

                                            .Selection.TypeText(Text:="NV")

                                            Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                        ElseIf StrComp(var1, "Y", vbTextCompare) = 0 Or (gAllowExclSamples And LAllowExclSamples And vE = -1) Then

                                            boolEnterDiff = True 'FALSE
                                            intExp = intExp + 1
                                            intLeg = intLeg + 1
                                            strA = ChrW(intLeg + intLegStart)

                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)

                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                If v1 = v2 Then
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                Else
                                                    str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                End If

                                                'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                            Else
                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                            End If

                                            'Add to Legend Array
                                            ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                            ''''''wdd.visible = True


                                            If boolRedBoldFont Then
                                                .Selection.Font.Bold = True
                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            End If

                                            If boolRCConc Then
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                End If

                                            ElseIf boolRCPA Then
                                                If boolLUseSigFigsArea Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigArea, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigArea), GetRegrDecStr(LSigFigArea))))
                                                End If
                                            ElseIf boolRCPARatio Then
                                                '.Selection.TypeText(Text:=Format(var2, "0.00000"))
                                                If boolLUseSigFigsAreaRatio Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigAreaRatio), GetRegrDecStr(LSigFigAreaRatio))))
                                                End If
                                            Else
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                End If

                                            End If

                                            Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                        Else

                                            boolEnterDiff = True
                                            'determine if value is outside acceptance criteria
                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'If (var2 > hi Or var2 < lo) And boolRCConc Then 'flag
                                            If OutsideAccCrit(var2, varNom, v1, v2, NZ(vU, 0)) Then
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                    v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                    'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'search for str1 in arrLegend
                                                boolPro = False
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For
                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                    End If

                                                ElseIf boolRCPA Then
                                                    If boolLUseSigFigsArea Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigArea, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigArea), GetRegrDecStr(LSigFigArea))))
                                                    End If

                                                ElseIf boolRCPARatio Then
                                                    '.Selection.TypeText(Text:=Format(var2, "0.00000"))
                                                    If boolLUseSigFigsAreaRatio Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigAreaRatio), GetRegrDecStr(LSigFigAreaRatio))))
                                                    End If
                                                Else
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                    End If

                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                            Else
                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                    End If
                                                ElseIf boolRCPA Then
                                                    If boolLUseSigFigsArea Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigArea, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigArea), GetRegrDecStr(LSigFigArea))))
                                                    End If
                                                ElseIf boolRCPARatio Then
                                                    '.Selection.TypeText(Text:=Format(var2, "0.00000"))
                                                    If boolLUseSigFigsAreaRatio Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigAreaRatio), GetRegrDecStr(LSigFigAreaRatio))))
                                                    End If
                                                Else
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                    End If
                                                End If
                                                boolEnterDiff = True
                                            End If
                                        End If

                                    End If

                                    If boolSTATSDIFFCOL Then
                                        .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                        If boolEnterDiff Then
                                            'var3 = Format(((var2 / varNom) - 1) * 100, strQCDec)
                                            var3 = Format(RoundToDecimal(((var2 / varNom) - 1) * 100, intQCDec), strQCDec)
                                        Else

                                            If boolQCNA Then
                                                var3 = "NA"
                                            Else
                                                var3 = ""
                                            End If

                                        End If
                                        .Selection.TypeText(Text:=CStr(var3))
                                        .Selection.MoveLeft(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                    End If

                                Next

                                .Selection.Tables.Item(1).Cell(intStart + Count4 + 1, 1).Select()
                                int1 = .Selection.Information(Microsoft.Office.Interop.Word.WdInformation.wdStartOfRangeRowNumber)
                                '.Selection.Tables.Item(1).Cell(int1 + 1, 2).Select()
                                'begin doing stats
                                If boolQCREPORTACCVALUES Then
                                Else
                                    If intExp = 0 Then
                                    Else
                                        If boolOutHeadE Then
                                        Else
                                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                            .Selection.TypeText(Text:="Summary Statistics Excluding Outlier Values")
                                            .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                            Try
                                                .Selection.Cells.Merge()
                                            Catch ex As Exception

                                            End Try
                                            With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                            End With
                                            boolOutHeadE = True
                                        End If


                                        .Selection.Tables.Item(1).Cell(int1 + 1, 1).Select()
                                    End If
                                End If

                                int1 = .Selection.Information(Microsoft.Office.Interop.Word.WdInformation.wdStartOfRangeRowNumber)

                                'now enter Mean/Bias/n
                                If Count3 = 0 Then
                                    int8 = 0
                                    Call typeStatsLabels(wd, int8, int1 - 1, 1, False)

                                    If boolQCREPORTACCVALUES Then
                                    Else
                                        If intExp = 0 Then
                                        Else
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + int8, 1).Select()
                                            If boolOutHeadI Then
                                            Else
                                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                                .Selection.TypeText(Text:="Summary Statistics Including Outlier Values")
                                                .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                                Try
                                                    .Selection.Cells.Merge()
                                                Catch ex As Exception

                                                End Try
                                                boolOutHeadI = True
                                            End If

                                            With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                            End With

                                            Call typeStatsLabels(wd, int8, int1, 1, False)
                                        End If
                                    End If

                                End If

                                int8 = 0
                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                If boolSTATSMEAN Then
                                    Try
                                        'enter Mean
                                        int8 = int8 + 1
                                        If boolRCConc Then
                                            var1 = MeanDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                        Else
                                            var1 = MeanDR(rows2E, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                        End If
                                        numMean = 0
                                        If boolRCConc Then
                                            If boolLUseSigFigs Then
                                                numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                            Else
                                                numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If

                                            'here

                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'determine if value is outside acceptance criteria
                                            'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag
                                            If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'search for str1 in arrLegend
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For

                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                boolEnterDiff = True
                                            Else
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If
                                                boolEnterDiff = True
                                            End If

                                        ElseIf boolRCPA Then
                                            If boolLUseSigFigsArea Then
                                                numMean = SigFigArea(var1, LSigFigArea, True, False)
                                                .Selection.TypeText(CStr(DisplayNum(numMean, LSigFigArea, False)))
                                            Else
                                                numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFigArea))))
                                            End If

                                        ElseIf boolRCPARatio Then
                                            If boolLUseSigFigsAreaRatio Then
                                                var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                .Selection.TypeText(CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                            Else
                                                var2 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                .Selection.TypeText(CStr(Format(RoundToDecimalRAFZ(var2, LSigFigAreaRatio), GetRegrDecStr(LSigFigAreaRatio))))
                                            End If
                                            numMean = var2 ' RoundToDecimal(var1, 5)
                                        Else
                                            If boolLUseSigFigs Then
                                                numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                            Else
                                                numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If


                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'determine if value is outside acceptance criteria
                                            'If numMean > hi Or numMean < lo Then 'flag
                                            If OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0)) Then 'flag
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'search for str1 in arrLegend
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For

                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                boolEnterDiff = True
                                            Else
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If
                                                boolEnterDiff = True
                                            End If

                                        End If
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Mean", numMean, CSng(var10), Count1, strDo, 0, 0, False)

                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                    Catch ex As Exception

                                    End Try
                                End If
                                If boolSTATSSD Then
                                    Try
                                        'enter SD
                                        int8 = int8 + 1
                                        If nE < gSDMax Then
                                            .Selection.TypeText("NA")
                                        Else
                                            numSD = 0
                                            If boolRCConc Then
                                                var1 = StdDevDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                            Else
                                                var1 = StdDevDR(rows2E, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                            End If

                                            If boolRCConc Then
                                                If boolLUseSigFigs Then
                                                    numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    .Selection.TypeText(CStr(DisplayNum(numSD, LSigFig, False)))
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                    .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                                End If

                                            ElseIf boolRCPA Then
                                                If boolLUseSigFigsArea Then
                                                    numSD = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                    .Selection.TypeText(CStr(DisplayNum(numSD, LSigFigArea, False)))
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                    .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFigArea))))
                                                End If
                                            ElseIf boolRCPARatio Then
                                                'var2 = RoundToDecimalRAFZ(var1, 5) ' SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False)
                                                If boolLUseSigFigsAreaRatio Then
                                                    numSD = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                    .Selection.TypeText(CStr(DisplayNum(numSD, LSigFigAreaRatio, False)))
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                    .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFigArea))))
                                                End If
                                                'numSD = var2 'SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False) ' RoundToDecimal(var1, 5)
                                                '.Selection.TypeText(CStr(Format(var2, 5)))
                                            End If
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "SD", numSD, CSng(var10), Count1, strDo, 0, 0, False)

                                        End If

                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSCV Then
                                    Try
                                        'enter %CV
                                        int8 = int8 + 1
                                        If nE < gSDMax Then
                                            .Selection.TypeText("NA")
                                        Else
                                            numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Precision", numPrec, CSng(var10), Count1, strDo, 0, 0, False)

                                        End If

                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSBIAS And boolSTATSMEAN Then
                                    Try
                                        'enter %Bias
                                        int8 = int8 + 1
                                        numBias = CalcREPercent(numMean, varNom, intQCDec)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolTHEORETICAL And boolSTATSMEAN Then
                                    Try
                                        'enter %theoretical
                                        int8 = int8 + 1
                                        numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                        numTheor = 100 + CDec(numTheor)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numTheor, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numTheor, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try

                                End If

                                If boolSTATSDIFF And boolSTATSMEAN Then
                                    Try
                                        'enter %Bias
                                        int8 = int8 + 1
                                        numBias = CalcREPercent(numMean, varNom, intQCDec)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                If BOOLSTATSRE And boolSTATSMEAN Then
                                    Try
                                        'enter %RE
                                        int8 = int8 + 1
                                        numBias = CalcREPercent(numMean, varNom, intQCDec)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSN Then
                                    Try
                                        'enter n
                                        int8 = int8 + 1
                                        .Selection.TypeText(CStr(nE))
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "n", nE, CSng(var10), Count1, strDo, 0, 0, False)

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolQCREPORTACCVALUES Then
                                Else
                                    If intExp = 0 Then
                                        If boolDeleteRows Then
                                        Else
                                            Call DeleteRows(ctExp / intNumRuns, wd)
                                            boolDeleteRows = True
                                        End If

                                    Else
                                        int8 = int8 + 2
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                        If boolSTATSMEAN Then
                                            Try
                                                'enter Mean
                                                int8 = int8 + 1

                                                If boolRCConc Then
                                                    var1 = MeanDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                Else
                                                    var1 = MeanDR(rows2, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                                End If
                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If

                                                    If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                        Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                                    End If

                                                    'determine if value is outside acceptance criteria
                                                    'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag
                                                    If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                        intLeg = intLeg + 1
                                                        strA = ChrW(intLeg + intLegStart)
                                                        If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                            If v1 = v2 Then
                                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            Else
                                                                str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            End If
                                                        Else
                                                            str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                        End If

                                                        'Add to Legend Array
                                                        ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                                        If boolRedBoldFont Then
                                                            .Selection.Font.Bold = True
                                                            .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If

                                                        Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                        boolEnterDiff = True
                                                    Else
                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If
                                                        boolEnterDiff = True
                                                    End If

                                                ElseIf boolRCPA Then
                                                    If boolLUseSigFigsArea Then
                                                        numMean = SigFigArea(var1, LSigFigArea, True, False)
                                                        .Selection.TypeText(CStr(DisplayNum(numMean, LSigFigArea, False)))
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                        .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFigArea))))
                                                    End If

                                                ElseIf boolRCPARatio Then
                                                    ''var2 = SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False)
                                                    'var2 = RoundToDecimalRAFZ(var1, 5)
                                                    'numMean = var2 'SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False) 'RoundToDecimal(var1, 5)
                                                    '.Selection.TypeText(CStr(Format(var2, 5)))

                                                    If boolLUseSigFigsAreaRatio Then
                                                        numMean = SigFigAreaRatio(var1, LSigFigAreaRatio, True, False)
                                                        .Selection.TypeText(CStr(DisplayNum(numMean, LSigFigArea, False)))
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                        .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFigAreaRatio))))
                                                    End If

                                                Else
                                                    If boolLUseSigFigs Then
                                                        numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If

                                                    If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                        Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                                    End If

                                                    'determine if value is outside acceptance criteria
                                                    'If numMean > hi Or numMean < lo Then 'flag
                                                    If OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0)) Then 'flag
                                                        intLeg = intLeg + 1
                                                        strA = ChrW(intLeg + intLegStart)
                                                        'str1 = "Value outside of acceptance criteria (" & RoundToDecimal(arrFP(1, Count3), 0) & "% theoretical) but included in summary statistics."

                                                        If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                            If v1 = v2 Then
                                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            Else
                                                                str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            End If
                                                            'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                        Else
                                                            str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                        End If

                                                        'Add to Legend Array
                                                        ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)


                                                        If boolRedBoldFont Then
                                                            .Selection.Font.Bold = True
                                                            .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If

                                                        Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                        boolEnterDiff = True
                                                    Else
                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If
                                                        boolEnterDiff = True
                                                    End If

                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSSD Then
                                            Try
                                                'enter SD
                                                int8 = int8 + 1
                                                If nI < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    If boolRCConc Then
                                                        var1 = StdDevDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                    Else
                                                        var1 = StdDevDR(rows2, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                                    End If

                                                    If boolRCConc Then
                                                        If boolLUseSigFigs Then
                                                            numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            .Selection.TypeText(CStr(DisplayNum(numSD, LSigFig, False)))
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                            .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                                        End If

                                                    ElseIf boolRCPA Then
                                                        If boolLUseSigFigsArea Then
                                                            numSD = SigFigArea(var1, LSigFigArea, True, False)
                                                            .Selection.TypeText(CStr(DisplayNum(numSD, LSigFigArea, False)))
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                            .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFigArea))))
                                                        End If

                                                    ElseIf boolRCPARatio Then
                                                        'var2 = RoundToDecimalRAFZ(var1, 5)
                                                        'numSD = var2 'RoundToDecimal(var1, 5)
                                                        '.Selection.TypeText(CStr(Format(numSD, 5)))

                                                        If boolLUseSigFigsAreaRatio Then
                                                            numSD = SigFigAreaRatio(var1, LSigFigAreaRatio, True, False)
                                                            .Selection.TypeText(CStr(DisplayNum(numSD, LSigFigAreaRatio, False)))
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                            .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFigAreaRatio))))
                                                        End If
                                                    End If
                                                End If

                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSCV Then
                                            Try
                                                'enter %CV
                                                int8 = int8 + 1
                                                If nI < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                    .Selection.TypeText(Format(numPrec, strQCDec))
                                                End If

                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSBIAS And boolSTATSMEAN Then
                                            Try
                                                'enter %Bias
                                                int8 = int8 + 1
                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolTHEORETICAL And boolSTATSMEAN Then
                                            Try
                                                'enter %theoretical
                                                int8 = int8 + 1
                                                numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                                numTheor = 100 + CDec(numTheor)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numTheor, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try

                                        End If

                                        If boolSTATSDIFF And boolSTATSMEAN Then
                                            Try
                                                'enter %Bias
                                                int8 = int8 + 1
                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If BOOLSTATSRE And boolSTATSMEAN Then
                                            Try
                                                'enter %RE
                                                int8 = int8 + 1
                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSN Then
                                            Try
                                                'enter n
                                                int8 = int8 + 1
                                                .Selection.TypeText(CStr(nI))
                                            Catch ex As Exception

                                            End Try
                                        End If
                                    End If
                                End If

                            Next

                            'increase row position counter
                            If Count2 = intNumRuns - 1 Then
                                intStart = int1 + int8 + 1
                            Else
                                intStart = int1 + int8 + 1
                            End If

                            'Next Count10

                        Next

skip2:


                    Catch ex As Exception

                        str1 = "There was a problem preparing table:"
                        str1 = strM1 & ChrW(10) & ChrW(10) & str1
                        str1 = str1 & ChrW(10) & ChrW(10)
                        str1 = str1 & ex.Message
                        MsgBox(str1, vbInformation, "Problem...")

                    End Try

                    'bottom border this row
                    wtbl.Cell(wtbl.Rows.Count, 1).Select()
                    .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow)
                    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                    .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                    '''wdd.visible = True

                    'autofit window
                    .Selection.Tables.Item(1).Select()
                    'autofit table
                    Call AutoFitTable(wd, False)


                    ''go back and merge line 1
                    '.Selection.Tables.Item(1).Cell(1, 2).Select()
                    '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                    ''.Selection.Cells.Merge()
                    'If intNumLevels < 2 Then
                    'Else
                    '    Try
                    '        .Selection.Cells.Merge()
                    '    Catch ex As Exception

                    '    End Try
                    'End If
                    '.Selection.Font.Bold = False
                    '.Selection.TypeText(Text:="Nominal Concentrations")
                    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                    '.Selection.Tables.Item(1).Cell(1, 1).Select()
                    ''go to end of table
                    '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdColumn)

                    'enter table number
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End
                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next
                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    'remove unused rows
                    Call RemoveRows(wd, ctTbl)

                    '***
                    strA = rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                    strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, False)
                    Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                    'Note: strTName is byRef and will return Table, number, caption, label

                    '***
                    'Call EnterTableNumber(wd, str1, 3)

                    'enter a table record in tblTableN
                    'ctTableN = ctTableN + 1
                    Dim dtblr As DataRow = tblTableN.NewRow
                    dtblr.BeginEdit()
                    dtblr.Item("TableNumber") = ctTableN
                    dtblr.Item("AnalyteName") = strDo 'arrAnalytes(1, Count1)
                    dtblr.Item("TableName") = strTNameO
                    dtblr.Item("TableID") = intTableID
                    dtblr.Item("CHARFCID") = charFCID
                    dtblr.Item("TableNameNew") = strTName
                    tblTableN.Rows.Add(dtblr)

                    'split table, if needed
                    str1 = frmH.lblProgress.Text

                    ctLegend = ctLegend + 1
                    intLeg = intLeg + 1
                    arrLegend(1, intLeg) = "NA"
                    arrLegend(2, intLeg) = "Not Applicable"
                    arrLegend(3, intLeg) = False


                    Call AutoFitTable(wd, BOOLINCLUDEDATE)

                    strM = "Finalizing " & strTName & "..."
                    strM1 = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."
                    str1 = strM1

                    frmH.lblProgress.Text = strM1
                    frmH.Refresh()

                    Call SplitTable(wd, 4, intLeg, arrLegend, str1, False, ctLegend + 2, False, False, False, intTableID)

                    'move to line below table
                    Call MoveOneCellDown(wd)

                    Call InsertLegend(wd, intTableID, idTR, False, 1)


                Else
                    boolJustTable = False

                End If

end1:
                If boolJustTable Then
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End
                    str2 = ""
                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next

                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    str1 = str2 & " Final Extract Stability: Summary of " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION") & " Interpolated QC Standard Concentrations."
                    str2 = str1
                    str1 = NZ(rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION"), "")
                    'Call JustTable(wd, str1, str2, strDo, strTName, intTableID)
                    If Len(str1) = 0 Then
                    Else
                        Call JustTable(wd, str1, strTName, strDo, strTName, intTableID, strTempInfo, "", strTNameO, 1, idTR)
                    End If


                End If

next1:

            Next
end2:
        End With


    End Sub

    Sub MT_QCs_37(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal idTR As Int64)

        Dim numNomConc As Decimal
        Dim var1, var2, var3, var4, var5, var10
        Dim dvDo As system.data.dataview
        Dim strTName As String
        Dim intDo As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim Count10 As Short
        Dim strDo As String
        Dim bool As Boolean
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim tbl1 As System.Data.DataTable
        Dim dv1 As system.data.dataview
        Dim rows1() As DataRow
        Dim intRows1 As Short
        Dim strF1 As String
        Dim tbl2 As System.Data.DataTable
        Dim dv2 As system.data.dataview
        Dim rows2() As DataRow
        Dim intRows2 As Short
        Dim strF2 As String
        Dim tbl3 As System.Data.DataTable
        Dim dv3 As system.data.dataview
        Dim rows3() As DataRow
        Dim intRows3 As Short
        Dim strF3 As String
        Dim intTableID As Short
        Dim tbl4 As System.Data.DataTable
        Dim dv4 As system.data.dataview
        Dim rows4() As DataRow
        Dim intRows4 As Short
        Dim strF4 As String
        Dim strS As String
        Dim intNumRuns As Short
        Dim dv As system.data.dataview
        Dim tblNumRuns As System.Data.DataTable
        Dim tblLevels As System.Data.DataTable
        Dim intNumLevels As Short
        Dim intTblRows As Short
        Dim wrdSelection As Microsoft.Office.Interop.Word.Selection
        Dim strF As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim int4 As Short
        Dim int10 As Short
        Dim intRowsX As Short
        Dim tblX As System.Data.DataTable
        Dim varNom
        Dim strConcUnits As String
        Dim intLeg As Short
        Dim ctQCLegend As Short
        Dim ctDilLeg As Short
        Dim strA As String
        Dim strB As String

        Dim ctLegend As Short
        Dim fontsize
        Dim boolPro As Boolean

        Dim varConc

        Dim hi, lo
        Dim rows10() As DataRow
        Dim rows11() As DataRow
        Dim intRowsAnal As Short
        Dim arrFP(2, 20) 'FlagPercent array: 1=hi, 2=lo
        Dim strFP As String
        Dim numMean As Decimal
        Dim numBias As Decimal
        Dim numSD As Decimal
        Dim tblZ As System.Data.DataTable
        Dim dvAn As system.data.dataview
        Dim tblAnGo As New System.Data.DataTable
        Dim p1, p2, p3, p4, p5, p6, p7, p8, p9, p10
        Dim strM As String
        Dim fonts
        Dim numDF As Decimal
        Dim DilFactor
        Dim strF2a As String
        Dim strTempInfo As String
        Dim rowsX() As DataRow
        Dim intLegStart As Short
        Dim boolJustTable As Boolean

        Dim intExp As Short
        Dim ctExp As Short
        Dim int8 As Short
        Dim intStart As Short

        Dim rows2E() As DataRow
        Dim nE As Short
        Dim nI As Short
        Dim boolOutHeadE As Boolean = False
        Dim boolOutHeadI As Boolean = False
        Dim boolDeleteRows As Boolean = False

        Dim tblRID As System.Data.DataTable
        Dim numRID As Short
        Dim ctTbl As Short
        Dim varAnal, varIS
        Dim v1, v2, vU

        Dim strMatrix As String
        Dim intGroup As Short

        Dim numPrec As Single
        Dim numTheor As Single

        Dim boolIS As Boolean = False

        Dim strTNameO As String

        Dim charFCID As String
        strF = "ID_TBLREPORTTABLE = " & idTR
        Dim rowsTR() As DataRow = tblReportTable.Select(strF)
        var1 = rowsTR(0).Item("CHARFCID")
        charFCID = NZ(var1, "NA")

        boolJustTable = False

        Cursor.Current = Cursors.WaitCursor

        ''wdd.visible = True

        fontsize = wd.ActiveDocument.Styles("Normal").Font.Size ' wd.Selection.Font.Size
        fonts = fontsize 'wd.Selection.Font.Size

        With wd

            intTableID = 37

            Dim strWRunId As String = GetWatsonColH(intTableID)

            dvDo = frmH.dgvReportTableConfiguration.DataSource
            strF = "id_tblconfigreporttables = " & intTableID
            intDo = FindRowDVNumByCol(intTableID, dvDo, "id_tblconfigreporttables")

            '***
            intDo = FindRowDVNumByCol(idTR, dvDo, "ID_TBLREPORTTABLE")

            'Get table name
            var1 = dvDo(intDo).Item("CHARHEADINGTEXT")
            strTName = NZ(var1, "[NONE]")

            strTNameO = strTName

            'get Temperature info
            var1 = dvDo(intDo).Item("CHARSTABILITYPERIOD")
            strTempInfo = NZ(var1, "[NONE]")

            '***

            ctPB = ctPB + 1
            If ctPB > frmH.pb1.Maximum Then
                ctPB = 1
            End If
            frmH.pb1.Value = ctPB
            frmH.pb1.Refresh()

            tbl1 = tblAnalysisResultsHome
            tbl2 = tblAssignedSamples
            tbl3 = tblAssignedSamplesHelper
            tbl4 = tblAnalytesHome

            Dim tbl5 As System.Data.DataTable
            tbl5 = tblTableProperties
            strF = "ID_TBLREPORTTABLE = " & idTR


            'ensure data has been entered
            strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR
            rowsX = tbl2.Select(strF)

            strF = "IsIntStd = 'No'"
            strS = "INTORDER ASC, IsIntStd ASC, AnalyteDescription ASC"
            rows11 = tblAnalytesHome.Select(strF, strS)
            intRowsAnal = rows11.Length

            ctTbl = 0
            For Count1 = 1 To intRowsAnal

                boolJustTable = False

                Dim arrLegend(4, 20)

                strTName = strTNameO

                ctLegend = 0

                Dim int11 As Short
                If boolSTATSDIFFCOL Then
                    int11 = 2
                Else
                    int11 = 1
                End If

                'for legend stuff

                intExp = 0
                ctExp = 0

                intLeg = 0
                ctQCLegend = 0
                ctDilLeg = 0
                ctLegend = 0
                strA = ""
                strB = ""
                arrLegend.Clear(arrLegend, 0, arrLegend.Length)
                arrFP.Clear(arrFP, 0, arrFP.Length)
                intLegStart = 96


                'check if table is to be generated
                strDo = rows11(Count1 - 1).Item("ANALYTEDESCRIPTION")

                If UseAnalyte(CStr(strDo)) Then
                Else
                    GoTo next1
                End If

                bool = dvDo.Item(intDo).Item(strDo) 'find boolean value of dvDo column

                Dim strAnalC As String
                Dim strAnal As String
                Dim intAnalyteID As Int32

                Dim strM1 As String
                If bool Then 'continue

                    ctTbl = ctTbl + 1

                    intTCur = intTCur + 1


                    If boolUseGroups Then
                        intGroups = tblAnalyteGroups.Rows(Count1 - 1).Item("INTGROUP")
                        strMatrix = tblAnalyteGroups.Rows(Count1 - 1).Item("MATRIX")
                        strAnalC = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                        gstrAnal = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C") ' arrAnalytes(1, Count1)
                        strAnal = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION") ' arrAnalytes(1, Count1)
                        intAnalyteID = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEID")
                    Else
                        strAnalC = arrAnalytes(14, Count1)
                        gstrAnal = arrAnalytes(1, Count1)
                        strAnal = arrAnalytes(1, Count1)
                    End If

                    'ensure data has been entered
                    strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ID_TBLREPORTTABLE = " & idTR
                    rowsX = tbl2.Select(strF)
                    If rowsX.Length = 0 Then
                        'strM = "Creating Summary of " & strTempInfo & " Final Extract Stability Table ...."
                        strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                        frmH.lblProgress.Text = strM
                        frmH.Refresh()
                        'MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
                        boolJustTable = True
                        'page setup according to configuration
                        str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                        'insert page break
                        'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                        Call InsertPageBreak(wd)
                        Call PageSetup(wd, str1) 'L=Landscape, P=Portrait
                        GoTo end1
                    Else
                        boolJustTable = False
                    End If

                    'page setup according to configuration
                    str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                    'insert page break
                    'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                    Call InsertPageBreak(wd)
                    Call PageSetup(wd, str1) 'L=Landscape, P=Portrait

                    'ReDim arrBCQCs(8, 50) '1=LevelNumber, 2=NomConcentration, 3=ID, 4=FlagPercent, 5=Hello, 6=Lo, 7=#ofReplicates, 8=ASSAYID
                    strM = "Creating Summary of " & strTempInfo & " Final Extract Stability Table For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                    strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                    strM1 = strM
                    frmH.lblProgress.Text = strM
                    frmH.Refresh()

                    'get strConcUnits
                    int1 = FindRowDV("ULOQ Units", frmH.dgvWatsonAnalRef.DataSource)
                    strConcUnits = NZ(frmH.dgvWatsonAnalRef(Count1, int1).Value, "ng/mL")

                    int1 = FindRowDV("Alternate Calibr/QC Std Units", frmH.dgvStudyConfig.DataSource)
                    str1 = NZ(frmH.dgvStudyConfig(1, int1).Value, "")

                    If Len(str1) = 0 Or StrComp(str1, "[None]", CompareMethod.Text) = 0 Then
                    Else
                        strConcUnits = str1
                    End If

                    'setup tables


                    var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    var4 = tbl4.Rows.Item(Count1 - 1).Item("ANALYTEID")

                    Dim vAnalyteIndex
                    Dim vMasterAssayID
                    Dim vAnalyteID
                    vAnalyteID = var4
                    vMasterAssayID = var2
                    vAnalyteIndex = var1

                    strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                    strF2 = strF2 & "ANALYTEID = " & var4 & " AND "
                    strF2 = strF2 & "MASTERASSAYID = " & var2 ' & " AND "
                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    rows2 = tbl2.Select(strF2, strS)
                    int1 = rows2.Length 'debug
                    dv2 = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                    int1 = dv2.Count 'debug

                    'find number of runs used
                    tblNumRuns = dv2.ToTable("a", True, "RUNID")
                    intNumRuns = tblNumRuns.Rows.Count

                    'var1 = dv2(0).Item("RUNID") 'DEBUG


                    'find number of different Run Identifiers
                    tblRID = dv2.ToTable("b", True, "RUNID")
                    numRID = tblRID.Rows.Count

                    're-establis tblLevels to get charhelper2's
                    tblRID = dv2.ToTable("b", True, "RUNID", "CHARHELPER2")

                    'establish table of level numbers
                    'must be sorted by nomconc!
                    'make new dv
                    Dim dvNL As New DataView(tbl2, strF2, "NOMCONC", DataViewRowState.CurrentRows)
                    tblLevels = dvNL.ToTable("b", True, "NOMCONC")
                    intNumLevels = tblLevels.Rows.Count

                    're-establisH tblLevels to get charhelper1's
                    tblLevels = dvNL.ToTable("b", True, "NOMCONC", "CHARHELPER1")

                    For Count2 = 0 To intNumLevels - 1 'check for any null values
                        var3 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                        If IsDBNull(var3) Then
                            str1 = "The Nominal Concentration for some assigned samples for " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & " have not been configured."
                            str1 = str1 & ChrW(10) & "When this action is finished, please navigate to the Assigned Samples window and correct this problem."
                            If boolDisableWarnings Then
                            Else
                                MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                            End If
                            GoTo end1
                        End If

                    Next

                    'establish combo table of level numbers and run identifiers
                    Dim tblLevelsRID As System.Data.DataTable
                    Dim intNumLevelsRID As Short

                    'find number of table rows to generate
                    intRowsX = 0

                    boolOutHeadE = False
                    boolOutHeadI = False
                    boolDeleteRows = False

                    'For Count2 = 0 To intNumRuns - 1
                    '    'enter runid
                    '    var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")
                    '    'intRowsX = 0
                    '    For Count3 = 0 To intNumLevels - 1
                    '        varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")
                    '        dv2.RowFilter = ""
                    '        'don't know why, but must make a long filter here or
                    '        'both analytes get returned in dv2.rowfilter
                    '        strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom
                    '        dv2.RowFilter = strF
                    '        int2 = dv2.Count
                    '        If int2 > intRowsX Then
                    '            intRowsX = int2
                    '        End If
                    '    Next
                    'Next

                    'generate table
                    intTblRows = 0
                    intTblRows = intTblRows + 3 'for header
                    intTblRows = intTblRows + 2 'for blank row
                    intTblRows = intTblRows + 10 'for sections x 2
                    intTblRows = intTblRows + dv2.Count

                    GoTo skip1

                    intTblRows = intTblRows + (intNumRuns * intRowsX) 'for number of data rows
                    intTblRows = intTblRows + (1 * intNumRuns) 'for one blank rows after each run set
                    'intTblRows = intTblRows + (5 * intNumRuns) 'for Mean/Bias/n section for each run set

                    'Increment for Statistics Sections
                    Dim intCSN As Short
                    intCSN = countNumStatsRows()
                    intTblRows = intTblRows + (intCSN * intNumRuns) + (intCSN * numRID)

                    If intCSN > 0 Then
                        intTblRows = intTblRows + (2 * intNumRuns) - 3 'for two blank rows after each Mean/Bias/n set, except last set
                        intTblRows = intTblRows + (2 * numRID) 'for two blank rows after each run identifier Mean/Bias/n set
                    Else
                        intTblRows = intTblRows - 1 'subtract an unneeded blank row
                    End If
              

                    If boolQCREPORTACCVALUES Then

                    Else
                        'For Count2 = 1 To intNumRuns 'must loop because this table may have several sections
                        intTblRows = intTblRows + (3 * intNumRuns) 'for stats headings
                        ctExp = ctExp + 2 'for stats headings

                        'Increment for Statistics Sections
                        intTblRows = intTblRows + (intCSN * intNumRuns) + (intCSN * numRID)
                        ctExp = ctExp + (intCSN * intNumRuns) + (countNumStatsRowsWithoutTheoretical() * numRID)

                        If intCSN > 0 Then
                            intTblRows = intTblRows + (1 * intNumRuns) - 1 'for a blank row after each Mean/Bias/n set, except last set
                            intTblRows = intTblRows + (2 * numRID) 'for two blank rows after each run identifier Mean/Bias/n set
                            ctExp = ctExp + (1 * intNumRuns) - 1
                            ctExp = ctExp + (2 * numRID)
                        End If

                    End If

skip1:

                    wrdSelection = wd.Selection()

                    Dim intCols As Short
                    'get intcols from tblreportdata
                    Dim tblH As System.Data.DataTable
                    Dim rowsH() As DataRow

                    tblH = tblReportTableHeaderConfig
                    strF = "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND BOOLINCLUDE <> 0 AND ID_TBLSTUDIES = " & id_tblStudies
                    strS = "INTORDER ASC"
                    rowsH = tblH.Select(strF)
                    intCols = rowsH.Length

                    Dim wtbl As Word.Table


                    Try

                        '20180913 LEE:
                        Call IncrNextTableNumber(wd)

                        If boolPlaceHolder Then
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=1, NumColumns:=1, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        Else
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=intTblRows, NumColumns:=intCols, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        End If


                        .Selection.Tables.Item(1).Select()

                        wtbl = .Selection.Tables.Item(1)

                        Call SetCellPaddingZero(.Selection.Tables.Item(1))

                        .Selection.Tables.Item(1).Rows.AllowBreakAcrossPages = False
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                        .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                        .Selection.Tables.Item(1).Columns.PreferredWidth = Microsoft.Office.Interop.Word.WdPreferredWidthType.wdPreferredWidthPoints
                        '.Selection.Tables.Item(1).Columns.Item(1).Width = 86

                        .Selection.Tables.Item(1).Select()

                        'remove border, but leave top and bottom
                        '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderLeft).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderRight).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderHorizontal).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderVertical).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalDown).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalUp).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter

                        'border top and bottom of range
                        .Selection.Tables.Item(1).Cell(1, 1).Select()

                        If boolPlaceHolder Then

                            .Selection.Tables.Item(1).Select()
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone

                            strA = arrAnalytes(14, Count1)
                            strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, False)
                            Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                            'Note: strTName is byRef and will return Table, number, caption, label

                            Call MoveOneCellDown(wd)

                            .Selection.TypeParagraph()
                            .Selection.TypeParagraph()

                            'enter a table record in tblTableN
                            'ctTableN = ctTableN + 1
                            Dim dtblr1 As DataRow = tblTableN.NewRow
                            dtblr1.BeginEdit()
                            dtblr1.Item("TableNumber") = ctTableN
                            dtblr1.Item("AnalyteName") = arrAnalytes(1, Count1)
                            dtblr1.Item("TableName") = strTNameO
                            dtblr1.Item("TableID") = intTableID
                            dtblr1.Item("CHARFCID") = charFCID
                            dtblr1.Item("TableNameNew") = strTName
                            tblTableN.Rows.Add(dtblr1)

                            GoTo next1
                        End If

                        .Selection.Tables.Item(1).Select()
                        Call GlobalTableParaFormat(wd)

                        '20171220 LEE: Do not set table size, use the style default table
                        '.Selection.Font.Size = fontsize - 1
                        .Selection.Tables.Item(1).Cell(1, 1).Select()


                        '.Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=2, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        wtbl.Cell(1, 1).Select()
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        ''wdd.visible = True

                        'strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                        strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC, NOMCONC ASC"
                        dv2.Sort = strS
                        'enter headings
                        Dim intID As Int64
                        Dim boolRA As Boolean = False
                        For Count3 = 1 To intCols
                            boolRA = False
                            str1 = NZ(rowsH(Count3 - 1).Item("CHARUSERLABEL"), "")
                            str2 = Replace(str1, " ", ChrW(10), 1, -1, CompareMethod.Text)
                            wtbl.Cell(1, Count3).Select()

                            intID = rowsH(Count3 - 1).Item("ID_TBLCONFIGHEADERLOOKUP")
                            Select Case intID
                                Case 183, 188
                                    str2 = str2 & ChrW(10) & "(" & strConcUnits & ")"
                            End Select

                            Select Case intID
                                Case 185, 186, 187, 189, 191
                                    boolRA = True
                            End Select

                            .Selection.TypeText(str2)
                            If boolRA Then
                                .Selection.SelectColumn()
                                .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                                wtbl.Cell(1, Count3).Select()
                                .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                            End If

                        Next
                        Dim intAArea As Int32 = 0
                        Dim intISArea As Int32 = 0
                        Dim aConc As Double
                        Dim intRow As Short
                        Dim tblDV As System.Data.DataTable = dv2.ToTable
                        Dim rowsDV() As DataRow
                        Dim totRec As Single
                        Dim intRowO As Short
                        Dim arrConc
                        Dim n
                        'legend
                        '86: Control wo/IS
                        '87: Control w/IS
                        '88: Fortified tissue - half tolerance
                        '89: Fortified tissue - tolerance
                        '90: Fortified tissue - twice tolerance

                        ''wdd.visible = True

                        intRow = 1
                        For Count4 = 1 To 5
                            intRow = intRow + 2
                            Select Case Count4
                                Case 1
                                    str1 = "Control wo/IS"
                                Case 2
                                    str1 = "Control w/IS"
                                Case 3
                                    'intRow = intRow + 1
                                    'intRowO = intRow + 1
                                    str1 = "Fortified tissue - half tolerance"
                                Case 4
                                    'intRowO = intRow + 1
                                    str1 = "Fortified tissue - tolerance"
                                Case 5
                                    'intRowO = intRow + 1
                                    str1 = "Fortified tissue - twice tolerance"

                            End Select
                            strF = "CHARHELPER1 = '" & str1 & "'"
                            wtbl.Cell(intRow, 2).Select()
                            .Selection.TypeText(str1 & " samples")

                            Select Case Count4
                                Case 1
                                Case Else
                                    wtbl.Cell(intRow - 1, 1).Select()
                                    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                    .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                            End Select

                            'intRow = intRow + 1
                            intRowO = intRow + 1

                            Erase rowsDV
                            strS = "RUNSAMPLEORDERNUMBER ASC"
                            rowsDV = tblDV.Select(strF, strS)
                            totRec = 0
                            ReDim arrConc(rowsDV.Length)

                            'Select Case Count4
                            '    Case 1
                            '    Case Else
                            '        wtbl.Cell(intRow + 1, 1).Select()
                            '        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                            '        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                            'End Select
                            For Count2 = 1 To rowsDV.Length
                                intRow = intRow + 1
                                intAArea = 0
                                intISArea = 0
                                'enter columnar data
                                For Count3 = 1 To intCols
                                    intID = rowsH(Count3 - 1).Item("ID_TBLCONFIGHEADERLOOKUP")
                                    Select Case intID
                                        Case 179 'Watson Run ID
                                            var1 = NZ(rowsDV(Count2 - 1).Item("RUNID"), "")
                                        Case 180 'Sample Description
                                            var1 = NZ(rowsDV(Count2 - 1).Item("SAMPLENAME"), "")
                                            boolSampleName01 = True
                                            If boolSampleName01 Then
                                                var1 = SampleName(CStr(var1))
                                            End If
                                        Case 181 'Sequence ID
                                            var1 = NZ(rowsDV(Count2 - 1).Item("RUNSAMPLEORDERNUMBER"), "")
                                        Case 182 'Sample Type
                                            var2 = NZ(rowsDV(Count2 - 1).Item("RUNSAMPLEKIND"), "")
                                            var1 = Replace(var2, " ", ChrW(160), 1, -1, CompareMethod.Text)
                                        Case 183 'Nominal Conc.
                                            Select Case Count4
                                                Case 1, 2
                                                    var1 = ""
                                                Case Else
                                                    var2 = NZ(rowsDV(Count2 - 1).Item("NOMCONC"), "")
                                                    If Len(var2) = 0 Then
                                                        numNomConc = -1
                                                        var1 = ""
                                                    Else
                                                        If boolLUseSigFigs Then
                                                            numNomConc = SigFigOrDec(var2, LSigFig, False)
                                                            var1 = SigFigOrDecString(numNomConc, LSigFig, False)
                                                        Else
                                                            numNomConc = RoundToDecimalRAFZ(var2, LSigFig)
                                                            var1 = RoundToDecimalRAFZ(numNomConc, LSigFig)
                                                        End If

                                                    End If
                                                    'var1 = numNomConc ' SigFigOrDecString(var2, LSigFig, False)
                                            End Select

                                        Case 184 'RT (min)
                                            var1 = NZ(rowsDV(Count2 - 1).Item("ANALYTEPEAKRETENTIONTIME"), "")
                                        Case 185 'Analyte Area
                                            var1 = NZ(rowsDV(Count2 - 1).Item("ANALYTEAREA"), "")
                                            If Len(var1) = 0 Then
                                                intAArea = -1
                                            Else
                                                intAArea = RoundToDecimalRAFZ(var1, 0)
                                            End If
                                        Case 186 'Int. Std. Area
                                            var1 = NZ(rowsDV(Count2 - 1).Item("INTERNALSTANDARDAREA"), "")
                                            If Len(var1) = 0 Then
                                                intISArea = 1
                                            Else
                                                intISArea = RoundToDecimalRAFZ(var1, 0)
                                            End If
                                        Case 187 'Peak Area Ratio
                                            Select Case Count4
                                                Case 1
                                                    var1 = ""
                                                Case Else
                                                    'calculate peak area ratio
                                                    If intAArea = -1 Then
                                                        var1 = ""
                                                    Else
                                                        If intISArea = 0 Then
                                                            intISArea = 1
                                                        End If
                                                        var2 = intAArea / intISArea
                                                        var1 = RoundToDecimalRAFZ(var2, 5)
                                                    End If
                                            End Select

                                        Case 188 'Calc. Conc.
                                            Select Case Count4
                                                Case 1
                                                    var1 = ""
                                                Case Else
                                                    var2 = NZ(rowsDV(Count2 - 1).Item("CONCENTRATION"), 0)
                                                    var3 = NZ(rowsDV(Count2 - 1).Item("ALIQUOTFACTOR"), 1)
                                                    var4 = var2 / var3
                                                    If boolLUseSigFigs Then
                                                        var1 = SigFigOrDecString(var4, LSigFig, False)
                                                    Else
                                                        var1 = RoundToDecimalRAFZ(var4, LSigFig)
                                                    End If

                                                    aConc = var1
                                                    arrConc(Count2) = aConc
                                            End Select

                                        Case 189 '%Rec:  Calculate accuracy
                                            Select Case Count4
                                                Case 1, 2
                                                    var1 = ""
                                                Case Else
                                                    var2 = ((aConc / numNomConc) - 1) * 100
                                                    var1 = Format(var2, strQCDec)
                                                    totRec = totRec + CSng(var1)
                                            End Select

                                        Case 190 'Average %Rec
                                            var1 = ""
                                        Case 191 '%CV
                                            var1 = ""
                                    End Select

                                    wtbl.Cell(intRow, Count3).Select()
                                    .Selection.TypeText(CStr(var1))

                                Next
                            Next

                            If rowsDV.Length = 0 Then
                            Else
                                Select Case Count4
                                    Case 1, 2
                                    Case Else
                                        Dim numCV As Single
                                        wtbl.Cell(intRowO, intCols - 1).Select()
                                        'calculate mean %Rec
                                        n = rowsDV.Length
                                        var1 = Mean(n, arrConc)
                                        numBias = CalcREPercent(var1, numNomConc, intQCDec)
                                        var2 = Format(numBias, strQCDec)
                                        .Selection.TypeText(var2)
                                        var3 = StdDev(n, arrConc)
                                        numCV = (var3 / var1 * 100)
                                        var4 = Format(numCV, strQCDec) 'SigFigOrDecString(numCV, LSigFig, False)
                                        wtbl.Cell(intRowO, intCols).Select()
                                        .Selection.TypeText(var4)

                                End Select

                            End If

                            autofitContent(wd, 2)


                        Next

                        'LEGEND
                        'ANALYTEID
                        'STUDYID
                        'STUDYNAME
                        'RUNTYPEID
                        'RUNID
                        'RUNSAMPLEORDERNUMBER
                        'ASSAYDATETIME
                        'ASSAYLEVEL
                        'ELIMINATEDFLAG
                        'SAMPLENAME
                        'ALIQUOTFACTOR
                        'RUNSAMPLEKIND
                        'ASSAYID
                        'MASTERASSAYID
                        'ANALYTEINDEX
                        'CONCENTRATION
                        'RUNANALYTEREGRESSIONSTATUS
                        'ANALYTEHEIGHT
                        'ANALYTEAREA
                        'INTERNALSTANDARDHEIGHT
                        'INTERNALSTANDARDAREA
                        'INTERNALSTDNAME
                        'SAMPLETYPEKEY
                        'SAMPLETYPEID
                        'ANALYTEPEAKRETENTIONTIME
                        'INTERNALSTANDARDRETENTIONTIME 

                        GoTo skip2


                        For Count2 = 0 To intNumLevels - 1
                            var1 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                            var2 = tblLevels.Rows.Item(Count2).Item("CHARHELPER1")

                            '******determine if the level is a diln level
                            Dim strE As String
                            'var3 = var2 ' & ChrW(10) & var1 & " " & strConcUnits
                            var3 = ReturnStdQC(var2.ToString)
                            .Selection.TypeText(Text:=var3)

                            dv2.RowFilter = ""
                            strF = strF2 & " AND NOMCONC = " & CDbl(var1)
                            dv2.RowFilter = strF
                            'check for aliquot factor
                            Dim numDS As Single
                            If dv2.Count = 0 Then

                            Else
                                numDS = dv2(0).Item("ALIQUOTFACTOR")
                                If numDS <> 1 Then
                                    'record legend
                                    intLeg = intLeg + 1
                                    ctDilLeg = ctDilLeg + 1
                                    ctLegend = ctLegend + 1
                                    'configure first legend item
                                    'var3 = Format(1 / CDec(numDS), "0")
                                    var3 = GetDilnFactor(CDec(numDS)) '20190220 LEE
                                    strA = Chr(96 + intLeg) 'debugging
                                    arrLegend(1, intLeg) = Chr(96 + intLeg) 'a,b,c,etc
                                    'var: units
                                    Dim strAN As String = GetAN(var3)

                                    If boolLUseSigFigs Then
                                        'arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & DisplayNum(SigFigOrDec(Val(var1), LSigFig, False), LSigFig, False) & " " & strConcUnits & "; a 1:" & var3 & " dilution with blank matrix was performed prior to extraction and analysis."
                                        arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & DisplayNum(SigFigOrDec(Val(var1), LSigFig, False), LSigFig, False) & " " & strConcUnits & "; " & strAN & " " & var3 & "-fold dilution with blank matrix was performed prior to extraction and analysis."
                                    Else
                                        'arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & Format(CDbl(Val(var1)), GetRegrDecStr(LSigFig)) & " " & strConcUnits & "; a 1:" & var3 & " dilution with blank matrix was performed prior to extraction and analysis."
                                        arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & Format(CDbl(Val(var1)), GetRegrDecStr(LSigFig)) & " " & strConcUnits & "; " & strAN & " " & var3 & "-fold dilution with blank matrix was performed prior to extraction and analysis."
                                    End If


                                    arrLegend(3, intLeg) = True
                                    arrLegend(4, intLeg) = True

                                    'enter superscript
                                    fonts = .Selection.Font.Size
                                    .Selection.Font.Bold = True
                                    .Selection.Font.Superscript = True
                                    .Selection.Font.Size = 12
                                    .Selection.TypeText(" " & strA)
                                    .Selection.Font.Superscript = False
                                    .Selection.Font.Size = fonts
                                    .Selection.Font.Bold = False
                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic

                                End If

                            End If
                            '.Selection.TypeText(strE)

                            '******

                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            If boolSTATSDIFFCOL Then
                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            End If

                        Next


                        'Enter nom. conc. row titles
                        .Selection.Tables.Item(1).Cell(3, 2).Select()

                        For Count2 = 0 To intNumLevels - 1
                            'var1 = arrBCQCs(3, Count2)
                            If boolLUseSigFigs Then
                                var1 = CStr(DisplayNum(SigFigOrDec(tblLevels.Rows.Item(Count2).Item("NOMCONC"), LSigFig, False), LSigFig, False))
                            Else
                                var1 = CStr(Format(tblLevels.Rows.Item(Count2).Item("NOMCONC"), GetRegrDecStr(LSigFig)))
                            End If

                            var3 = var1 & " " & strConcUnits
                            .Selection.TypeText(Text:=var3)
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            If boolSTATSDIFFCOL Then
                                .Selection.TypeText(Text:=ReturnDiffLabel)
                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            End If

                        Next

                        .Selection.Tables.Item(1).Cell(3, 1).Select()
                        'bottom border this row
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        'enter Watson Run ID column header
                        .Selection.Tables.Item(1).Cell(3, 1).Select()

                        If BOOLINCLUDEDATE Then
                            .Selection.Tables.Item(1).Cell(2, 1).Select()
                            .Selection.TypeText(strWRunId)
                            .Selection.Tables.Item(1).Cell(3, 1).Select()
                            '.Selection.TypeText("(Analysis Date)")
                            '20180420 LEE:
                            .Selection.TypeText("(" & GetAnalysisDateLabel(intTableID) & ")")
                        Else
                            .Selection.TypeText(strWRunId)
                        End If

                        'begin entering data'
                        intStart = 5
                        int1 = 5 'row position counter
                        Dim boolExit As Boolean = False

                        For Count2 = 0 To intNumRuns - 1

                            ''legend

                            ''find number of runs used
                            'tblNumRuns = dv2.ToTable("a", True, "RUNID")
                            'intNumRuns = tblNumRuns.Rows.Count

                            ''find number of different Run Identifiers
                            'tblRID = dv2.ToTable("b", True, "RUNID")
                            'numRID = tblRID.Rows.Count

                            ''re-establish tblLevels to get charhelper2's
                            'tblRID = dv2.ToTable("b", True, "RUNID", "CHARHELPER2")

                            ''end legend


                            .Selection.Tables.Item(1).Cell(intStart, 1).Select()
                            'enter runid
                            var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")

                            frmH.lblProgress.Text = strM1 & ChrW(10) & "Processing Run ID " & var10
                            frmH.Refresh()

                            Dim strH As String
                            Dim rowsG() As DataRow
                            Dim intG As Short
                            strF = "RUNID = " & var10
                            rowsG = tblRID.Select(strF, "RUNID ASC")
                            intG = rowsG.Length
                            strH = "[NONE]"
                            If intG = 0 Then
                                strH = "[NONE]"
                            Else
                                strH = NZ(rowsG(0).Item("CHARHELPER2"), "[NONE]")
                            End If

                            .Selection.TypeText(CStr(var10))
                            int1 = intStart
                            If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                            Else
                                int1 = int1 + 1
                                .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1)
                                .Selection.TypeText(strH)
                                .Selection.MoveUp(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1)
                            End If
                            If BOOLINCLUDEDATE Then
                                int1 = int1 + 1
                                .Selection.Tables.Item(1).Cell(int1, 1).Select()
                                str1 = GetDateFromRunID(NZ(var10, 0), LDateFormat, intGroup, idTR)
                                .Selection.TypeText("(" & str1 & ")")
                                .Selection.Tables.Item(1).Cell(intStart, 1).Select()
                            End If
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)

                            'must first determine if there are any outliers
                            intExp = 0

                            For Count3 = 0 To intNumLevels - 1

                                varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")
                                'start evaluating data
                                dv2.RowFilter = strF2
                                'don't know why, but must make a long filter here or
                                'both analytes get returned in dv2.rowfilter
                                If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND (CHARHELPER2 IS NULL OR CHARHELPER2 = '')"
                                Else
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND CHARHELPER2 = '" & strH & "'"
                                End If
                                'strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom
                                ''''''''console.writeline(strF)
                                dv2.RowFilter = strF
                                int2 = dv2.Count 'debugging

                                Erase rows1

                                Dim tbl2SA As System.Data.DataTable = dv2.ToTable
                                strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                rows2 = tbl2SA.Select(strF)
                                int3 = rows2.Length
                                intRowsX = int3 'new introwsx

                                'evaluate data
                                For Count4 = 0 To intRowsX - 1 'int3 - 1
                                    var1 = NZ(rows2(Count4).Item("ELIMINATEDFLAG"), "N")
                                    var2 = NZ(rows2(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                    If StrComp(var1, "Y", CompareMethod.Text) = 0 Or var2 = -1 Then
                                        intExp = intExp + 1
                                        boolExit = True
                                        Exit For
                                    End If
                                Next

                                If boolExit Then
                                    Exit For
                                End If

                            Next

                            Dim boolEnterDiff As Boolean
                            Dim int12 As Short
                            int12 = -1
                            'start filling in data by columns
                            For Count3 = 0 To (intNumLevels * int11) - 1 Step int11
                                int12 = int12 + 1
                                varNom = tblLevels.Rows.Item(int12).Item("NOMCONC")

                                strF = "CONCENTRATION = " & varNom & " AND ANALYTEID = " & vAnalyteID & " AND MASTERASSAYID = " & vMasterAssayID & " AND ANALYTEINDEX = " & vAnalyteIndex & " AND CONCENTRATION = " & varNom & " AND RUNID = " & var10
                                'rows10 = tblBCQCs.Select(strF)
                                rows10 = tblQCRunIDs.Select(strF, "LEVELNUMBER ASC")
                                Dim intRC As Short
                                intRC = rows10.Length
                                If intRC = 0 Then
                                    var1 = 15
                                Else
                                    var1 = CDec(NZ(rows10(0).Item("ANALYTEFLAGPERCENT"), 15))
                                    var1 = NZ(var1, 15)
                                End If

                                var2 = var1
                                arrFP(1, int12) = var1
                                arrFP(2, int12) = var2
                                Call SetHighAndLowCriteria(varNom, var1, var1, hi, lo)
                                v1 = var1
                                v2 = var1
                                vU = 0

                                'start entering data
                                dv2.RowFilter = strF2
                                'don't know why, but must make a long filter here or
                                'both analytes get returned in dv2.rowfilter
                                If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND (CHARHELPER2 IS NULL OR CHARHELPER2 = '')"
                                Else
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND CHARHELPER2 = '" & strH & "'"
                                End If
                                dv2.RowFilter = strF
                                ''''''''console.writeline(strF)
                                int2 = dv2.Count
                                nI = int2

                                'create rows1 from tbl1 which will contain all data
                                strF = ""
                                Erase rows1

                                Dim tbl2s As System.Data.DataTable = dv2.ToTable
                                rows2 = tbl2s.Select("RUNID > -1")
                                int3 = rows2.Length

                                ''debugging
                                Dim CountE As Short
                                Dim CountF As Short
                                Dim CountG As Short
                                Dim strCCC As String

                                'now do rows2E
                                strF = ""

                                Erase rows2E

                                If gAllowExclSamples And LAllowExclSamples Then
                                    'rows2E = tbl2s.Select("ELIMINATEDFLAG = 'N' AND BOOLEXCLSAMPLE = 0")
                                    rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL) AND BOOLEXCLSAMPLE = 0")
                                    '(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)
                                Else
                                    'rows2E = tbl2s.Select("ELIMINATEDFLAG = 'N'")
                                    rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)")
                                End If

                                nE = rows2E.Length

                                'enter data
                                For Count4 = 0 To intRowsX - 1 'int3 - 1
                                    boolEnterDiff = False
                                    If Count4 = 0 Then
                                        'enter charhelper2
                                        str1 = NZ(dv2(0).Item("CHARHELPER2"), "")
                                        .Selection.Tables.Item(1).Cell(intStart + Count4 + 1, 1).Select()
                                        .Selection.TypeText(str1)
                                        vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                        v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                        v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                    End If
                                    .Selection.Tables.Item(1).Cell(intStart + Count4, Count3 + 2).Select()
                                    If Count4 > int3 - 1 Then

                                        If boolQCNA Then
                                            str1 = "NA"
                                        Else
                                            str1 = ""
                                        End If

                                        .Selection.TypeText(str1)
                                        boolEnterDiff = False
                                    Else
                                        var1 = rows2(Count4).Item("CONCENTRATION")
                                        varConc = var1
                                        varAnal = NZ(rows2(Count4).Item("ANALYTEAREA"), 0)
                                        varIS = NZ(rows2(Count4).Item("INTERNALSTANDARDAREA"), 0)

                                        var1 = NZ(var1, 0)
                                        numDF = rows2(Count4).Item("ALIQUOTFACTOR")
                                        var1 = var1 / numDF

                                        If boolRCConc Then
                                            If boolLUseSigFigs Then
                                                var2 = SigFigOrDec(var1, LSigFig, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If


                                        Else
                                            'var2 = SigFigOrDec(var1, LSigFig, False)

                                            If boolIS Then
                                                var1 = varIS
                                            Else
                                                var1 = varAnal
                                            End If
                                            '*****
                                            If boolRCPARatio Then

                                                If boolLUseSigFigsAreaRatio Then
                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, False)
                                                Else
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                End If
                                            Else
                                                If boolLUseSigFigsArea Then
                                                    var1 = SigFigArea(var1, LSigFigArea, False, False) 'special rounding incorporated
                                                Else
                                                    var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                End If
                                                var2 = var1
                                            End If
                                            '*****
                                        End If

                                        var1 = NZ(rows2(Count4).Item("ELIMINATEDFLAG"), "N")

                                        Dim vE
                                        vE = dv2(Count4).Item("BOOLEXCLSAMPLE")

                                        If IsDBNull(varConc) Then

                                            boolEnterDiff = True 'FALSE
                                            intExp = intExp + 1
                                            intLeg = intLeg + 1
                                            strA = ChrW(intLeg + intLegStart)

                                            var1 = "Y"

                                            str1 = "No Value."

                                            'Add to Legend Array
                                            ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                            If boolRedBoldFont Then
                                                .Selection.Font.Bold = True
                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            End If

                                            .Selection.TypeText(Text:="NV")

                                            Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                        ElseIf StrComp(var1, "Y", vbTextCompare) = 0 Or (gAllowExclSamples And LAllowExclSamples And vE = -1) Then

                                            boolEnterDiff = True 'FALSE
                                            intExp = intExp + 1
                                            intLeg = intLeg + 1
                                            strA = ChrW(intLeg + intLegStart)

                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                If v1 = v2 Then
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                Else
                                                    str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                End If

                                                'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                            Else
                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                            End If

                                            'Add to Legend Array
                                            ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                            If boolRedBoldFont Then
                                                .Selection.Font.Bold = True
                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            End If

                                            If boolRCConc Then
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                End If

                                            Else

                                                If boolIS Then
                                                    var1 = varIS
                                                Else
                                                    var1 = varAnal
                                                End If
                                                '*****
                                                If boolRCPARatio Then
                                                    If boolLUseSigFigsAreaRatio Then
                                                        var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, False)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                    End If
                                                Else
                                                    If boolLUseSigFigsArea Then
                                                        var1 = SigFigArea(var1, LSigFigArea, False, False) 'special rounding incorporated
                                                    Else
                                                        var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    var2 = var1
                                                End If
                                                .Selection.TypeText(Text:=CStr(var2))
                                                '*****
                                            End If

                                            Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                        Else

                                            boolEnterDiff = True
                                            'determine if value is outside acceptance criteria
                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'If (var2 > hi Or var2 < lo) And boolRCConc Then 'flag
                                            If (OutsideAccCrit(var2, varNom, v1, v2, NZ(vU, 0))) And boolRCConc Then 'flag
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                    v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                    'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'search for str1 in arrLegend
                                                boolPro = False
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For
                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                    End If
                                                Else

                                                    If boolIS Then
                                                        var1 = varIS
                                                    Else
                                                        var1 = varAnal
                                                    End If
                                                    '*****
                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(var1, LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    End If
                                                    .Selection.TypeText(Text:=CStr(var2))
                                                    '*****
                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                            Else

                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                    End If

                                                Else

                                                    If boolIS Then
                                                        var1 = varIS
                                                    Else
                                                        var1 = varAnal
                                                    End If
                                                    '*****
                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(var1, LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    End If
                                                    .Selection.TypeText(Text:=CStr(var2))
                                                    '*****
                                                End If

                                                boolEnterDiff = True
                                            End If
                                        End If

                                    End If

                                    If boolSTATSDIFFCOL Then
                                        .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                        If boolEnterDiff Then
                                            'var3 = Format(((var2 / varNom) - 1) * 100, strQCDec)
                                            var3 = Format(RoundToDecimal(((var2 / varNom) - 1) * 100, intQCDec), strQCDec)
                                        Else

                                            If boolQCNA Then
                                                var3 = "NA"
                                            Else
                                                var3 = ""
                                            End If

                                        End If
                                        .Selection.TypeText(Text:=CStr(var3))
                                        .Selection.MoveLeft(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                    End If

                                Next

                                .Selection.Tables.Item(1).Cell(intStart + Count4 + 1, 1).Select()
                                int1 = .Selection.Information(Microsoft.Office.Interop.Word.WdInformation.wdStartOfRangeRowNumber)
                                '.Selection.Tables.Item(1).Cell(int1 + 1, 2).Select()
                                'begin doing stats
                                If boolQCREPORTACCVALUES Then
                                Else
                                    If intExp = 0 Then
                                    Else
                                        If boolOutHeadE Then
                                        Else
                                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                            .Selection.TypeText(Text:="Summary Statistics Excluding Outlier Values")
                                            .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                            Try
                                                .Selection.Cells.Merge()
                                            Catch ex As Exception

                                            End Try
                                            With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                            End With
                                            boolOutHeadE = True
                                        End If


                                        .Selection.Tables.Item(1).Cell(int1 + 1, 1).Select()
                                    End If
                                End If

                                int1 = .Selection.Information(Microsoft.Office.Interop.Word.WdInformation.wdStartOfRangeRowNumber)

                                'now enter Mean/Bias/n
                                If Count3 = 0 Then
                                    int8 = 0
                                    Call typeStatsLabels(wd, int8, int1 - 1, 1, False)

                                    If boolQCREPORTACCVALUES Then
                                    Else
                                        If intExp = 0 Then
                                        Else
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + int8, 1).Select()
                                            If boolOutHeadI Then
                                            Else
                                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                                .Selection.TypeText(Text:="Summary Statistics Including Outlier Values")
                                                .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                                Try
                                                    .Selection.Cells.Merge()
                                                Catch ex As Exception

                                                End Try
                                                boolOutHeadI = True
                                            End If

                                            With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                            End With

                                            Call typeStatsLabels(wd, int8, int1, 1, False)
                                        End If
                                    End If

                                End If

                                int8 = 0
                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                If boolSTATSMEAN Then
                                    Try
                                        'enter Mean
                                        int8 = int8 + 1
                                        If boolRCConc Then
                                            var1 = MeanDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                        Else
                                            'var1 = MeanDR(rows2E, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                            If boolIS Then
                                                var1 = MeanDR(rows2E, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, False)
                                            Else
                                                var1 = MeanDR(rows2E, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                            End If

                                        End If
                                        numMean = 0
                                        If boolRCConc Then
                                            If boolLUseSigFigs Then
                                                numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                            Else
                                                numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If

                                            'here

                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'determine if value is outside acceptance criteria
                                            'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag
                                            If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'search for str1 in arrLegend
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For

                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                boolEnterDiff = True
                                            Else
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If
                                                boolEnterDiff = True
                                            End If

                                        Else

                                            If boolIS Then
                                                var1 = varIS
                                            Else
                                                var1 = varAnal
                                            End If
                                            '*****
                                            If boolRCPARatio Then
                                                If boolLUseSigFigsAreaRatio Then
                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                Else
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                End If
                                            Else
                                                If boolLUseSigFigsArea Then
                                                    var2 = SigFigArea(var1, LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                End If

                                            End If
                                            '*****
                                            numMean = var2
                                            .Selection.TypeText(Text:=CStr(var2))

                                        End If
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Mean", numMean, CSng(var10), Count1, strDo, 0, 0, False)

                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                    Catch ex As Exception

                                    End Try
                                End If
                                If boolSTATSSD Then
                                    Try
                                        'enter SD
                                        int8 = int8 + 1
                                        If nE < gSDMax Then
                                            .Selection.TypeText("NA")
                                        Else
                                            numSD = 0
                                            If boolRCConc Then
                                                var1 = StdDevDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                            Else
                                                If boolIS Then
                                                    var1 = StdDevDRArea(rows2E, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, False)
                                                Else
                                                    var1 = StdDevDRArea(rows2E, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                                End If

                                            End If

                                            If boolRCConc Then
                                                If boolLUseSigFigs Then
                                                    numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    .Selection.TypeText(CStr(DisplayNum(numSD, LSigFig, False)))
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                    .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                                End If

                                            Else

                                                If boolIS Then
                                                    var1 = varIS
                                                Else
                                                    var1 = varAnal
                                                End If
                                                '*****
                                                If boolRCPARatio Then
                                                    If boolLUseSigFigsAreaRatio Then
                                                        var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                    End If
                                                Else
                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If

                                                End If
                                                '*****

                                                numSD = var2
                                                .Selection.TypeText(CStr(var2))

                                            End If
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "SD", numSD, CSng(var10), Count1, strDo, 0, 0, False)

                                        End If

                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSCV Then
                                    Try
                                        'enter %CV
                                        int8 = int8 + 1
                                        If nE < gSDMax Then
                                            .Selection.TypeText("NA")
                                        Else
                                            numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Precision", numPrec, CSng(var10), Count1, strDo, 0, 0, False)

                                        End If

                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                    Catch ex As Exception

                                    End Try
                                End If
                                If boolSTATSBIAS And boolSTATSMEAN Then
                                    Try
                                        'enter %Bias
                                        int8 = int8 + 1
                                        numBias = CalcREPercent(numMean, varNom, intQCDec)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolTHEORETICAL And boolSTATSMEAN Then
                                    Try
                                        'enter %theoretical
                                        int8 = int8 + 1
                                        numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                        numTheor = 100 + CDec(numTheor)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numTheor, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numTheor, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try

                                End If

                                If boolSTATSDIFF And boolSTATSMEAN Then
                                    Try
                                        'enter %Bias
                                        int8 = int8 + 1
                                        numBias = CalcREPercent(numMean, varNom, intQCDec)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                If BOOLSTATSRE And boolSTATSMEAN Then
                                    Try
                                        'enter %RE
                                        int8 = int8 + 1
                                        numBias = CalcREPercent(numMean, varNom, intQCDec)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSN Then
                                    Try
                                        'enter n
                                        int8 = int8 + 1
                                        .Selection.TypeText(CStr(nE))
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "n", nE, CSng(var10), Count1, strDo, 0, 0, False)

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolQCREPORTACCVALUES Then
                                Else
                                    If intExp = 0 Then
                                        If boolDeleteRows Then
                                        Else
                                            Call DeleteRows(ctExp / intNumRuns, wd)
                                            boolDeleteRows = True
                                        End If

                                    Else
                                        int8 = int8 + 2
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                        If boolSTATSMEAN Then
                                            Try
                                                'enter Mean
                                                int8 = int8 + 1

                                                If boolRCConc Then
                                                    var1 = MeanDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                Else
                                                    'var1 = MeanDR(rows2, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                                    If boolIS Then
                                                        var1 = MeanDR(rows2, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, False)
                                                    Else
                                                        var1 = MeanDR(rows2, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                                    End If
                                                End If
                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If


                                                    If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                        Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                                    End If

                                                    'determine if value is outside acceptance criteria
                                                    'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag
                                                    If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                        intLeg = intLeg + 1
                                                        strA = ChrW(intLeg + intLegStart)
                                                        If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                            If v1 = v2 Then
                                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            Else
                                                                str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            End If
                                                        Else
                                                            str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                        End If

                                                        'Add to Legend Array
                                                        ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                                        If boolRedBoldFont Then
                                                            .Selection.Font.Bold = True
                                                            .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If

                                                        Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                        boolEnterDiff = True
                                                    Else
                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If
                                                        boolEnterDiff = True
                                                    End If

                                                Else

                                                    If boolIS Then
                                                        var1 = varIS
                                                    Else
                                                        var1 = varAnal
                                                    End If
                                                    '*****
                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If

                                                    End If
                                                    '*****

                                                    numMean = var2
                                                    .Selection.TypeText(CStr(var2))

                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSSD Then
                                            Try
                                                'enter SD
                                                int8 = int8 + 1
                                                If nI < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    If boolRCConc Then
                                                        var1 = StdDevDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                    Else
                                                        'var1 = StdDevDR(rows2, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                                        If boolIS Then
                                                            var1 = StdDevDRArea(rows2, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, False)
                                                        Else
                                                            var1 = StdDevDRArea(rows2, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                                        End If

                                                    End If

                                                    If boolRCConc Then
                                                        If boolLUseSigFigs Then
                                                            numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            .Selection.TypeText(CStr(DisplayNum(numSD, LSigFig, False)))
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                            .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                                        End If

                                                    Else

                                                        If boolIS Then
                                                            var1 = varIS
                                                        Else
                                                            var1 = varAnal
                                                        End If
                                                        '*****
                                                        If boolRCPARatio Then
                                                            If boolLUseSigFigsAreaRatio Then
                                                                var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                            Else
                                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                            End If
                                                        Else
                                                            If boolLUseSigFigsArea Then
                                                                var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                            Else
                                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                            End If

                                                        End If
                                                        '*****

                                                        numSD = var2
                                                        .Selection.TypeText(CStr(var2))

                                                    End If
                                                End If

                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSCV Then
                                            Try
                                                'enter %CV
                                                int8 = int8 + 1
                                                If nI < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                    .Selection.TypeText(Format(numPrec, strQCDec))
                                                End If

                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSBIAS And boolSTATSMEAN Then
                                            Try
                                                'enter %Bias
                                                int8 = int8 + 1
                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolTHEORETICAL And boolSTATSMEAN Then
                                            Try
                                                'enter %theoretical
                                                int8 = int8 + 1
                                                numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                                numTheor = 100 + CDec(numTheor)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numTheor, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try

                                        End If

                                        If boolSTATSDIFF And boolSTATSMEAN Then
                                            Try
                                                'enter %Bias
                                                int8 = int8 + 1
                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If BOOLSTATSRE And boolSTATSMEAN Then
                                            Try
                                                'enter %RE
                                                int8 = int8 + 1
                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSN Then
                                            Try
                                                'enter n
                                                int8 = int8 + 1
                                                .Selection.TypeText(CStr(nI))
                                            Catch ex As Exception

                                            End Try
                                        End If
                                    End If
                                End If

                            Next

                            'increase row position counter
                            If Count2 = intNumRuns - 1 Then
                                intStart = int1 + int8 + 1
                            Else
                                intStart = int1 + int8 + 1
                            End If

                            'Next Count10

                        Next

skip2:


                    Catch ex As Exception

                        str1 = "There was a problem preparing table:"
                        str1 = strM1 & ChrW(10) & ChrW(10) & str1
                        str1 = str1 & ChrW(10) & ChrW(10)
                        str1 = str1 & ex.Message
                        MsgBox(str1, vbInformation, "Problem...")

                    End Try



                    'bottom border this row
                    wtbl.Cell(wtbl.Rows.Count, 1).Select()
                    .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow)
                    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                    .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                    ''wdd.visible = True

                    'autofit window
                    .Selection.Tables.Item(1).Select()
                    'autofit table
                    Call AutoFitTable(wd, False)


                    ''go back and merge line 1
                    '.Selection.Tables.Item(1).Cell(1, 2).Select()
                    '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                    ''.Selection.Cells.Merge()
                    'If intNumLevels < 2 Then
                    'Else
                    '    Try
                    '        .Selection.Cells.Merge()
                    '    Catch ex As Exception

                    '    End Try
                    'End If
                    '.Selection.Font.Bold = False
                    '.Selection.TypeText(Text:="Nominal Concentrations")
                    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                    '.Selection.Tables.Item(1).Cell(1, 1).Select()
                    ''go to end of table
                    '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdColumn)

                    'enter table number
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End
                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next
                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    'remove unused rows
                    Call RemoveRows(wd, ctTbl)

                    '***
                    strA = rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                    strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, False)
                    Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                    'Note: strTName is byRef and will return Table, number, caption, label

                    '***
                    'Call EnterTableNumber(wd, str1, 3)

                    'enter a table record in tblTableN
                    'ctTableN = ctTableN + 1
                    Dim dtblr As DataRow = tblTableN.NewRow
                    dtblr.BeginEdit()
                    dtblr.Item("TableNumber") = ctTableN
                    dtblr.Item("AnalyteName") = strDo 'arrAnalytes(1, Count1)
                    dtblr.Item("TableName") = strTNameO
                    dtblr.Item("TableID") = intTableID
                    dtblr.Item("CHARFCID") = charFCID
                    dtblr.Item("TableNameNew") = strTName
                    tblTableN.Rows.Add(dtblr)

                    'split table, if needed
                    str1 = frmH.lblProgress.Text

                    ctLegend = ctLegend + 1
                    intLeg = intLeg + 1
                    arrLegend(1, intLeg) = "NA"
                    arrLegend(2, intLeg) = "Not Applicable"
                    arrLegend(3, intLeg) = False
                    'autofit table
                    Call AutoFitTable(wd, BOOLINCLUDEDATE)

                    strM = "Finalizing " & strTName & "..."
                    strM1 = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."
                    str1 = strM1

                    frmH.lblProgress.Text = strM1
                    frmH.Refresh()

                    Call SplitTable(wd, 4, intLeg, arrLegend, str1, False, ctLegend + 2, False, False, False, intTableID)

                    'move to line below table
                    Call MoveOneCellDown(wd)

                    Call InsertLegend(wd, intTableID, idTR, False, 1)


                Else
                    boolJustTable = False

                End If

end1:
                If boolJustTable Then
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End
                    str2 = ""
                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next

                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    str1 = str2 & " Final Extract Stability: Summary of " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION") & " Interpolated QC Standard Concentrations."
                    str2 = str1
                    str1 = NZ(rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION"), "")
                    'Call JustTable(wd, str1, str2, strDo, strTName, intTableID)
                    If Len(str1) = 0 Then
                    Else
                        Call JustTable(wd, str1, strTName, strDo, strTName, intTableID, strTempInfo, "", strTNameO, 1, idTR)
                    End If


                End If

next1:

            Next
end2:
        End With


    End Sub

    Sub MT_CalibrStds_36(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal idTR As Int64)

        Dim numNomConc As Decimal
        Dim var1, var2, var3, var4, var5, var10
        Dim dvDo As system.data.dataview
        Dim strTName As String
        Dim intDo As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim Count10 As Short
        Dim strDo As String
        Dim bool As Boolean
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim tbl1 As System.Data.DataTable
        Dim dv1 As system.data.dataview
        Dim rows1() As DataRow
        Dim intRows1 As Short
        Dim strF1 As String
        Dim tbl2 As System.Data.DataTable
        Dim dv2 As system.data.dataview
        Dim rows2() As DataRow
        Dim intRows2 As Short
        Dim strF2 As String
        Dim tbl3 As System.Data.DataTable
        Dim dv3 As system.data.dataview
        Dim rows3() As DataRow
        Dim intRows3 As Short
        Dim strF3 As String
        Dim intTableID As Short
        Dim tbl4 As System.Data.DataTable
        Dim dv4 As system.data.dataview
        Dim rows4() As DataRow
        Dim intRows4 As Short
        Dim strF4 As String
        Dim strS As String
        Dim intNumRuns As Short
        Dim dv As system.data.dataview
        Dim tblNumRuns As System.Data.DataTable
        Dim tblLevels As System.Data.DataTable
        Dim intNumLevels As Short
        Dim intTblRows As Short
        Dim wrdSelection As Microsoft.Office.Interop.Word.Selection
        Dim strF As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim int4 As Short
        Dim int10 As Short
        Dim intRowsX As Short
        Dim tblX As System.Data.DataTable
        Dim varNom
        Dim strConcUnits As String
        Dim intLeg As Short
        Dim ctQCLegend As Short
        Dim ctDilLeg As Short
        Dim strA As String
        Dim strB As String

        Dim ctLegend As Short
        Dim fontsize
        Dim boolPro As Boolean

        Dim varConc

        Dim hi, lo
        Dim rows10() As DataRow
        Dim rows11() As DataRow
        Dim intRowsAnal As Short
        Dim arrFP(2, 20) 'FlagPercent array: 1=hi, 2=lo
        Dim strFP As String
        Dim numMean As Decimal
        Dim numBias As Decimal
        Dim numSD As Decimal
        Dim tblZ As System.Data.DataTable
        Dim dvAn As system.data.dataview
        Dim tblAnGo As New System.Data.DataTable
        Dim p1, p2, p3, p4, p5, p6, p7, p8, p9, p10
        Dim strM As String
        Dim fonts
        Dim numDF As Decimal
        Dim DilFactor
        Dim strF2a As String
        Dim strTempInfo As String
        Dim rowsX() As DataRow
        Dim intLegStart As Short
        Dim boolJustTable As Boolean

        Dim intExp As Short
        Dim ctExp As Short
        Dim int8 As Short
        Dim intStart As Short

        Dim rows2E() As DataRow
        Dim nE As Short
        Dim nI As Short
        Dim boolOutHeadE As Boolean = False
        Dim boolOutHeadI As Boolean = False
        Dim boolDeleteRows As Boolean = False

        Dim tblRID As System.Data.DataTable
        Dim numRID As Short
        Dim ctTbl As Short
        Dim varAnal, varIS
        Dim v1, v2, vU

        Dim strMatrix As String
        Dim intGroup As Short

        Dim numPrec As Single
        Dim numTheor As Single

        Dim boolIS As Boolean = False

        Dim strTNameO As String

        Dim charFCID As String
        strF = "ID_TBLREPORTTABLE = " & idTR
        Dim rowsTR() As DataRow = tblReportTable.Select(strF)
        var1 = rowsTR(0).Item("CHARFCID")
        charFCID = NZ(var1, "NA")

        boolJustTable = False

        Cursor.Current = Cursors.WaitCursor

        ''wdd.visible = True

        fontsize = wd.ActiveDocument.Styles("Normal").Font.Size ' wd.Selection.Font.Size
        fonts = fontsize ' wd.Selection.Font.Size

        With wd

            intTableID = 36

            Dim strWRunId As String = GetWatsonColH(intTableID)

            dvDo = frmH.dgvReportTableConfiguration.DataSource
            strF = "id_tblconfigreporttables = " & intTableID
            intDo = FindRowDVNumByCol(intTableID, dvDo, "id_tblconfigreporttables")

            '***
            intDo = FindRowDVNumByCol(idTR, dvDo, "ID_TBLREPORTTABLE")

            'Get table name
            var1 = dvDo(intDo).Item("CHARHEADINGTEXT")
            strTName = NZ(var1, "[NONE]")

            strTNameO = strTName

            'get Temperature info
            var1 = dvDo(intDo).Item("CHARSTABILITYPERIOD")
            strTempInfo = NZ(var1, "[NONE]")

            '***

            ctPB = ctPB + 1
            If ctPB > frmH.pb1.Maximum Then
                ctPB = 1
            End If
            frmH.pb1.Value = ctPB
            frmH.pb1.Refresh()

            tbl1 = tblAnalysisResultsHome
            tbl2 = tblAssignedSamples
            tbl3 = tblAssignedSamplesHelper
            tbl4 = tblAnalytesHome

            Dim tbl5 As System.Data.DataTable
            tbl5 = tblTableProperties
            strF = "ID_TBLREPORTTABLE = " & idTR


            'ensure data has been entered
            strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR
            rowsX = tbl2.Select(strF)

            strF = "IsIntStd = 'No'"
            strS = "INTORDER ASC, IsIntStd ASC, AnalyteDescription ASC"
            rows11 = tblAnalytesHome.Select(strF, strS)
            intRowsAnal = rows11.Length

            ctTbl = 0
            For Count1 = 1 To intRowsAnal

                boolJustTable = False

                Dim arrLegend(4, 20)

                strTName = strTNameO

                ctLegend = 0

                Dim int11 As Short
                If boolSTATSDIFFCOL Then
                    int11 = 2
                Else
                    int11 = 1
                End If

                'for legend stuff

                intExp = 0
                ctExp = 0

                intLeg = 0
                ctQCLegend = 0
                ctDilLeg = 0
                ctLegend = 0
                strA = ""
                strB = ""
                arrLegend.Clear(arrLegend, 0, arrLegend.Length)
                arrFP.Clear(arrFP, 0, arrFP.Length)
                intLegStart = 96


                'check if table is to be generated
                strDo = rows11(Count1 - 1).Item("ANALYTEDESCRIPTION")

                If UseAnalyte(CStr(strDo)) Then
                Else
                    GoTo next1
                End If

                bool = dvDo.Item(intDo).Item(strDo) 'find boolean value of dvDo column

                Dim strAnalC As String
                Dim strAnal As String
                Dim intAnalyteID As Int32

                Dim strM1 As String
                If bool Then 'continue

                    ctTbl = ctTbl + 1

                    intTCur = intTCur + 1

                    If boolUseGroups Then
                        intGroups = tblAnalyteGroups.Rows(Count1 - 1).Item("INTGROUP")
                        strMatrix = tblAnalyteGroups.Rows(Count1 - 1).Item("MATRIX")
                        strAnalC = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                        gstrAnal = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C") ' arrAnalytes(1, Count1)
                        strAnal = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION") ' arrAnalytes(1, Count1)
                        intAnalyteID = tblAnalyteGroups.Rows(Count1 - 1).Item("ANALYTEID")
                    Else
                        strAnalC = arrAnalytes(14, Count1)
                        gstrAnal = arrAnalytes(1, Count1)
                        strAnal = arrAnalytes(1, Count1)
                    End If

                    'ensure data has been entered
                    strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ID_TBLREPORTTABLE = " & idTR
                    rowsX = tbl2.Select(strF)
                    If rowsX.Length = 0 Then
                        'strM = "Creating Summary of " & strTempInfo & " Final Extract Stability Table ...."
                        strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                        frmH.lblProgress.Text = strM
                        frmH.Refresh()
                        'MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
                        boolJustTable = True
                        'page setup according to configuration
                        str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                        'insert page break
                        'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                        Call InsertPageBreak(wd)
                        Call PageSetup(wd, str1) 'L=Landscape, P=Portrait
                        GoTo end1
                    Else
                        boolJustTable = False
                    End If

                    'page setup according to configuration
                    str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                    'insert page break
                    'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                    Call InsertPageBreak(wd)
                    Call PageSetup(wd, str1) 'L=Landscape, P=Portrait

                    'ReDim arrBCQCs(8, 50) '1=LevelNumber, 2=NomConcentration, 3=ID, 4=FlagPercent, 5=Hello, 6=Lo, 7=#ofReplicates, 8=ASSAYID
                    strM = "Creating Summary of " & strTempInfo & " Final Extract Stability Table For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                    strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                    strM1 = strM
                    frmH.lblProgress.Text = strM
                    frmH.Refresh()

                    'get strConcUnits
                    int1 = FindRowDV("ULOQ Units", frmH.dgvWatsonAnalRef.DataSource)
                    strConcUnits = NZ(frmH.dgvWatsonAnalRef(Count1, int1).Value, "ng/mL")

                    int1 = FindRowDV("Alternate Calibr/QC Std Units", frmH.dgvStudyConfig.DataSource)
                    str1 = NZ(frmH.dgvStudyConfig(1, int1).Value, "")

                    If Len(str1) = 0 Or StrComp(str1, "[None]", CompareMethod.Text) = 0 Then
                    Else
                        strConcUnits = str1
                    End If

                    'setup tables


                    var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    var4 = tbl4.Rows.Item(Count1 - 1).Item("ANALYTEID")

                    Dim vAnalyteIndex
                    Dim vMasterAssayID
                    Dim vAnalyteID
                    vAnalyteID = var4
                    vMasterAssayID = var2
                    vAnalyteIndex = var1

                    strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                    strF2 = strF2 & "ANALYTEID = " & var4 & " AND "
                    strF2 = strF2 & "MASTERASSAYID = " & var2 ' & " AND "
                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    rows2 = tbl2.Select(strF2, strS)
                    int1 = rows2.Length 'debug
                    dv2 = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                    int1 = dv2.Count 'debug

                    'find number of runs used
                    tblNumRuns = dv2.ToTable("a", True, "RUNID")
                    intNumRuns = tblNumRuns.Rows.Count

                    'var1 = dv2(0).Item("RUNID") 'DEBUG


                    'find number of different Run Identifiers
                    tblRID = dv2.ToTable("b", True, "RUNID")
                    numRID = tblRID.Rows.Count

                    're-establis tblLevels to get charhelper2's
                    tblRID = dv2.ToTable("b", True, "RUNID", "CHARHELPER2")

                    'establish table of level numbers
                    'must be sorted by nomconc!
                    'make new dv
                    Dim dvNL As New DataView(tbl2, strF2, "NOMCONC", DataViewRowState.CurrentRows)
                    tblLevels = dvNL.ToTable("b", True, "NOMCONC")
                    intNumLevels = tblLevels.Rows.Count

                    're-establisH tblLevels to get charhelper1's
                    tblLevels = dvNL.ToTable("b", True, "NOMCONC", "CHARHELPER1")

                    For Count2 = 0 To intNumLevels - 1 'check for any null values
                        var3 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                        If IsDBNull(var3) Then
                            str1 = "The Nominal Concentration for some assigned samples for " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & " have not been configured."
                            str1 = str1 & ChrW(10) & "When this action is finished, please navigate to the Assigned Samples window and correct this problem."
                            If boolDisableWarnings Then
                            Else
                                MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                            End If
                            'MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                            GoTo end1
                        End If

                    Next

                    'establish combo table of level numbers and run identifiers
                    Dim tblLevelsRID As System.Data.DataTable
                    Dim intNumLevelsRID As Short

                    'find number of table rows to generate
                    intRowsX = 0

                    boolOutHeadE = False
                    boolOutHeadI = False
                    boolDeleteRows = False

                    'For Count2 = 0 To intNumRuns - 1
                    '    'enter runid
                    '    var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")
                    '    'intRowsX = 0
                    '    For Count3 = 0 To intNumLevels - 1
                    '        varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")
                    '        dv2.RowFilter = ""
                    '        'don't know why, but must make a long filter here or
                    '        'both analytes get returned in dv2.rowfilter
                    '        strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom
                    '        dv2.RowFilter = strF
                    '        int2 = dv2.Count
                    '        If int2 > intRowsX Then
                    '            intRowsX = int2
                    '        End If
                    '    Next
                    'Next

                    'generate table
                    intTblRows = 0
                    intTblRows = intTblRows + 3 'for header
                    intTblRows = intTblRows + 1 'for blank row
                    intTblRows = intTblRows + dv2.Count

                    GoTo skip1

                    intTblRows = intTblRows + (intNumRuns * intRowsX) 'for number of data rows
                    intTblRows = intTblRows + (1 * intNumRuns) 'for one blank rows after each run set
                    'intTblRows = intTblRows + (5 * intNumRuns) 'for Mean/Bias/n section for each run set

                    'Increment for Statistics Sections
                    Dim intCSN As Short
                    intCSN = countNumStatsRows()
                    intTblRows = intTblRows + (intCSN * intNumRuns) + (intCSN * numRID)

                    If intCSN > 0 Then
                        intTblRows = intTblRows + (2 * intNumRuns) - 3 'for two blank rows after each Mean/Bias/n set, except last set
                        intTblRows = intTblRows + (2 * numRID) 'for two blank rows after each run identifier Mean/Bias/n set
                    Else
                        intTblRows = intTblRows - 1 'subtract an unneeded blank row
                    End If


                    If boolQCREPORTACCVALUES Then

                    Else
                        'For Count2 = 1 To intNumRuns 'must loop because this table may have several sections
                        intTblRows = intTblRows + (3 * intNumRuns) 'for stats headings
                        ctExp = ctExp + 2 'for stats headings

                        'Increment for Statistics Sections
                        intTblRows = intTblRows + (intCSN * intNumRuns) + (intCSN * numRID)
                        ctExp = ctExp + (intCSN * intNumRuns) + (countNumStatsRowsWithoutTheoretical() * numRID)

                        If intCSN > 0 Then
                            intTblRows = intTblRows + (1 * intNumRuns) - 1 'for a blank row after each Mean/Bias/n set, except last set
                            intTblRows = intTblRows + (2 * numRID) 'for two blank rows after each run identifier Mean/Bias/n set
                            ctExp = ctExp + (1 * intNumRuns) - 1
                            ctExp = ctExp + (2 * numRID)
                        End If

                    End If

skip1:

                    wrdSelection = wd.Selection()

                    Dim intCols As Short
                    'get intcols from tblreportdata
                    Dim tblH As System.Data.DataTable
                    Dim rowsH() As DataRow

                    tblH = tblReportTableHeaderConfig
                    strF = "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND BOOLINCLUDE <> 0 AND ID_TBLSTUDIES = " & id_tblStudies
                    strS = "INTORDER ASC"
                    rowsH = tblH.Select(strF)
                    intCols = rowsH.Length


                    Try

                        '20180913 LEE:
                        Call IncrNextTableNumber(wd)

                        If boolPlaceHolder Then
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=1, NumColumns:=1, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        Else
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=intTblRows, NumColumns:=intCols, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        End If

                        .Selection.Tables.Item(1).Select()


                        .Selection.Tables.Item(1).Rows.AllowBreakAcrossPages = False
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                        .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                        .Selection.Tables.Item(1).Columns.PreferredWidth = Microsoft.Office.Interop.Word.WdPreferredWidthType.wdPreferredWidthPoints
                        '.Selection.Tables.Item(1).Columns.Item(1).Width = 86

                        .Selection.Tables.Item(1).Select()

                        Call SetCellPaddingZero(.Selection.Tables.Item(1))

                        Dim wtbl As Word.Table
                        wtbl = .Selection.Tables.Item(1)

                        'remove border, but leave top and bottom
                        '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderLeft).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderRight).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderHorizontal).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderVertical).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalDown).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalUp).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter

                        'border top and bottom of range
                        .Selection.Tables.Item(1).Cell(1, 1).Select()

                        If boolPlaceHolder Then

                            .Selection.Tables.Item(1).Select()
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone

                            strA = arrAnalytes(14, Count1)
                            strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, False)
                            Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                            'Note: strTName is byRef and will return Table, number, caption, label

                            Call MoveOneCellDown(wd)

                            .Selection.TypeParagraph()
                            .Selection.TypeParagraph()

                            'enter a table record in tblTableN
                            'ctTableN = ctTableN + 1
                            Dim dtblr1 As DataRow = tblTableN.NewRow
                            dtblr1.BeginEdit()
                            dtblr1.Item("TableNumber") = ctTableN
                            dtblr1.Item("AnalyteName") = arrAnalytes(1, Count1)
                            dtblr1.Item("TableName") = strTNameO
                            dtblr1.Item("TableID") = intTableID
                            dtblr1.Item("CHARFCID") = charFCID
                            dtblr1.Item("TableNameNew") = strTName
                            tblTableN.Rows.Add(dtblr1)

                            GoTo next1
                        End If

                        .Selection.Tables.Item(1).Select()
                        Call GlobalTableParaFormat(wd)

                        '20171220 LEE: Do not set table size, use the style default table
                        '.Selection.Font.Size = fontsize - 1
                        .Selection.Tables.Item(1).Cell(1, 1).Select()


                        '.Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=2, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        wtbl.Cell(1, 1).Select()
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        ''wdd.visible = True

                        'strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                        strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC, NOMCONC ASC"
                        dv2.Sort = strS
                        'enter headings
                        Dim intID As Int64
                        Dim boolRA As Boolean = False
                        For Count3 = 1 To intCols
                            boolRA = False
                            str1 = NZ(rowsH(Count3 - 1).Item("CHARUSERLABEL"), "")
                            str2 = Replace(str1, " ", ChrW(10), 1, -1, CompareMethod.Text)
                            wtbl.Cell(1, Count3).Select()

                            intID = rowsH(Count3 - 1).Item("ID_TBLCONFIGHEADERLOOKUP")
                            Select Case intID
                                Case 172, 177
                                    str2 = str2 & ChrW(10) & "(" & strConcUnits & ")"
                            End Select

                            Select Case intID
                                Case 174, 175, 176, 178
                                    boolRA = True
                            End Select

                            .Selection.TypeText(str2)
                            If boolRA Then
                                .Selection.SelectColumn()
                                .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                                wtbl.Cell(1, Count3).Select()
                                .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                            End If

                        Next
                        Dim numAArea As Double = 0
                        Dim numISArea As Double = 0
                        Dim aConc As Double
                        Dim intRow As Short

                        intRow = 2
                        For Count2 = 1 To dv2.Count
                            intRow = intRow + 1
                            numAArea = 0
                            numISArea = 0
                            'enter columnar data
                            For Count3 = 1 To intCols
                                intID = rowsH(Count3 - 1).Item("ID_TBLCONFIGHEADERLOOKUP")
                                Select Case intID
                                    Case 168 'Watson Run ID
                                        var1 = NZ(dv2(Count2 - 1).Item("RUNID"), "")
                                    Case 169 'Sample Description
                                        var1 = NZ(dv2(Count2 - 1).Item("SAMPLENAME"), "")
                                        boolSampleName01 = True
                                        If boolSampleName01 Then
                                            var1 = SampleName(CStr(var1))
                                        End If
                                    Case 170 'Sequence ID
                                        var1 = NZ(dv2(Count2 - 1).Item("RUNSAMPLEORDERNUMBER"), "")
                                    Case 171 'Sample Type
                                        var1 = NZ(dv2(Count2 - 1).Item("RUNSAMPLEKIND"), "")
                                    Case 172 'Nominal Conc.
                                        var2 = NZ(dv2(Count2 - 1).Item("NOMCONC"), "")
                                        If Len(var2) = 0 Then
                                            numNomConc = -1
                                        Else
                                            If boolLUseSigFigs Then
                                                numNomConc = SigFigOrDec(var2, LSigFig, False)
                                            Else
                                                numNomConc = RoundToDecimalRAFZ(var2, LSigFig)
                                            End If

                                        End If
                                        'var1 = numNomConc ' SigFigOrDecString(var2, LSigFig, False)
                                        var1 = numNomConc ' SigFigOrDecString(var2, LSigFig, False)
                                    Case 173 'RT (min)
                                        var1 = NZ(dv2(Count2 - 1).Item("ANALYTEPEAKRETENTIONTIME"), "")
                                    Case 174 'Analyte Area
                                        var1 = NZ(dv2(Count2 - 1).Item("ANALYTEAREA"), "")
                                        If Len(var1) = 0 Then
                                            numAArea = -1
                                        Else
                                            If boolLUseSigFigsArea Then
                                                numAArea = SigFigOrDec(var1, LSigFigArea, False)
                                            Else
                                                numAArea = RoundToDecimalRAFZ(var1, LSigFigArea)
                                            End If
                                        End If
                                    Case 175 'Int. Std. Area
                                        var1 = NZ(dv2(Count2 - 1).Item("INTERNALSTANDARDAREA"), "")
                                        If Len(var1) = 0 Then
                                            numISArea = 1
                                        Else
                                            If boolLUseSigFigsArea Then
                                                numISArea = SigFigOrDec(var1, LSigFigArea, False)
                                            Else
                                                numISArea = RoundToDecimalRAFZ(var1, LSigFigArea)
                                            End If
                                        End If
                                    Case 176 'Peak Area Ratio
                                        'calculate peak area ratio
                                        If numAArea = -1 Then
                                            var1 = ""
                                        Else
                                            var2 = numAArea / numISArea
                                            var1 = RoundToDecimalRAFZ(var2, 5)
                                        End If
                                    Case 177 'Calc. Conc.
                                        var2 = NZ(dv2(Count2 - 1).Item("CONCENTRATION"), 0)
                                        var3 = NZ(dv2(Count2 - 1).Item("ALIQUOTFACTOR"), 1)
                                        var4 = var2 / var3
                                        If boolLUseSigFigs Then
                                            var1 = SigFigOrDecString(var4, LSigFig, False)
                                        Else
                                            var1 = RoundToDecimalRAFZ(var4, LSigFig)
                                        End If

                                        aConc = var1
                                    Case 178 '%Rec:  Calculate accuracy
                                        var2 = ((aConc / numNomConc) - 1) * 100
                                        var1 = Format(var2, strQCDec)
                                End Select

                                wtbl.Cell(intRow, Count3).Select()
                                .Selection.TypeText(CStr(var1))

                            Next
                        Next

                        'LEGEND
                        'ANALYTEID
                        'STUDYID
                        'STUDYNAME
                        'RUNTYPEID
                        'RUNID
                        'RUNSAMPLEORDERNUMBER
                        'ASSAYDATETIME
                        'ASSAYLEVEL
                        'ELIMINATEDFLAG
                        'SAMPLENAME
                        'ALIQUOTFACTOR
                        'RUNSAMPLEKIND
                        'ASSAYID
                        'MASTERASSAYID
                        'ANALYTEINDEX
                        'CONCENTRATION
                        'RUNANALYTEREGRESSIONSTATUS
                        'ANALYTEHEIGHT
                        'ANALYTEAREA
                        'INTERNALSTANDARDHEIGHT
                        'INTERNALSTANDARDAREA
                        'INTERNALSTDNAME
                        'SAMPLETYPEKEY
                        'SAMPLETYPEID
                        'ANALYTEPEAKRETENTIONTIME
                        'INTERNALSTANDARDRETENTIONTIME 

                        GoTo skip2


                        For Count2 = 0 To intNumLevels - 1
                            var1 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                            var2 = tblLevels.Rows.Item(Count2).Item("CHARHELPER1")

                            '******determine if the level is a diln level
                            Dim strE As String
                            'var3 = var2 ' & ChrW(10) & var1 & " " & strConcUnits
                            var3 = ReturnStdQC(var2.ToString)
                            .Selection.TypeText(Text:=var3)

                            dv2.RowFilter = ""
                            strF = strF2 & " AND NOMCONC = " & CDbl(var1)
                            dv2.RowFilter = strF
                            'check for aliquot factor
                            Dim numDS As Single
                            If dv2.Count = 0 Then

                            Else
                                numDS = dv2(0).Item("ALIQUOTFACTOR")
                                If numDS <> 1 Then
                                    'record legend
                                    intLeg = intLeg + 1
                                    ctDilLeg = ctDilLeg + 1
                                    ctLegend = ctLegend + 1
                                    'configure first legend item
                                    'var3 = Format(1 / CDec(numDS), "0")
                                    var3 = GetDilnFactor(CDec(numDS)) '20190220 LEE
                                    strA = Chr(96 + intLeg) 'debugging
                                    arrLegend(1, intLeg) = Chr(96 + intLeg) 'a,b,c,etc
                                    'var: units
                                    Dim strAN As String = GetAN(var3)

                                    If boolLUseSigFigs Then
                                        'arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & DisplayNum(SigFigOrDec(Val(var1), LSigFig, False), LSigFig, False) & " " & strConcUnits & "; a 1:" & var3 & " dilution with blank matrix was performed prior to extraction and analysis."
                                        arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & DisplayNum(SigFigOrDec(Val(var1), LSigFig, False), LSigFig, False) & " " & strConcUnits & "; " & strAN & " " & var3 & "-fold dilution with blank matrix was performed prior to extraction and analysis."
                                    Else
                                        'arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & Format(CDbl(Val(var1)), GetRegrDecStr(LSigFig)) & " " & strConcUnits & "; a 1:" & var3 & " dilution with blank matrix was performed prior to extraction and analysis."
                                        arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & Format(CDbl(Val(var1)), GetRegrDecStr(LSigFig)) & " " & strConcUnits & "; " & strAN & " " & var3 & "-fold dilution with blank matrix was performed prior to extraction and analysis."
                                    End If

                                    arrLegend(3, intLeg) = True
                                    arrLegend(4, intLeg) = True

                                    'enter superscript
                                    fonts = .Selection.Font.Size
                                    .Selection.Font.Bold = True
                                    .Selection.Font.Superscript = True
                                    .Selection.Font.Size = 12
                                    .Selection.TypeText(" " & strA)
                                    .Selection.Font.Superscript = False
                                    .Selection.Font.Size = fonts
                                    .Selection.Font.Bold = False
                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic

                                End If

                            End If
                            '.Selection.TypeText(strE)

                            '******

                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            If boolSTATSDIFFCOL Then
                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            End If

                        Next


                        'Enter nom. conc. row titles
                        .Selection.Tables.Item(1).Cell(3, 2).Select()

                        For Count2 = 0 To intNumLevels - 1
                            'var1 = arrBCQCs(3, Count2)
                            If boolLUseSigFigs Then
                                var1 = CStr(DisplayNum(SigFigOrDec(tblLevels.Rows.Item(Count2).Item("NOMCONC"), LSigFig, False), LSigFig, False))
                            Else
                                var1 = CStr(Format(tblLevels.Rows.Item(Count2).Item("NOMCONC"), GetRegrDecStr(LSigFig)))
                            End If

                            var3 = var1 & " " & strConcUnits
                            .Selection.TypeText(Text:=var3)
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            If boolSTATSDIFFCOL Then
                                .Selection.TypeText(Text:=ReturnDiffLabel)
                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            End If

                        Next

                        .Selection.Tables.Item(1).Cell(3, 1).Select()
                        'bottom border this row
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        'enter Watson Run ID column header
                        .Selection.Tables.Item(1).Cell(3, 1).Select()

                        If BOOLINCLUDEDATE Then
                            .Selection.Tables.Item(1).Cell(2, 1).Select()
                            .Selection.TypeText(strWRunId)
                            .Selection.Tables.Item(1).Cell(3, 1).Select()
                            '.Selection.TypeText("(Analysis Date)")
                            '20180420 LEE:
                            .Selection.TypeText("(" & GetAnalysisDateLabel(intTableID) & ")")
                        Else
                            .Selection.TypeText(strWRunId)
                        End If
                      
                        'begin entering data'
                        intStart = 5
                        int1 = 5 'row position counter
                        Dim boolExit As Boolean = False

                        For Count2 = 0 To intNumRuns - 1

                            ''legend

                            ''find number of runs used
                            'tblNumRuns = dv2.ToTable("a", True, "RUNID")
                            'intNumRuns = tblNumRuns.Rows.Count

                            ''find number of different Run Identifiers
                            'tblRID = dv2.ToTable("b", True, "RUNID")
                            'numRID = tblRID.Rows.Count

                            ''re-establish tblLevels to get charhelper2's
                            'tblRID = dv2.ToTable("b", True, "RUNID", "CHARHELPER2")

                            ''end legend


                            .Selection.Tables.Item(1).Cell(intStart, 1).Select()
                            'enter runid
                            var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")

                            frmH.lblProgress.Text = strM1 & ChrW(10) & "Processing Run ID " & var10
                            frmH.Refresh()

                            Dim strH As String
                            Dim rowsG() As DataRow
                            Dim intG As Short
                            strF = "RUNID = " & var10
                            rowsG = tblRID.Select(strF, "RUNID ASC")
                            intG = rowsG.Length
                            strH = "[NONE]"
                            If intG = 0 Then
                                strH = "[NONE]"
                            Else
                                strH = NZ(rowsG(0).Item("CHARHELPER2"), "[NONE]")
                            End If

                            .Selection.TypeText(CStr(var10))
                            int1 = intStart
                            If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                            Else
                                int1 = int1 + 1
                                .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1)
                                .Selection.TypeText(strH)
                                .Selection.MoveUp(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1)
                            End If
                            If BOOLINCLUDEDATE Then
                                int1 = int1 + 1
                                .Selection.Tables.Item(1).Cell(int1, 1).Select()
                                str1 = GetDateFromRunID(NZ(var10, 0), LDateFormat, intGroup, idTR)
                                .Selection.TypeText("(" & str1 & ")")
                                .Selection.Tables.Item(1).Cell(intStart, 1).Select()
                            End If
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)

                            'must first determine if there are any outliers
                            intExp = 0

                            For Count3 = 0 To intNumLevels - 1

                                varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")
                                'start evaluating data
                                dv2.RowFilter = strF2
                                'don't know why, but must make a long filter here or
                                'both analytes get returned in dv2.rowfilter
                                If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND (CHARHELPER2 IS NULL OR CHARHELPER2 = '')"
                                Else
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND CHARHELPER2 = '" & strH & "'"
                                End If
                                'strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom
                                ''''''''console.writeline(strF)
                                dv2.RowFilter = strF
                                int2 = dv2.Count 'debugging

                                Erase rows1

                                Dim tbl2SA As System.Data.DataTable = dv2.ToTable
                                strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                rows2 = tbl2SA.Select(strF)
                                int3 = rows2.Length
                                intRowsX = int3 'new introwsx

                                'evaluate data
                                For Count4 = 0 To intRowsX - 1 'int3 - 1
                                    var1 = NZ(rows2(Count4).Item("ELIMINATEDFLAG"), "N")
                                    var2 = NZ(rows2(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                    If StrComp(var1, "Y", CompareMethod.Text) = 0 Or var2 = -1 Then
                                        intExp = intExp + 1
                                        boolExit = True
                                        Exit For
                                    End If
                                Next

                                If boolExit Then
                                    Exit For
                                End If

                            Next

                            Dim boolEnterDiff As Boolean
                            Dim int12 As Short
                            int12 = -1
                            'start filling in data by columns
                            For Count3 = 0 To (intNumLevels * int11) - 1 Step int11
                                int12 = int12 + 1
                                varNom = tblLevels.Rows.Item(int12).Item("NOMCONC")

                                strF = "CONCENTRATION = " & varNom & " AND ANALYTEID = " & vAnalyteID & " AND MASTERASSAYID = " & vMasterAssayID & " AND ANALYTEINDEX = " & vAnalyteIndex & " AND CONCENTRATION = " & varNom & " AND RUNID = " & var10
                                'rows10 = tblBCQCs.Select(strF)
                                rows10 = tblQCRunIDs.Select(strF, "LEVELNUMBER ASC")
                                Dim intRC As Short
                                intRC = rows10.Length
                                If intRC = 0 Then
                                    var1 = 15
                                Else
                                    var1 = CDec(NZ(rows10(0).Item("ANALYTEFLAGPERCENT"), 15))
                                    var1 = NZ(var1, 15)
                                End If


                                var2 = var1
                                arrFP(1, int12) = var1
                                arrFP(2, int12) = var2
                                Call SetHighAndLowCriteria(varNom, var1, var1, hi, lo)
                                v1 = var1
                                v2 = var1
                                vU = 0

                                'start entering data
                                dv2.RowFilter = strF2
                                'don't know why, but must make a long filter here or
                                'both analytes get returned in dv2.rowfilter
                                If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND (CHARHELPER2 IS NULL OR CHARHELPER2 = '')"
                                Else
                                    strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND CHARHELPER2 = '" & strH & "'"
                                End If
                                dv2.RowFilter = strF
                                ''''''''console.writeline(strF)
                                int2 = dv2.Count
                                nI = int2

                                'create rows1 from tbl1 which will contain all data
                                strF = ""
                                Erase rows1

                                Dim tbl2s As System.Data.DataTable = dv2.ToTable
                                rows2 = tbl2s.Select("RUNID > -1")
                                int3 = rows2.Length

                                ''debugging
                                Dim CountE As Short
                                Dim CountF As Short
                                Dim CountG As Short
                                Dim strCCC As String

                                'now do rows2E
                                strF = ""

                                Erase rows2E

                                If gAllowExclSamples And LAllowExclSamples Then
                                    'rows2E = tbl2s.Select("ELIMINATEDFLAG = 'N' AND BOOLEXCLSAMPLE = 0")
                                    rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL) AND BOOLEXCLSAMPLE = 0")
                                    '(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)
                                Else
                                    'rows2E = tbl2s.Select("ELIMINATEDFLAG = 'N'")
                                    rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)")
                                End If

                                nE = rows2E.Length

                                'enter data
                                For Count4 = 0 To intRowsX - 1 'int3 - 1
                                    boolEnterDiff = False
                                    If Count4 = 0 Then
                                        'enter charhelper2
                                        str1 = NZ(dv2(0).Item("CHARHELPER2"), "")
                                        .Selection.Tables.Item(1).Cell(intStart + Count4 + 1, 1).Select()
                                        .Selection.TypeText(str1)
                                        vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                        v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                        v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                    End If
                                    .Selection.Tables.Item(1).Cell(intStart + Count4, Count3 + 2).Select()
                                    If Count4 > int3 - 1 Then

                                        If boolQCNA Then
                                            str1 = "NA"
                                        Else
                                            str1 = ""
                                        End If

                                        .Selection.TypeText(str1)
                                        boolEnterDiff = False
                                    Else
                                        var1 = rows2(Count4).Item("CONCENTRATION")
                                        varConc = var1
                                        varAnal = NZ(rows2(Count4).Item("ANALYTEAREA"), 0)
                                        varIS = NZ(rows2(Count4).Item("INTERNALSTANDARDAREA"), 0)

                                        var1 = NZ(var1, 0)
                                        numDF = rows2(Count4).Item("ALIQUOTFACTOR")
                                        var1 = var1 / numDF
                                        If boolRCConc Then
                                            If boolLUseSigFigs Then
                                                var2 = SigFigOrDec(var1, LSigFig, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If

                                        ElseIf boolRCPA Then
                                            If boolLUseSigFigsArea Then
                                                var2 = SigFigOrDec(varAnal / numDF, LSigFigArea, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(varAnal / numDF, LSigFigArea)
                                            End If

                                        ElseIf boolRCPARatio Then
                                            If varIS = 0 Then
                                                var2 = varAnal
                                                If boolLUseSigFigsAreaRatio Then
                                                    var2 = SigFigAreaRatio(var2, LSigFigAreaRatio, True, False)
                                                Else
                                                    var2 = RoundToDecimalRAFZ(var2, LSigFigAreaRatio)
                                                End If

                                            Else
                                                var2 = varAnal / varIS
                                                'var2 = RoundToDecimalRAFZ(var2 / numDF, 5)

                                                If boolLUseSigFigsAreaRatio Then
                                                    var2 = SigFigAreaRatio(var2, LSigFigAreaRatio, True, False)
                                                Else
                                                    var2 = RoundToDecimalRAFZ(var2, LSigFigAreaRatio)
                                                End If

                                            End If

                                        Else
                                            If boolLUseSigFigs Then
                                                var2 = SigFigOrDec(var1, LSigFig, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If

                                        End If

                                        var1 = NZ(rows2(Count4).Item("ELIMINATEDFLAG"), "N")

                                        Dim vE
                                        vE = dv2(Count4).Item("BOOLEXCLSAMPLE")

                                        If IsDBNull(varConc) Then

                                            boolEnterDiff = True 'FALSE
                                            intExp = intExp + 1
                                            intLeg = intLeg + 1
                                            strA = ChrW(intLeg + intLegStart)

                                            var1 = "Y"

                                            str1 = "No Value."

                                            'Add to Legend Array
                                            ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                            '''''wdd.visible = True


                                            If boolRedBoldFont Then
                                                .Selection.Font.Bold = True
                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            End If

                                            .Selection.TypeText(Text:="NV")

                                            Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                        ElseIf StrComp(var1, "Y", vbTextCompare) = 0 Or (gAllowExclSamples And LAllowExclSamples And vE = -1) Then

                                            boolEnterDiff = True 'FALSE
                                            intExp = intExp + 1
                                            intLeg = intLeg + 1
                                            strA = ChrW(intLeg + intLegStart)

                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                If v1 = v2 Then
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                Else
                                                    str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                End If

                                                'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                            Else
                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                            End If

                                            'Add to Legend Array
                                            ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                            '''''wdd.visible = True


                                            If boolRedBoldFont Then
                                                .Selection.Font.Bold = True
                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            End If

                                            If boolRCConc Then
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                End If


                                            ElseIf boolRCPA Then
                                                If boolLUseSigFigsArea Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigArea, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigArea), GetRegrDecStr(LSigFigArea))))
                                                End If

                                            ElseIf boolRCPARatio Then
                                                '.Selection.TypeText(Text:=Format(var2, "0.00000"))
                                                If boolLUseSigFigsAreaRatio Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigAreaRatio), GetRegrDecStr(LSigFigAreaRatio))))
                                                End If
                                            Else
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                End If
                                            End If

                                            Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                        Else

                                            boolEnterDiff = True
                                            'determine if value is outside acceptance criteria
                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'If (var2 > hi Or var2 < lo) And boolRCConc Then 'flag
                                            If (OutsideAccCrit(var2, varNom, v1, v2, NZ(vU, 0))) And boolRCConc Then 'flag
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                    v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                    'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'search for str1 in arrLegend
                                                boolPro = False
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For
                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                    End If

                                                ElseIf boolRCPA Then
                                                    If boolLUseSigFigsArea Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigArea, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigArea), GetRegrDecStr(LSigFigArea))))
                                                    End If

                                                ElseIf boolRCPARatio Then
                                                    '.Selection.TypeText(Text:=Format(var2, "0.00000"))
                                                    If boolLUseSigFigsAreaRatio Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigAreaRatio), GetRegrDecStr(LSigFigAreaRatio))))
                                                    End If
                                                Else
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                    End If

                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                            Else
                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                    End If

                                                ElseIf boolRCPA Then
                                                    If boolLUseSigFigsArea Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigArea, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigArea), GetRegrDecStr(LSigFigArea))))
                                                    End If

                                                ElseIf boolRCPARatio Then
                                                    '.Selection.TypeText(Text:=Format(var2, "0.00000"))
                                                    If boolLUseSigFigsAreaRatio Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFigAreaRatio), GetRegrDecStr(LSigFigAreaRatio))))
                                                    End If
                                                Else
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                    End If
                                                End If
                                                boolEnterDiff = True
                                            End If
                                        End If

                                    End If

                                    If boolSTATSDIFFCOL Then
                                        .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                        If boolEnterDiff Then
                                            'var3 = Format(((var2 / varNom) - 1) * 100, strQCDec)
                                            var3 = Format(RoundToDecimal(((var2 / varNom) - 1) * 100, intQCDec), strQCDec)
                                        Else

                                            If boolQCNA Then
                                                var3 = "NA"
                                            Else
                                                var3 = ""
                                            End If

                                        End If
                                        .Selection.TypeText(Text:=CStr(var3))
                                        .Selection.MoveLeft(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                    End If

                                Next

                                .Selection.Tables.Item(1).Cell(intStart + Count4 + 1, 1).Select()
                                int1 = .Selection.Information(Microsoft.Office.Interop.Word.WdInformation.wdStartOfRangeRowNumber)
                                '.Selection.Tables.Item(1).Cell(int1 + 1, 2).Select()
                                'begin doing stats
                                If boolQCREPORTACCVALUES Then
                                Else
                                    If intExp = 0 Then
                                    Else
                                        If boolOutHeadE Then
                                        Else
                                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                            .Selection.TypeText(Text:="Summary Statistics Excluding Outlier Values")
                                            .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                            Try
                                                .Selection.Cells.Merge()
                                            Catch ex As Exception

                                            End Try
                                            With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                            End With
                                            boolOutHeadE = True
                                        End If


                                        .Selection.Tables.Item(1).Cell(int1 + 1, 1).Select()
                                    End If
                                End If

                                int1 = .Selection.Information(Microsoft.Office.Interop.Word.WdInformation.wdStartOfRangeRowNumber)

                                'now enter Mean/Bias/n
                                If Count3 = 0 Then
                                    int8 = 0
                                    Call typeStatsLabels(wd, int8, int1 - 1, 1, False)

                                    If boolQCREPORTACCVALUES Then
                                    Else
                                        If intExp = 0 Then
                                        Else
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + int8, 1).Select()
                                            If boolOutHeadI Then
                                            Else
                                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                                .Selection.TypeText(Text:="Summary Statistics Including Outlier Values")
                                                .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                                Try
                                                    .Selection.Cells.Merge()
                                                Catch ex As Exception

                                                End Try
                                                boolOutHeadI = True
                                            End If

                                            With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                            End With

                                            Call typeStatsLabels(wd, int8, int1, 1, False)

                                        End If
                                    End If

                                End If

                                int8 = 0
                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                If boolSTATSMEAN Then
                                    Try
                                        'enter Mean
                                        int8 = int8 + 1
                                        If boolRCConc Then
                                            var1 = MeanDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                        Else
                                            var1 = MeanDR(rows2E, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                        End If
                                        numMean = 0
                                        If boolRCConc Then
                                            numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                            'here

                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'determine if value is outside acceptance criteria
                                            'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag
                                            If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'search for str1 in arrLegend
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For

                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                boolEnterDiff = True
                                            Else
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If
                                                boolEnterDiff = True
                                            End If

                                        ElseIf boolRCPA Then
                                            If boolLUseSigFigsArea Then
                                                numMean = SigFigAreaRatio(var1, LSigFigArea, True, False)
                                            Else
                                                numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                            End If

                                            If boolLUseSigFigsArea Then
                                                .Selection.TypeText(CStr(DisplayNum(numMean, LSigFigArea, False)))
                                            Else
                                                .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFigArea))))
                                            End If

                                        ElseIf boolRCPARatio Then
                                            'var2 = RoundToDecimalRAFZ(var1, 5)
                                            'numMean = var2 ' RoundToDecimal(var1, 5)
                                            '.Selection.TypeText(CStr(Format(numMean, "0.00000")))

                                            If boolLUseSigFigsAreaRatio Then
                                                numMean = SigFigAreaRatio(var1, LSigFigAreaRatio, True, False)
                                            Else
                                                numMean = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                            End If

                                            If boolLUseSigFigsArea Then
                                                .Selection.TypeText(CStr(DisplayNum(numMean, LSigFigArea, False)))
                                            Else
                                                .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFigAreaRatio))))
                                            End If

                                        Else
                                            numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)

                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'determine if value is outside acceptance criteria
                                            'If numMean > hi Or numMean < lo Then 'flag
                                            If OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0)) Then 'flag
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'search for str1 in arrLegend
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For

                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                boolEnterDiff = True
                                            Else

                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If
                                                boolEnterDiff = True
                                            End If

                                        End If
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Mean", numMean, CSng(var10), Count1, strDo, 0, 0, False)

                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                    Catch ex As Exception

                                    End Try
                                End If
                                If boolSTATSSD Then
                                    Try
                                        'enter SD
                                        int8 = int8 + 1
                                        If nE < gSDMax Then
                                            .Selection.TypeText("NA")
                                        Else
                                            numSD = 0
                                            If boolRCConc Then
                                                var1 = StdDevDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                            Else
                                                var1 = StdDevDR(rows2E, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                                If boolIS Then
                                                    var1 = StdDevDRArea(rows2E, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, False)
                                                Else
                                                    var1 = StdDevDRArea(rows2E, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                                End If

                                            End If

                                            If boolRCConc Then
                                                If boolLUseSigFigs Then
                                                    numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    .Selection.TypeText(CStr(DisplayNum(numSD, LSigFig, False)))
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                    .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                                End If

                                            ElseIf boolRCPA Then
                                                If boolLUseSigFigsArea Then
                                                    numSD = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                    .Selection.TypeText(CStr(DisplayNum(numSD, LSigFigArea, False)))
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                    .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFigArea))))
                                                End If

                                            ElseIf boolRCPARatio Then
                                                'var2 = RoundToDecimalRAFZ(var1, 5) ' SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False)
                                                'numSD = var2 'SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False) ' RoundToDecimal(var1, 5)
                                                '.Selection.TypeText(CStr(Format(numSD, "0.00000")))

                                                If boolLUseSigFigsAreaRatio Then
                                                    numSD = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                    .Selection.TypeText(CStr(DisplayNum(numSD, LSigFigAreaRatio, False)))
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                    .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFigAreaRatio))))
                                                End If

                                            End If
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "SD", numSD, CSng(var10), Count1, strDo, 0, 0, False)

                                        End If

                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSCV Then
                                    Try
                                        'enter %CV
                                        int8 = int8 + 1
                                        If nE < gSDMax Then
                                            .Selection.TypeText("NA")
                                        Else
                                            numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Precision", numPrec, CSng(var10), Count1, strDo, 0, 0, False)

                                        End If

                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                    Catch ex As Exception

                                    End Try
                                End If
                                If boolSTATSBIAS And boolSTATSMEAN Then
                                    Try
                                        'enter %Bias
                                        int8 = int8 + 1
                                        numBias = CalcREPercent(numMean, varNom, intQCDec)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolTHEORETICAL And boolSTATSMEAN Then
                                    Try
                                        'enter %theoretical
                                        int8 = int8 + 1
                                        numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                        numTheor = 100 + CDec(numTheor)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numTheor, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numTheor, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try

                                End If

                                If boolSTATSDIFF And boolSTATSMEAN Then
                                    Try
                                        'enter %Bias
                                        int8 = int8 + 1
                                        numBias = CalcREPercent(numMean, varNom, intQCDec)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                If BOOLSTATSRE And boolSTATSMEAN Then
                                    Try
                                        'enter %RE
                                        int8 = int8 + 1
                                        numBias = CalcREPercent(numMean, varNom, intQCDec)
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                        If nE = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSN Then
                                    Try
                                        'enter n
                                        int8 = int8 + 1
                                        .Selection.TypeText(CStr(nE))
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "n", nE, CSng(var10), Count1, strDo, 0, 0, False)

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolQCREPORTACCVALUES Then
                                Else
                                    If intExp = 0 Then
                                        If boolDeleteRows Then
                                        Else
                                            Call DeleteRows(ctExp / intNumRuns, wd)
                                            boolDeleteRows = True
                                        End If

                                    Else
                                        int8 = int8 + 2
                                        .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                        If boolSTATSMEAN Then
                                            Try
                                                'enter Mean
                                                int8 = int8 + 1

                                                If boolRCConc Then
                                                    var1 = MeanDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                Else
                                                    var1 = MeanDR(rows2, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                                End If
                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If


                                                    If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                        Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                                    End If

                                                    'determine if value is outside acceptance criteria
                                                    'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag
                                                    If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                        intLeg = intLeg + 1
                                                        strA = ChrW(intLeg + intLegStart)
                                                        If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                            If v1 = v2 Then
                                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            Else
                                                                str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            End If
                                                        Else
                                                            str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                        End If

                                                        'Add to Legend Array
                                                        ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)


                                                        If boolRedBoldFont Then
                                                            .Selection.Font.Bold = True
                                                            .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If

                                                        Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                        boolEnterDiff = True
                                                    Else
                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If
                                                        boolEnterDiff = True
                                                    End If

                                                ElseIf boolRCPA Then

                                                    If boolLUseSigFigsArea Then
                                                        numMean = SigFigArea(var1, LSigFigArea, True, False)
                                                        .Selection.TypeText(CStr(DisplayNum(numMean, LSigFigArea, False)))
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                        .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFigArea))))
                                                    End If

                                                    '.Selection.TypeText(CStr(numMean))
                                                ElseIf boolRCPARatio Then
                                                    'var2 = RoundToDecimalRAFZ(var1, 5) ' SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False)
                                                    'numMean = var2 'SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False) 'RoundToDecimal(var1, 5)
                                                    '.Selection.TypeText(CStr(var2))

                                                    If boolLUseSigFigsAreaRatio Then
                                                        numMean = SigFigAreaRatio(var1, LSigFigAreaRatio, True, False)
                                                        .Selection.TypeText(CStr(DisplayNum(numMean, LSigFigAreaRatio, False)))
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                        .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFigAreaRatio))))
                                                    End If

                                                Else
                                                    If boolLUseSigFigs Then
                                                        numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If

                                                    If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                        Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                                    End If

                                                    'determine if value is outside acceptance criteria
                                                    'If numMean > hi Or numMean < lo Then 'flag
                                                    If OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0)) Then 'flag
                                                        '
                                                        intLeg = intLeg + 1
                                                        strA = ChrW(intLeg + intLegStart)
                                                        'str1 = "Value outside of acceptance criteria (" & RoundToDecimal(arrFP(1, Count3), 0) & "% theoretical) but included in summary statistics."

                                                        If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                            If v1 = v2 Then
                                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            Else
                                                                str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            End If
                                                            'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                        Else
                                                            str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                        End If

                                                        'Add to Legend Array
                                                        ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                                        If boolRedBoldFont Then
                                                            .Selection.Font.Bold = True
                                                            .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If

                                                        Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                        boolEnterDiff = True
                                                    Else
                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If
                                                        boolEnterDiff = True
                                                    End If

                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()

                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSSD Then
                                            Try
                                                'enter SD
                                                int8 = int8 + 1
                                                If nI < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    If boolRCConc Then
                                                        var1 = StdDevDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                    Else
                                                        'var1 = StdDevDR(rows2, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                                        If boolIS Then
                                                            var1 = StdDevDRArea(rows2, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, False)
                                                        Else
                                                            var1 = StdDevDRArea(rows2, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                                        End If

                                                    End If

                                                    If boolRCConc Then
                                                        If boolLUseSigFigs Then
                                                            numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            .Selection.TypeText(CStr(DisplayNum(numSD, LSigFig, False)))
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                            .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                                        End If


                                                    ElseIf boolRCPA Then
                                                        If boolLUseSigFigsArea Then
                                                            numSD = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                            .Selection.TypeText(CStr(DisplayNum(numSD, LSigFigArea, False)))
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                            .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFigArea))))
                                                        End If
                                                    ElseIf boolRCPARatio Then
                                                        'var2 = RoundToDecimalRAFZ(var1, 5) ' SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False)
                                                        'numSD = var2 'RoundToDecimal(var1, 5)
                                                        '.Selection.TypeText(CStr(Format(var2, "0.00000")))

                                                        If boolLUseSigFigsAreaRatio Then
                                                            numSD = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                            .Selection.TypeText(CStr(DisplayNum(numSD, LSigFigAreaRatio, False)))
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                            .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFigAreaRatio))))
                                                        End If

                                                    End If
                                                End If

                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSCV Then
                                            Try
                                                'enter %CV
                                                int8 = int8 + 1
                                                If nI < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                    .Selection.TypeText(Format(numPrec, strQCDec))
                                                End If

                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSBIAS And boolSTATSMEAN Then
                                            Try
                                                'enter %Bias
                                                int8 = int8 + 1
                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolTHEORETICAL And boolSTATSMEAN Then
                                            Try
                                                'enter %theoretical
                                                int8 = int8 + 1
                                                numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                                numTheor = 100 + CDec(numTheor)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numTheor, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try

                                        End If

                                        If boolSTATSDIFF And boolSTATSMEAN Then
                                            Try
                                                'enter %Bias
                                                int8 = int8 + 1
                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If BOOLSTATSRE And boolSTATSMEAN Then
                                            Try
                                                'enter %RE
                                                int8 = int8 + 1
                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + 2).Select()
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSN Then
                                            Try
                                                'enter n
                                                int8 = int8 + 1
                                                .Selection.TypeText(CStr(nI))
                                            Catch ex As Exception

                                            End Try
                                        End If
                                    End If
                                End If

                            Next

                            'increase row position counter
                            If Count2 = intNumRuns - 1 Then
                                intStart = int1 + int8 + 1
                            Else
                                intStart = int1 + int8 + 1
                            End If

                            'Next Count10

                        Next

skip2:


                        'bottom border this row
                        wtbl.Cell(wtbl.Rows.Count, 1).Select()
                        .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow)
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                    Catch ex As Exception

                        str1 = "There was a problem preparing table:"
                        str1 = strM1 & ChrW(10) & ChrW(10) & str1
                        str1 = str1 & ChrW(10) & ChrW(10)
                        str1 = str1 & ex.Message
                        MsgBox(str1, vbInformation, "Problem...")

                    End Try


                    'autofit window
                    .Selection.Tables.Item(1).Select()
                    'autofit table
                    Call AutoFitTable(wd, False)

                    ''go back and merge line 1
                    '.Selection.Tables.Item(1).Cell(1, 2).Select()
                    '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                    ''.Selection.Cells.Merge()
                    'If intNumLevels < 2 Then
                    'Else
                    '    Try
                    '        .Selection.Cells.Merge()
                    '    Catch ex As Exception

                    '    End Try
                    'End If
                    '.Selection.Font.Bold = False
                    '.Selection.TypeText(Text:="Nominal Concentrations")
                    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                    '.Selection.Tables.Item(1).Cell(1, 1).Select()
                    ''go to end of table
                    '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdColumn)

                    'enter table number
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End
                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next
                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    'remove unused rows
                    Call RemoveRows(wd, ctTbl)

                    '***
                    strA = rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                    strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, False)
                    Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                    'Note: strTName is byRef and will return Table, number, caption, label

                    '***
                    'Call EnterTableNumber(wd, str1, 3)

                    'enter a table record in tblTableN
                    'ctTableN = ctTableN + 1
                    Dim dtblr As DataRow = tblTableN.NewRow
                    dtblr.BeginEdit()
                    dtblr.Item("TableNumber") = ctTableN
                    dtblr.Item("AnalyteName") = strDo 'arrAnalytes(1, Count1)
                    dtblr.Item("TableName") = strTNameO
                    dtblr.Item("TableID") = intTableID
                    dtblr.Item("CHARFCID") = charFCID
                    dtblr.Item("TableNameNew") = strTName
                    tblTableN.Rows.Add(dtblr)

                    'split table, if needed
                    str1 = frmH.lblProgress.Text

                    ctLegend = ctLegend + 1
                    intLeg = intLeg + 1
                    arrLegend(1, intLeg) = "NA"
                    arrLegend(2, intLeg) = "Not Applicable"
                    arrLegend(3, intLeg) = False

                    'autofit table
                    Call AutoFitTable(wd, BOOLINCLUDEDATE)

                    strM = "Finalizing " & strTName & "..."
                    strM1 = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."

                    frmH.lblProgress.Text = strM1
                    frmH.Refresh()

                    str1 = strM1

                    Call SplitTable(wd, 4, intLeg, arrLegend, str1, False, ctLegend + 2, False, False, False, intTableID)

                    'move to line below table
                    Call MoveOneCellDown(wd)

                    Call InsertLegend(wd, intTableID, idTR, False, 1)


                Else
                    boolJustTable = False

                End If

end1:
                If boolJustTable Then
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End
                    str2 = ""
                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next

                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    str1 = str2 & " Final Extract Stability: Summary of " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION") & " Interpolated QC Standard Concentrations."
                    str2 = str1
                    str1 = NZ(rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION"), "")
                    'Call JustTable(wd, str1, str2, strDo, strTName, intTableID)
                    If Len(str1) = 0 Then
                    Else
                        Call JustTable(wd, str1, strTName, strDo, strTName, intTableID, strTempInfo, "", strTNameO, 1, idTR)
                    End If


                End If

next1:

            Next
end2:
        End With


    End Sub

    Sub MVAdHocQCStability_31(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal idTR As Int64, intTID As Short)

        '20190118 LEE:
        'Note that the following tables are now redirected here:
        '12	Summary of Interpolated Dilution QC Concentrations
        '19	Summary of Freeze/Thaw [#Cycles] Stability in Matrix
        '21	[Period Temp] Final Extract Stability of Interpolated QC Std Concentrations
        'when redirected, boolRCConc has been forced to TRUE at modReport.PrepareTable

        Dim boolOC As Boolean = False 'bool if eliminated
        Dim numNomConc As Decimal
        Dim var1, var2, var3, var4, var5, var10
        Dim dvDo As System.Data.DataView
        Dim strTName As String
        Dim intDo As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim Count10 As Short
        Dim strDo As String
        Dim bool As Boolean
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim tbl1 As System.Data.DataTable
        Dim dv1 As System.Data.DataView
        Dim rows1() As DataRow
        Dim intRows1 As Short
        Dim strF1 As String
        Dim tbl2 As System.Data.DataTable
        Dim dv2 As System.Data.DataView
        Dim rows2() As DataRow
        Dim intRows2 As Short
        Dim strF2 As String
        Dim tbl3 As System.Data.DataTable
        Dim dv3 As System.Data.DataView
        Dim rows3() As DataRow
        Dim intRows3 As Short
        Dim strF3 As String
        Dim intTableID As Short
        Dim tbl4 As System.Data.DataTable
        Dim dv4 As System.Data.DataView
        Dim rows4() As DataRow
        Dim intRows4 As Short
        Dim strF4 As String
        Dim strS As String
        Dim intNumRuns As Short
        Dim dv As System.Data.DataView
        Dim tblNumRuns As System.Data.DataTable
        Dim tblLevels As System.Data.DataTable
        Dim intNumLevels As Short
        Dim intTblRows As Short
        Dim wrdSelection As Microsoft.Office.Interop.Word.Selection
        Dim strF As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim int4 As Short
        Dim int10 As Short
        Dim intRowsX As Short
        Dim tblX As System.Data.DataTable
        Dim varNom
        Dim strConcUnits As String
        Dim intLeg As Short
        Dim ctQCLegend As Short
        Dim ctDilLeg As Short
        Dim strA As String
        Dim strB As String

        Dim ctLegend As Short
        Dim fontsize
        Dim boolPro As Boolean

        Dim varConc

        Dim hi, lo
        Dim rows10() As DataRow
        Dim rows11() As DataRow
        Dim intRowsAnal As Short
        Dim arrFP(2, 20) 'FlagPercent array: 1=hi, 2=lo
        Dim strFP As String
        Dim numMean As Decimal
        Dim numBias As Decimal
        Dim numSD As Decimal
        Dim tblZ As System.Data.DataTable
        Dim dvAn As System.Data.DataView
        Dim tblAnGo As New System.Data.DataTable
        Dim p1, p2, p3, p4, p5, p6, p7, p8, p9, p10
        Dim strM As String
        Dim fonts
        Dim numDF As Decimal
        Dim DilFactor
        Dim strF2a As String
        Dim strTempInfo As String
        Dim rowsX() As DataRow
        Dim intLegStart As Short
        Dim boolJustTable As Boolean

        Dim intExp As Short
        Dim ctExp As Short
        Dim int8 As Short
        Dim intStart As Short

        Dim rows2E() As DataRow
        Dim nE As Short
        Dim nI As Short
        Dim boolOutHeadE As Boolean = False
        Dim boolOutHeadI As Boolean = False
        Dim boolDeleteRows As Boolean = False

        Dim tblRID As System.Data.DataTable
        Dim numRID As Short
        Dim ctTbl As Short
        Dim varAnal, varIS
        Dim v1, v2, vU
        Dim arrV(200)


        Dim vAnalyteIndex
        Dim vMasterAssayID
        Dim vAnalyteID
        Dim tblAG As DataTable = tblAnalyteGroups 'tblAnalyteGroups has all analytes, not just accepted

        Dim intGroup As Short
        Dim strAnal As String
        Dim strAnalC As String
        Dim strMatrix As String
        Dim strTNameO As String
        Dim intRunID As Int16
        Dim strDECISIONREASON As String
        Dim boolExFromAS As Boolean

        Dim numPrec As Single
        Dim numTheor As Single

        Dim boolIS As Boolean = False

        '20190225 LEE:
        'BOOLRCPA, BOOLRCCONC, and BOOLRCPA
        If boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then
            boolIS = True
        End If

        Dim int12 As Short
        Dim boolEnterDiff As Boolean

        Dim charFCID As String
        strF = "ID_TBLREPORTTABLE = " & idTR
        Dim rowsTR() As DataRow = tblReportTable.Select(strF)
        var1 = rowsTR(0).Item("CHARFCID")
        charFCID = NZ(var1, "NA")

        boolJustTable = False

        Cursor.Current = Cursors.WaitCursor

        '''''wdd.visible = True

        fontsize = wd.ActiveDocument.Styles("Normal").Font.Size ' wd.Selection.Font.Size
        fonts = fontsize ' wd.Selection.Font.Size

        With wd

            intTableID = intTID ' 31

            Dim strWRunId As String = GetWatsonColH(intTableID)

            dvDo = frmH.dgvReportTableConfiguration.DataSource
            strF = "id_tblconfigreporttables = " & intTableID
            intDo = FindRowDVNumByCol(intTableID, dvDo, "id_tblconfigreporttables")

            ''Get table name
            'var1 = dvDo(intDo).Item("Table")
            'strTName = NZ(var1, "[NONE]")

            ''get Temperature info
            'var1 = dvDo(intDo).Item("PERIODTEMP")
            'strTempInfo = NZ(var1, "[NONE]")

            '***
            intDo = FindRowDVNumByCol(idTR, dvDo, "ID_TBLREPORTTABLE")
            'intLeg = 0
            'intLegStart = 96
            'boolPro = False

            'Get table name
            'var1 = dvDo(intDo).Item("Table")
            var1 = dvDo(intDo).Item("CHARHEADINGTEXT")
            strTName = NZ(var1, "[NONE]")
            strTNameO = strTName

            'get Temperature info
            var1 = dvDo(intDo).Item("CHARSTABILITYPERIOD")
            strTempInfo = NZ(var1, "[NONE]")

            '***

            ctPB = ctPB + 1
            If ctPB > frmH.pb1.Maximum Then
                ctPB = 1
            End If
            frmH.pb1.Value = ctPB
            frmH.pb1.Refresh()

            tbl1 = tblAnalysisResultsHome
            tbl2 = tblAssignedSamples
            tbl3 = tblAssignedSamplesHelper
            tbl4 = tblAnalytesHome

            Dim tbl5 As System.Data.DataTable
            tbl5 = tblTableProperties
            strF = "ID_TBLREPORTTABLE = " & idTR


            'ensure data has been entered
            strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR
            rowsX = tbl2.Select(strF)
            'If rowsX.Length = 0 Then
            '    strM = "Creating Summary of " & strTempInfo & " Final Extract Stability Table ...."
            '    frmH.lblProgress.Text = strM
            '    frmH.Refresh()
            '    MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
            '    GoTo end2
            'End If

            'strF = "IsIntStd = 'No'"

            If boolIncludeISTbl Then
                strF = "IsIntStd = 'No' OR IsIntStd = 'Yes'"
            Else
                strF = "IsIntStd = 'No'"
            End If
            'strS = "IsIntStd ASC, AnalyteDescription ASC"
            strS = "INTORDER ASC, IsIntStd ASC, AnalyteDescription ASC"

            rows11 = tblAnalytesHome.Select(strF)
            intRowsAnal = rows11.Length

            ctTbl = 0
            For Count1 = 1 To intRowsAnal

                boolJustTable = False

                Dim arrLegend(4, 20)

                strTName = strTNameO

                ctLegend = 0

                Dim int11 As Short
                If boolSTATSDIFFCOL Then
                    int11 = 2
                Else
                    int11 = 1
                End If

                'for legend stuff

                intExp = 0
                ctExp = 0

                intLeg = 0
                ctQCLegend = 0
                ctDilLeg = 0
                ctLegend = 0
                strA = ""
                strB = ""
                arrLegend.Clear(arrLegend, 0, arrLegend.Length)
                arrFP.Clear(arrFP, 0, arrFP.Length)
                intLegStart = 96


                'check if table is to be generated
                'strDo = arrAnalytes(1, Count1) 'record column name
                strDo = rows11(Count1 - 1).Item("ANALYTEDESCRIPTION")

                If UseAnalyte(CStr(strDo)) Then
                Else
                    GoTo next1
                End If

                bool = dvDo.Item(intDo).Item(strDo) 'find boolean value of dvDo column

                Dim strM1 As String
                If bool Then 'continue

                    ctTbl = ctTbl + 1

                    intTCur = intTCur + 1

                    'ensure data has been entered
                    strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ID_TBLREPORTTABLE = " & idTR
                    rowsX = tbl2.Select(strF)

                    'setup tables
                    If boolUseGroups Then
                        intGroup = tblAG.Rows(Count1 - 1).Item("INTGROUP")
                        strAnal = tblAG.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        strAnalC = tblAG.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                        vAnalyteID = tblAG.Rows.Item(Count1 - 1).Item("ANALYTEID")
                        strMatrix = tblAG.Rows(Count1 - 1).Item("MATRIX")
                    Else
                        var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                        var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                        var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        var4 = tbl4.Rows.Item(Count1 - 1).Item("ANALYTEID")
                        intGroup = 0
                        vAnalyteIndex = var1
                        vMasterAssayID = var2
                        vAnalyteID = var4
                        strMatrix = ""
                    End If

                    If rowsX.Length = 0 Then
                        'strM = "Creating Summary of " & strTempInfo & " Final Extract Stability Table ...."
                        strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                        strM = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."
                        frmH.lblProgress.Text = strM
                        frmH.Refresh()
                        'MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
                        boolJustTable = True
                        'page setup according to configuration
                        str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                        'insert page break
                        'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                        Call InsertPageBreak(wd)
                        Call PageSetup(wd, str1) 'L=Landscape, P=Portrait
                        GoTo end1
                    Else
                        boolJustTable = False
                    End If

                    'page setup according to configuration
                    str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")

                    Call InsertPageBreak(wd)
                    Call PageSetup(wd, str1) 'L=Landscape, P=Portrait

                    'ReDim arrBCQCs(8, 50) '1=LevelNumber, 2=NomConcentration, 3=ID, 4=FlagPercent, 5=Hello, 6=Lo, 7=#ofReplicates, 8=ASSAYID
                    strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                    strM = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."
                    strM1 = strM
                    frmH.lblProgress.Text = strM
                    frmH.Refresh()

                    'setup tables
                    strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    strF2 = strF2 & "INTGROUP = " & intGroup
                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    rows2 = tbl2.Select(strF2, strS)
                    int1 = rows2.Length 'debug
                    dv2 = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                    int1 = dv2.Count 'debug

                    'Table logic:
                    'There is only one data set for Ad Hoc Stability
                    'Use Ad Hoc Stability Comparison for more than one set of data

                    'find number of runs used
                    tblNumRuns = dv2.ToTable("a", True, "RUNID")
                    intNumRuns = tblNumRuns.Rows.Count

                    'get strConcUnits
                    intRunID = 0
                    int1 = 0
                    Do Until intRunID > 0
                        var1 = tblNumRuns.Rows(int1).Item("RUNID")
                        If IsDBNull(var1) Then
                        Else
                            intRunID = var1
                        End If
                        int1 = int1 + 1
                    Loop
                    strConcUnits = GetConcUnits(intRunID)

                    'var1 = dv2(0).Item("RUNID") 'DEBUG


                    'find number of different Run Identifiers
                    tblRID = dv2.ToTable("b", True, "RUNID")
                    numRID = tblRID.Rows.Count

                    're-establis tblLevels to get charhelper2's
                    tblRID = dv2.ToTable("b", True, "RUNID", "CHARHELPER2")

                    Dim tblOpt As System.Data.DataTable = dv2.ToTable("opt", True, "CHARHELPER2")
                    Dim intOpt As Short = tblOpt.Rows.Count
                    Dim boolOpt As Boolean = False
                    If intOpt = 0 Then
                        boolOpt = True
                    ElseIf intOpt >= 1 Then
                        var1 = tblOpt.Rows(0).Item("CHARHELPER2")
                        If Len(NZ(var1, "")) = 0 Then
                            boolOpt = False
                        Else
                            boolOpt = True
                        End If
                    Else
                        boolOpt = False
                    End If


                    'establish table of level numbers
                    'must be sorted by nomconc!
                    'make new dv
                    Dim dvNL As New DataView(tbl2, strF2, "NOMCONC", DataViewRowState.CurrentRows)
                    tblLevels = dvNL.ToTable("b", True, "NOMCONC", "ALIQUOTFACTOR", "CHARHELPER1")

                    '20180823 LEE:
                    '20190117 LEE:
                    'If there are several Diln samples that have the same nomconc as QCH, column order gets screwed up
                    'first assign to tblL
                    'then make tblLevels with sorted rows
                    Dim tblL As DataTable
                    If INTQCLEVELGROUP = 0 Then 'use assaylevel
                        tblL = dvNL.ToTable("b", True, "NOMCONC", "ALIQUOTFACTOR", "CHARHELPER1")
                    ElseIf INTQCLEVELGROUP = 1 Then 'use NomConc
                        tblL = dvNL.ToTable("b", True, "NOMCONC", "ALIQUOTFACTOR")
                    ElseIf INTQCLEVELGROUP = 2 Then 'use Level Label
                        tblL = dvNL.ToTable("b", True, "NOMCONC", "ALIQUOTFACTOR", "CHARHELPER1")
                    Else
                        tblL = dvNL.ToTable("b", True, "NOMCONC", "ALIQUOTFACTOR", "CHARHELPER1")
                    End If

                    Dim rowsL() As DataRow = tblL.Select("NOMCONC > 0", "NOMCONC ASC, ALIQUOTFACTOR DESC, CHARHELPER1")
                    tblLevels = rowsL.CopyToDataTable

                    intNumLevels = tblLevels.Rows.Count

                    '20180823 LEE:
                    'need to do this to get level labels
                    Dim tblLabels As DataTable = dvNL.ToTable("b", True, "NOMCONC", "CHARHELPER1")


                    For Count2 = 0 To intNumLevels - 1 'check for any null values
                        var3 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                        If IsDBNull(var3) Then
                            str1 = "The Nominal Concentration for some assigned samples for " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & " have not been configured."
                            str1 = str1 & ChrW(10) & "When this action is finished, please navigate to the Assigned Samples window and correct this problem."
                            If boolDisableWarnings Then
                            Else
                                MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                            End If
                            GoTo end1
                        End If
                        If INTQCLEVELGROUP = 1 Then
                        Else
                            var3 = tblLevels.Rows.Item(Count2).Item("CHARHELPER1")
                            If IsDBNull(var3) Then
                                str1 = "The Term 1 designation for some assigned samples for " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & " have not been configured."
                                str1 = str1 & ChrW(10) & "When this action is finished, please navigate to the Assigned Samples window and correct this problem."
                                If boolDisableWarnings Then
                                Else
                                    MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                                End If
                                GoTo end1
                            End If
                        End If
                    Next

                    'establish combo table of level numbers and run identifiers
                    Dim tblLevelsRID As System.Data.DataTable
                    Dim intNumLevelsRID As Short

                    'find number of table rows to generate
                    intRowsX = 0

                    boolOutHeadE = False
                    boolOutHeadI = False
                    boolDeleteRows = False

                    Dim intRowsXTot As Short = 0

                    For Count2 = 0 To intNumRuns - 1
                        '.Selection.Tables.item(1).Cell(int1, 1).Select()
                        'enter runid
                        var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")
                        '.Selection.TypeText(CStr(var10))
                        '.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)

                        intRowsX = 0
                        For Count3 = 0 To intNumLevels - 1
                            varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")
                            dv2.RowFilter = ""
                            'don't know why, but must make a long filter here or
                            'both analytes get returned in dv2.rowfilter
                            strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom
                            dv2.RowFilter = strF
                            int2 = dv2.Count
                            If int2 > intRowsX Then
                                intRowsX = int2
                            End If
                        Next

                        intRowsXTot = intRowsXTot + intRowsX

                    Next

                    'generate table
                    intTblRows = 0
                    intTblRows = intTblRows + 3 'for header
                    intTblRows = intTblRows + 1 'for blank row
                    intTblRows = intTblRows + (intRowsXTot) 'for number of data rows
                    intTblRows = intTblRows + (1 * intNumRuns) 'for one blank rows after each run set
                    'intTblRows = intTblRows + (5 * intNumRuns) 'for Mean/Bias/n section for each run set

                    'Increment for Statistics Sections
                    Dim intCSN As Short
                    intCSN = countNumStatsRows()
                    intTblRows = intTblRows + (intCSN * intNumRuns) + (intCSN * numRID)

                    If intCSN > 0 Then
                        intTblRows = intTblRows + (2 * intNumRuns) - 3 'for two blank rows after each Mean/Bias/n set, except last set
                        intTblRows = intTblRows + (2 * numRID) 'for two blank rows after each run identifier Mean/Bias/n set
                    Else
                        intTblRows = intTblRows - 1 'subtract an unneeded blank row
                    End If

                    If BOOLINCLUDEDATE Then
                        intTblRows = intTblRows + (1 * intNumRuns) 'for one additional rows after each run set
                    End If


                    If boolQCREPORTACCVALUES Then

                    Else
                        'For Count2 = 1 To intNumRuns 'must loop because this table may have several sections
                        intTblRows = intTblRows + (3 * intNumRuns) 'for stats headings
                        ctExp = ctExp + 2 'for stats headings

                        'Increment for Statistics Sections
                        intTblRows = intTblRows + (intCSN * intNumRuns) + (intCSN * numRID)
                        ctExp = ctExp + (intCSN * intNumRuns) + (countNumStatsRowsWithoutTheoretical() * numRID)

                        If intCSN > 0 Then
                            intTblRows = intTblRows + (1 * intNumRuns) - 1 'for a blank row after each Mean/Bias/n set, except last set
                            intTblRows = intTblRows + (2 * numRID) 'for two blank rows after each run identifier Mean/Bias/n set
                            ctExp = ctExp + (1 * intNumRuns) - 1
                            ctExp = ctExp + (2 * numRID)
                        End If

                    End If
                    wrdSelection = wd.Selection()

                    Dim intCols As Short

                    If boolSTATSDIFFCOL Then
                        intCols = (intNumLevels * 2) + 1
                    Else
                        intCols = intNumLevels + 1
                    End If
                    If boolOpt Then
                        intCols = intCols + 1
                    End If

                    Try

                        '20180913 LEE:
                        Call IncrNextTableNumber(wd)

                        If boolPlaceHolder Then
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=1, NumColumns:=1, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        Else
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=intTblRows, NumColumns:=intCols, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        End If

                        .Selection.Tables.Item(1).Select()

                        Call SetCellPaddingZero(.Selection.Tables.Item(1))

                        .Selection.Tables.Item(1).Rows.AllowBreakAcrossPages = False
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                        .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                        .Selection.Tables.Item(1).Columns.PreferredWidth = Microsoft.Office.Interop.Word.WdPreferredWidthType.wdPreferredWidthPoints
                        '.Selection.Tables.Item(1).Columns.Item(1).Width = 86
                        For Count2 = 1 To intNumLevels
                            '.Selection.Tables.item(1).Columns.item(Count2 + 1).Width = 50
                        Next
                        .Selection.Tables.Item(1).Select()


                        'remove border, but leave top and bottom
                        Call removeBorderButLeaveTopAndBottom(wd)

                        'border top and bottom of range
                        .Selection.Tables.Item(1).Cell(1, 1).Select()

                        If boolPlaceHolder Then

                            .Selection.Tables.Item(1).Select()
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone

                            strA = arrAnalytes(14, Count1)
                            strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, False)
                            Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                            'Note: strTName is byRef and will return Table, number, caption, label

                            Call MoveOneCellDown(wd)

                            .Selection.TypeParagraph()
                            .Selection.TypeParagraph()

                            'enter a table record in tblTableN
                            'ctTableN = ctTableN + 1
                            Dim dtblr1 As DataRow = tblTableN.NewRow
                            dtblr1.BeginEdit()
                            dtblr1.Item("TableNumber") = ctTableN
                            dtblr1.Item("AnalyteName") = arrAnalytes(1, Count1)
                            dtblr1.Item("TableName") = strTNameO
                            dtblr1.Item("TableID") = intTableID
                            dtblr1.Item("CHARFCID") = charFCID
                            dtblr1.Item("TableNameNew") = strTName
                            tblTableN.Rows.Add(dtblr1)

                            GoTo next1
                        End If

                        .Selection.Tables.Item(1).Select()
                        Call GlobalTableParaFormat(wd)

                        '20171220 LEE: Do not set table size, use the style default table
                        '.Selection.Font.Size = fontsize - 1
                        .Selection.Tables.Item(1).Cell(1, 1).Select()


                        .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=2, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        '.Selection.MoveRight Unit:=Microsoft.Office.Interop.Word.wdunits.word.wdunits.wdCharacter, Count:=ctQCs, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        'Enter QC ID row titles
                        Dim intSCol As Short
                        If boolOpt Then
                            intSCol = 3
                        Else
                            intSCol = 2
                        End If

                        .Selection.Tables.Item(1).Cell(2, intSCol).Select()

                        ''wdd.visible = True

                        Dim vDil
                        For Count2 = 0 To intNumLevels - 1


                            Dim strE As String
                            If INTQCLEVELGROUP = 1 Then 'has only NomConc
                                var1 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                                vDil = tblLevels.Rows.Item(Count2).Item("ALIQUOTFACTOR")

                                Dim rowsLabels() As DataRow = tblLabels.Select("NOMCONC = " & CSng(var1))
                                If rowsLabels.Length = 0 Then
                                    var3 = "NA"
                                Else
                                    var3 = rowsLabels(0).Item("CHARHELPER1")
                                End If

                            Else
                                var1 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                                var2 = tblLevels.Rows.Item(Count2).Item("CHARHELPER1")
                                vDil = tblLevels.Rows.Item(Count2).Item("ALIQUOTFACTOR")
                                var3 = ReturnStdQC(var2.ToString)
                            End If

                            .Selection.TypeText(Text:=var3)

                            '******determine if the level is a diln level
                            dv2.RowFilter = ""
                            strF = strF2 & " AND NOMCONC = " & CDbl(var1) & " AND ALIQUOTFACTOR = " & vDil

                            dv2.RowFilter = strF

                            'check for aliquot factor
                            Dim numDS As Single
                            If dv2.Count = 0 Then

                            Else
                                numDS = dv2(0).Item("ALIQUOTFACTOR")
                                If numDS <> 1 Then
                                    'record legend
                                    'var1 = NZ(DilQCFactor(Count2), 1)
                                    intLeg = intLeg + 1
                                    ctDilLeg = ctDilLeg + 1
                                    ctLegend = ctLegend + 1
                                    'configure first legend item
                                    'var4 = numDSNomConc 'tblLevels.Rows(Count2 - 1).Item("NOMCONC")
                                    'var3 = Format(1 / CDec(numDS), "0")
                                    var3 = GetDilnFactor(CDec(numDS)) '20190220 LEE
                                    strA = Chr(96 + intLeg) 'debugging
                                    arrLegend(1, intLeg) = Chr(96 + intLeg) 'a,b,c,etc
                                    'var: units
                                    Dim strAN As String = GetAN(var3)

                                    If boolLUseSigFigs Then
                                        'arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & DisplayNum(SigFigOrDec(Val(var1), LSigFig, False), LSigFig, False) & " " & strConcUnits & "; a 1:" & var3 & " dilution with blank matrix was performed prior to extraction and analysis."
                                        arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & DisplayNum(SigFigOrDec(Val(var1), LSigFig, False), LSigFig, False) & " " & strConcUnits & "; " & strAN & " " & var3 & "-fold dilution with blank matrix was performed prior to extraction and analysis."
                                    Else
                                        'arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & Format(CDbl(Val(var1)), GetRegrDecStr(LSigFig)) & " " & strConcUnits & "; a 1:" & var3 & " dilution with blank matrix was performed prior to extraction and analysis."
                                        arrLegend(2, intLeg) = "Dilution QCs undiluted concentration " & Format(CDbl(Val(var1)), GetRegrDecStr(LSigFig)) & " " & strConcUnits & "; " & strAN & " " & var3 & "-fold dilution with blank matrix was performed prior to extraction and analysis."
                                    End If


                                    arrLegend(3, intLeg) = True
                                    arrLegend(4, intLeg) = True

                                    'enter superscript

                                    If boolRedBoldFont Then
                                        .Selection.Font.Bold = True
                                        .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                    End If

                                    Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                    .Selection.Font.Bold = False
                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic

                                End If

                            End If
                            '.Selection.TypeText(strE)

                            '******

                            '.Selection.TypeText(Text:=var3)
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            If boolSTATSDIFFCOL Then
                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            End If

                        Next


                        'Enter nom. conc. row titles
                        .Selection.Tables.Item(1).Cell(3, intSCol).Select()

                        For Count2 = 0 To intNumLevels - 1

                            If boolLUseSigFigs Then
                                var1 = CStr(DisplayNum(SigFigOrDec(NZ(tblLevels.Rows.Item(Count2).Item("NOMCONC"), 0), LSigFig, False), LSigFig, False))
                            Else
                                var1 = CStr(Format(NZ(tblLevels.Rows.Item(Count2).Item("NOMCONC"), 0), GetRegrDecStr(LSigFig)))
                            End If

                            If LboolNomConcParen Then
                                var3 = "(" & var1 & ChrW(160) & strConcUnits & ")"
                            Else
                                var3 = var1 & ChrW(160) & strConcUnits
                            End If

                            .Selection.TypeText(Text:=var3)
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            If boolSTATSDIFFCOL Then
                                .Selection.TypeText(Text:=ReturnDiffLabel)
                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            End If

                        Next

                        .Selection.Tables.Item(1).Cell(3, 1).Select()
                        'bottom border this row
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        'enter Watson Run ID column header
                        .Selection.Tables.Item(1).Cell(3, 1).Select()

                        If BOOLINCLUDEDATE Then
                            .Selection.Tables.Item(1).Cell(3 - 1, 1).Select()
                            .Selection.TypeText(strWRunId)
                            .Selection.Tables.Item(1).Cell(3, 1).Select()
                            '.Selection.TypeText("(Analysis Date)")
                            '20180420 LEE:
                            .Selection.TypeText("(" & GetAnalysisDateLabel(intTableID) & ")")
                        Else
                            .Selection.TypeText(strWRunId)
                        End If

                        If boolOpt Then
                            .Selection.Tables.Item(1).Cell(3, 2).Select()
                            str1 = "Designation"
                            .Selection.TypeText(str1)
                        End If

                        'begin entering data'
                        intStart = 5
                        int1 = intStart 'row position counter
                        Dim boolExit As Boolean = False

                        'do ne and ni
                        'ne = n for data that excludes outlier data
                        'ni = n for data the includes all data
                        'start entering data
                        dv2.RowFilter = ""
                        Erase rows2
                        Dim tbl2s As System.Data.DataTable = dv2.ToTable
                        rows2 = tbl2s.Select("RUNID > -1") 'this is all data
                        int3 = rows2.Length
                        nI = int3
                        'now do rows2E
                        strF = ""
                        Erase rows2E

                        If gAllowExclSamples And LAllowExclSamples Then
                            rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL) AND BOOLEXCLSAMPLE = 0")
                        Else
                            rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)")
                        End If
                        nE = rows2E.Length

                        int1 = intStart

                        '20190117 LEE
                        intExp = 0

                        For Count2 = 0 To intNumRuns - 1

                            var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")

                            '20160816 LEE: intRowsX needs to be determined for each dataset
                            '****
                            dv2.RowFilter = ""
                            'don't know why, but must make a long filter here or
                            'both analytes get returned in dv2.rowfilter

                            intRowsX = 0

                            int12 = -1
                            For Count3 = 0 To tblLevels.Rows.Count - 1
                                int12 = int12 + 1
                                varNom = tblLevels.Rows.Item(int12).Item("NOMCONC")
                                var1 = tblLevels.Rows.Item(int12).Item("ALIQUOTFACTOR")
                                strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND ALIQUOTFACTOR = " & CDec(var1)
                                dv2.RowFilter = strF
                                int2 = dv2.Count
                                If int2 > intRowsX Then
                                    intRowsX = int2
                                End If
                            Next

                            '****

                            ''start legend

                            ''find number of runs used
                            'tblNumRuns = dv2.ToTable("a", True, "RUNID")
                            'intNumRuns = tblNumRuns.Rows.Count

                            ''find number of different Run Identifiers
                            'tblRID = dv2.ToTable("b", True, "RUNID")
                            'numRID = tblRID.Rows.Count

                            ''re-establish tblLevels to get charhelper2's
                            'tblRID = dv2.ToTable("b", True, "RUNID", "CHARHELPER2")

                            ''end legend


                            'For Count10 = 0 To numRID - 1

                            .Selection.Tables.Item(1).Cell(int1, 1).Select()
                            'enter runid


                            'strM = "Creating Summary of " & strTempInfo & " Final Extract Stability Table For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                            frmH.lblProgress.Text = strM1 & ChrW(10) & "Processing Run ID " & var10
                            frmH.Refresh()

                            Dim strH As String
                            Dim rowsG() As DataRow
                            Dim intG As Short
                            strF = "RUNID = " & var10
                            rowsG = tblRID.Select(strF, "RUNID ASC")
                            intG = rowsG.Length
                            strH = "[NONE]"
                            If intG = 0 Then
                                strH = "[NONE]"
                            Else
                                strH = NZ(rowsG(0).Item("CHARHELPER2"), "[NONE]")
                            End If
                            'strH = NZ(tblRID.Rows(Count10).Item("CHARHELPER2"), "[NONE]")

                            .Selection.TypeText(CStr(var10))
                            If BOOLINCLUDEDATE Then
                                int1 = int1 + 1
                                .Selection.Tables.Item(1).Cell(int1, 1).Select()
                                str1 = GetDateFromRunID(NZ(var10, 0), LDateFormat, intGroup, idTR)
                                .Selection.TypeText("(" & str1 & ")")
                                int1 = int1 - 1
                                .Selection.Tables.Item(1).Cell(int1, 1).Select()

                            End If
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)

                            'intRowsX = 0
                            For Count3 = 0 To intNumLevels - 1

                                varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")
                                vDil = tblLevels.Rows.Item(Count3).Item("ALIQUOTFACTOR")
                                'start evaluating data
                                dv2.RowFilter = ""

                                'don't know why, but must make a long filter here or
                                'both analytes get returned in dv2.rowfilter
                                strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND ALIQUOTFACTOR = " & vDil
                                ''''''''console.writeline(strF)
                                dv2.RowFilter = strF
                                int2 = dv2.Count 'debugging

                                'evaluate data
                                For Count4 = 0 To int2 - 1
                                    'var1 = NZ(rows2(Count4).Item("ELIMINATEDFLAG"), "N")
                                    'var2 = NZ(rows2(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                    var1 = NZ(dv2(Count4).Item("ELIMINATEDFLAG"), "N")
                                    var2 = NZ(dv2(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                    If StrComp(var1, "Y", CompareMethod.Text) = 0 Or var2 = -1 Then
                                        intExp = intExp + 1
                                        boolExit = True
                                        Exit For
                                    End If
                                Next

                                If boolExit Then
                                    Exit For
                                End If

                            Next

                            int12 = -1
                            'start filling in data by columns
                            'intRowsX = 0
                            For Count3 = 0 To (intNumLevels * int11) - 1 Step int11

                                int12 = int12 + 1
                                varNom = tblLevels.Rows.Item(int12).Item("NOMCONC")
                                vDil = tblLevels.Rows.Item(int12).Item("ALIQUOTFACTOR")

                                'determine hi and lo (nom*flagpercent)
                                strF = "CONCENTRATION = " & varNom & " AND ANALYTEID = " & vAnalyteID & " AND MASTERASSAYID = " & vMasterAssayID & " AND ANALYTEINDEX = " & vAnalyteIndex & " AND CONCENTRATION = " & varNom & " AND RUNID = " & var10 & " AND ALIQUOTFACTOR = " & vDil
                                'if Conc < 1, then the query return 0 records
                                'must do something different
                                var1 = GetANALYTEFLAGPERCENT(varNom, var10, vAnalyteID)

                                var2 = var1
                                arrFP(1, int12) = var1
                                arrFP(2, int12) = var2
                                Call SetHighAndLowCriteria(varNom, var1, var1, hi, lo)
                                v1 = var1
                                v2 = var2
                                vU = 0

                                'start entering data
                                dv2.RowFilter = strF2
                                'don't know why, but must make a long filter here or
                                'both analytes get returned in dv2.rowfilter
                                strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom & " AND ALIQUOTFACTOR = " & vDil
                                dv2.RowFilter = strF
                                ''''''''console.writeline(strF)
                                int2 = dv2.Count
                                int3 = int2
                                'nI = int2

                                'create rows1 from tbl1 which will contain all data
                                strF = ""
                                'Erase rows2
                                'Dim tbl2s As System.Data.DataTable = dv2.ToTable
                                'rows2 = tbl2s.Select("RUNID > -1") 'this is all data
                                'int3 = rows2.Length

                                ''debugging
                                Dim CountE As Short
                                Dim CountF As Short
                                Dim CountG As Short
                                Dim strCCC As String

                                'remember to evaluate GuWu Acc Crit
                                'legend
                                'tbl1 = tblAnalysisResultsHome
                                'tbl2 = tblAssignedSamples = dv2
                                'tbl3 = tblAssignedSamplesHelper
                                'tbl4 = tblAnalytesHome
                                'end legend
                             

                                'enter data
                                For Count4 = 0 To intRowsX - 1 'int3 - 1

                                    boolOC = False

                                    .Selection.Tables.Item(1).Cell(int1 + Count4, Count3 + intSCol).Select()

                                    If Count4 > int3 - 1 Then

                                        If boolQCNA Then
                                            str1 = "NA"
                                        Else
                                            str1 = ""
                                        End If

                                        .Selection.TypeText(str1)
                                        boolEnterDiff = False
                                        boolOC = True
                                    Else

                                        If boolOpt Then
                                            str1 = NZ(dv2(Count4).Item("CHARHELPER2"), "")
                                            .Selection.Tables.Item(1).Cell(int1 + Count4, intSCol - 1).Select()
                                            .Selection.TypeText(Text:=str1)
                                            .Selection.Tables.Item(1).Cell(int1 + Count4, Count3 + intSCol).Select()
                                        Else
                                            .Selection.Tables.Item(1).Cell(int1 + Count4, Count3 + intSCol).Select()
                                        End If

                                        boolEnterDiff = False
                                        If Count4 = 0 Then
                                            'enter charhelper2
                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                            End If
                                        End If

                                        var1 = dv2(Count4).Item("CONCENTRATION")
                                        varAnal = NZ(dv2(Count4).Item("ANALYTEAREA"), 0)
                                        varIS = NZ(dv2(Count4).Item("INTERNALSTANDARDAREA"), 0)

                                        varConc = var1
                                        var1 = NZ(var1, 0)
                                        numDF = dv2(Count4).Item("ALIQUOTFACTOR")
                                        var1 = var1 / numDF
                                        If boolRCConc Then
                                            If boolLUseSigFigs Then
                                                var2 = SigFigOrDec(var1, LSigFig, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If

                                        Else
                                            'var2 = SigFigOrDec(var1, LSigFig, False)

                                            If boolIS Then
                                                var1 = varIS
                                            Else
                                                var1 = varAnal
                                            End If
                                            '*****
                                            If boolRCPARatio Then
                                                If boolLUseSigFigsAreaRatio Then
                                                    If varIS = 0 Then
                                                        var1 = var1
                                                    Else
                                                        var1 = var1 / varIS
                                                    End If
                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, False)
                                                Else
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                End If
                                            ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE: is Int Std
                                                If boolLUseSigFigsArea Then
                                                    var1 = SigFigArea(RoundToDecimalA(varIS, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    var1 = Format(RoundToDecimalRAFZ(varIS, LSigFigArea), strAreaDec)
                                                End If
                                                var2 = var1
                                            Else
                                                If boolLUseSigFigsArea Then
                                                    var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                End If
                                                var2 = var1
                                            End If
                                            '*****

                                        End If

                                        var1 = NZ(dv2(Count4).Item("ELIMINATEDFLAG"), "N")

                                        Dim vE
                                        vE = dv2(Count4).Item("BOOLEXCLSAMPLE")

                                        If IsDBNull(varConc) Then

                                            boolExFromAS = False
                                            boolOC = True

                                            If gAllowExclSamples And LAllowExclSamples Then
                                                If vE = -1 Then
                                                    var1 = "Y"
                                                    boolExFromAS = True
                                                Else
                                                    'var1 = "N"
                                                    'don't assign "N", Watson may override
                                                End If
                                            End If

                                            var1 = "Y"

                                            boolEnterDiff = True 'FALSE
                                            intExp = intExp + 1
                                            intLeg = intLeg + 1
                                            strA = ChrW(intLeg + intLegStart)

                                            'Remember, tblAssignedSamples does not have DECISIONREASON
                                            Dim var6
                                            var6 = "No Value: " & GetDECISIONREASONValue(boolExFromAS, vAnalyteID, rows2(Count4))

                                            If gAllowExclSamples And LAllowExclSamples Then
                                                If vE = -1 Then
                                                    var1 = "Y"
                                                    boolExFromAS = True
                                                Else
                                                    'var1 = "N"
                                                    'don't assign "N", Watson may override
                                                End If
                                            End If

                                            var1 = "Y"

                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                            'Set Legend String
                                            str1 = GetLegendStringExcluded(arrFP(1, int12), arrFP(2, int12), vU, var6, intTableID, True, "")
                                            'Add to Legend Array
                                            ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                            '''''wdd.visible = True

                                            If boolRedBoldFont Then
                                                .Selection.Font.Bold = True
                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            End If

                                            .Selection.TypeText(Text:="NV")

                                            Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                        ElseIf StrComp(var1, "Y", vbTextCompare) = 0 Or (gAllowExclSamples And LAllowExclSamples And vE = -1) Then

                                            boolExFromAS = False
                                            boolOC = True

                                            If gAllowExclSamples And LAllowExclSamples Then
                                                If vE = -1 Then
                                                    var1 = "Y"
                                                    boolExFromAS = True
                                                Else
                                                    'var1 = "N"
                                                    'don't assign "N", Watson may override
                                                End If
                                            End If

                                            boolEnterDiff = True 'FALSE
                                            intExp = intExp + 1
                                            intLeg = intLeg + 1
                                            strA = ChrW(intLeg + intLegStart)

                                            'Remember, tblAssignedSamples does not have DECISIONREASON
                                            Dim var6
                                            var6 = GetDECISIONREASONValue(boolExFromAS, vAnalyteID, rows2(Count4))

                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                            'Set Legend String
                                            str1 = GetLegendStringExcluded(arrFP(1, int12), arrFP(2, int12), vU, var6, intTableID, True, "")
                                            'Add to Legend Array
                                            ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                            '''''wdd.visible = True

                                            If boolRedBoldFont Then
                                                .Selection.Font.Bold = True
                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            End If

                                            If boolRCConc Then
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                End If

                                            Else

                                                If boolIS Then
                                                    var1 = varIS
                                                Else
                                                    var1 = varAnal
                                                End If
                                                '*****
                                                If boolRCPARatio Then
                                                    If varIS = 0 Then
                                                        var1 = var1
                                                    Else
                                                        var1 = var1 / varIS
                                                    End If
                                                    If boolLUseSigFigsAreaRatio Then
                                                        var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                    End If
                                                ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE: is Int Std
                                                    If boolLUseSigFigsArea Then
                                                        var1 = SigFigArea(RoundToDecimalA(varIS, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var1 = Format(RoundToDecimalRAFZ(varIS, LSigFigArea), strAreaDec)
                                                    End If
                                                    var2 = var1
                                                Else
                                                    If boolLUseSigFigsArea Then
                                                        var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    var2 = var1
                                                End If
                                                '*****
                                                .Selection.TypeText(Text:=CStr(var2))
                                            End If

                                            Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                        Else

                                            boolEnterDiff = True
                                            'determine if value is outside acceptance criteria
                                            vU = NZ(dv2(Count4).Item("BOOLUSEGUWUACCCRIT"), 0)
                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'If (var2 > hi Or var2 < lo) And boolRCConc Then 'flag
                                            If (OutsideAccCrit(var2, varNom, v1, v2, NZ(vU, 0))) And boolRCConc Then 'flag
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    v1 = NZ(dv2(Count4).Item("NUMMAXACCCRIT"), 0)
                                                    v2 = NZ(dv2(Count4).Item("NUMMINACCCRIT"), 0)
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                    'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'str1 = "Value outside of acceptance criteria (" & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                'search for str1 in arrLegend
                                                boolPro = False
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For
                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                    End If
                                                Else
                                                    If boolIS Then
                                                        var1 = varIS
                                                    Else
                                                        var1 = varAnal
                                                    End If
                                                    '*****
                                                    If boolRCPARatio Then
                                                        If varIS = 0 Then
                                                            var1 = var1
                                                        Else
                                                            var1 = var1 / varIS
                                                        End If
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                    ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE is Int Std
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(RoundToDecimalA(varIS, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(varIS, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    End If
                                                    '*****
                                                    .Selection.TypeText(Text:=CStr(var2))
                                                End If
                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                            Else
                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                    End If
                                                Else
                                                    If boolIS Then
                                                        var1 = varIS
                                                    Else
                                                        var1 = varAnal
                                                    End If
                                                    '*****

                                                    If boolRCPARatio Then
                                                        If varIS = 0 Then
                                                            var1 = var1
                                                        Else
                                                            var1 = var1 / varIS
                                                        End If
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                    ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE is Int Std
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(RoundToDecimalA(varIS, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(varIS, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    End If
                                                    '*****
                                                    .Selection.TypeText(Text:=CStr(var2))
                                                End If
                                                boolEnterDiff = True
                                            End If
                                        End If

                                    End If

                                    If boolSTATSDIFFCOL Then
                                        .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                        If boolEnterDiff Then
                                            'var3 = Format(((var2 / varNom) - 1) * 100, strQCDec)

                                            '20180723 LEE: Must do this in case more than one accuracy
                                            var3 = CalcREPercent(var2, varNom, intQCDec)
                                            numTheor = 100 + CDec(var3)
                                            If boolTHEORETICAL And (boolSTATSBIAS = False And boolSTATSDIFF = False And BOOLSTATSRE = False) Then
                                                'redo var3 as string in case %RE column is shown
                                                'var3 = Format(RoundToDecimal(CalcREPercent(numTheor, varNom, intQCDec), intQCDec), strQCDec)
                                                var3 = numTheor
                                                If boolOC Then
                                                Else
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numTheor, CSng(var10), Count1, strDo, v1, v2, boolOC)
                                                End If

                                            Else
                                                var3 = Format(RoundToDecimal(CalcREPercent(var2, varNom, intQCDec), intQCDec), strQCDec)

                                                If boolOC Then
                                                Else
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", var3, CSng(var10), Count1, strDo, v1, v2, boolOC)
                                                End If

                                            End If
                                        Else

                                            If boolQCNA Then
                                                var3 = "NA"
                                            Else
                                                var3 = ""
                                            End If

                                        End If
                                        .Selection.TypeText(Text:=CStr(var3))
                                        .Selection.MoveLeft(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                    End If

                                Next


                                '.Selection.Tables.Item(1).Cell(int1 + Count4 + 1, 1).Select()
                                .Selection.Tables.Item(1).Cell(int1, 1).Select()
                                int1 = .Selection.Information(Microsoft.Office.Interop.Word.WdInformation.wdStartOfRangeRowNumber)
                                '.Selection.Tables.Item(1).Cell(int1 + 1, 2).Select()
                                'begin doing stats

                                int1 = .Selection.Information(Microsoft.Office.Interop.Word.WdInformation.wdStartOfRangeRowNumber)

                                int8 = 0
                                .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()
                                '''''wdd.visible = True
                                var1 = var1

                            Next Count3 'Levels

                            'increase row position counter
                            If Count2 = intNumRuns - 1 Then
                                int1 = int1 + intRowsX + 1
                                'intStart = int1 + int8 + 1
                            Else
                                int1 = int1 + intRowsX + 1
                                'intStart = int1 + int8 + 1
                            End If

                            'Next Count10

                        Next Count2 'numRunID



                        '**** begin stats

                        'now enter Mean/Bias/n

                        int8 = 0
                        If boolQCREPORTACCVALUES Then
                            Call typeStatsLabels(wd, int8, int1 - 1, 1, False)
                        Else
                            If intExp = 0 Then
                                Call typeStatsLabels(wd, int8, int1 - 1, 1, False)
                            Else
                                .Selection.Tables.Item(1).Cell(int1 + int8, 1).Select()
                                If boolOutHeadE Then
                                Else
                                    .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                    .Selection.TypeText(Text:="Summary Statistics Excluding Outlier Values")
                                    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                    Try
                                        .Selection.Cells.Merge()
                                    Catch ex As Exception

                                    End Try
                                    boolOutHeadE = True
                                End If
                                With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                    .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                End With
                                int8 = int8 + 1
                                Call typeStatsLabels(wd, int8, int1 - 1, 1, False)
                                'int1 = int1 + 1
                            End If
                        End If

                        If boolQCREPORTACCVALUES Then
                        Else
                            If intExp = 0 Then
                            Else
                                int8 = int8 + 1
                                .Selection.Tables.Item(1).Cell(int1 + int8, 1).Select()
                                If boolOutHeadI Then
                                Else
                                    .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                    .Selection.TypeText(Text:="Summary Statistics Including Outlier Values")
                                    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                    Try
                                        .Selection.Cells.Merge()
                                    Catch ex As Exception

                                    End Try
                                    boolOutHeadI = True
                                End If

                                With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                    .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                End With

                                Call typeStatsLabels(wd, int8, int1, 1, False)

                                int1 = int1 + 1
                            End If
                        End If

                        .Selection.Tables.Item(1).Cell(int1, 2).Select()

                        int12 = -1
                        'start filling in data by columns
                        'intRowsX = 0

                        For Count3 = 0 To (intNumLevels * int11) - 1 Step int11

                            int12 = int12 + 1
                            int8 = 0

                            varNom = tblLevels.Rows.Item(int12).Item("NOMCONC")
                            vDil = tblLevels.Rows.Item(int12).Item("ALIQUOTFACTOR")

                            .Selection.Tables.Item(1).Cell(int1, Count3 + intSCol).Select()

                            'do ne and ni
                            dv2.RowFilter = ""

                            dv2.RowFilter = ""
                            'don't know why, but must make a long filter here or
                            'both analytes get returned in dv2.rowfilter
                            strF = strF2 & " AND NOMCONC = " & varNom & " AND ALIQUOTFACTOR = " & vDil
                            dv2.RowFilter = strF
                            int2 = dv2.Count

                            Erase rows2
                            tbl2s = dv2.ToTable
                            rows2 = tbl2s.Select("RUNID > -1") 'this is all data
                            int3 = rows2.Length
                            nI = int3

                            'now do rows2E
                            strF = ""
                            Erase rows2E

                            'Dim tbl2E as System.Data.DataTable = dv2.ToTable
                            If gAllowExclSamples And LAllowExclSamples Then
                                'rows2E = tbl2s.Select("ELIMINATEDFLAG = 'N' AND BOOLEXCLSAMPLE = 0")
                                rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL) AND BOOLEXCLSAMPLE = 0")
                                '(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)
                            Else
                                'rows2E = tbl2s.Select("ELIMINATEDFLAG = 'N'")
                                rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)")
                            End If
                            nE = rows2E.Length


                            Try
                                'If boolRCConc Then
                                '    var1 = MeanDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                'Else
                                '    var1 = MeanDRArea(rows2E, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                'End If
                                '20180720 LEE: MeanDR can accept Area
                                If boolRCConc Then
                                    var1 = MeanDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                Else
                                    var1 = MeanDR(rows2E, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                End If

                                If nE = 0 Then
                                    numMean = 0
                                Else
                                    If boolRCConc Then
                                        If boolLUseSigFigs Then
                                            numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                        Else
                                            numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                        End If

                                    Else
                                        '*****
                                        If boolRCPARatio Then
                                            If boolLUseSigFigsAreaRatio Then
                                                var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                            Else
                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                            End If
                                        ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE is Int Std
                                            If boolLUseSigFigsArea Then
                                                var1 = SigFigArea(RoundToDecimalA(varIS, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                            Else
                                                var1 = Format(RoundToDecimalRAFZ(varIS, LSigFigArea), strAreaDec)
                                            End If
                                            var2 = var1
                                        Else
                                            If boolLUseSigFigsArea Then
                                                var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                            Else
                                                var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                            End If
                                            var2 = var1
                                        End If
                                        '*****
                                        numMean = var2

                                    End If
                                End If

                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Mean", numMean, CSng(var10), Count1, strDo, 0, 0, False)

                            Catch ex As Exception

                            End Try
                            If boolSTATSMEAN Then
                                Try
                                    'enter Mean
                                    int8 = int8 + 1
                                    'If boolRCConc Then
                                    '    var1 = MeanDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                    'Else
                                    '    var1 = MeanDRArea(rows2E, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                    'End If
                                    '20180720 LEE: MeanDR can accept Area
                                    If boolRCConc Then
                                        var1 = MeanDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                    ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE is Int Std
                                        var1 = MeanDR(rows2E, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, True)
                                    Else
                                        var1 = MeanDR(rows2E, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                    End If
                                    numMean = 0

                                    If nE = 0 Then
                                        .Selection.TypeText("NA")
                                    Else
                                        If boolRCConc Then
                                            If boolLUseSigFigs Then
                                                numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                            Else
                                                numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If

                                            If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                            End If

                                            'determine if value is outside acceptance criteria
                                            'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag

                                            If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                    If v1 = v2 Then
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                    End If

                                                    'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                Else
                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                End If

                                                'str1 = "Value outside of acceptance criteria (" & RoundToDecimal(arrFP(1, Count3), 0) & "% theoretical) but included in summary statistics."
                                                'search for str1 in arrLegend
                                                If intLeg = 1 Then
                                                    arrLegend(1, intLeg) = strA
                                                    arrLegend(2, intLeg) = str1
                                                    arrLegend(3, intLeg) = True
                                                    ctLegend = ctLegend + 1
                                                Else
                                                    boolPro = True
                                                    For Count5 = 1 To intLeg - 1
                                                        str2 = arrLegend(2, Count5)
                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                            intLeg = intLeg - 1
                                                            strA = arrLegend(1, Count5)
                                                            boolPro = False
                                                            Exit For

                                                        End If
                                                    Next
                                                    If boolPro Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    End If
                                                End If


                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                '.Selection.TypeText(Text:=CStr(numMean))
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                boolEnterDiff = True
                                            Else
                                                '.Selection.TypeText(Text:=CStr(numMean))
                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                End If
                                                boolEnterDiff = True
                                            End If

                                        Else
                                            '*****
                                            If boolRCPARatio Then
                                                If boolLUseSigFigsAreaRatio Then
                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                Else
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                End If
                                            Else
                                                If boolLUseSigFigsArea Then
                                                    var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                End If
                                                var2 = var1
                                            End If
                                            '*****

                                            numMean = var2
                                            .Selection.TypeText(CStr(var2))

                                        End If
                                    End If


                                    'Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Mean", numMean, CSng(var10), Count1, strDo,0,0)

                                    .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()

                                Catch ex As Exception

                                End Try
                            End If


                            Try
                                If nE < gSDMax Then
                                    numSD = 0
                                Else
                                    numSD = 0
                                    If boolRCConc Then
                                        var1 = StdDevDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                    ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE is Int Std
                                        var1 = StdDevDRArea(rows2E, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, True)
                                    Else
                                        var1 = StdDevDRArea(rows2E, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                    End If

                                    If boolRCConc Then
                                        If boolLUseSigFigs Then
                                            numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                        Else
                                            numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                        End If

                                        '*****
                                    Else
                                        If boolRCPARatio Then
                                            If boolLUseSigFigsAreaRatio Then
                                                var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                            Else
                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                            End If
                                        Else
                                            If boolLUseSigFigsArea Then
                                                var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                            Else
                                                var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                            End If
                                            var2 = var1
                                        End If
                                        '*****
                                        numSD = var2

                                    End If
                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "SD", numSD, CSng(var10), Count1, strDo, 0, 0, False)

                                End If
                            Catch ex As Exception

                            End Try
                            If boolSTATSSD Then
                                Try
                                    'enter SD
                                    int8 = int8 + 1
                                    If nE < gSDMax Then
                                        .Selection.TypeText("NA")
                                    Else
                                        numSD = 0
                                        If boolRCConc Then
                                            var1 = StdDevDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                        ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE is Int Std
                                            var1 = StdDevDRArea(rows2E, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, True)
                                        Else
                                            var1 = StdDevDRArea(rows2E, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                        End If

                                        If boolRCConc Then
                                            If boolLUseSigFigs Then
                                                numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                .Selection.TypeText(CStr(DisplayNum(numSD, LSigFig, False)))
                                            Else
                                                numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                            End If

                                            '*****
                                        Else
                                            If boolRCPARatio Then
                                                If boolLUseSigFigsAreaRatio Then
                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                Else
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                End If
                                            Else
                                                If boolLUseSigFigsArea Then
                                                    var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                End If
                                                var2 = var1
                                            End If
                                            '*****
                                            numSD = var2
                                            .Selection.TypeText(CStr(var2))

                                        End If
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "SD", numSD, CSng(var10), Count1, strDo, 0, 0, False)

                                        'numSD = SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False)
                                        '.Selection.TypeText(CStr(numSD))
                                    End If

                                    '.Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + intscol).Select()
                                    .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()
                                Catch ex As Exception

                                End Try
                            End If


                            Try
                                If nE < gSDMax Then
                                Else
                                    numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Precision", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                End If

                            Catch ex As Exception

                            End Try
                            If boolSTATSCV Then
                                Try
                                    'enter %CV
                                    int8 = int8 + 1
                                    If nE < gSDMax Then
                                        .Selection.TypeText("NA")
                                    Else
                                        .Selection.TypeText(Format(numPrec, strQCDec))
                                    End If

                                    .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()
                                Catch ex As Exception

                                End Try
                            End If


                            If boolSTATSBIAS And (boolSTATSDIFFCOL = False Or (boolSTATSDIFFCOL And BOOLDIFFCOLSTATS = False)) Then
                                Try
                                    numBias = CalcREPercent(numMean, varNom, intQCDec)
                                    If nE = 0 Then
                                    Else
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                    End If

                                Catch ex As Exception

                                End Try
                            Else
                                'get numbias from average of %Bias columns
                                numBias = GetBiasFromDiffCol(idTR, varNom, int12 + 1, 0, False)
                            End If

                            If boolSTATSBIAS And boolSTATSMEAN Then
                                Try
                                    'enter %Bias
                                    int8 = int8 + 1

                                    If nE = 0 Then
                                        .Selection.TypeText("NA")
                                    Else
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                    End If

                                    .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()

                                Catch ex As Exception

                                End Try
                            End If

                            '20180723 LEE: Must do this in case more than one accuracy
                            numTheor = CalcREPercent(numMean, varNom, intQCDec)
                            numTheor = 100 + CDec(numTheor)
                            If boolTHEORETICAL And (boolSTATSDIFFCOL = False Or (boolSTATSDIFFCOL And BOOLDIFFCOLSTATS = False)) Then

                                Try
                                    'numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                    'numTheor = 100 + CDec(numTheor)
                                    If nE = 0 Then
                                    Else
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numTheor, CSng(var10), Count1, strDo, 0, 0, False)
                                    End If

                                Catch ex As Exception

                                End Try
                            Else

                                If (boolSTATSBIAS = False And boolSTATSDIFF = False And BOOLSTATSRE = False) And boolSTATSDIFFCOL Then
                                    'get numbias from average of %Bias columns
                                    numTheor = GetBiasFromDiffCol(idTR, varNom, int12 + 1, 0, False)
                                Else
                                    'use numTheor from above
                                End If


                            End If


                            If boolTHEORETICAL And boolSTATSMEAN Then
                                Try
                                    'enter %theoretical
                                    int8 = int8 + 1


                                    If nE = 0 Then
                                        .Selection.TypeText("NA")
                                    Else
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numTheor, strQCDec))
                                        End If
                                    End If

                                    .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()


                                Catch ex As Exception

                                End Try

                            End If


                            If boolSTATSDIFF And (boolSTATSDIFFCOL = False Or (boolSTATSDIFFCOL And BOOLDIFFCOLSTATS = False)) Then
                                Try
                                    numBias = CalcREPercent(numMean, varNom, intQCDec)
                                    If nE = 0 Then
                                    Else
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                    End If

                                Catch ex As Exception

                                End Try
                            Else
                                'get numbias from average of %Bias columns
                                numBias = GetBiasFromDiffCol(idTR, varNom, int12 + 1, 0, False)
                            End If

                            If boolSTATSDIFF And boolSTATSMEAN Then
                                Try
                                    'enter %Bias
                                    int8 = int8 + 1

                                    If nE = 0 Then
                                        .Selection.TypeText("NA")
                                    Else
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                    End If

                                    '.Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + intscol).Select()
                                    .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()


                                Catch ex As Exception

                                End Try
                            End If


                            If BOOLSTATSRE And (boolSTATSDIFFCOL = False Or (boolSTATSDIFFCOL And BOOLDIFFCOLSTATS = False)) Then
                                Try
                                    numBias = CalcREPercent(numMean, varNom, intQCDec)
                                    If nE = 0 Then
                                    Else
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                    End If

                                Catch ex As Exception

                                End Try
                            Else
                                'get numbias from average of %Bias columns
                                numBias = GetBiasFromDiffCol(idTR, varNom, int12 + 1, 0, False)
                            End If

                            If BOOLSTATSRE And boolSTATSMEAN Then
                                Try
                                    'enter %RE
                                    int8 = int8 + 1

                                    If nE = 0 Then
                                        .Selection.TypeText("NA")
                                    Else
                                        If boolRCPA Or boolRCPARatio Then
                                            .Selection.TypeText("NA")
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If
                                    End If

                                    .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()

                                Catch ex As Exception

                                End Try
                            End If


                            Try
                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "n", nE, CSng(var10), Count1, strDo, 0, 0, False)
                            Catch ex As Exception

                            End Try
                            If boolSTATSN Then
                                Try
                                    'enter n
                                    int8 = int8 + 1

                                    .Selection.TypeText(CStr(nE))

                                Catch ex As Exception

                                End Try
                            End If

                            If boolQCREPORTACCVALUES Then
                            Else
                                If intExp = 0 Then

                                    ''20180510 LEE:
                                    ''don't do this anymore
                                    ''inefficient. RemoveRows is run at the end
                                    'If boolDeleteRows Then
                                    'Else

                                    '    Call DeleteRows(ctExp / intNumRuns, wd)
                                    '    boolDeleteRows = True

                                    'End If

                                Else
                                    int8 = int8 + 2
                                    .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()

                                    If boolSTATSMEAN Then

                                        numMean = 0

                                        Try
                                            'enter Mean
                                            int8 = int8 + 1

                                            If nI = 0 Then
                                                .Selection.TypeText("NA")
                                            Else
                                                'If boolRCConc Then
                                                '    var1 = MeanDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                'Else
                                                '    var1 = MeanDRArea(rows2, "CONCENTRATION", False, "ALIQUOTFACTOR", False, False)
                                                'End If
                                                '20180720 LEE: MeanDR can accept Area
                                                If boolRCConc Then
                                                    var1 = MeanDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE is Int Std
                                                    var1 = MeanDR(rows2, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, False)
                                                Else
                                                    var1 = MeanDR(rows2, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                                End If

                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If

                                                    If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                        Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                                    End If

                                                    'determine if value is outside acceptance criteria
                                                    'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag
                                                    If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                        intLeg = intLeg + 1
                                                        strA = ChrW(intLeg + intLegStart)
                                                        'str1 = "Value outside of acceptance criteria (" & RoundToDecimal(arrFP(1, Count3), 0) & "% theoretical) but included in summary statistics."
                                                        If LAllowGuWuAccCrit And gAllowGuWuAccCrit And vU = -1 Then
                                                            If v1 = v2 Then
                                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            Else
                                                                str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                            End If
                                                            'str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) and excluded from summary statistics because the value is a statistical outlier according to the [OUTLIERMETHOD]."
                                                        Else
                                                            str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                                        End If

                                                        'Add to Legend Array
                                                        ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                                        If boolRedBoldFont Then
                                                            .Selection.Font.Bold = True
                                                            .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        End If

                                                        '.Selection.TypeText(Text:=CStr(numMean))
                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If

                                                        Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                        boolEnterDiff = True
                                                    Else
                                                        '.Selection.TypeText(Text:=CStr(numMean))
                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                        End If
                                                        boolEnterDiff = True
                                                    End If

                                                Else


                                                    '*****
                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, False)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, False) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    End If
                                                    '*****
                                                    numMean = var2
                                                    .Selection.TypeText(CStr(var2))

                                                End If
                                            End If

                                            .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()

                                        Catch ex As Exception

                                        End Try

                                    End If
                                    If boolSTATSSD Then
                                        Try
                                            'enter SD
                                            int8 = int8 + 1
                                            If nI < gSDMax Then
                                                .Selection.TypeText("NA")
                                            Else
                                                If boolRCConc Then
                                                    var1 = StdDevDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then '20190225 LEE is Int Std
                                                    var1 = StdDevDRArea(rows2, "INTERNALSTANDARDAREA", False, "ALIQUOTFACTOR", False, True)
                                                Else
                                                    var1 = StdDevDRArea(rows2, "ANALYTEAREA", False, "ALIQUOTFACTOR", False, False)
                                                End If

                                                If boolRCConc Then
                                                    If boolLUseSigFigs Then
                                                        numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                        .Selection.TypeText(CStr(DisplayNum(numSD, LSigFig, False)))
                                                    Else
                                                        numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                        .Selection.TypeText(CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                                    End If

                                                    '*****
                                                Else

                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    End If
                                                    '*****
                                                    numSD = var2
                                                    .Selection.TypeText(CStr(var2))

                                                End If

                                            End If

                                            '.Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + intscol).Select()
                                            .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()
                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If boolSTATSCV Then
                                        Try
                                            'enter %CV
                                            int8 = int8 + 1
                                            If nI < gSDMax Then
                                                .Selection.TypeText("NA")
                                            Else
                                                numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                .Selection.TypeText(Format(numPrec, strQCDec))
                                            End If

                                            '.Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + intscol).Select()
                                            .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()
                                        Catch ex As Exception

                                        End Try
                                    End If
                                    If boolSTATSBIAS And boolSTATSMEAN Then
                                        Try
                                            'enter %Bias
                                            int8 = int8 + 1
                                            'var1 = (((numMean / varNom) - 1) * 100)
                                            'var1 = Format(var1, strQCDec)
                                            '.Selection.TypeText(CStr(var1))

                                            numBias = CalcREPercent(numMean, varNom, intQCDec)
                                            If nI = 0 Then
                                                .Selection.TypeText("NA")
                                            Else
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                            End If

                                            '.Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + intscol).Select()
                                            .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()
                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If boolTHEORETICAL And boolSTATSMEAN Then
                                        Try
                                            'enter %theoretical
                                            int8 = int8 + 1
                                            'var1 = CDec(Format((((numMean / varNom) - 1) * 100), strQCDec))
                                            'var1 = Format(var1, strQCDec)
                                            'var1 = Format(100 + var1, strQCDec)
                                            '.Selection.TypeText(CStr(var1))

                                            numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                            numTheor = 100 + CDec(numTheor)
                                            If nI = 0 Then
                                                .Selection.TypeText("NA")
                                            Else
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numTheor, strQCDec))
                                                End If
                                            End If

                                            .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()
                                        Catch ex As Exception

                                        End Try

                                    End If

                                    If boolSTATSDIFF And boolSTATSMEAN Then
                                        Try
                                            'enter %Bias
                                            int8 = int8 + 1
                                            numBias = CalcREPercent(numMean, varNom, intQCDec)
                                            If nI = 0 Then
                                                .Selection.TypeText("NA")
                                            Else
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                            End If

                                            '.Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + intscol).Select()
                                            .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()
                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If BOOLSTATSRE And boolSTATSMEAN Then
                                        Try
                                            'enter %RE
                                            int8 = int8 + 1
                                            numBias = CalcREPercent(numMean, varNom, intQCDec)
                                            If nI = 0 Then
                                                .Selection.TypeText("NA")
                                            Else
                                                If boolRCPA Or boolRCPARatio Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If
                                            End If

                                            '.Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + intscol).Select()
                                            .Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intSCol).Select()
                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If boolSTATSN Then
                                        Try
                                            'enter n
                                            int8 = int8 + 1
                                            .Selection.TypeText(CStr(nI))
                                            '.Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + intscol).Select()
                                            '.Selection.Tables.Item(1).Cell(int1 + int8, Count3 + intscol).Select()

                                        Catch ex As Exception

                                        End Try
                                    End If
                                End If
                            End If



                        Next


                        '**** end stats

                        'bottom border this row
                        .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow)
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        '.Selection.MoveRight Unit:=Microsoft.Office.Interop.Word.wdunits.word.wdunits.wdCharacter, Count:=ctQCs, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        'autofit window
                        .Selection.Tables.Item(1).Select()
                        'autofit table
                        Call AutoFitTable(wd, False)

                        'go back and merge line 1
                        .Selection.Tables.Item(1).Cell(1, intSCol).Select()
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        '.Selection.Cells.Merge()
                        If intNumLevels < 2 And boolSTATSDIFFCOL = False Then
                        Else
                            Try
                                .Selection.Cells.Merge()
                            Catch ex As Exception

                            End Try
                        End If
                        .Selection.Font.Bold = False
                        str1 = "Nominal Concentration"
                        If boolRCPA Then
                            str1 = "Peak Area"
                        ElseIf boolRCPARatio Then
                            'If boolx Then
                            '    str1 = "Peak Areas"
                            'Else
                            '    str1 = "Peak Area Ratios"
                            'End If
                            str1 = "Peak Area Ratio"
                        ElseIf boolRCPA = False And boolRCConc = False And boolRCPARatio = False Then
                            str1 = "Internal Standard Peak Area"
                        Else
                            str1 = "Nominal Concentration"
                        End If
                        .Selection.TypeText(Text:=str1)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                    Catch ex As Exception

                        str1 = "There was a problem preparing table:"
                        str1 = strM1 & ChrW(10) & ChrW(10) & str1
                        str1 = str1 & ChrW(10) & ChrW(10)
                        str1 = str1 & ex.Message
                        MsgBox(str1, vbInformation, "Problem...")

                    End Try


                    .Selection.Tables.Item(1).Cell(1, 1).Select()
                    'go to end of table
                    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdColumn)

                    'enter table number
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End
                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next
                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    'remove unused rows
                    Call RemoveRows(wd, ctTbl)

                    str1 = str2 & " Final Extract Stability: Summary of " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION") & " Interpolated QC Standard Concentrations."

                    '***
                    strA = rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                    strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, False)

                    Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)

                    'Note: strTName is byRef and will return Table, number, caption, label

                    '***
                    'Call EnterTableNumber(wd, str1, 3)

                    'enter a table record in tblTableN
                    'ctTableN = ctTableN + 1
                    Dim dtblr As DataRow = tblTableN.NewRow
                    dtblr.BeginEdit()
                    dtblr.Item("TableNumber") = ctTableN
                    dtblr.Item("AnalyteName") = strDo 'arrAnalytes(1, Count1)
                    dtblr.Item("TableName") = strTNameO
                    dtblr.Item("TableID") = intTableID
                    dtblr.Item("CHARFCID") = charFCID
                    dtblr.Item("TableNameNew") = strTName
                    tblTableN.Rows.Add(dtblr)

                    'split table, if needed
                    str1 = frmH.lblProgress.Text

                    ctLegend = ctLegend + 1
                    intLeg = intLeg + 1
                    arrLegend(1, intLeg) = "NA"
                    arrLegend(2, intLeg) = "Not Applicable"
                    arrLegend(3, intLeg) = False

                    '.Selection.Tables.item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                    '.Selection.Tables.item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)


                    Call AutoFitTable(wd, BOOLINCLUDEDATE)

                    strM = "Finalizing " & strTName & "..."
                    strM1 = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."

                    str1 = strM1

                    frmH.lblProgress.Text = strM1
                    frmH.Refresh()

                    Call SplitTable(wd, 4, intLeg, arrLegend, str1, False, ctLegend + 2, False, False, False, intTableID)

                    'move to line below table
                    Call MoveOneCellDown(wd)

                    Call InsertLegend(wd, intTableID, idTR, False, 1)


                Else
                    boolJustTable = False

                End If

end1:
                If boolJustTable Then
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End
                    str2 = ""
                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next

                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    str1 = str2 & " Final Extract Stability: Summary of " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION") & " Interpolated QC Standard Concentrations."
                    str2 = str1
                    str1 = NZ(rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION"), "")
                    'Call JustTable(wd, str1, str2, strDo, strTName, intTableID)
                    If Len(str1) = 0 Then
                    Else
                        strA = strAnal
                        str1 = strA
                        strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, False)
                        Call JustTable(wd, str1, strTName, strDo, strTName, intTableID, strTempInfo, "", strTNameO, intGroup, idTR)
                    End If


                End If

next1:

            Next
end2:
        End With


    End Sub

    Sub MVSummaryStockSolnStability_22(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal idTR As Int64)

        '20191017 LEE: Divert to MVAdHocQCStabilityComparison_32

        'Example: PPN00022LX
        'Need to add elimination "Y" evaluation

        'BIG NOTE: Stock Soln Stability has no calibr standards
        '   So there are no data in ANARUNANALYTERESULTS
        '   So can't ELIMINATEFLAG any data, because ELIMINATEFLAG is in ANARUNANALYTERESULTS

        Dim boolOC As Boolean = False 'bool OutsideCrit
        Dim numNomConc As Decimal
        Dim var1, var2, var3, var4, var5, var6, var7, var8, var10
        Dim dvDo As system.data.dataview
        Dim strTName As String
        Dim intDo As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim strDo As String
        Dim bool As Boolean
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim tbl1 As System.Data.DataTable
        Dim dv1 As system.data.dataview
        Dim rows1() As DataRow
        Dim intRows1 As Short
        Dim strF1 As String
        Dim tbl2 As System.Data.DataTable
        Dim tbl2a As New System.Data.DataTable
        Dim tbl2b As New System.Data.DataTable
        Dim dv2 As system.data.dataview
        Dim rows2() As DataRow
        Dim rows2a() As DataRow
        Dim rows2b() As DataRow
        Dim intRows2 As Short
        Dim strF2 As String
        Dim tbl3 As System.Data.DataTable
        Dim dv3 As system.data.dataview
        Dim rows3() As DataRow
        Dim intRows3 As Short
        Dim strF3 As String
        Dim intTableID As Short
        Dim tbl4 As System.Data.DataTable
        Dim dv4 As system.data.dataview
        Dim rows4() As DataRow
        Dim intRows4 As Short
        Dim strF4 As String
        Dim strS As String
        Dim intNumRuns As Short
        Dim dv As system.data.dataview
        Dim tblNumRuns As System.Data.DataTable
        Dim tblLevels As System.Data.DataTable
        Dim intNumLevels As Short
        Dim intTblRows As Short
        Dim wrdSelection As Microsoft.Office.Interop.Word.Selection
        Dim strF As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim int4 As Short
        Dim int10 As Short
        Dim intRowsX As Short
        Dim tblX As New System.Data.DataTable
        Dim varNom
        Dim strConcUnits As String
        Dim intLeg As Short
        Dim ctQCLegend As Short
        Dim ctDilLeg As Short
        Dim strA As String
        Dim strB As String

        Dim ctTbl As Short = 0

        Dim varE, varBE

        Dim ctLegend As Short
        Dim fontsize
        Dim boolPro As Boolean

        Dim varAnal
        Dim varIS

        Dim hi, lo
        Dim rows10() As DataRow
        Dim rows11() As DataRow
        Dim intRowsAnal As Short
        Dim arrFP(20) 'FlagPercent array
        Dim strFP As String
        Dim numMean As Decimal
        Dim numBias As Decimal
        Dim numSD As Decimal
        Dim tblZ As New System.Data.DataTable
        Dim dvAn As system.data.dataview
        Dim p1, p2, p3, p4, p5, p6, p7, p8, p9, p10
        Dim strM As String
        Dim fonts
        Dim numDF As Decimal
        Dim DilFactor
        Dim strF2a As String
        Dim strTempInfo As String
        Dim rowsQC() As DataRow
        Dim rowsRS() As DataRow
        Dim introwsQC As Short
        Dim introwsRS As Short
        Dim arr1(1)
        Dim numA, numB, numAE, numBE
        Dim numA1 As Decimal
        Dim numB1 As Decimal
        Dim numA1E As Decimal
        Dim numB1E As Decimal
        Dim boolIS As Boolean
        Dim strX As String
        Dim rowsX() As DataRow
        Dim boolX As Boolean
        Dim intCols As Short
        Dim col1, col2, col3, col4, col5, col6 As Short
        Dim intLegStart As Short
        Dim strUnits As String
        Dim boolJustTable As Boolean

        Dim intExp As Short
        Dim ctExp As Short
        Dim int8 As Short

        Dim strMatrix As String
        Dim intGroup As Short

        Dim rows2E() As DataRow
        Dim tblXE As System.Data.DataTable
        Dim rows2bE() As DataRow
        Dim nE As Short
        Dim nI As Short
        Dim boolOutHeadE As Boolean = False
        Dim boolOutHeadI As Boolean = False
        Dim boolDeleteRows As Boolean = False
        Dim boolOutlier As Boolean = False
        Dim intStart As Short


        Dim vAnalyteIndex
        Dim vMasterAssayID
        Dim vAnalyteID
        Dim tblAG As DataTable = tblAnalyteGroups 'tblAnalyteGroups has all analytes, not just accepted

        Dim strAnal As String
        Dim strAnalC As String
        Dim strTNameO As String
        Dim intRunID As Int16
        Dim strDECISIONREASON As String
        Dim boolExFromAS As Boolean


        Dim numPrec As Single
        Dim numTheor As Single

        Dim charFCID As String
        strF = "ID_TBLREPORTTABLE = " & idTR
        Dim rowsTR() As DataRow = tblReportTable.Select(strF)
        var1 = rowsTR(0).Item("CHARFCID")
        charFCID = NZ(var1, "NA")

        boolJustTable = False

        Cursor.Current = Cursors.WaitCursor

        fontsize = wd.ActiveDocument.Styles("Normal").Font.Size ' wd.Selection.Font.Size
        fonts = fontsize 'wd.Selection.Font.Size

        With wd

            intTableID = 22

            Dim strWRunId As String = GetWatsonColH(intTableID)

            dvDo = frmH.dgvReportTableConfiguration.DataSource
            strF = "id_tblconfigreporttables = " & intTableID
            intDo = FindRowDVNumByCol(intTableID, dvDo, "id_tblconfigreporttables")

            ''Get table name
            'var1 = dvDo(intDo).Item("Table")
            'strTName = NZ(var1, "[NONE]")

            ''get Temperature info
            'var1 = dvDo(intDo).Item("PERIODTEMP")
            'strTempInfo = NZ(var1, "[NONE]")

            '***
            intDo = FindRowDVNumByCol(idTR, dvDo, "ID_TBLREPORTTABLE")
            'intLeg = 0
            'intLegStart = 96
            'boolPro = False

            'Get table name
            'var1 = dvDo(intDo).Item("Table")
            var1 = dvDo(intDo).Item("CHARHEADINGTEXT")
            strTName = NZ(var1, "[NONE]")
            strTNameO = strTName

            'get Temperature info
            var1 = dvDo(intDo).Item("CHARSTABILITYPERIOD")
            strTempInfo = NZ(var1, "[NONE]")

            '***
            'find lloq units
            dv = frmH.dgvWatsonAnalRef.DataSource
            int2 = FindRowDV("LLOQ Units", dv)
            strUnits = dv(int2).Item(1)

            int1 = FindRowDV("Alternate Calibr/QC Std Units", frmH.dgvstudyconfig.DataSource)
            str1 = NZ(frmH.dgvStudyConfig(1, int1).Value, "")

            If Len(str1) = 0 Or StrComp(str1, "[None]", CompareMethod.Text) = 0 Then
            Else
                strUnits = str1
            End If

            ctPB = ctPB + 1
            If ctPB > frmH.pb1.Maximum Then
                ctPB = 1
            End If
            frmH.pb1.Value = ctPB
            frmH.pb1.Refresh()

            tbl1 = tblAnalysisResultsHome
            tbl2 = tblAssignedSamples
            tbl3 = tblAssignedSamplesHelper
            tbl4 = tblAnalytesHome

            'ensure data has been entered
            strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR
            rowsX = tbl2.Select(strF)
            'If rowsX.Length = 0 Then
            '    strM = "Creating Stock Solution Stability Assessment ...."
            '    frmH.lblProgress.Text = strM
            '    frmH.Refresh()
            '    MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
            '    GoTo end2
            'End If
            If boolIncludeISTbl Then
                strF = "IsIntStd = 'No' OR IsIntStd = 'Yes'"
            Else
                strF = "IsIntStd = 'No'"
            End If
            'strF = "IsIntStd = 'No'"
            'strS = "AnalyteDescription ASC"
            'strS = "IsIntStd ASC, AnalyteDescription ASC"
            strS = "INTORDER ASC, IsIntStd ASC, AnalyteDescription ASC"
            rows11 = tblAnalytesHome.Select(strF, strS)
            intRowsAnal = rows11.Length

            If tblX.Columns.Contains("Ratio") Then
            Else
                tblX.Columns.Add("Ratio", Type.GetType("System.Double"))
                tblX.Columns.Add("ANALYTEAREA", Type.GetType("System.Double"))
                tblX.Columns.Add("INTERNALSTANDARDAREA", Type.GetType("System.Double"))
                tblX.Columns.Add("EXCLUDED", Type.GetType("System.String")) 'Y/N
            End If

            For Count1 = 1 To intRowsAnal

                boolJustTable = False

                Dim arrLegend(4, 20)

                strTName = strTNameO

                ctLegend = 0

                Dim int11 As Short
                If boolSTATSDIFFCOL Then
                    int11 = 2
                Else
                    int11 = 1
                End If

                'for legend stuff
                intExp = 0
                ctExp = 0
                intLeg = 0
                ctQCLegend = 0
                ctDilLeg = 0
                ctLegend = 0
                strA = ""
                strB = ""
                arrLegend.Clear(arrLegend, 0, arrLegend.Length)
                arrFP.Clear(arrFP, 0, arrFP.Length)
                intLegStart = 96

                'check if table is to be generated
                'strDo = arrAnalytes(1, Count1) 'record column name
                strDo = rows11(Count1 - 1).Item("ANALYTEDESCRIPTION")

                'If UseAnalyte(CStr(strDo)) Then
                'Else
                '    GoTo next1
                'End If

                strX = rows11(Count1 - 1).Item("IsIntStd")

                Dim strISConc As String = ""

                If StrComp(strX, "Yes", CompareMethod.Text) = 0 Then
                    If boolIncludeISTbl Then
                        'get strISConc
                        Dim strFIS As String
                        Dim rowsFIS() As DataRow
                        Dim tblP As System.Data.DataTable = tblTableProperties
                        strFIS = "ID_TBLREPORTTABLE = " & idTR
                        rowsFIS = tblP.Select(strFIS)
                        strISConc = NZ(rowsFIS(0).Item("CHARISCONC"), "")
                    Else
                        GoTo next1
                    End If
                Else
                    If UseAnalyte(CStr(strDo)) Then
                    Else
                        GoTo next1
                    End If
                    If BOOLINTSTDONLY Then
                        GoTo next1
                    End If
                End If

                strX = rows11(Count1 - 1).Item("IsIntStd")
                boolX = False
                If StrComp(strX, "Yes", CompareMethod.Text) = 0 Then
                    'check for boolIntStd in tbl2
                    strF = "IsIntStd = 'Yes'"
                    var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    strF2 = strF2 & "BOOLINTSTD = -1"
                    Erase rowsX
                    rowsX = tbl2.Select(strF2)
                    int1 = rowsX.Length
                    boolX = True

                    '****
                    If int1 > 0 And boolIncludeISTbl Then
                        bool = True
                    Else
                        bool = True 'False
                        boolJustTable = True
                    End If

                    '****

                Else
                    bool = dvDo.Item(intDo).Item(strDo) 'find boolean value of dvDo column
                End If

                Dim strM1 As String
                If bool Then 'continue

                    ctTbl = ctTbl + 1

                    'ensure data has been entered
                    strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ID_TBLREPORTTABLE = " & idTR
                    rowsX = tbl2.Select(strF)

                    intTCur = intTCur + 1

                    'setup tables
                    If boolUseGroups Then
                        If boolX Then
                            intGroup = -1 ' tblAG.Rows(Count1 - 1).Item("INTGROUP")
                            strAnal = tbl4.Rows.Item(Count1 - 1).Item("OriginalAnalyteDescription") 'tblAG.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                            strAnalC = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription") ' tblAG.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                            vAnalyteID = 0 ' tblAG.Rows.Item(Count1 - 1).Item("ANALYTEID")

                            'find matrix
                            Dim strFF As String
                            strFF = "INTSTD = '" & CleanText(strAnal) & "'"
                            Dim rowsFF() As DataRow = tblAG.Select(strFF, "", DataViewRowState.CurrentRows)
                            If rowsFF.Length = 0 Then
                                strMatrix = "NA"
                            Else
                                strMatrix = NZ(rowsFF(0).Item("MATRIX"), "NA")
                            End If

                        Else
                            intGroup = tblAG.Rows(Count1 - 1).Item("INTGROUP")
                            strAnal = tblAG.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                            strAnalC = tblAG.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                            vAnalyteID = tblAG.Rows.Item(Count1 - 1).Item("ANALYTEID")
                            strMatrix = tblAG.Rows(Count1 - 1).Item("MATRIX")
                        End If

                    Else
                        var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                        var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                        var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        var4 = tbl4.Rows.Item(Count1 - 1).Item("ANALYTEID")
                        intGroup = 0
                        vAnalyteIndex = var1
                        vMasterAssayID = var2
                        vAnalyteID = var4
                        strMatrix = ""
                    End If

                    If rowsX.Length = 0 Then
                        strM = "Creating " & strTName & "..."
                        strM = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."
                        strM1 = strM

                        frmH.lblProgress.Text = strM
                        frmH.Refresh()
                        'MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
                        boolJustTable = True
                        'page setup according to configuration
                        str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                        'insert page break
                        'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                        Call InsertPageBreak(wd)
                        Call PageSetup(wd, str1) 'L=Landscape, P=Portrait
                        GoTo end1
                    Else
                        boolJustTable = False
                    End If

                    'page setup according to configuration
                    str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                    'insert page break
                    'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                    Call InsertPageBreak(wd)
                    Call PageSetup(wd, str1) 'L=Landscape, P=Portrait

                    'ReDim arrBCQCs(8, 50) '1=LevelNumber, 2=NomConcentration, 3=ID, 4=FlagPercent, 5=Hello, 6=Lo, 7=#ofReplicates, 8=ASSAYID
                    strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                    strM = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."
                    strM1 = strM
                    frmH.lblProgress.Text = strM
                    frmH.Refresh()

                    'get strConcUnits
                    int1 = FindRowDV("ULOQ Units", frmH.dgvWatsonAnalRef.DataSource)
                    strConcUnits = NZ(frmH.dgvWatsonAnalRef(Count1, int1).Value, "ng/mL")

                    int1 = FindRowDV("Alternate Calibr/QC Std Units", frmH.dgvStudyConfig.DataSource)
                    str1 = NZ(frmH.dgvStudyConfig(1, int1).Value, "")

                    If Len(str1) = 0 Or StrComp(str1, "[None]", CompareMethod.Text) = 0 Then
                    Else
                        strConcUnits = str1
                    End If

                    ''setup tables
                    'If boolUseGroups Then
                    '    If boolX Then
                    '        intGroup = -1 ' tblAG.Rows(Count1 - 1).Item("INTGROUP")
                    '        strAnal = tbl4.Rows.Item(Count1 - 1).Item("OriginalAnalyteDescription") 'tblAG.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    '        strAnalC = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription") ' tblAG.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                    '        vAnalyteID = 0 ' tblAG.Rows.Item(Count1 - 1).Item("ANALYTEID")
                    '        strMatrix = "" ' tblAG.Rows(Count1 - 1).Item("MATRIX")
                    '    Else
                    '        intGroup = tblAG.Rows(Count1 - 1).Item("INTGROUP")
                    '        strAnal = tblAG.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    '        strAnalC = tblAG.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                    '        vAnalyteID = tblAG.Rows.Item(Count1 - 1).Item("ANALYTEID")
                    '        strMatrix = tblAG.Rows(Count1 - 1).Item("MATRIX")
                    '    End If

                    'Else
                    '    var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    '    var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    '    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    '    var4 = tbl4.Rows.Item(Count1 - 1).Item("ANALYTEID")
                    '    intGroup = 0
                    '    vAnalyteIndex = var1
                    '    vMasterAssayID = var2
                    '    vAnalyteID = var4
                    '    strMatrix = ""
                    'End If

                    'look for outliers
                    'setup tables
                    If boolX Then
                        var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        strF2 = "BOOLINTSTD = -1 AND "
                        strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                        strF2 = strF2 & "CHARANALYTE = '" & CleanText(cstr(var3)) & "' AND (ELIMINATEDFLAG = 'Y' OR BOOLEXCLSAMPLE = -1)"
                    Else

                        strF2 = "BOOLINTSTD = 0 AND ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                        strF2 = strF2 & "INTGROUP = " & intGroup & " AND (ELIMINATEDFLAG = 'Y' OR BOOLEXCLSAMPLE = -1)"

                    End If
                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    rows2 = tbl2.Select(strF2, strS)
                    int1 = rows2.Length 'debug

                    If int1 > 0 Then
                        boolOutlier = True
                    End If

                    'setup tables
                    If boolX Then
                        var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        strF2 = "BOOLINTSTD = -1 AND "
                        strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                        strF2 = strF2 & "CHARANALYTE = '" & CleanText(cstr(var3)) & "'"
                    Else

                        strF2 = "BOOLINTSTD = 0 AND ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                        strF2 = strF2 & "INTGROUP = " & intGroup

                    End If
                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    rows2 = tbl2.Select(strF2, strS)
                    int1 = rows2.Length 'debug
                    dv2 = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                    int1 = dv2.Count 'debug

                    'find number of runs used
                    tblNumRuns = dv2.ToTable("a", True, "RUNID")
                    intNumRuns = tblNumRuns.Rows.Count

                    intNumLevels = 2

                    ReDim arr1(intNumLevels)

                    'find number of table rows to generate
                    intRowsX = intNumLevels

                    'find introwsQC and dataviews CHARHELPER1
                    If boolX Then
                        strF = " AND CHARHELPER1 = 'Old Stock Solution' AND BOOLINTSTD = -1"
                    Else
                        strF = " AND CHARHELPER1 = 'Old Stock Solution' AND BOOLINTSTD = 0"
                    End If
                    strF = strF2 & strF
                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    dv1 = New DataView(tbl2, strF, strS, DataViewRowState.CurrentRows)
                    tbl2a = dv1.ToTable
                    introwsQC = tbl2a.Rows.Count
                    If introwsQC = 0 Then
                        str1 = "Appropriate assigned samples for " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & " have not been configured as 'Old Stock Solution'."
                        str1 = str1 & ChrW(10) & "When this action is finished, please navigate to the Assigned Samples window and correct this problem."
                        MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                        GoTo end1
                    End If

                    'find introwsRS and dataviews CHARHELPER1
                    If boolX Then
                        strF = " AND CHARHELPER1 = 'New Stock Solution' AND BOOLINTSTD = -1"
                    Else
                        strF = " AND CHARHELPER1 = 'New Stock Solution' AND BOOLINTSTD = 0"
                    End If
                    strF = strF2 & strF
                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    dv3 = New DataView(tbl2, strF, strS, DataViewRowState.CurrentRows)
                    tbl2b = dv3.ToTable
                    introwsRS = tbl2b.Rows.Count
                    If introwsRS = 0 Then
                        str1 = "Appropriate assigned samples for " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & " have not been configured as 'New Stock Solution'."
                        str1 = str1 & ChrW(10) & "When this action is finished, please navigate to the Assigned Samples window and correct this problem."
                        MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                        GoTo end1
                    End If

                    'generate table
                    intTblRows = 0
                    intTblRows = intTblRows + 1 'for header1
                    intTblRows = intTblRows + 1 'for blank row
                    intTblRows = intTblRows + introwsRS 'for Old set
                    intTblRows = intTblRows + introwsQC 'for New set
                    intTblRows = intTblRows + 2 'for blank rows

                    intNumRuns = 1

                    'Increment for Statistics Sections
                    Dim intCSN As Short
                    intCSN = countNumStatsRows()
                    intTblRows = intTblRows + (intCSN * 2 * intNumRuns)

                    If intCSN > 0 Then
                    Else
                        intTblRows = intTblRows - 1 'subtract an unneeded blank row
                    End If

                    intTblRows = intTblRows + (2 * intNumRuns) 'for blank rows
                    intTblRows = intTblRows + 1 'for %Difference

                    If boolQCREPORTACCVALUES Then

                    Else
                        If boolOutlier Then
                            intTblRows = intTblRows + (3 * intNumRuns * 2) 'for stats headings
                            ctExp = ctExp + (3 * 2) 'for stats headings

                            'Increment for Statistics Sections
                            intTblRows = intTblRows + (intCSN * intNumRuns * 2)
                            ctExp = ctExp + (intCSN * intNumRuns * 2)

                            If intCSN > 0 Then
                                intTblRows = intTblRows + (2 * intNumRuns) - 1 'for a blank row after each Mean/Bias/n set, except last set
                                ctExp = ctExp + (2 * intNumRuns) - 1
                            End If

                            'add a few extra rows for legends
                            'extra will get removed at end of sub

                            intTblRows = intTblRows + 4
                            ctExp = ctExp + 4

                        End If
                    End If


                    'intTblRows = intTblRows + 2 'for footer

                    wrdSelection = wd.Selection()

                    'intCols = 3
                    Dim intColStats As Short
                    If boolRCPA Or boolX Then
                        intColStats = 1
                        intCols = 2
                    Else
                        intColStats = 3
                        intCols = 4
                    End If


                    Try

                        '20180913 LEE:
                        Call IncrNextTableNumber(wd)

                        If boolPlaceHolder Then
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=1, NumColumns:=1, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        Else
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=intTblRows, NumColumns:=intCols, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        End If

                        .Selection.Tables.Item(1).Select()

                        Call SetCellPaddingZero(.Selection.Tables.Item(1))

                        .Selection.Tables.Item(1).Rows.AllowBreakAcrossPages = False
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                        .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                        .Selection.Tables.Item(1).Columns.PreferredWidth = Microsoft.Office.Interop.Word.WdPreferredWidthType.wdPreferredWidthPoints
                        '.Selection.Tables.Item(1).Columns.Item(1).Width = 86
                        For Count2 = 1 To intNumLevels
                            '.Selection.Tables.item(1).Columns.item(Count2 + 1).Width = 50
                        Next
                        .Selection.Tables.Item(1).Select()

                        'remove border, but leave top and bottom
                        removeBorderButLeaveTopAndBottom(wd)

                        'border top and bottom of range
                        .Selection.Tables.Item(1).Cell(1, 1).Select()

                        If boolPlaceHolder Then

                            .Selection.Tables.Item(1).Select()
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone

                            strA = arrAnalytes(14, Count1)
                            If boolX Then
                                strA = "Internal Standard " & strA
                            End If
                            strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, boolX)
                            Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                            'Note: strTName is byRef and will return Table, number, caption, label

                            Call MoveOneCellDown(wd)

                            .Selection.TypeParagraph()
                            .Selection.TypeParagraph()

                            'enter a table record in tblTableN
                            'ctTableN = ctTableN + 1
                            '20180913 LEE:
                            Call IncrNextTableNumber(wd)
                            Dim dtblr1 As DataRow = tblTableN.NewRow
                            dtblr1.BeginEdit()
                            dtblr1.Item("TableNumber") = ctTableN
                            dtblr1.Item("AnalyteName") = arrAnalytes(1, Count1)
                            dtblr1.Item("TableName") = strTNameO
                            dtblr1.Item("TableID") = intTableID
                            dtblr1.Item("CHARFCID") = charFCID
                            dtblr1.Item("TableNameNew") = strTName
                            tblTableN.Rows.Add(dtblr1)

                            GoTo next1
                        End If

                        .Selection.Tables.Item(1).Select()
                        Call GlobalTableParaFormat(wd)

                        '20171220 LEE: Do not set table size, use the style default table
                        '.Selection.Font.Size = fontsize - 1
                        .Selection.Tables.Item(1).Cell(1, 1).Select()


                        '.Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        '.Selection.MoveRight Unit:=Microsoft.Office.Interop.Word.wdunits.word.wdunits.wdCharacter, Count:=ctQCs, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        'format selection
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                        .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom


                        ''bottom border this row
                        '.Selection.Tables.item(1).Cell(intTblRows - 2, 1).Select()
                        '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        '.Selection.Borders.item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.wdlinestyle.wdLineStyleSingle


                        '.Selection.MoveLeft(Microsoft.Office.Interop.Word.WdUnits.wdCharacter, 1)

                        'Enter  row titles
                        'column 1
                        .Selection.Tables.Item(1).Cell(1, 1).Select()

                        str1 = strWRunId
                        str2 = Replace(str1, " ", ChrW(160), 1, -1)
                        If BOOLINCLUDEDATE Then
                            '.Selection.TypeText(str2 & ChrW(10) & "(Analysis Date)")
                            '20180420 LEE:
                            .Selection.TypeText(str2 & ChrW(10) & "(" & GetAnalysisDateLabel(intTableID) & ")")
                        Else
                            .Selection.TypeText(str2)
                        End If
                        '.Selection.TypeText(Text:=Replace(str1, " ", ChrW(160), 1, -1))

                        'column 2
                        .Selection.Tables.Item(1).Cell(1, 2).Select()
                        If boolRCPA Then
                            If boolX Then
                                str1 = "Internal Standard" & ChrW(10) & "Peak Area" ' & ChrW(10) & "Recovery Stock"
                            Else
                                str1 = "Analyte" & ChrW(10) & "Peak Area" ' & ChrW(10) & "Recovery Stock"
                            End If
                        Else
                            If boolX Then
                                str1 = "Internal Standard" & ChrW(10) & "Peak Area" ' & ChrW(10) & "Recovery Stock"
                            Else
                                str1 = "Analyte" & ChrW(10) & "Peak Area" ' & ChrW(10) & "Recovery Stock"
                            End If
                        End If
                        .Selection.TypeText(Text:=Replace(str1, " ", ChrW(160), 1, -1))
                        If boolRCPA Or boolX Then
                        Else
                            'column 3
                            .Selection.Tables.Item(1).Cell(1, 3).Select()
                            str1 = "Internal Standard" & ChrW(10) & "Peak Area"
                            .Selection.TypeText(Text:=Replace(str1, " ", ChrW(160), 1, -1))
                            'column 4
                            .Selection.Tables.Item(1).Cell(1, 4).Select()
                            str1 = "Area Ratio (A/IS)" ' & ChrW(10) & "Recovery Stock"
                            .Selection.TypeText(Text:=Replace(str1, " ", ChrW(160), 1, -1))
                        End If

                        'If boolRCPA Then
                        '    str1 = "Analyte Peak Area" & ChrW(10) & "Recovery Stock"
                        'Else
                        '    str1 = "Area Ratio (A/IS)" & ChrW(10) & "Recovery Stock"
                        'End If
                        '.Selection.TypeText(Text:=Replace(str1, " ", ChrW(160), 1, -1))

                        .Selection.Tables.Item(1).Cell(1, 1).Select()
                        'bottom border this row
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        'for legend stuff
                        intLeg = 0
                        ctQCLegend = 0
                        ctDilLeg = 0
                        ctLegend = 0

                        strB = ""
                        arrLegend.Clear(arrLegend, 0, arrLegend.Length)
                        arrFP.Clear(arrFP, 0, arrFP.Length)
                        intLegStart = 96

                        '''''wdd.visible = True

                        'begin entering data'
                        int1 = 3 'row position counter
                        For Count2 = 0 To intNumRuns - 1

                            ''wd.visible = True

                            'enter runid
                            var10 = tblNumRuns.Rows.Item(0).Item("RUNID")

                            'strM = "Creating Stock Solution Assessment For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                            frmH.lblProgress.Text = strM1 & ChrW(10) & "Processing Run ID " & var10
                            frmH.Refresh()

                            'start filling in data by rows
                            'intRowsX = 0
                            For Count3 = 0 To intNumLevels - 1

                                .Selection.Tables.Item(1).Cell(int1, 1).Select()
                                .Selection.TypeText(CStr(var10))
                                If BOOLINCLUDEDATE Then
                                    .Selection.Tables.Item(1).Cell(int1 + 1, 1).Select()
                                    str1 = GetDateFromRunID(NZ(var10, 0), LDateFormat, intGroup, idTR)
                                    .Selection.TypeText("(" & str1 & ")")
                                    .Selection.Tables.Item(1).Cell(int1, 1).Select()
                                End If

                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)

                                'column 3
                                If Count3 = 0 Then 'get Old Stock Solution
                                    strF = "CHARHELPER1 = 'Old Stock Solution'"
                                    Erase rows2a
                                    rows2a = tbl2a.Select(strF)
                                Else 'get new stock solution
                                    strF = "CHARHELPER1 = 'New Stock Solution'"
                                    Erase rows2a
                                    rows2a = tbl2b.Select(strF)
                                End If
                                int2 = rows2a.Length
                                var10 = rows2a(0).Item("RUNID")
                                var1 = rows2a(0).Item("BOOLINTSTD")
                                If var1 = -1 Then
                                    boolIS = True
                                Else
                                    boolIS = False
                                End If
                                strF = ""
                                'Here
                                'For Count4 = 0 To int2 - 1
                                '    var2 = rows2a(Count4).Item("ANALYTEINDEX")
                                '    var3 = rows2a(Count4).Item("MASTERASSAYID")
                                '    var4 = rows2a(Count4).Item("RUNSAMPLEORDERNUMBER")
                                '    var5 = rows2a(Count4).Item("ANALYTEID")

                                '    If Count4 <> int2 - 1 Then
                                '        strF = strF & "(RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                '    Else
                                '        strF = strF & "(RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & ")"
                                '    End If
                                'Next
                                Erase rows1
                                'rows1 = tbl1.Select(strF)
                                rows1 = rows2a
                                int3 = rows1.Length
                                nI = int3

                                ''get outliers
                                ''problem: tbl1 does not have ELIMINATEDFLAG field
                                'strF = ""
                                'For Count4 = 0 To int2 - 1
                                '    var2 = rows2a(Count4).Item("ANALYTEINDEX")
                                '    var3 = rows2a(Count4).Item("MASTERASSAYID")
                                '    var4 = rows2a(Count4).Item("RUNSAMPLEORDERNUMBER")
                                '    If Count4 <> int2 - 1 Then
                                '        strF = strF & "(RUNID = " & var10 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ELIMINATEDFLAG = 'N') OR "
                                '    Else
                                '        strF = strF & "(RUNID = " & var10 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ELIMINATEDFLAG = 'N')"
                                '    End If
                                'Next
                                'Erase rows2E
                                'strF = "ELIMINATEDFLAG = 'N' AND BOOLEXCLSAMPLE = 0"
                                strF = "(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL) AND BOOLEXCLSAMPLE = 0"
                                rows2E = tbl2b.Select(strF)
                                nE = rows2E.Length

                                If tbl2b.Columns.Contains("ANALYTEAREA") Then
                                    var1 = var1
                                End If
                                If tbl2b.Columns.Contains("INTERNALSTANDARDAREA") Then
                                    var1 = var1
                                End If

                                'get area ratios Included
                                strF = "" '

                                'load tblX with everything
                                tblX.Clear()
                                For Count4 = 0 To int3 - 1
                                    var1 = rows1(Count4).Item("ANALYTEAREA")
                                    var2 = NZ(rows1(Count4).Item("INTERNALSTANDARDAREA"), 0)
                                    If boolRCPA Then
                                        If boolX Then
                                            var3 = var2
                                        Else
                                            var3 = var1
                                        End If

                                    Else 'is area ratio
                                        If boolX Then 'is int std
                                            var3 = var2
                                        Else
                                            If var2 = 0 Then
                                                var3 = 0 'var1
                                            Else
                                                var3 = var1 / var2
                                            End If
                                        End If

                                    End If

                                    var4 = NZ(rows1(Count4).Item("ELIMINATEDFLAG"), "N") '
                                    var5 = NZ(rows1(Count4).Item("BOOLEXCLSAMPLE"), 0)

                                    Dim nr1 As DataRow = tblX.NewRow
                                    nr1.BeginEdit()
                                    nr1.Item("Ratio") = RoundToDecimalRAFZ(var3, LSigFigAreaRatio)
                                    nr1.Item("ANALYTEAREA") = var1
                                    nr1.Item("INTERNALSTANDARDAREA") = var2

                                    If var4 = "Y" Or var5 = -1 Then
                                        nr1.Item("EXCLUDED") = "Y"
                                    Else
                                        nr1.Item("EXCLUDED") = "N"
                                    End If

                                    nr1.EndEdit()
                                    tblX.Rows.Add(nr1)
                                Next

                                'get excluded
                                strF = "EXCLUDED = 'N'"
                                'strF = "Ratio > 0"
                                Erase rows2b
                                rows2b = tblX.Select(strF)
                                nE = rows2b.Length

                                'get ALL
                                strF = "EXCLUDED = 'N' OR EXCLUDED = 'Y'"
                                'strF = "Ratio > 0"
                                Erase rows2bE
                                rows2bE = tblX.Select(strF)
                                nI = rows2b.Length



                                'Row1 Column 1
                                .Selection.Tables.Item(1).Cell(int1, 1).Select()

                                int8 = 0
                                If boolQCREPORTACCVALUES Then
                                Else
                                    If boolOutlier Then
                                        .Selection.Tables.Item(1).Cell(int1 + int3 + 1, 2).Select()
                                        .Selection.TypeText(Text:="Summary Statistics Excluding Outlier Values")
                                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                        Try
                                            .Selection.Cells.Merge()
                                        Catch ex As Exception
                                        End Try
                                        With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                            .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                        End With
                                        int8 = int8 + 1
                                    End If
                                End If

                                Dim intPos As Short
                                Dim intP1 As Short
                                intPos = int1
                                int8 = 0
                                intStart = int1 + int8
                                int1 = intStart

                                If Count3 > -1 Then
                                    If BOOLINCLUDEDATE Then
                                        intP1 = intStart + 2
                                    Else
                                        intP1 = intStart + 1
                                    End If
                                Else
                                    intP1 = intStart
                                End If

                                .Selection.Tables.Item(1).Cell(intP1 + int8, 1).Select()
                                If Count3 = 0 Then
                                    var1 = tbl2a.Rows.Item(0).Item("CHARHELPER1")
                                    var2 = tbl2a.Rows.Item(0).Item("CHARHELPER2")
                                Else
                                    var1 = tbl2b.Rows.Item(0).Item("CHARHELPER1")
                                    var2 = tbl2b.Rows.Item(0).Item("CHARHELPER2")
                                End If

                                If Len(NZ(var2, "")) = 0 Then
                                    .Selection.TypeText(CStr(NZ(var1, "")))
                                Else
                                    'Row2 Column 1
                                    .Selection.Tables.Item(1).Cell(intP1 + int8, 1).Select()
                                    If Count3 = 0 Then
                                        var1 = tbl2a.Rows.Item(0).Item("CHARHELPER2")
                                    Else
                                        var1 = tbl2b.Rows.Item(0).Item("CHARHELPER2")
                                    End If
                                    If IsNumeric(var1) Then
                                        var1 = DisplayCommas(var1)
                                    End If

                                    If LboolNomConcParen Then
                                        If boolX And Len(strISConc) <> 0 Then
                                            .Selection.TypeText(strISConc)
                                        Else
                                            .Selection.TypeText("(" & CStr(NZ(var1, "")) & ChrW(160) & strUnits & ")")
                                        End If

                                    Else
                                        If boolX And Len(strISConc) <> 0 Then
                                            .Selection.TypeText(strISConc)
                                        Else
                                            If IsNumeric(var1) Then
                                                .Selection.TypeText(CStr(NZ(var1, "")) & ChrW(160) & strUnits)
                                            Else
                                                .Selection.TypeText(CStr(NZ(var1, "")))
                                            End If
                                        End If

                                    End If
                                End If

                                'enter data
                                int8 = -1

                                For Count4 = 0 To int3 - 1

                                    int8 = int8 + 1

                                    var1 = rows1(Count4).Item("ANALYTEAREA")
                                    var2 = NZ(rows1(Count4).Item("INTERNALSTANDARDAREA"), 0)
                                    varE = NZ(rows1(Count5).Item("ELIMINATEDFLAG"), "N")
                                    varBE = NZ(rows1(Count4).Item("BOOLEXCLSAMPLE"), 0)


                                    'Note: If Peak Area Ratio, this table will show Analyte, Int Std, and Area Ratio

                                    'convert to appropriate
                                    If boolLUseSigFigsArea Then
                                        var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True)
                                    Else
                                        'var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                        var1 = RoundToDecimalRAFZ(var1, LSigFigArea)
                                    End If

                                    If boolLUseSigFigsArea Then
                                        var2 = SigFigArea(RoundToDecimalA(var2, LSigFigArea), LSigFigArea, False, True)
                                    Else
                                        'var2 = Format(RoundToDecimalRAFZ(var2, LSigFigArea), strAreaDec)
                                        var2 = RoundToDecimalRAFZ(var2, LSigFigArea)
                                    End If

                                    'make area ratio
                                    If boolIS Then
                                        var3 = CDec(var2)
                                    Else
                                        If var2 = 0 Then
                                            var3 = 0
                                        Else
                                            var3 = var1 / var2
                                        End If
                                    End If

                                    If boolLUseSigFigsAreaRatio Then
                                        var3 = SigFigAreaRatio(RoundToDecimalA(var3, LSigFigAreaRatio), LSigFigAreaRatio, False, True) 'special rounding incorporated
                                    Else
                                        var3 = Format(RoundToDecimalRAFZ(var3, LSigFigAreaRatio), strAreaDecAreaRatio)
                                    End If

                                    If boolIS Then
                                        .Selection.Tables.Item(1).Cell(int1 + int8, 2).Select()
                                        .Selection.TypeText((var2))
                                    Else
                                        .Selection.Tables.Item(1).Cell(int1 + int8, 2).Select()
                                        .Selection.TypeText(CStr(var1))
                                        If boolRCPA Then
                                        Else
                                            .Selection.Tables.Item(1).Cell(int1 + int8, 3).Select()
                                            .Selection.TypeText(CStr(var2))
                                            .Selection.Tables.Item(1).Cell(int1 + int8, 4).Select()
                                            .Selection.TypeText(CStr(var3))
                                        End If
                                    End If

                                    '*****

                                    '******

                                    'var1 = NZ(rows1(Count4).Item("ELIMINATEDFLAG"), "N")
                                    'var3 = NZ(rows1(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                    If StrComp(varE, "Y", CompareMethod.Text) = 0 Then
                                        boolExFromAS = False
                                    Else
                                        If gAllowExclSamples And LAllowExclSamples Then
                                            If varBE = -1 Then
                                                varE = "Y"
                                                boolExFromAS = True
                                            Else
                                                'var1 = "N"
                                                'don't assign "N", Watson may override
                                            End If
                                        End If
                                    End If


                                    '******

                                    If StrComp(varE, "Y", vbTextCompare) = 0 Then

                                        boolOC = True
                                        intExp = intExp + 1
                                        intLeg = intLeg + 1

                                        strB = Chr(intLeg + intLegStart) 'Chr(96 + intLeg)
                                        'str1 = "Dilution QC failed to meet acceptance criteria. Excluded from summary statistics."
                                        'str1 = "Value outside of acceptance criteria (" & RoundToDecimal(arrFP(Count3), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the [OUTLIERMETHOD]."

                                        'str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(rowT(0).Item("FlagPercent"), 0) & "% theoretical) and excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."

                                        '******
                                        'Set Legend String
                                        str1 = "Excluded from summary statistics because the value is a statistical outlier according to the " & ReturnOutlierMethod() & "."
                                        'Add to Legend Array
                                        ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strB, True)

                                        '******

                                        If boolRedBoldFont Then
                                            .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                                            .Selection.Font.Bold = True
                                            .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine)
                                        End If

                                        '.Selection.TypeText(Text:=var4)
                                        'arrCS(intCS) = var4
                                        Call typeInSuperscriptFontSize12WithSpace(wd, strA)


                                    End If

                                    '*****

                                Next

                                int8 = int8 + 1

                                If boolOutlier Then
                                    int8 = int8 + 1
                                End If

                                Try
                                    'Row1 Mean
                                    If boolRCPA Then

                                        If boolIS Then
                                            var1 = MeanDR(rows2b, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                        Else
                                            var1 = MeanDR(rows2b, "ANALYTEAREA", False, "gaga", False, False)
                                        End If

                                    Else

                                        If boolIS Then
                                            var1 = MeanDR(rows2b, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                        Else
                                            var1 = MeanDR(rows2b, "Ratio", False, "gaga", False, False)
                                        End If

                                    End If

                                    '*****
                                    If boolIS Then
                                        If boolLUseSigFigsArea Then
                                            var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                        Else
                                            'var2 = Format(RoundToDecimalRAFZ(RoundToDecimalRAFZ(var1, 10), 5), strAreaDec)
                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                        End If
                                        '.Selection.TypeText(DisplayCommas(var2))
                                    Else
                                        If boolRCPARatio Then
                                            If boolLUseSigFigsAreaRatio Then
                                                var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                            Else
                                                'var2 = Format(RoundToDecimalRAFZ(var1, 5 + 2), strAreaDec)
                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                            End If
                                            '.Selection.TypeText(CStr(var2))
                                        Else
                                            If boolLUseSigFigsArea Then
                                                var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                            Else
                                                'var2 = Format(RoundToDecimalRAFZ(RoundToDecimalRAFZ(var1, 10), 5), strAreaDec)
                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                            End If
                                        End If
                                    End If

                                    '*****

                                    numMean = var2
                                    If Count3 = 0 Then
                                        numA = numMean
                                        numA1 = CDec(var1)
                                    Else
                                        numB = numMean
                                        numB1 = CDec(var1)
                                    End If
                                Catch ex As Exception

                                End Try
                                If boolSTATSMEAN Then
                                    Try
                                        'Row1 Mean
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                        .Selection.TypeText("Mean")
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                        If boolRCPA Then

                                            If boolIS Then
                                                var1 = MeanDR(rows2b, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                            Else
                                                var1 = MeanDR(rows2b, "ANALYTEAREA", False, "gaga", False, False)
                                            End If

                                        Else

                                            If boolIS Then
                                                var1 = MeanDR(rows2b, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                            Else
                                                var1 = MeanDR(rows2b, "Ratio", False, "gaga", False, False)
                                            End If

                                        End If

                                        '*****
                                        If boolIS Then
                                            If boolLUseSigFigsArea Then
                                                var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                            Else
                                                'var2 = Format(RoundToDecimalRAFZ(RoundToDecimalRAFZ(var1, 10), 5), strAreaDec)
                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                            End If
                                            .Selection.TypeText(DisplayCommas(var2))
                                        Else
                                            If boolRCPARatio Then
                                                If boolLUseSigFigsAreaRatio Then
                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                Else
                                                    'var2 = Format(RoundToDecimalRAFZ(var1, 5 + 2), strAreaDec)
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                End If
                                                .Selection.TypeText(CStr(var2))
                                            Else
                                                If boolLUseSigFigsArea Then
                                                    var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    'var2 = Format(RoundToDecimalRAFZ(RoundToDecimalRAFZ(var1, 10), 5), strAreaDec)
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                End If
                                                .Selection.TypeText(DisplayCommas(var2))
                                            End If
                                        End If

                                        '*****

                                        'numMean = var2
                                        'If Count3 = 0 Then
                                        '    numA = numMean
                                        '    numA1 = CDec(var1)
                                        'Else
                                        '    numB = numMean
                                        '    numB1 = CDec(var1)
                                        'End If
                                    Catch ex As Exception

                                    End Try
                                End If


                                Try
                                    'Row2 SD
                                    If nI < gSDMax Then
                                        var3 = 0
                                    Else

                                        If boolRCPA Then

                                            If boolIS Then
                                                var1 = StdDevDRArea(rows2b, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                            Else
                                                var1 = StdDevDRArea(rows2b, "ANALYTEAREA", False, "gaga", False, False)
                                            End If

                                        Else

                                            If boolIS Then
                                                var1 = StdDevDRArea(rows2b, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                            Else
                                                var1 = StdDevDRArea(rows2b, "Ratio", False, "gaga", False, False)
                                            End If

                                        End If

                                        '*****
                                        If boolIS Then
                                            If boolLUseSigFigsArea Then
                                                var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                            Else
                                                var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                            End If
                                            var2 = var1
                                        Else
                                            If boolRCPARatio Then
                                                If boolLUseSigFigsAreaRatio Then
                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                Else
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                End If
                                            Else
                                                If boolLUseSigFigsArea Then
                                                    var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                End If
                                                var2 = var1
                                            End If
                                        End If

                                    End If

                                    numSD = var2

                                Catch ex As Exception

                                End Try
                                If boolSTATSSD Then
                                    Try
                                        'Row2 SD
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                        .Selection.TypeText("S.D.")
                                        If nI < gSDMax Then
                                            .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                            .Selection.TypeText("NA")
                                            var3 = 0
                                        Else
                                            .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                            If boolRCPA Then

                                                If boolIS Then
                                                    var1 = StdDevDRArea(rows2b, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                Else
                                                    var1 = StdDevDRArea(rows2b, "ANALYTEAREA", False, "gaga", False, False)
                                                End If

                                            Else

                                                If boolIS Then
                                                    var1 = StdDevDRArea(rows2b, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                Else
                                                    var1 = StdDevDRArea(rows2b, "Ratio", False, "gaga", False, False)
                                                End If

                                            End If

                                            '*****
                                            If boolIS Then
                                                If boolLUseSigFigsArea Then
                                                    var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                End If
                                                var2 = var1
                                            Else
                                                If boolRCPARatio Then
                                                    If boolLUseSigFigsAreaRatio Then
                                                        var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                    End If
                                                Else
                                                    If boolLUseSigFigsArea Then
                                                        var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    var2 = var1
                                                End If
                                            End If


                                            .Selection.TypeText(CStr(var2))
                                            '*****
                                        End If

                                        numSD = var2

                                    Catch ex As Exception

                                    End Try
                                End If


                                Try
                                    If nI < gSDMax Then
                                    Else
                                        numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3, "Precision", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                    End If

                                Catch ex As Exception

                                End Try
                                If boolSTATSCV Then
                                    Try
                                        'Row3 %CV
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                        .Selection.TypeText(ReturnPrecLabel())
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                        If nI < gSDMax Then
                                            var3 = "NA"
                                            .Selection.TypeText(CStr(var3))
                                        Else

                                            .Selection.TypeText(Format(numPrec, strQCDec))


                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If


                                If boolSTATSBIAS Then
                                    Try
                                        numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                        If nI = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSBIAS And boolSTATSMEAN Then
                                    Try
                                        'Row3 %Bias
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                        .Selection.TypeText("%Bias")
                                        'var3 = Format(((numMean / numNomConc) - 1) * 100, strQCDec)
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                        .Selection.TypeText(Format(numBias, strQCDec))

                                    Catch ex As Exception

                                    End Try
                                End If


                                If boolTHEORETICAL Then
                                    Try
                                        numTheor = CalcREPercent(numMean, numNomConc, intQCDec)
                                        numTheor = 100 + CDec(numTheor)
                                        If nI = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3, "Accuracy", numTheor, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolTHEORETICAL And boolSTATSMEAN Then
                                    Try
                                        'enter %theoretical
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                        .Selection.TypeText("%Theoretical")
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                        .Selection.TypeText(Format(numTheor, strQCDec))

                                    Catch ex As Exception

                                    End Try

                                End If

                                If boolSTATSDIFF Then
                                    Try
                                        numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                        If nI = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSDIFF And boolSTATSMEAN Then
                                    Try
                                        'Row3 %Bias
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                        .Selection.TypeText("%Diff")
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()

                                        .Selection.TypeText(Format(numBias, strQCDec))

                                    Catch ex As Exception

                                    End Try
                                End If


                                If BOOLSTATSRE Then
                                    Try
                                        numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                        If nI = 0 Then
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3, "Accuracy", numBias, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If BOOLSTATSRE And boolSTATSMEAN Then
                                    Try
                                        'Row3 %RE
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                        .Selection.TypeText("%RE")

                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()

                                        .Selection.TypeText(Format(numBias, strQCDec))

                                    Catch ex As Exception

                                    End Try
                                End If


                                Try
                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3, "n", CInt(nI), CSng(var10), Count1, strDo, 0, 0, False)
                                Catch ex As Exception

                                End Try
                                If boolSTATSN Then
                                    Try
                                        'Row4 n
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                        .Selection.TypeText("n")
                                        var3 = rows2b.Length
                                        .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                        .Selection.TypeText(CStr(nI))

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolQCREPORTACCVALUES Then
                                Else
                                    If boolOutlier Then
                                        int8 = int8 + 2
                                        .Selection.Tables.Item(1).Cell(int1 + int8, 2).Select()
                                        .Selection.TypeText(Text:="Summary Statistics Including Outlier Values")
                                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                        Try
                                            .Selection.Cells.Merge()
                                        Catch ex As Exception
                                        End Try
                                        With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                            .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                        End With

                                        If boolSTATSMEAN Then
                                            Try
                                                'Row1 Mean
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                                .Selection.TypeText("Mean")

                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                                If boolRCPA Then
                                                    'var1 = MeanDR(rows2b, "ANALYTEAREA", False, "gaga", False, False)
                                                    If boolIS Then
                                                        var1 = MeanDR(rows2bE, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                    Else
                                                        var1 = MeanDR(rows2bE, "ANALYTEAREA", False, "gaga", False, False)
                                                    End If

                                                Else
                                                    'var1 = MeanDR(rows2b, "Ratio", False, "gaga", False, False)
                                                    If boolIS Then
                                                        var1 = MeanDR(rows2bE, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                    Else
                                                        var1 = MeanDR(rows2bE, "Ratio", False, "gaga", False, False)
                                                    End If

                                                End If

                                                '*****
                                                If boolRCPARatio Then
                                                    If boolLUseSigFigsAreaRatio Then
                                                        var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                    End If
                                                Else
                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                End If
                                                .Selection.TypeText(CStr(var2))
                                                '*****

                                                numMean = var2
                                                If Count3 = 0 Then
                                                    numAE = numMean
                                                    numA1E = CDec(var1)
                                                Else
                                                    numBE = numMean
                                                    numB1E = CDec(var1)
                                                End If
                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSSD Then
                                            Try
                                                'Row2 SD
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                                .Selection.TypeText("S.D.")
                                                If nI < gSDMax Then
                                                    .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                                    .Selection.TypeText("NA")
                                                    var3 = 0
                                                Else

                                                    .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                                    If boolRCPA Then

                                                        If boolIS Then
                                                            var1 = StdDevDRArea(rows2bE, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                        Else
                                                            var1 = StdDevDRArea(rows2bE, "ANALYTEAREA", False, "gaga", False, False)
                                                        End If

                                                    Else

                                                        If boolIS Then
                                                            var1 = StdDevDRArea(rows2bE, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                        Else
                                                            var1 = StdDevDRArea(rows2bE, "Ratio", False, "gaga", False, False)
                                                        End If

                                                    End If

                                                    '*****
                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    End If
                                                    .Selection.TypeText(CStr(var2))
                                                    '*****

                                                End If

                                                numSD = var2

                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSCV Then
                                            Try
                                                'Row3 %CV
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                                .Selection.TypeText(ReturnPrecLabel())
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                                If nI < gSDMax Then
                                                    var3 = "NA"
                                                    .Selection.TypeText(CStr(var3))
                                                Else
                                                    numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                    .Selection.TypeText(Format(numPrec, strQCDec))
                                                End If


                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSBIAS And boolSTATSMEAN Then
                                            Try
                                                'Row3 %Bias
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                                .Selection.TypeText(ReturnPrecLabel())
                                                'var3 = Format(((numMean / numNomConc) - 1) * 100, strQCDec)
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                                '.Selection.TypeText(CStr(var3))

                                                numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                                .Selection.TypeText(Format(numBias, strQCDec))
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolTHEORETICAL And boolSTATSMEAN Then
                                            Try
                                                'enter %theoretical
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                                .Selection.TypeText("%Theoretical")
                                                'var1 = (((numMean / numNomConc) - 1) * 100)
                                                'var1 = Format(var1, strQCDec)
                                                'var1 = Format(100 + var1, strQCDec)
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                                '.Selection.TypeText(CStr(var1))

                                                numTheor = CalcREPercent(numMean, numNomConc, intQCDec)
                                                numTheor = 100 + CDec(numTheor)
                                                .Selection.TypeText(Format(numTheor, strQCDec))
                                            Catch ex As Exception

                                            End Try

                                        End If

                                        If boolSTATSDIFF And boolSTATSMEAN Then
                                            Try
                                                'Row3 %Bias
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                                .Selection.TypeText("%Diff")
                                                'var3 = Format(((numMean / numNomConc) - 1) * 100, strQCDec)
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                                '.Selection.TypeText(CStr(var3))

                                                numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                                .Selection.TypeText(Format(numBias, strQCDec))
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If BOOLSTATSRE And boolSTATSMEAN Then
                                            Try
                                                'Row3 %RE
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                                .Selection.TypeText("%RE")
                                                'var3 = Format(((numMean / numNomConc) - 1) * 100, strQCDec)
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                                '.Selection.TypeText(CStr(var3))

                                                numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                                .Selection.TypeText(Format(numBias, strQCDec))
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSN Then
                                            Try
                                                'Row4 n
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats).Select()
                                                .Selection.TypeText("n")
                                                var3 = rows2bE.Length
                                                .Selection.Tables.Item(1).Cell(int1 + int8, intColStats + 1).Select()
                                                .Selection.TypeText(CStr(nI))

                                            Catch ex As Exception

                                            End Try
                                        End If

                                    End If
                                End If

                                If Count2 = intNumRuns - 1 Then
                                    int1 = int1 + int8 + 2 '5
                                Else
                                    int1 = int1 + int8 + 2 '5
                                End If

                            Next

                        Next

                        'do %Difference
                        '.Selection.Tables.item(1).Cell(int1, 2).Select()
                        '.Selection.TypeText("%Difference")
                        Dim numA2 As Decimal
                        Dim numB2 As Decimal
                        Try

                            var1 = 0

                            If gboolMeanFullPrec Then
                                '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                numA2 = numA1
                                numB2 = numB1
                            Else
                                numA2 = numA
                                numB2 = numB
                            End If

                            'If boolMEANACCURACY Then
                            '    If numA2 And numB2 = 0 Then
                            '        var3 = 0
                            '    Else
                            '        If boolPOSLEG Then
                            '            var3 = (numA2 - numB2) / ((numA2 + numB2) / 2) * 100
                            '        Else
                            '            var3 = (numB2 - numA2) / ((numA2 + numB2) / 2) * 100
                            '        End If
                            '    End If

                            'ElseIf BOOLDIFFERENCE Then

                            '    If boolPOSLEG Then
                            '        If numA = 0 Then
                            '            var3 = 0
                            '        Else
                            '            var3 = RoundToDecimalRAFZ((numA2 - numB2) / numA2 * 100, 5) '(T0-Tn)/((Tn+T0)/2)
                            '        End If
                            '    Else
                            '        If numA2 = 0 Then
                            '            var3 = 0
                            '        Else
                            '            var3 = RoundToDecimalRAFZ((numB2 - numA2) / numA2 * 100, 5) '(Tn-T0)/((Tn+T0)/2)
                            '        End If

                            '    End If

                            'ElseIf boolRECOVERY Then

                            '    If boolPOSLEG Then
                            '        If numB2 = 0 Then
                            '            var3 = 0
                            '        Else
                            '            var3 = RoundToDecimalRAFZ(numA2 / numB2 * 100, 5) 'T0/Tn
                            '        End If

                            '    Else
                            '        If numA = 0 Then
                            '            var3 = 3
                            '        Else
                            '            var3 = RoundToDecimalRAFZ(numB2 / numA2 * 100, 5) 'Tn/T0
                            '        End If

                            '    End If

                            'Else
                            '    If numB2 = 0 Then
                            '        var3 = 0
                            '    Else
                            '        If boolPOSLEG Then
                            '            var3 = ((numA2 / numB2) - 1) * 100
                            '        Else
                            '            var3 = (1 - (numA2 / numB2)) * 100
                            '        End If
                            '    End If

                            'End If

                            var3 = ReturnDiff(numA2, numB2)

                            'QCLevel is always 1 for this table
                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, 1, "Diff", RoundToDecimalRAFZ(var3, intQCDec), CSng(var10), Count1, strDo, 0, 0, False)

                            var2 = var3 ' RoundToDecimal(var3, 5)
                        Catch ex As Exception
                            var2 = "NA"
                        End Try

                        var3 = Format(RoundToDecimalRAFZ(var2, intQCDec), strQCDec)

                        .Selection.Tables.Item(1).Cell(int1, intColStats + 1).Select()
                        .Selection.TypeText(CStr(var3))

                        If boolOutlier Then

                            Try

                                var1 = 0
                                If gboolMeanFullPrec Then
                                    '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                    numA2 = numA1E
                                    numB2 = numB1E
                                Else
                                    numA2 = numAE
                                    numB2 = numBE
                                End If

                                'If boolMEANACCURACY Then
                                '    If numA2 And numB2 = 0 Then
                                '        var3 = 0
                                '    Else
                                '        If boolPOSLEG Then
                                '            var3 = (numA2 - numB2) / ((numA2 + numB2) / 2) * 100
                                '        Else
                                '            var3 = (numB2 - numA2) / ((numA2 + numB2) / 2) * 100
                                '        End If
                                '    End If

                                'ElseIf BOOLDIFFERENCE Then

                                '    If boolPOSLEG Then
                                '        If numA = 0 Then
                                '            var3 = 0
                                '        Else
                                '            var3 = RoundToDecimalRAFZ((numA2 - numB2) / numA2 * 100, 5) '(T0-Tn)/((Tn+T0)/2)
                                '        End If
                                '    Else
                                '        If numA2 = 0 Then
                                '            var3 = 0
                                '        Else
                                '            var3 = RoundToDecimalRAFZ((numB2 - numA2) / numA2 * 100, 5) '(Tn-T0)/((Tn+T0)/2)
                                '        End If

                                '    End If

                                'ElseIf boolRECOVERY Then

                                '    If boolPOSLEG Then
                                '        If numB2 = 0 Then
                                '            var3 = 0
                                '        Else
                                '            var3 = RoundToDecimalRAFZ(numA2 / numB2 * 100, 5) 'T0/Tn
                                '        End If

                                '    Else
                                '        If numA = 0 Then
                                '            var3 = 3
                                '        Else
                                '            var3 = RoundToDecimalRAFZ(numB2 / numA2 * 100, 5) 'Tn/T0
                                '        End If

                                '    End If

                                'Else
                                '    If numB2 = 0 Then
                                '        var3 = 0
                                '    Else
                                '        If boolPOSLEG Then
                                '            var3 = ((numA2 / numB2) - 1) * 100
                                '        Else
                                '            var3 = (1 - (numA2 / numB2)) * 100
                                '        End If
                                '    End If

                                'End If

                                'var2 = var3 ' RoundToDecimal(var3, 5)

                                var2 = ReturnDiff(numA2, numB2)

                            Catch ex As Exception
                                var2 = "NA"
                            End Try

                            intExp = intExp + 1
                            intLeg = intLeg + 1
                            strB = Chr(intLeg + intLegStart) 'Chr(96 + intLeg)
                            'Set Legend String
                            str2 = GetLegendTitle(intTableID, idTR)
                            'if there is an '=' sign, then remove it
                            str2 = Replace(str2, " = ", "", 1, -1, CompareMethod.Text)
                            str2 = Replace(str2, "= ", "", 1, -1, CompareMethod.Text)
                            str2 = Replace(str2, " =", "", 1, -1, CompareMethod.Text)

                            str1 = "Value in parentheses is " & str2 & " including outliers."
                            'Add to Legend Array
                            ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strB, True)

                            var3 = " (" & Format(RoundToDecimalRAFZ(var2, intQCDec), strQCDec) & ")"
                            .Selection.TypeText(CStr(var3))

                            If boolRedBoldFont Then
                                .Selection.Font.Bold = True
                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                            End If

                            '.Selection.TypeText(Text:=var4)
                            'arrCS(intCS) = var4
                            Call typeInSuperscriptFontSize12WithSpace(wd, strA)


                        End If

                        'bottom border this row
                        .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow)
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        '.Selection.MoveRight Unit:=Microsoft.Office.Interop.Word.wdunits.word.wdunits.wdCharacter, Count:=ctQCs, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        'If boolQCREPORTACCVALUES Then
                        'Else
                        '    If intExp = 0 Then
                        '        Call DeleteRows(ctExp, wd)
                        '    End If
                        'End If

                    Catch ex As Exception

                        str1 = "There was a problem preparing table:"
                        str1 = strM1 & ChrW(10) & ChrW(10) & str1
                        str1 = str1 & ChrW(10) & ChrW(10)
                        str1 = str1 & ex.Message
                        MsgBox(str1, vbInformation, "Problem...")

                    End Try


                    'autofit window
                    .Selection.Tables.Item(1).Select()
                    'autofit table
                    Call AutoFitTable(wd, False)

                    ''enter Difference information' No! Leave this for Legend
                    .Selection.Tables.Item(1).Cell(int1, intColStats).Select()

                    str1 = GetLegendTitle(intTableID, idTR) ' "%Difference"
                    '20190225 LEE:
                    Dim strDiff As String = ""
                    strDiff = str1

                    'if there is an '=' sign, then remove it
                    str1 = Replace(str1, " = ", "", 1, -1, CompareMethod.Text)
                    str1 = Replace(str1, "= ", "", 1, -1, CompareMethod.Text)
                    str1 = Replace(str1, " =", "", 1, -1, CompareMethod.Text)

                    .Selection.TypeText(Text:=str1)


                    'Call DeleteTableRows(wd)

                    '20180523 LEE
                    Call RemoveRows(wd, ctTbl)

                    'enter table number
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End

                    '''''wdd.visible = True

                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next
                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    'str1 = str2 & " Stock Solution Stability Assessment: Summary of " & strDo ' rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")

                    ''***
                    strA = strAnal ' rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                    If boolIS Then
                        str1 = str2 & " Stock Solution Stability Assessment: Summary of " & strDo
                        'strA = strDo
                    Else
                        str1 = str2 & " Stock Solution Stability Assessment: Summary of " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                        strA = rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                    End If
                    If boolX Then
                        strA = "Internal Standard " & strA
                    End If
                    strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, boolX)
                    Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                    'Note: strTName is byRef and will return Table, number, caption, label

                    '***

                    'Call EnterTableNumber(wd, str1, 3)

                    'enter a table record in tblTableN
                    'ctTableN = ctTableN + 1

                    Dim dtblr As DataRow = tblTableN.NewRow
                    dtblr.BeginEdit()
                    dtblr.Item("TableNumber") = ctTableN
                    dtblr.Item("AnalyteName") = strDo 'arrAnalytes(1, Count1)
                    dtblr.Item("TableName") = strTNameO
                    dtblr.Item("TableID") = intTableID
                    dtblr.Item("CHARFCID") = charFCID
                    dtblr.Item("TableNameNew") = strTName
                    tblTableN.Rows.Add(dtblr)

                    '.Selection.Tables.item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                    '.Selection.Tables.item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)

                    ''split table, if needed

                    Call AutoFitTable(wd, BOOLINCLUDEDATE)

                    strM = "Finalizing " & strTName & "..."
                    strM1 = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."

                    frmH.lblProgress.Text = strM1
                    frmH.Refresh()

                    str1 = frmH.lblProgress.Text

                    Call SplitTable(wd, 3, intLeg, arrLegend, str1, True, ctLegend + 2, False, False, False, intTableID)

                    'move to line below table
                    Call MoveOneCellDown(wd)

                    Call InsertLegend(wd, intTableID, idTR, boolX, 1)

                End If

end1:
                If boolJustTable Then
                    var1 = strTempInfo
                    'replace numeric with verbose in strTempInfo
                    'look for a sequence of characters that is numeric
                    var3 = ""
                    var4 = ""
                    Dim bool1 As Boolean
                    Dim bool2 As Boolean
                    bool1 = False 'Start
                    bool2 = False 'End
                    str2 = ""
                    For Count2 = 1 To Len(var1)
                        var2 = Mid(var1, Count2, 1)
                        If StrComp(var2, " ", CompareMethod.Text) = 0 Then
                            var2 = "a"
                        End If
                        If IsNumeric(var2) Then
                            var3 = var3 & var2
                            If IsNumeric(var3) Then
                                var4 = var3
                                bool1 = True
                            Else
                            End If
                        Else
                            If bool1 Then
                                bool2 = True
                            End If
                        End If
                        If bool1 And bool2 Then
                            Exit For
                        End If
                    Next
                    If bool1 = False Then
                        var2 = "[NA]"
                    Else
                        var2 = VerboseNumber(var4, True)
                        str2 = Replace(var1, CStr(var4), var2, 1, 1, CompareMethod.Text)
                    End If

                    If boolX Then
                        str1 = str2 & " Stock Solution Stability Assessment: Summary of " & strDo
                        str2 = str1
                        str1 = strDo ' NZ(rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION"), "")

                    Else
                        str1 = str2 & " Stock Solution Stability Assessment: Summary of " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                        str2 = str1
                        str1 = NZ(rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION"), "")

                    End If
                    'Call JustTable(wd, str1, str2, strDo, strTName, intTableID)
                    If Len(str1) = 0 Then
                    Else
                        strA = strAnal
                        str1 = strA
                        strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, boolX)
                        Call JustTable(wd, str1, strTName, strDo, strTName, intTableID, strTempInfo, "", strTNameO, intGroup, idTR)
                    End If

                End If

next1:

            Next
end2:
        End With

    End Sub


    Sub MVSummaryCombinedRecoveryQC_13(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal idTR As Int64, boolCombined As Boolean, boolTrue As Boolean, boolSE As Boolean)

        '20160905 LEE: This code now does all Recovery and Suppression/Enhancement/MatrixFactor tables

        'Recovery: decimals
        'MF: SigFigs

        '20181130 LEE:
        'Combined Recovery
        '  QC/RS
        'True (Extraction) Recovery
        '  QC/PES
        'Suppression/Enhancement
        '  PES/RS

        'QC: Normal QC
        'RS: Unextracted QC or Neat
        'PES: Post-Extraction Spike

        'If BOOLMFTABLE Then  ' table is Matrix Factor

        '    If BOOLINCLMFCOLS Then 'Columns 1 and 2 are MFAnalyte and MFIntStd

        '        If BOOLDOINDREC Then 'record individual MF values
        '            '   Column 1
        '            '   Matrix Factor Analyte
        '            '   IF nRS < nPES Then
        '            '       (PES Analyte Peak Area)/(Mean RS Analyte Peak Area)
        '            '   Else
        '            '       (PES Analyte Peak Area)/(RS Analyte Peak Area)
        '            '   Endif

        '            '   Column 2
        '            '   Matrix Factor IS
        '            '   IF nRS < nPES Then
        '            '       (PES Analyte Peak Area)/(Mean RS Analyte Peak Area)
        '            '   Else
        '            '       (PES IS Peak Area)/(RS IS Peak Area)
        '            '   Endif
        '        Else
        '            '   Column 1 = NA if configured for NA
        '            '   Column 2 = NA if configured for NA
        '        End If

        '        If BOOLCALCINTSTDNMF Then
        '            'Column 3
        '            'IntStdNormalizeMatrixFactor (ISNMF)
        '            If BOOLDOINDREC Then
        '                '(MFAnalyte)/(MFIS)
        '            Else
        '                '(MeanMFAnalyte)/(MeanMFIS)
        '            End If
        '        End If

        '    Else 'Columns 1 and 2 are PARatio Analyte and PARatio IntStd

        '        'Column 1
        '        'PARatio Analyte

        '        'Column 2
        '        'PARatio IS

        '        If BOOLCALCINTSTDNMF Then
        '            'Column 3
        '            'IntStdNormalizeMatrixFactor (ISNMF)
        '            If BOOLDOINDREC Then
        '                'if nRS < nPES then
        '                '   (PARatio PES)/(Mean PARatio RS)
        '                'Else
        '                '   (PARatio PES)/(PARatio RS)
        '                'Endif
        '            Else
        '                ' NA if configured for NA
        '            End If

        '        End If

        '    End If

        '    'REPORTING STATS
        '    If BOOLMFTABLE Then

        '        If BOOLINCLMFCOLS Then 'Columns 1 and 2 are MFAnalyte and MFIntStd

        '            'Column 1
        '            'MF Analyte
        '            If BOOLDOINDREC Then '
        '                'Mean Ind Values
        '            Else
        '                '(Mean PES Analyte Peak Area)/(Mean RS Analyte Peak Area)
        '            End If

        '            'Column 2
        '            'MF Int Std
        '            If BOOLDOINDREC Then '
        '                'Mean Ind Values
        '            Else
        '                '(Mean PES IS Peak Area)/(Mean RS IS Peak Area)
        '            End If

        '            'Column 3
        '            If BOOLDOINDREC Then '
        '                'Mean Ind Values
        '            Else
        '                '(Mean MF Analyte)/(Mean MF IntStd)
        '            End If

        '        Else 'columns are PARatio
        '            'stats should always be Mean of Ind Values

        '            'Column 1
        '            'Analyte PAR
        '            'Mean of Ind Values

        '            'Column 2
        '            'IS PAR
        '            'Mean of Ind Values

        '            'Column 3
        '            If BOOLCALCINTSTDNMF Then
        '                If BOOLDOINDREC Then '
        '                    'Mean Ind Values
        '                Else
        '                    '(Mean MF Analyte)/(Mean MF IntStd)
        '                End If

        '            End If

        '        End If

        '    End If

        'End If



        Dim BOOLCALCINTSTDNMF As Boolean = False '20180803 LEE: re-using BOOLCALCINTSTDNMF as Denominator choice used in InsertLegends

        Dim boolOC As Boolean = False 'bool if eliminated
        Dim var1, var2, var3, var4, var5, var6, var10
        Dim dvDo As System.Data.DataView
        Dim strTName As String
        Dim intDo As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim strDo As String
        Dim bool As Boolean
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim tbl1 As System.Data.DataTable
        Dim dv1 As System.Data.DataView
        Dim rows1() As DataRow
        Dim intRows1 As Short
        Dim strF1 As String
        Dim tbl2 As System.Data.DataTable
        Dim tbl2a As New System.Data.DataTable
        Dim tbl2b As New System.Data.DataTable
        Dim dv2 As System.Data.DataView
        Dim rows2() As DataRow
        Dim rows2a() As DataRow
        Dim rows2b() As DataRow
        Dim intRows2 As Short
        Dim strF2 As String
        Dim tbl3 As System.Data.DataTable
        Dim dv3 As System.Data.DataView
        Dim rows3() As DataRow
        Dim intRows3 As Short
        Dim strF3 As String
        Dim intTableID As Short
        Dim tbl4 As System.Data.DataTable
        Dim dv4 As System.Data.DataView
        Dim rows4() As DataRow
        Dim intRows4 As Short
        Dim strF4 As String
        Dim strS As String
        Dim intNumRuns As Short
        Dim dv As System.Data.DataView
        Dim tblNumRuns As System.Data.DataTable
        Dim tblLevels As System.Data.DataTable
        Dim intNumLevels As Short
        Dim intNumLevelsO As Short
        Dim intTblRows As Short
        Dim wrdSelection As Microsoft.Office.Interop.Word.Selection
        Dim strF As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim int4 As Short
        Dim int10 As Short
        Dim intRowsX As Short
        Dim tblX As System.Data.DataTable
        Dim varNom
        Dim strConcUnits As String
        Dim intLeg As Short
        Dim ctQCLegend As Short
        Dim ctDilLeg As Short
        Dim strA As String
        Dim strB As String

        Dim boolOut As Boolean = False

        strF = "ID_TBLREPORTTABLE = " & idTR
        Dim tblTP As DataTable = tblTableProperties
        Dim rowsTP() As DataRow = tblTP.Select(strF)
        Dim strISConc As String = ""
        If rowsTP.Length = 0 Then
        Else
            strISConc = NZ(rowsTP(0).Item("CHARISCONC"), "")
        End If

        Dim intIndUP As Short = 15
        Dim arrInd(intIndUP, 1)
        '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF

        Dim intCtMid As Short
        Dim boolMultiMid As Boolean = False

        Dim boolNAStat As Boolean = False

        Dim ctLegend As Short
        Dim fontsize

        Dim hi, lo
        Dim rows10() As DataRow
        Dim rows11() As DataRow
        Dim intRowsAnal As Short
        Dim arrFP(20) 'FlagPercent array
        Dim strFP As String
        Dim numMean As Decimal
        Dim numBias As Decimal
        Dim numSD As Decimal

        Dim numMeanRSAPA As Decimal
        Dim numMeanRSISPA As Decimal
        Dim numMeanPESAPA As Decimal
        Dim numMeanPESISPA As Decimal
        Dim numMeanAMF As Decimal
        Dim numMeanISMF As Decimal
        Dim numMeanISNMF As Decimal

        Dim nummeanRSPAR As Decimal
        Dim nummeanPESPAR As Decimal

        Dim nummeanRSPAR_Out As Decimal
        Dim nummeanPESPAR_Out As Decimal

        Dim numSDRSAPA As Decimal
        Dim numSDRSISPA As Decimal
        Dim numSDPESAPA As Decimal
        Dim numSDPESISPA As Decimal
        Dim numSDAMF As Decimal
        Dim numSDISMF As Decimal
        Dim numSDISNMF As Decimal

        Dim intNRSAPA As Short
        Dim intNRSISPA As Short
        Dim intNPESAPA As Short
        Dim intNPESISPA As Short
        Dim intNAMF As Short
        Dim intNISMF As Short
        Dim intNISNMF As Short


        '*****

        Dim numMeanRSAPA_Out As Decimal
        Dim numMeanRSISPA_Out As Decimal
        Dim numMeanPESAPA_Out As Decimal
        Dim numMeanPESISPA_Out As Decimal
        Dim numMeanAMF_Out As Decimal
        Dim numMeanISMF_Out As Decimal
        Dim numMeanISNMF_Out As Decimal

        Dim numSDRSAPA_Out As Decimal
        Dim numSDRSISPA_Out As Decimal
        Dim numSDPESAPA_Out As Decimal
        Dim numSDPESISPA_Out As Decimal
        Dim numSDAMF_Out As Decimal
        Dim numSDISMF_Out As Decimal
        Dim numSDISNMF_Out As Decimal

        Dim intNRSAPA_Out As Short
        Dim intNRSISPA_Out As Short
        Dim intNPESAPA_Out As Short
        Dim intNPESISPA_Out As Short
        Dim intNAMF_Out As Short
        Dim intNISMF_Out As Short
        Dim intNISNMF_Out As Short

        '*****

        Dim tblZ As New System.Data.DataTable
        Dim dvAn As System.Data.DataView
        Dim p1, p2, p3, p4, p5, p6, p7, p8, p9, p10
        Dim strM As String
        Dim fonts
        Dim numDF As Decimal
        Dim DilFactor
        Dim strF2a As String
        Dim strTempInfo As String
        Dim rowsQC() As DataRow
        Dim rowsRS() As DataRow
        Dim introwsQC As Short
        Dim introwsRS As Short
        Dim boolIS As Boolean
        Dim strX As String
        Dim rowsX() As DataRow
        Dim boolX As Boolean
        Dim intCols As Short
        Dim col1, col2, col3, col4, col5, col6, col7, col8, col9, col10 As Short

        Dim colWID As Short
        Dim colQCID As Short
        Dim colNomConc As Short
        Dim colRSPAR As Short
        Dim colRSPA As Short
        Dim colRSAPA As Short
        Dim colRSISPA As Short
        Dim colPESPA As Short
        Dim colPESPAR As Short
        Dim colPESAPA As Short
        Dim colPESISPA As Short
        Dim colAMF As Short
        Dim colISMF As Short
        Dim colISNMF As Short
        Dim colRec As Short

        Dim numRSAPA As Decimal
        Dim numRSISPA As Decimal
        Dim numRSPAR As Decimal
        Dim numPESAPA As Decimal
        Dim numPESISPA As Decimal
        Dim numPESPAR As Decimal
        Dim numAMF As Decimal
        Dim numISMF As Decimal
        Dim numISNMF As Decimal


        Dim intLegStart As Short
        Dim intRowsData As Short
        Dim boolHasNA As Boolean
        Dim boolPro As Boolean
        Dim boolJustTable As Boolean
        Dim numNomConc As Decimal

        Dim intExp As Short
        Dim ctExp As Short
        Dim int8 As Short

        Dim rows1E() As DataRow
        Dim rows3E() As DataRow
        Dim nE As Short
        Dim nI As Short
        Dim boolOutHeadE As Boolean = False
        Dim boolOutHeadI As Boolean = False
        Dim boolDeleteRows As Boolean = False
        Dim boolE() As Boolean
        Dim boolETot As Boolean
        Dim intStart As Short
        Dim numA, numB, numAI, numBI
        Dim intRowCol6 As Short
        Dim intRowCol6I As Short
        Dim arr1(2, 1)
        Dim arr2(1)
        Dim varIS

        Dim numPrec As Single
        Dim numTheor As Single

        Dim numMeanFP As Decimal 'full precision
        Dim numAFP As Decimal
        Dim numBFP As Decimal
        Dim numAIFP As Decimal
        Dim numBIFP As Decimal

        Dim v1, v2, vU

        Dim vAnalyteIndex
        Dim vMasterAssayID
        Dim vAnalyteID
        Dim tblAG As DataTable = tblAnalyteGroups 'tblAnalyteGroups has all analytes, not just accepted

        Dim intGroup As Short
        Dim strAnal As String
        Dim strAnalC As String
        Dim strMatrix As String
        Dim strTNameO As String
        Dim intRunID As Int16
        Dim strDECISIONREASON As String
        Dim boolExFromAS As Boolean

        '20181217 LEE
        Dim strRS As String 'for column labels
        Dim strPES As String 'for column labels

        '20181202 LEE:
        'Need to configure a table to store just RSAPA, RSISPA, PESAPA, PESISPA
        Dim tblRec As New DataTable

        Dim RSAPA As New DataColumn
        RSAPA.ColumnName = "RSAPA" 'RSAPA
        RSAPA.AllowDBNull = True
        tblRec.Columns.Add(RSAPA)

        Dim RSISPA As New DataColumn
        RSISPA.ColumnName = "RSISPA" 'RSISPA
        RSISPA.AllowDBNull = True
        tblRec.Columns.Add(RSISPA)

        Dim PESAPA As New DataColumn
        PESAPA.ColumnName = "PESAPA" 'PESAPA
        PESAPA.AllowDBNull = True
        tblRec.Columns.Add(PESAPA)

        Dim PESISPA As New DataColumn
        PESISPA.ColumnName = "PESISPA"
        PESISPA.AllowDBNull = True
        tblRec.Columns.Add(PESISPA)

        Dim RSOUT As New DataColumn
        RSOUT.ColumnName = "RSOUT" 'RS is outlier
        RSOUT.AllowDBNull = True
        tblRec.Columns.Add(RSOUT)

        Dim PESOUT As New DataColumn
        PESOUT.ColumnName = "PESOUT" 'PES is outlier
        PESOUT.AllowDBNull = True
        tblRec.Columns.Add(PESOUT)

        Dim RSPAR As New DataColumn
        RSPAR.ColumnName = "RSPAR" 'RSPARatio
        RSPAR.AllowDBNull = True
        tblRec.Columns.Add(RSPAR)

        Dim PESPAR As New DataColumn
        PESPAR.ColumnName = "PESPAR" 'PESPARatio
        PESPAR.AllowDBNull = True
        tblRec.Columns.Add(PESPAR)

        Dim AMF As New DataColumn
        AMF.ColumnName = "AMF" 'Analyte Matrix Factor
        AMF.AllowDBNull = True
        tblRec.Columns.Add(AMF)

        Dim AliqF As New DataColumn
        AliqF.ColumnName = "AliqF" 'Aliquot factor
        AliqF.AllowDBNull = True
        tblRec.Columns.Add(AliqF)

        Dim RecType As New DataColumn
        RecType.ColumnName = "RecType" 'Recovery Type: Null, Normal, MFA, MFIS, ISNMF
        RecType.AllowDBNull = True
        tblRec.Columns.Add(RecType)

   

        Dim nRS As Short = 0
        Dim nPES As Short = 0
        'Public boolMeanRS As Boolean = False 'If nRS <> nPES, then boolmeanrs=true

        Dim charFCID As String
        strF = "ID_TBLREPORTTABLE = " & idTR
        Dim rowsTR() As DataRow = tblReportTable.Select(strF)
        var1 = rowsTR(0).Item("CHARFCID")
        charFCID = NZ(var1, "NA")

        boolSTATSBIAS = False 'bias not possible in this table
        boolTHEORETICAL = False 'theoretical not possible in this table


        boolJustTable = False

        Cursor.Current = Cursors.WaitCursor
        boolHasNA = False

        '''''''''''wdd.visible = True

        fontsize = wd.ActiveDocument.Styles("Normal").Font.Size ' wd.Selection.Font.Size
        fonts = fontsize 'wd.Selection.Font.Size

        With wd

            If boolCombined Then
                intTableID = 13
            ElseIf boolTrue Then
                intTableID = 14
            ElseIf boolSE Then
                intTableID = 15
                '20161203 LEE:  New Logic:  BOOLCALCINTSTDNMF is always true
                BOOLCALCINTSTDNMF = True
            End If

            Dim strWRunId As String = GetWatsonColH(intTableID)

            dvDo = frmH.dgvReportTableConfiguration.DataSource
            strF = "id_tblconfigreporttables = " & intTableID
            intDo = FindRowDVNumByCol(intTableID, dvDo, "id_tblconfigreporttables")
            intLeg = 0
            intLegStart = 96
            boolPro = False

            ''Get table name
            'var1 = dvDo(intDo).Item("Table")
            'strTName = NZ(var1, "[NONE]")

            ''get Temperature info
            'var1 = dvDo(intDo).Item("PERIODTEMP")
            'strTempInfo = NZ(var1, "[NONE]")

            '***
            intDo = FindRowDVNumByCol(idTR, dvDo, "ID_TBLREPORTTABLE")
            'intLeg = 0
            'intLegStart = 96
            'boolPro = False

            'Get table name
            'var1 = dvDo(intDo).Item("Table")
            var1 = dvDo(intDo).Item("CHARHEADINGTEXT")
            strTName = NZ(var1, "[NONE]")
            strTNameO = strTName

            'get Temperature info
            var1 = dvDo(intDo).Item("CHARSTABILITYPERIOD")
            strTempInfo = NZ(var1, "[NONE]")

            '***

            ctPB = ctPB + 1
            If ctPB > frmH.pb1.Maximum Then
                ctPB = 1
            End If
            frmH.pb1.Value = ctPB
            frmH.pb1.Refresh()

            tbl1 = tblAnalysisResultsHome
            tbl2 = tblAssignedSamples
            tbl3 = tblAssignedSamplesHelper
            tbl4 = tblAnalytesHome

            ''debug
            ''report columns in tbl2
            'Console.WriteLine("Start")
            'For Count1 = 0 To tbl2.Columns.Count - 1
            '    Console.WriteLine(tbl2.Columns(Count1).ColumnName)
            'Next
            'Console.WriteLine("End")

            'ensure data has been entered
            strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR
            rowsX = tbl2.Select(strF)
            'If rowsX.Length = 0 Then
            '    strM = "Creating Summary of Combined Recovery Calculations and Data ...."
            '    frmH.lblProgress.Text = strM
            '    frmH.Refresh()
            '    MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
            '    GoTo end2
            'End If

            If boolIncludeISTbl Then
                strF = "IsIntStd = 'No' OR IsIntStd = 'Yes'"
            Else
                strF = "IsIntStd = 'No'"
            End If
            strS = "INTORDER ASC, IsIntStd ASC, AnalyteDescription ASC"
            rows11 = tblAnalytesHome.Select(strF, strS)
            intRowsAnal = rows11.Length

            Dim int11 As Short
            If boolSTATSDIFFCOL Then
                int11 = 2
            Else
                int11 = 1
            End If


            For Count1 = 1 To intRowsAnal

                boolJustTable = False

                Dim arrLegend(4, 20)

                strTName = strTNameO

                ctLegend = 0

                'for legend stuff
                intExp = 0
                ctExp = 0

                intLeg = 0
                ctQCLegend = 0
                ctDilLeg = 0
                ctLegend = 0
                strA = ""
                strB = ""
                arrLegend.Clear(arrLegend, 0, arrLegend.Length)
                arrFP.Clear(arrFP, 0, arrFP.Length)
                intLegStart = 96

                'check if table is to be generated
                'strDo = arrAnalytes(1, Count1) 'record column name
                strDo = rows11(Count1 - 1).Item("ANALYTEDESCRIPTION")

                strX = rows11(Count1 - 1).Item("IsIntStd")
                If StrComp(strX, "Yes", CompareMethod.Text) = 0 Then
                    If boolIncludeISTbl Then
                    Else
                        GoTo next1
                    End If
                Else
                    If UseAnalyte(CStr(strDo)) Then
                    Else
                        GoTo next1
                    End If
                End If

                strX = rows11(Count1 - 1).Item("IsIntStd")
                boolX = False
                If StrComp(strX, "Yes", CompareMethod.Text) = 0 Then
                    'check for boolIntStd in tbl2
                    strF = "IsIntStd = 'Yes'"
                    var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    strF2 = strF2 & "BOOLINTSTD = -1"
                    Erase rowsX
                    rowsX = tbl2.Select(strF2)
                    int1 = rowsX.Length
                    boolX = True
                    If int1 > 0 And boolIncludeISTbl Then
                        bool = True
                    Else
                        bool = True 'False
                        boolJustTable = True
                    End If
                Else
                    bool = dvDo.Item(intDo).Item(strDo) 'find boolean value of dvDo column
                End If

                Dim strM1 As String
                If bool Then 'continue

                    intTCur = intTCur + 1

                    'ensure data has been entered
                    If StrComp(strX, "Yes", CompareMethod.Text) = 0 Then
                        strF = strF2
                    Else
                        strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ID_TBLREPORTTABLE = " & idTR

                    End If
                    rowsX = tbl2.Select(strF)

                    'setup tables
                    If boolUseGroups Then
                        If boolX Then
                            intGroup = -1 'tblAG.Rows(Count1 - 1).Item("INTGROUP")
                            strAnal = tbl4.Rows.Item(Count1 - 1).Item("OriginalAnalyteDescription") ' tblAG.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                            strAnalC = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription") 'tblAG.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                            vAnalyteID = 0 'tblAG.Rows.Item(Count1 - 1).Item("ANALYTEID")
                            'find matrix
                            Dim strFF As String
                            strFF = "INTSTD = '" & CleanText(strAnal) & "'"
                            Dim rowsFF() As DataRow = tblAG.Select(strFF, "", DataViewRowState.CurrentRows)
                            If rowsFF.Length = 0 Then
                                strMatrix = "NA"
                            Else
                                strMatrix = NZ(rowsFF(0).Item("MATRIX"), "NA")
                            End If

                        Else
                            intGroup = tblAG.Rows(Count1 - 1).Item("INTGROUP")
                            strAnal = tblAG.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                            strAnalC = tblAG.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                            vAnalyteID = tblAG.Rows.Item(Count1 - 1).Item("ANALYTEID")
                            strMatrix = tblAG.Rows(Count1 - 1).Item("MATRIX")
                        End If

                    Else
                        var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                        var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                        var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        var4 = tbl4.Rows.Item(Count1 - 1).Item("ANALYTEID")
                        intGroup = 0
                        vAnalyteIndex = var1
                        vMasterAssayID = var2
                        vAnalyteID = var4
                        strMatrix = ""
                    End If

                    If rowsX.Length = 0 Then
                        strM = "Creating " & strTName & "...."
                        strM = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."

                        frmH.lblProgress.Text = strM
                        frmH.Refresh()
                        'MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
                        boolJustTable = True
                        'page setup according to configuration
                        str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                        'insert page break
                        'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                        Call InsertPageBreak(wd)
                        Call PageSetup(wd, str1) 'L=Landscape, P=Portrait
                        GoTo end1
                    Else
                        boolJustTable = False
                    End If

                    ''do this later
                    ''page setup according to configuration
                    'str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                    ''insert page break
                    'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                    'Call PageSetup(wd, str1) 'L=Landscape, P=Portrait

                    'ReDim arrBCQCs(8, 50) '1=LevelNumber, 2=NomConcentration, 3=ID, 4=FlagPercent, 5=Hello, 6=Lo, 7=#ofReplicates, 8=ASSAYID
                    strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                    strM = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."
                    strM1 = strM
                    frmH.lblProgress.Text = strM
                    frmH.Refresh()

                    ''get strConcUnits
                    'int1 = FindRowDV("ULOQ Units", frmH.dgvWatsonAnalRef.DataSource)
                    'strConcUnits = NZ(frmH.dgvWatsonAnalRef(Count1, int1).Value, "ng/mL")

                    'int1 = FindRowDV("Alternate Calibr/QC Std Units", frmH.dgvstudyconfig.DataSource)
                    'str1 = NZ(frmH.dgvStudyConfig(1, int1).Value, "")

                    'If Len(str1) = 0 Or StrComp(str1, "[None]", CompareMethod.Text) = 0 Then
                    'Else
                    '    strConcUnits = str1
                    'End If

                    'setup tables
                    'do this again because need strF2
                    If boolX Then
                        var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        strF2 = "BOOLINTSTD = -1 AND "
                        strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                        strF2 = strF2 & "CHARANALYTE = '" & CleanText(cstr(var3)) & "'"
                    Else


                        If boolUseGroups Then
                            strF2 = "BOOLINTSTD = 0 AND ID_TBLSTUDIES = " & id_tblStudies & " AND "
                            strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                            strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                            strF2 = strF2 & "INTGROUP = " & intGroup
                        Else
                            strF2 = "BOOLINTSTD = 0 AND "
                            var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                            var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                            var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                            strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                            strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                            strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                            strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                            strF2 = strF2 & "MASTERASSAYID = " & var2 ' & " AND "
                        End If

                    End If

                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    rows2 = tbl2.Select(strF2, strS)
                    int1 = rows2.Length 'debug
                    dv2 = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                    int1 = dv2.Count 'debug

                    'find number of runs used
                    tblNumRuns = dv2.ToTable("a", True, "RUNID")
                    intNumRuns = tblNumRuns.Rows.Count

                    If intNumRuns = 0 Then
                        boolJustTable = True
                        'page setup according to configuration
                        str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                        'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                        Call InsertPageBreak(wd)
                        Call PageSetup(wd, str1) 'L=Landscape, P=Portrait
                        GoTo end1
                    End If

                    'get strConcUnits
                    intRunID = 0
                    int1 = 0
                    Do Until intRunID > 0
                        var1 = tblNumRuns.Rows(int1).Item("RUNID")
                        If IsDBNull(var1) Then
                        Else
                            intRunID = var1
                        End If
                        int1 = int1 + 1
                    Loop
                    strConcUnits = GetConcUnits(intRunID)

                    'insert page break

                    'page setup according to configuration
                    str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                    'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                    Call InsertPageBreak(wd)
                    Call PageSetup(wd, str1) 'L=Landscape, P=Portrait

                    'establish number of QCs evaluated
                    'this will actually give number of rows
                    'must be sorted by nomconc!
                    'make new dv
                    Dim dvNL As New DataView(tbl2, strF2, "NOMCONC ASC", DataViewRowState.CurrentRows)
                    tblLevels = dvNL.ToTable("b", True, "NOMCONC")
                    intNumLevels = tblLevels.Rows.Count
                    intNumLevelsO = intNumLevels

                    For Count2 = 0 To intNumLevels - 1 'check for any null values
                        var3 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                        If IsDBNull(var3) Then
                            str1 = "The Nominal Concentration for some assigned samples for " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & " have not been configured."
                            str1 = str1 & ChrW(10) & "When this action is finished, please navigate to the Assigned Samples window and correct this problem."
                            If boolDisableWarnings Then
                            Else
                                MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                            End If
                            GoTo end1
                        End If
                    Next

                    ReDim arr1(2, intNumLevels)
                    '1=Excluded Rec, 2=Included Rec
                    ReDim boolE(intNumLevels)

                    'find number of table rows to generate
                    intRowsX = intNumLevels

                    'find introwsQC and dataviews CHARHELPER1
                    If boolCombined Or boolTrue Then
                        If boolX Then
                            strF = " AND CHARHELPER1 = 'QC' AND BOOLINTSTD = -1"
                        Else
                            strF = " AND CHARHELPER1 = 'QC' AND BOOLINTSTD = 0"
                        End If
                    ElseIf boolSE Then
                        If boolX Then
                            strF = " AND CHARHELPER1 = 'RS - Recovery Standard' AND BOOLINTSTD = -1"
                        Else
                            strF = " AND CHARHELPER1 = 'RS - Recovery Standard' AND BOOLINTSTD = 0"
                        End If
                    End If


                    ''debug
                    'var1 = ""
                    'For Count2 = 0 To tbl2.Columns.Count - 1
                    '    var1 = var1 & ";" & tbl2.Columns(Count2).ColumnName
                    'Next
                    'Console.WriteLine(var1)

                    'For Count3 = 0 To tbl2.Rows.Count - 1
                    '    var1 = ""
                    '    For Count2 = 0 To tbl2.Columns.Count - 1
                    '        var1 = var1 & ";" & NZ(tbl2.Rows(Count3).Item(Count2), "")
                    '    Next
                    '    Console.WriteLine(var1)
                    'Next

                    strF = strF2 & strF
                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    dv1 = New DataView(tbl2, strF, strS, DataViewRowState.CurrentRows)
                    tbl2a = dv1.ToTable
                    introwsQC = tbl2a.Rows.Count

                    'find introwsRS and dataviews CHARHELPER1
                    If boolCombined Then
                        If boolX Then
                            strF = " AND CHARHELPER1 = 'RS - Recovery Standard' AND BOOLINTSTD = -1"
                        Else
                            strF = " AND CHARHELPER1 = 'RS - Recovery Standard' AND BOOLINTSTD = 0"
                        End If
                    ElseIf boolTrue Or boolSE Then
                        If boolX Then
                            strF = " AND CHARHELPER1 = 'PES - Post Extraction Spike' AND BOOLINTSTD = -1"
                        Else
                            strF = " AND CHARHELPER1 = 'PES - Post Extraction Spike' AND BOOLINTSTD = 0"
                        End If
                    End If

                    'strF = " AND CHARHELPER1 = 'PES - Post Extraction Spike'"
                    strF = strF2 & strF
                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    dv3 = New DataView(tbl2, strF, strS, DataViewRowState.CurrentRows)
                    tbl2b = dv3.ToTable
                    introwsRS = tbl2b.Rows.Count

                    '20160820 LEE: intRowsData must include NA's
                    intRowsData = 0
                    For Count2 = 0 To intNumRuns - 1
                        var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")
                        For Count3 = 0 To intNumLevels - 1
                            varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")

                            strF = "NOMCONC = " & varNom & " AND RUNID = " & var10
                            Erase rows2a
                            rows2a = tbl2a.Select(strF, "") 'QC
                            Erase rows2b
                            rows2b = tbl2b.Select(strF, "") 'RS

                            If rows2a.Length > rows2b.Length Then
                                intRowsData = intRowsData + rows2a.Length
                            Else
                                intRowsData = intRowsData + rows2b.Length
                            End If
                        Next
                    Next
                    'If introwsRS > introwsQC Then
                    '    intRowsData = introwsRS
                    'Else
                    '    intRowsData = introwsQC
                    'End If

                    'first determine if there are any outliers
                    Dim intInc As Short
                    Dim intRowsT As Short
                    Dim RowsT() As DataRow
                    boolETot = False
                    intExp = 0
                    If boolQCREPORTACCVALUES Then
                    Else
                        For Count2 = 0 To intNumRuns - 1
                            var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")
                            intInc = 0

                            boolMultiMid = False
                            intCtMid = 1

                            If intNumLevels > 3 Then
                                boolMultiMid = True
                            End If

                            For Count3 = 0 To intNumLevels - 1
                                varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")
                                boolE(Count3) = False

                                ''column 2

                                'column 4
                                'get average of peak areas for QC
                                'and record column 4 peak areas for QC
                                strF = "NOMCONC = " & varNom
                                strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                Erase rows2a
                                rows2a = tbl2a.Select(strF, strS)
                                int2 = rows2a.Length

                                If int2 > UBound(arrInd, 2) Then
                                    ReDim Preserve arrInd(intIndUP, int2)
                                End If

                                var1 = rows2a(0).Item("BOOLINTSTD")
                                If var1 = -1 Then
                                    boolIS = True
                                Else
                                    boolIS = False
                                End If

                                strF = ""
                                'strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                '20180126 LEE: Hmmm. This statement will exclude IS because intGroup isn't -1 in tbl2 (tblAssignedSamples)
                                'checked further. Turns out the problem was in AssignSamples.AddRows sub.  INTGROUP = -1 was getting overwritten by code to populate IntStd info by hand.
                                If boolIS Then
                                    strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ("
                                Else
                                    strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                End If

                                For Count4 = 0 To int2 - 1
                                    var2 = rows2a(Count4).Item("ANALYTEINDEX")
                                    var3 = rows2a(Count4).Item("MASTERASSAYID")
                                    var4 = rows2a(Count4).Item("RUNSAMPLEORDERNUMBER")
                                    var5 = rows2a(Count4).Item("ANALYTEID")
                                    If boolIS Then
                                        If Count4 <> int2 - 1 Then
                                            strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                        Else
                                            strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                        End If
                                    Else
                                        If Count4 <> int2 - 1 Then
                                            strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                        Else
                                            strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                        End If
                                    End If
                                Next
                                Erase rows1

                                strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"

                                rows1 = tbl2.Select(strF, strS)
                                int3 = rows1.Length

                                Erase RowsT
                                '20160820 LEE: This evaluation must include NOMCONC
                                'reset introwsRS and introwsQC
                                Dim rowsTa() As DataRow = tbl2a.Select("NOMCONC = " & varNom) 'intRowsQC
                                Dim rowsTb() As DataRow = tbl2b.Select("NOMCONC = " & varNom) 'intRowsPES
                                introwsQC = rowsTa.Length
                                introwsRS = rowsTb.Length

                                If introwsQC > introwsRS Then
                                    intRowsT = introwsQC
                                Else
                                    intRowsT = introwsRS
                                End If

                                For Count4 = 0 To intRowsT - 1
                                    If Count4 > int3 - 1 Then
                                    Else
                                        var2 = NZ(rows1(Count4).Item("ELIMINATEDFLAG"), "N")
                                        var3 = NZ(rows1(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                        'check for outlier
                                        If StrComp(var2, "Y", vbTextCompare) = 0 Or (var3 = -1 And gAllowExclSamples And LAllowExclSamples) Then
                                            boolE(Count3) = True
                                            boolETot = True
                                            Exit For
                                        End If
                                    End If
                                Next Count4

                                If boolE(Count3) Then
                                Else
                                    'get column 5
                                    'get average of peak areas for RS
                                    strF = "NOMCONC = " & varNom
                                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    Erase rows2b
                                    rows2b = tbl2b.Select(strF, strS)
                                    int2 = rows2b.Length

                                    If int2 > UBound(arrInd, 2) Then
                                        ReDim Preserve arrInd(intIndUP, int2)
                                    End If

                                    var1 = rows2b(0).Item("BOOLINTSTD")
                                    If var1 = -1 Then
                                        boolIS = True
                                    Else
                                        boolIS = False
                                    End If
                                    strF = ""
                                    'strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                    '20180126 LEE: Hmmm. This statement will exclude IS because intGroup isn't -1 in tbl2 (tblAssignedSamples)
                                    If boolIS Then
                                        strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ("
                                    Else
                                        strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                    End If

                                    For Count4 = 0 To int2 - 1
                                        var2 = rows2b(Count4).Item("ANALYTEINDEX")
                                        var3 = rows2b(Count4).Item("MASTERASSAYID")
                                        var4 = rows2b(Count4).Item("RUNSAMPLEORDERNUMBER")
                                        var5 = rows2b(Count4).Item("ANALYTEID")
                                        If boolIS Then
                                            If Count4 <> int2 - 1 Then
                                                strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                            Else
                                                strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                            End If
                                        Else
                                            'If Count4 <> int2 - 1 Then
                                            '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                            'Else
                                            '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                            'End If
                                            If Count4 <> int2 - 1 Then
                                                strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                            Else
                                                strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                            End If
                                        End If

                                    Next
                                    Erase rows3
                                    'rows3 = tbl1.Select(strF)
                                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    rows3 = tbl2.Select(strF, strS)
                                    int3 = rows3.Length 'debug

                                    'find eliminated samples
                                    For Count4 = 0 To intRowsT - 1

                                        If Count4 > int3 - 1 Then
                                        Else
                                            var2 = NZ(rows3(Count4).Item("ELIMINATEDFLAG"), "N")
                                            var3 = NZ(rows3(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                            'check for outlier
                                            'debug
                                            Dim intU As Int16 = UBound(boolE)
                                            If StrComp(var2, "Y", vbTextCompare) = 0 Or (var3 = -1 And gAllowExclSamples And LAllowExclSamples) Then
                                                intExp = intExp + 1
                                                If intExp > UBound(boolE) Then
                                                    ReDim Preserve boolE(UBound(boolE) + 1)
                                                End If
                                                boolE(Count3) = True
                                                Exit For
                                            End If
                                        End If

                                        ''*****

                                    Next Count4

                                End If

                            Next Count3

                        Next Count2

                    End If

                    'generate table
                    Dim intStatsStart As Short
                    intTblRows = 0
                    intTblRows = intTblRows + 1 'for header
                    intTblRows = intTblRows + 1 'for blank row
                    intTblRows = intTblRows + (2 * intNumRuns * intRowsX) 'for two blank rows for each run set
                    intTblRows = intTblRows + intRowsData 'for number of data rows
                    'intTblRows = intTblRows + (4 * intNumRuns * intRowsX) 'for Mean/Bias/n section for each run set

                    'Increment for Statistics Sections
                    Dim intCSN As Short
                    intCSN = countNumStatsRows()
                    If intCSN > 0 Then
                        intTblRows = intTblRows + (intCSN * intNumRuns * intRowsX)
                    Else
                        intTblRows = intTblRows - 1 'subtract an unneeded blank row
                    End If

                    If boolQCREPORTACCVALUES Then
                    Else
                        For Count2 = 1 To intNumLevels
                            If boolE(Count2 - 1) Then
                                intTblRows = intTblRows + (3 * intNumRuns) 'for stats headings
                                ctExp = ctExp + 3 'for stats headings

                                'Increment for Statistics Sections
                                intTblRows = intTblRows + (intCSN * intNumRuns)
                                ctExp = ctExp + (intCSN * intNumRuns)
                                If intCSN > 0 Then
                                    intTblRows = intTblRows + 1 - 1 'for a blank row after each Mean/Bias/n set, except last set
                                    ctExp = ctExp + 1 - 1
                                End If
                                
                            End If
                        Next
                    End If

                    intStatsStart = intTblRows

                    If BOOLINTRARUNSUMSTATS Then
                        'Increment for Statistics Sections
                        intTblRows = intTblRows + countNumStatsRows()
                    Else
                        intTblRows = intTblRows - 1
                    End If

                    'intTblRows = intTblRows + (1 * intNumRuns) - 1 'for a blank row after each Mean/Bias/n set, except last set

                    wrdSelection = wd.Selection()

                    ''old:
                    'If boolX Then
                    '    intCols = 5
                    '    col1 = 1
                    '    col2 = 2
                    '    col3 = 2
                    '    col4 = 3
                    '    col5 = 4
                    '    col6 = 5
                    'Else
                    '    intCols = 6
                    '    col1 = 1
                    '    col2 = 2
                    '    col3 = 3
                    '    col4 = 4
                    '    col5 = 5
                    '    col6 = 6
                    'End If

                    If boolX Then

                        intCols = 5
                        colWID = 1 'watson run id
                        colQCID = 2 'QC ID and Stats Labels
                        colRSPA = 3 'RS 
                        colPESPA = 4 'PES
                        colRec = 5 'Recovery

                        col1 = colWID
                        col2 = colQCID
                        col3 = colQCID
                        col4 = colRSPA
                        col5 = colPESPA
                        col6 = colRec

                    Else

                        If BOOLMFTABLE Then
                            colWID = 1 'watson run id
                            colQCID = 2 'QC ID
                            colNomConc = 3 'NomConc and Stats Labels
                            colRSAPA = 4 'RS Analyte Peak Area
                            colRSISPA = 5 'RS Int Std Peak Area
                            colPESAPA = 6 'PES Analyte Peak Area
                            colPESISPA = 7 'PES Int Std Peak Area

                            col1 = colWID
                            col2 = colQCID
                            col3 = colNomConc
                            col4 = colRSAPA
                            col5 = colRSISPA
                            col6 = colPESAPA
                            col7 = colPESISPA

                            If BOOLINCLMFCOLS Then
                                colAMF = 8 'Analyte MF
                                colISMF = 9 'Int Std MF

                                col8 = colAMF
                                col9 = colISMF

                                If BOOLINCLINTSTDNMF Then
                                    intCols = 10
                                    colISNMF = 10 'ISNormalized MF

                                    col10 = colISNMF
                                Else
                                    intCols = 9
                                End If
                            Else
                                'If BOOLINCLINTSTDNMF Then
                                '    intCols = 8
                                '    colISNMF = 8 'ISNormalized MF

                                '    col8 = colISNMF

                                'Else
                                '    intCols = 7
                                'End If

                                '20180531 LEE:
                                'Use MF columns for PARatio

                                colAMF = 8 'Analyte MF
                                colISMF = 9 'Int Std MF

                                col8 = colAMF
                                col9 = colISMF

                                If BOOLINCLINTSTDNMF Then
                                    intCols = 10
                                    colISNMF = 10 'ISNormalized MF

                                    col8 = colISNMF
                                Else
                                    intCols = 9
                                End If

                            End If

                        Else

                            If boolRCPARatio Then
                                intCols = 6
                                colWID = 1 'watson run id
                                colQCID = 2 'QC ID and Stats Labels
                                colNomConc = 3 'Nominal conc
                                colRSPAR = 4 'RS Peak Area Ratio
                                colPESPAR = 5 'PES peak area ratio
                                colRec = 6 'Recovery

                                col1 = colWID
                                col2 = colQCID
                                col3 = colNomConc
                                col4 = colRSPAR
                                col5 = colPESPAR
                                col6 = colRec

                            Else
                                intCols = 6
                                colWID = 1 'watson run id
                                colQCID = 2 'QC ID and Stats Labels
                                colNomConc = 3 'Nominal conc
                                colRSPA = 4 'RS Peak Area 
                                colPESPA = 5 'PES peak area 
                                colRec = 6 'Recovery

                                col1 = colWID
                                col2 = colQCID
                                col3 = colNomConc
                                col4 = colRSPA
                                col5 = colPESPA
                                col6 = colRec

                            End If

                        End If

                    End If

                    'adjust intcols
                    If boolQCREPORTACCVALUES Then
                    Else
                        If boolETot And BOOLMFTABLE = False Then
                            If boolX And intNumLevels = 1 Then
                            Else
                                intCols = intCols + 1

                                'make legend entries
                                intLeg = intLeg + 1
                                strA = ChrW(intLeg + intLegStart)
                                str1 = "Excluding Outlier Values"
                                arrLegend(1, intLeg) = strA
                                arrLegend(2, intLeg) = str1
                                arrLegend(3, intLeg) = True
                                arrLegend(4, intLeg) = True
                                ctLegend = ctLegend + 1

                                intLeg = intLeg + 1
                                strA = ChrW(intLeg + intLegStart)
                                str1 = "Including Outlier Values"
                                arrLegend(1, intLeg) = strA
                                arrLegend(2, intLeg) = str1
                                arrLegend(3, intLeg) = True
                                arrLegend(4, intLeg) = True
                                ctLegend = ctLegend + 1
                            End If

                        End If

                    End If


                    Try

                        '20180913 LEE:
                        Call IncrNextTableNumber(wd)

                        If boolPlaceHolder Then
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=1, NumColumns:=1, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        Else
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=intTblRows, NumColumns:=intCols, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        End If

                        .Selection.Tables.Item(1).Select()

                        Call SetCellPaddingZero(.Selection.Tables.Item(1))

                        .Selection.Tables.Item(1).Rows.AllowBreakAcrossPages = False
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                        .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                        .Selection.Tables.Item(1).Columns.PreferredWidth = Microsoft.Office.Interop.Word.WdPreferredWidthType.wdPreferredWidthPoints
                        '.Selection.Tables.Item(1).Columns.Item(1).Width = 86
                        For Count2 = 1 To intNumLevels
                            '.Selection.Tables.item(1).Columns.item(Count2 + 1).Width = 50
                        Next
                        .Selection.Tables.Item(1).Select()
                        Dim cel As Microsoft.Office.Interop.Word.Cell
                        For Each cel In .Selection.Tables.Item(1).Range.Cells
                            cel.WordWrap = False
                        Next

                        'remove border, but leave top and bottom
                        removeBorderButLeaveTopAndBottom(wd)

                        '.Selection.Font.Size = 9

                        'border top and bottom of range
                        .Selection.Tables.Item(1).Cell(1, 1).Select()

                        If boolPlaceHolder Then

                            .Selection.Tables.Item(1).Select()
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone

                            strA = arrAnalytes(14, Count1)
                            If boolX Then
                                strA = "Internal Standard " & strA
                            End If
                            strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, boolX)
                            Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                            'Note: strTName is byRef and will return Table, number, caption, label

                            Call MoveOneCellDown(wd)

                            .Selection.TypeParagraph()
                            .Selection.TypeParagraph()

                            'enter a table record in tblTableN
                            'ctTableN = ctTableN + 1
                            Dim dtblr1 As DataRow = tblTableN.NewRow
                            dtblr1.BeginEdit()
                            dtblr1.Item("TableNumber") = ctTableN
                            dtblr1.Item("AnalyteName") = arrAnalytes(1, Count1)
                            dtblr1.Item("TableName") = strTNameO
                            dtblr1.Item("TableID") = intTableID
                            dtblr1.Item("CHARFCID") = charFCID
                            dtblr1.Item("TableNameNew") = strTName
                            tblTableN.Rows.Add(dtblr1)

                            GoTo next1
                        End If

                        .Selection.Tables.Item(1).Select()
                        Call GlobalTableParaFormat(wd)

                        '20171220 LEE: Do not set table size, use the style default table
                        '.Selection.Font.Size = fontsize - 1
                        .Selection.Tables.Item(1).Cell(1, 1).Select()

                        '.Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        '.Selection.MoveRight Unit:=Microsoft.Office.Interop.Word.wdunits.word.wdunits.wdCharacter, Count:=ctQCs, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        'format selection
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                        .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom

                        '.Selection.Font.Size = 9

                        '.Selection.MoveLeft(Microsoft.Office.Interop.Word.WdUnits.wdCharacter, 1)

                        'Enter  row titles
                        'column 1
                        .Selection.Tables.Item(1).Cell(1, 1).Select()

                        Dim wTbl As Word.Table
                        wTbl = .Selection.Tables.Item(1)


                        If BOOLINCLUDEDATE Then
                            'str1 = strWRunId & ChrW(10) & "(Analysis Date)"
                            '20180420 LEE:
                            str1 = strWRunId & ChrW(10) & "(" & GetAnalysisDateLabel(intTableID) & ")"

                        Else
                            str1 = strWRunId
                        End If

                        .Selection.TypeText(Text:=str1)
                        'column 2
                        .Selection.Tables.Item(1).Cell(1, 2).Select()
                        str1 = "QC ID"
                        .Selection.TypeText(Text:=str1)

                        'get Extracted QC Column Heading
                        'enter headings


                        'column 4
                        If boolX Then
                            Select Case intTableID
                                Case 13
                                    str1 = ReturnRecoveryLabel(intTableID, 220) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                Case 14
                                    str1 = ReturnRecoveryLabel(intTableID, 223) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                Case 15
                                    str1 = ReturnRecoveryLabel(intTableID, 226) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                            End Select
                            strRS = str1

                            .Selection.Tables.Item(1).Cell(1, col4).Select()
                            If boolCombined Or boolTrue Then
                                If Len(str1) = 0 Then
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = "Extracted QC Standard" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = "Extracted QC Standard" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = "Extracted QC Standard" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                    End If
                                Else
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                    End If
                                End If

                            ElseIf boolSE Then

                                If Len(str1) = 0 Then
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = "Recovery Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = "Recovery Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = "Recovery Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                    End If
                                Else
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Pead Area"
                                    End If
                                End If

                            End If

                            .Selection.TypeText(Text:=str1)


                            'column 5
                            .Selection.Tables.Item(1).Cell(1, col5).Select()
                            Select Case intTableID
                                Case 13
                                    str1 = ReturnRecoveryLabel(intTableID, 221) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                Case 14
                                    str1 = ReturnRecoveryLabel(intTableID, 224) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                Case 15
                                    str1 = ReturnRecoveryLabel(intTableID, 227) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                            End Select
                            strPES = str1
                            'str1 = ReturnRecoveryLabel(intTableID, 221) ' NZ(rowsH(1).Item("CHARUSERLABEL"), "")
                            If boolCombined Then
                                If Len(str1) = 0 Then
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = "Recovery Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = "Recovery Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = "Recovery Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                    End If
                                Else
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                    End If
                                End If
                            ElseIf boolTrue Then
                                If Len(str1) = 0 Then
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                    End If
                                Else
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                    End If
                                End If
                            ElseIf boolSE Then
                                If Len(str1) = 0 Then
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                    End If
                                Else
                                    If boolRCPARatio Then
                                        If boolX Then
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                        Else
                                            str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area Ratio"
                                        End If
                                    Else
                                        str1 = str1 & ChrW(10) & "Internal Standard" & ChrW(10) & "Peak Area"
                                    End If
                                End If
                            End If


                            .Selection.TypeText(Text:=str1)
                            'column 6
                            Select Case intTableID
                                Case 13
                                    str1 = ReturnRecoveryLabel(intTableID, 222) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                Case 14
                                    str1 = ReturnRecoveryLabel(intTableID, 225) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                Case 15
                                    str1 = ReturnRecoveryLabel(intTableID, 228) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                            End Select
                            'str1 = ReturnRecoveryLabel(intTableID, 222) ' NZ(rowsH(2).Item("CHARUSERLABEL"), "")
                            If Len(str1) = 0 Then
                                If boolCombined Or boolTrue Then
                                    str1 = "%" & ChrW(10) & "Recovery"
                                ElseIf boolSE Then
                                    If BOOLMFTABLE And BOOLINCLINTSTDNMF Then
                                        str1 = "IS Normalized" & ChrW(10) & "Matrix Factor"
                                    Else
                                        '20181109 LEE: should be %
                                        str1 = "% Suppression/" & ChrW(10) & "Enhancement"
                                    End If
                                End If

                            End If

                            '
                            If boolETot And BOOLMFTABLE = False Then
                                .Selection.Tables.Item(1).Cell(1, col6).Select()
                                .Selection.TypeText(Text:=str1)

                                '20190108 LEE:
                                If boolNONELEG Then
                                Else
                                    If boolX And intNumLevels = 1 Then
                                    Else
                                        Call typeInSuperscriptFontSize12WithSpace(wd, "a")
                                        'ctLegend = ctLegend + 1 'ctlegend incremented earlier

                                        .Selection.Tables.Item(1).Cell(1, col6 + 1).Select()
                                        .Selection.TypeText(Text:=str1)
                                        Call typeInSuperscriptFontSize12WithSpace(wd, "b")
                                        'ctLegend = ctLegend + 1 'ctlegend incremented earlier
                                    End If
                                End If

                            Else
                                .Selection.Tables.Item(1).Cell(1, col6).Select()
                                .Selection.TypeText(Text:=str1)
                            End If

                        Else

                            'column 3
                            .Selection.Tables.Item(1).Cell(1, colNomConc).Select()
                            str1 = "Theoretical" & ChrW(10) & "Nominal" & ChrW(10) & "Concentration" & ChrW(10) & "(" & strConcUnits & ")"
                            'str1 = str1 & ChrW(10) & "(" & strConcUnits & ")"
                            .Selection.TypeText(Text:=str1)

                            '20181217 LEE:
                            'New logic. Use User Labels in MF column headers
                            Select Case intTableID
                                Case 13
                                    str1 = ReturnRecoveryLabel(intTableID, 220) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                Case 14
                                    str1 = ReturnRecoveryLabel(intTableID, 223) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                Case 15
                                    str1 = ReturnRecoveryLabel(intTableID, 226) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                            End Select
                            strRS = str1

                            'column 4
                            If BOOLMFTABLE Then

                                Select Case intTableID
                                    Case 13
                                        str1 = ReturnRecoveryLabel(intTableID, 221) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                    Case 14
                                        str1 = ReturnRecoveryLabel(intTableID, 224) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                    Case 15
                                        str1 = ReturnRecoveryLabel(intTableID, 227) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                End Select
                                strPES = str1 'column 5

                                'need Analyte/IS columns
                                'str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Analyte" & ChrW(10) & "Peak Area"
                                str1 = strRS & ChrW(10) & "Analyte" & ChrW(10) & "Peak Area"
                                wTbl.Cell(1, colRSAPA).Range.Text = str1

                                'str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Internal" & ChrW(10) & "Standard" & ChrW(10) & "Peak Area"
                                str1 = strRS & ChrW(10) & "Internal" & ChrW(10) & "Standard" & ChrW(10) & "Peak Area"
                                wTbl.Cell(1, colRSISPA).Range.Text = str1

                                'str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Analyte" & ChrW(10) & "Peak Area"
                                str1 = strPES & ChrW(10) & "Analyte" & ChrW(10) & "Peak Area"
                                wTbl.Cell(1, colPESAPA).Range.Text = str1

                                'str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Internal" & ChrW(10) & "Standard" & ChrW(10) & "Peak Area"
                                str1 = strPES & ChrW(10) & "Internal" & ChrW(10) & "Standard" & ChrW(10) & "Peak Area"
                                wTbl.Cell(1, colPESISPA).Range.Text = str1

                                If BOOLINCLMFCOLS Then

                                    If BOOLCALCINTSTDNMF Then
                                        str1 = "Analyte" & ChrW(10) & "Matrix" & ChrW(10) & "Factor"

                                        .Selection.Tables.Item(1).Cell(1, colAMF).Select()
                                        .Selection.TypeText(Text:=str1)
                                        '20190108 LEE:
                                        If boolNONELEG Then
                                        Else
                                            Call typeInSuperscriptFontSize12WithSpace(wd, "a")
                                            ctLegend = ctLegend + 1
                                            intLeg = intLeg + 1
                                        End If
                                     

                                        str1 = "Internal" & ChrW(10) & "Standard" & ChrW(10) & "Matrix" & ChrW(10) & "Factor"
                                        .Selection.Tables.Item(1).Cell(1, colISMF).Select()
                                        .Selection.TypeText(Text:=str1)
                                        '20190108 LEE:
                                        If boolNONELEG Then
                                        Else
                                            Call typeInSuperscriptFontSize12WithSpace(wd, "b")
                                            ctLegend = ctLegend + 1
                                            intLeg = intLeg + 1
                                        End If
                                       

                                    Else

                                        '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated

                                        'str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area" & ChrW(10) & "Ratio"
                                        str1 = strRS & ChrW(10) & "Peak Area" & ChrW(10) & "Ratio"

                                        .Selection.Tables.Item(1).Cell(1, colAMF).Select()
                                        .Selection.TypeText(Text:=str1)
                                        'Call typeInSuperscriptFontSize12WithSpace(wd, "a")

                                        'str1 = "Post" & ChrW(10) & "Extraction" & ChrW(10) & "Spike" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area" & ChrW(10) & "Ratio"
                                        str1 = strPES & ChrW(10) & "Peak Area" & ChrW(10) & "Ratio"
                                        .Selection.Tables.Item(1).Cell(1, colISMF).Select()
                                        .Selection.TypeText(Text:=str1)
                                        'Call typeInSuperscriptFontSize12WithSpace(wd, "b")

                                    End If

                                Else

                                    '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated

                                    'str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area" & ChrW(10) & "Ratio"
                                    str1 = strRS & ChrW(10) & "Peak Area" & ChrW(10) & "Ratio"

                                    .Selection.Tables.Item(1).Cell(1, colAMF).Select()
                                    .Selection.TypeText(Text:=str1)
                                    'Call typeInSuperscriptFontSize12WithSpace(wd, "a")

                                    'str1 = "Post" & ChrW(10) & "Extraction" & ChrW(10) & "Spike" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area" & ChrW(10) & "Ratio"
                                    str1 = strPES & ChrW(10) & "Peak Area" & ChrW(10) & "Ratio"
                                    .Selection.Tables.Item(1).Cell(1, colISMF).Select()
                                    .Selection.TypeText(Text:=str1)
                                    'Call typeInSuperscriptFontSize12WithSpace(wd, "b")

                                End If

                                If BOOLINCLINTSTDNMF Then

                                    str1 = "Internal" & ChrW(10) & "Standard" & ChrW(10) & "Normalized" & ChrW(10) & "Matrix" & ChrW(10) & "Factor"
                                    .Selection.Tables.Item(1).Cell(1, colISNMF).Select()
                                    .Selection.TypeText(Text:=str1)

                                    '20190108 LEE:
                                    If boolNONELEG Then
                                    Else
                                        If BOOLINCLMFCOLS Then
                                            If BOOLCALCINTSTDNMF Then
                                                Call typeInSuperscriptFontSize12WithSpace(wd, "c")
                                                ctLegend = ctLegend + 1
                                                intLeg = intLeg + 1
                                            Else
                                                '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated
                                                'Matrix Factor always has a legend
                                                Call typeInSuperscriptFontSize12WithSpace(wd, "a")
                                                ctLegend = ctLegend + 1
                                                intLeg = intLeg + 1

                                            End If
                                        Else
                                            If BOOLCALCINTSTDNMF Then
                                                'Call typeInSuperscriptFontSize12WithSpace(wd, "a,b")
                                                Call typeInSuperscriptFontSize12WithSpace(wd, "a")
                                                ctLegend = ctLegend + 1
                                                intLeg = intLeg + 1
                                            Else
                                                '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated
                                                'Matrix Factor always has a legend
                                                Call typeInSuperscriptFontSize12WithSpace(wd, "a")
                                                ctLegend = ctLegend + 1
                                                intLeg = intLeg + 1

                                            End If

                                        End If
                                    End If

                                End If

                            Else

                                Select Case intTableID
                                    Case 13
                                        str1 = ReturnRecoveryLabel(intTableID, 220) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                    Case 14
                                        str1 = ReturnRecoveryLabel(intTableID, 223) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                    Case 15
                                        str1 = ReturnRecoveryLabel(intTableID, 226) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                End Select
                                strRS = str1
                                'str1 = ReturnRecoveryLabel(intTableID, 220)
                                .Selection.Tables.Item(1).Cell(1, col4).Select()

                                If boolCombined Or boolTrue Then
                                    If Len(str1) = 0 Then
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = "Extracted" & ChrW(10) & "QC Standard" & ChrW(10) & "Peak Area"
                                            Else
                                                str1 = "Extracted" & ChrW(10) & "QC Standard" & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = "Extracted" & ChrW(10) & "QC Standard" & ChrW(10) & "Peak Area"
                                        End If
                                    Else
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = str1 & ChrW(10) & "Peak Area"
                                            Else
                                                str1 = str1 & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = str1 & ChrW(10) & "Peak Area"
                                        End If
                                    End If
                                ElseIf boolSE Then
                                    If Len(str1) = 0 Then
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area"
                                            Else
                                                'str1 = "Solution" & ChrW(10) & "QC Standard" & ChrW(10) & "Peak Area Ratio"
                                                str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area"
                                        End If
                                    Else
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = str1 & ChrW(10) & "Peak Area"
                                            Else
                                                str1 = str1 & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = str1 & ChrW(10) & "Peak Area"
                                        End If
                                    End If
                                End If

                                .Selection.TypeText(Text:=str1)


                                'column 5
                                .Selection.Tables.Item(1).Cell(1, col5).Select()
                                Select Case intTableID
                                    Case 13
                                        str1 = ReturnRecoveryLabel(intTableID, 221) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                    Case 14
                                        str1 = ReturnRecoveryLabel(intTableID, 224) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                    Case 15
                                        str1 = ReturnRecoveryLabel(intTableID, 227) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                End Select
                                strPES = str1
                                'str1 = ReturnRecoveryLabel(intTableID, 221)

                                If boolCombined Then
                                    If Len(str1) = 0 Then
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area"
                                            Else
                                                str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = "Recovery" & ChrW(10) & "Solution" & ChrW(10) & "Peak Area"
                                        End If
                                    Else
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = str1 & "Solution" & ChrW(10) & "Peak Area"
                                            Else
                                                str1 = str1 & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = str1 & ChrW(10) & "Peak Area"
                                        End If
                                    End If
                                ElseIf boolTrue Then
                                    If Len(str1) = 0 Then
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Peak Area"
                                            Else
                                                str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Peak Area"
                                        End If
                                    Else
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = str1 & ChrW(10) & "Peak Area"
                                            Else
                                                str1 = str1 & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = str1 & ChrW(10) & "Peak Area"
                                        End If
                                    End If
                                ElseIf boolSE Then
                                    If Len(str1) = 0 Then
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Peak Area"
                                            Else
                                                str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = "Post Extraction" & ChrW(10) & "Spike Solution" & ChrW(10) & "Peak Area"
                                        End If
                                    Else
                                        If boolRCPARatio Then
                                            If boolX Then
                                                str1 = str1 & ChrW(10) & "Peak Area"
                                            Else
                                                str1 = str1 & ChrW(10) & "Peak Area Ratio"
                                            End If
                                        Else
                                            str1 = str1 & ChrW(10) & "Peak Area"
                                        End If
                                    End If
                                End If

                                .Selection.TypeText(Text:=str1)

                                'column 6
                                Select Case intTableID
                                    Case 13
                                        str1 = ReturnRecoveryLabel(intTableID, 222) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                    Case 14
                                        str1 = ReturnRecoveryLabel(intTableID, 225) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                    Case 15
                                        str1 = ReturnRecoveryLabel(intTableID, 228) ' NZ(rowsH(0).Item("CHARUSERLABEL"), "")
                                End Select
                                'str1 = ReturnRecoveryLabel(intTableID, 222)
                                If Len(str1) = 0 Then
                                    If boolCombined Or boolTrue Then
                                        If Len(str1) = 0 Then
                                            str1 = "%" & ChrW(10) & "Recovery"
                                        End If
                                    ElseIf boolSE Then
                                        '20181109 LEE: should be %
                                        str1 = "% Suppression/" & ChrW(10) & "Enhancement"
                                    End If
                                End If

                                If boolETot And BOOLMFTABLE = False Then
                                    .Selection.Tables.Item(1).Cell(1, col6).Select()
                                    .Selection.TypeText(Text:=str1)
                                    '20190108 LEE:
                                    If boolNONELEG Then
                                    Else
                                        Call typeInSuperscriptFontSize12WithSpace(wd, "a")
                                    End If

                                    .Selection.Tables.Item(1).Cell(1, col6 + 1).Select()
                                    .Selection.TypeText(Text:=str1)
                                    '20190108 LEE:
                                    If boolNONELEG Then
                                    Else
                                        Call typeInSuperscriptFontSize12WithSpace(wd, "b")
                                    End If

                                Else
                                    .Selection.Tables.Item(1).Cell(1, col6).Select()
                                    .Selection.TypeText(Text:=str1)
                                End If

                            End If

                        End If

                        .Selection.Tables.Item(1).Cell(1, 1).Select()
                        'bottom border this row
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle


                        'begin entering data'
                        int1 = 3 'row position counter
                        For Count2 = 0 To intNumRuns - 1

                            .Selection.Tables.Item(1).Cell(int1, 1).Select()
                            'enter runid
                            var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")
                            .Selection.TypeText(CStr(var10))
                            If BOOLINCLUDEDATE Then
                                .Selection.Tables.Item(1).Cell(int1 + 1, 1).Select()
                                str1 = GetDateFromRunID(NZ(var10, 0), LDateFormat, intGroup, idTR)
                                .Selection.TypeText("(" & str1 & ")")
                            End If
                            .Selection.Tables.Item(1).Cell(int1, 1).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)

                            'strM = "Creating Summary of Combined Recovery Calculations and Data For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                            frmH.lblProgress.Text = strM1 & ChrW(10) & "Processing Run ID " & var10
                            frmH.Refresh()

                            'start filling in data by rows
                            'intRowsX = 0

                            ''''wdd.visible = True

                            intInc = 0

                            boolMultiMid = False
                            intCtMid = 1

                            If intNumLevels > 3 Then
                                boolMultiMid = True
                            End If

                            For Count3 = 0 To intNumLevels - 1

                                boolNAStat = False

                                varNom = tblLevels.Rows.Item(Count3).Item("NOMCONC")

                                'column 2

                                If boolX And intNumLevels = 1 Then
                                    str1 = "All QC Levels"
                                Else

                                    Dim rowsTa1() As DataRow = tbl2a.Select("NOMCONC = " & varNom) 'intRowsQC
                                    Dim rowsTb1() As DataRow = tbl2b.Select("NOMCONC = " & varNom) 'intRowsRS
                                    Dim boolTT As Boolean = False
                                    Try
                                        If rowsTa1.Length = 0 Then
                                            If rowsTb1.Length = 0 Then
                                                boolTT = True
                                                Select Case Count3
                                                    Case 0
                                                        str1 = "QC Low"
                                                    Case intNumLevels - 1
                                                        str1 = "QC High"
                                                    Case Else
                                                        If boolMultiMid Then
                                                            str1 = "QC Mid-" & intCtMid
                                                            intCtMid = intCtMid + 1
                                                        Else
                                                            str1 = "QC Mid"
                                                        End If
                                                End Select
                                                var2 = str1
                                            Else
                                                'get sample name 
                                                var2 = rowsTb1(0).Item("SAMPLENAME")
                                                'not sample name, need QC ID
                                                'may not be available if IS and intNumLevels > 1
                                                var1 = rowsTb1(0).Item("INTANALYTEID")
                                                var3 = rowsTb1(0).Item("RUNID")
                                                var2 = GetQCID(CInt(var1), CInt(var3), CSng(varNom))
                                                If Len(var2) = 0 Then
                                                    var2 = rowsTa1(0).Item("SAMPLENAME")
                                                End If
                                                'If boolX Then
                                                '    var2 = rowsTa1(0).Item("SAMPLENAME")
                                                'Else
                                                '    var1 = rowsTb1(0).Item("INTANALYTEID")
                                                '    var3 = rowsTb1(0).Item("RUNID")
                                                '    var2 = GetQCID(CInt(var1), CInt(var3), CSng(varNom))
                                                'End If
                                            End If
                                        Else
                                            'get sample name 
                                            var2 = rowsTa1(0).Item("SAMPLENAME")
                                            'not sample name, need QC ID
                                            'may not be available if IS and intNumLevels > 1
                                            var1 = rowsTa1(0).Item("INTANALYTEID")
                                            var3 = rowsTa1(0).Item("RUNID")
                                            var2 = GetQCID(CInt(var1), CInt(var3), CSng(varNom))
                                            If Len(var2) = 0 Then
                                                var2 = rowsTa1(0).Item("SAMPLENAME")
                                            End If
                                            'If boolX Then
                                            '    var2 = rowsTa1(0).Item("SAMPLENAME")
                                            'Else
                                            '    var1 = rowsTa1(0).Item("INTANALYTEID")
                                            '    var3 = rowsTa1(0).Item("RUNID")
                                            '    var2 = GetQCID(CInt(var1), CInt(var3), CSng(varNom))
                                            'End If
                                        End If

                                        If boolTT Then
                                        Else
                                            str1 = ReturnStdQC(var2.ToString)
                                        End If
                                    Catch ex As Exception
                                        var1 = var1
                                    End Try

                                End If

                                .Selection.Tables.Item(1).Cell(int1 + intInc, 2).Select()
                                .Selection.TypeText(str1)
                                If Len(strISConc) = 0 Or boolX = False Then
                                Else
                                    'activedocument.tables(1).cell(1, 1).range.text = textbox1.text
                                    str2 = "IS Concentration: " & strISConc
                                    .Selection.Tables.Item(1).Cell(int1 + intInc + 1, 2).Range.Text = str2
                                End If

                                If boolX Then
                                Else
                                    'column 3 NomConc
                                    .Selection.Tables.Item(1).Cell(int1 + intInc, colNomConc).Select()
                                    If boolLUseSigFigs Then
                                        .Selection.TypeText(CStr(DisplayNum(SigFigOrDec(varNom, LSigFig, False), LSigFig, False)))
                                    Else
                                        .Selection.TypeText(CStr(Format(varNom, GetRegrDecStr(LSigFig))))
                                    End If


                                End If


                                'column 4
                                'get average of peak areas for QC
                                'and record column 4 peak areas for QC
                                strF = "NOMCONC = " & varNom
                                strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                Erase rows2a
                                rows2a = tbl2a.Select(strF, strS)
                                int2 = rows2a.Length

                                '20181130 LEE:
                                nRS = int2

                                If int2 > UBound(arrInd, 2) Then
                                    ReDim Preserve arrInd(intIndUP, int2)
                                End If

                                If int2 = 0 Then
                                    'get boolis from previous
                                    boolIS = boolIS 'debug
                                Else
                                    var1 = rows2a(0).Item("BOOLINTSTD")
                                    If var1 = -1 Then
                                        boolIS = True
                                    Else
                                        boolIS = False
                                    End If
                                End If

                                'get all data
                                strF = ""
                                '20180126 LEE: Hmmm. This statement will exclude IS because intGroup isn't -1 in tbl2 (tblAssignedSamples)
                                'strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                If boolIS Then
                                    strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ("
                                Else
                                    strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                End If


                                ''debug
                                'If intGroup = -1 Then
                                '    Dim CountX As Int16
                                '    Dim CountY As Int16
                                '    Dim strFX As String = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR

                                '    Console.WriteLine("Start Debug")
                                '    Dim rowsABC() = tbl2.Select(strFX, strS)
                                '    var1 = ""
                                '    For CountX = 0 To tbl2.Columns.Count - 1
                                '        If CountX = 0 Then
                                '            var1 = tbl2.Columns(CountX).ColumnName
                                '        Else
                                '            var1 = var1 & ";" & tbl2.Columns(CountX).ColumnName
                                '        End If
                                '    Next
                                '    Console.WriteLine(CStr(var1))

                                '    For CountY = 0 To rowsABC.Length - 1
                                '        var1 = ""
                                '        For CountX = 0 To tbl2.Columns.Count - 1
                                '            If CountX = 0 Then
                                '                var1 = rowsABC(CountY).Item(CountX)
                                '            Else
                                '                var1 = var1 & ";" & rowsABC(CountY).Item(CountX)
                                '            End If
                                '        Next
                                '        Console.WriteLine(CStr(var1))
                                '    Next

                                '    Console.WriteLine("End Debug")
                                '    'end debug
                                'End If



                                'strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " OR ("
                                For Count4 = 0 To int2 - 1
                                    var2 = rows2a(Count4).Item("ANALYTEINDEX")
                                    var3 = rows2a(Count4).Item("MASTERASSAYID")
                                    var4 = rows2a(Count4).Item("RUNSAMPLEORDERNUMBER")
                                    var5 = rows2a(Count4).Item("ANALYTEID")

                                    If boolIS Then
                                        If Count4 <> int2 - 1 Then
                                            strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                        Else
                                            strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND  RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                        End If
                                    Else
                                        'If Count4 <> int2 - 1 Then
                                        '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                        'Else
                                        '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                        'End If
                                        If Count4 <> int2 - 1 Then
                                            strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                        Else
                                            strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                        End If
                                    End If

                                Next
                                Erase rows1

                                If int2 = 0 Then

                                    nI = 0
                                    nE = 0
                                    int3 = 0
                                    Erase rows1E

                                Else


                                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    rows1 = tbl2.Select(strF, strS)

                                    'Console.WriteLine(strF)

                                    int3 = rows1.Length
                                    nI = int3

                                    ''''''''console.writeline(strF)

                                    'now do rowsExcluded
                                    strF = ""
                                    'strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                    '20180126 LEE: Hmmm. This statement will exclude IS because intGroup isn't -1 in tbl2 (tblAssignedSamples)
                                    If boolIS Then
                                        strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ("
                                    Else
                                        strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                    End If

                                    For Count4 = 0 To int2 - 1
                                        var2 = rows2a(Count4).Item("ANALYTEINDEX")
                                        var3 = rows2a(Count4).Item("MASTERASSAYID")
                                        var4 = rows2a(Count4).Item("RUNSAMPLEORDERNUMBER")
                                        var5 = rows2a(Count4).Item("ANALYTEID")

                                        If boolIS Then
                                            If Count4 <> int2 - 1 Then
                                                strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)) OR "
                                            Else
                                                strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)))"
                                            End If
                                        Else
                                            'If Count4 <> int2 - 1 Then
                                            '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)) OR "
                                            'Else
                                            '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)))"
                                            'End If
                                            If Count4 <> int2 - 1 Then
                                                strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)) OR "
                                            Else
                                                strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)))"
                                            End If
                                        End If

                                    Next
                                    Erase rows1E
                                    'rows1E = tbl1.Select(strF)
                                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    rows1E = tbl2.Select(strF, strS)
                                    nE = rows1E.Length

                                End If


                                Erase RowsT
                                '20160820 LEE: This evaluation must include NOMCONC
                                'reset introwsRS and introwsQC
                                Dim rowsTa() As DataRow = tbl2a.Select("NOMCONC = " & varNom) 'intRowsQC
                                Dim rowsTb() As DataRow = tbl2b.Select("NOMCONC = " & varNom) 'intRowsRS
                                introwsQC = rowsTa.Length
                                introwsRS = rowsTb.Length

                                If introwsQC > introwsRS Then
                                    intRowsT = introwsQC
                                Else
                                    intRowsT = introwsRS
                                End If

                                'herehere
                                For Count4 = 0 To intRowsT - 1

                                    'Start 20161017
                                    '*****

                                    If Count4 > rows1.Length - 1 Then

                                        If boolQCNA Then
                                            
                                            If BOOLMFTABLE Then
                                                wTbl.Cell(int1 + intInc + Count4, colRSAPA).Range.Text = "NA"
                                                wTbl.Cell(int1 + intInc + Count4, colRSISPA).Range.Text = "NA"
                                            Else
                                                .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, col4).Select()
                                                .Selection.TypeText("NA")
                                            End If
                                            boolHasNA = True
                                        Else
                                            Exit For
                                        End If

                                    Else

                                        var1 = NZ(rows1(Count4).Item("ANALYTEAREA"), 0)
                                        If boolLUseSigFigsArea Then
                                            var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True)
                                        Else
                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                        End If

                                        If BOOLMFTABLE Then
                                            numRSAPA = var2
                                        End If

                                        var1 = NZ(rows1(Count4).Item("INTERNALSTANDARDAREA"), 0)
                                        If boolLUseSigFigsArea Then
                                            var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True)
                                        Else
                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                        End If

                                        If BOOLMFTABLE Then
                                            numRSISPA = var2
                                        End If

                                        '*****
                                        'End 20161017

                                        If Count4 > int3 - 1 Then
                                            If boolQCNA Then
                                                var1 = "NA"
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                var1 = ""
                                            End If

                                        Else
                                            If boolIS Then
                                                var1 = NZ(rows1(Count4).Item("INTERNALSTANDARDAREA"), 1)
                                                var3 = var1
                                            Else
                                                var1 = NZ(rows1(Count4).Item("ANALYTEAREA"), 0)
                                                varIS = NZ(rows1(Count4).Item("INTERNALSTANDARDAREA"), 1)
                                                If boolRCPARatio Then
                                                    If varIS = 0 Then
                                                        var3 = var1
                                                    Else
                                                        var3 = var1 / varIS
                                                    End If
                                                Else
                                                    var3 = var1
                                                End If

                                            End If
                                            '*****

                                            If boolIS Then

                                                If boolLUseSigFigsArea Then
                                                    var2 = SigFigArea(RoundToDecimalA(var3, LSigFigArea), LSigFigArea, False, True)
                                                Else
                                                    var2 = Format(RoundToDecimalRAFZ(var3, LSigFigArea), strAreaDec)
                                                End If

                                                var1 = var2

                                            Else

                                                If boolRCPARatio Then

                                                    If boolLUseSigFigsAreaRatio Then
                                                        var2 = SigFigAreaRatio(RoundToDecimalA(var3, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var3, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                    End If
                                                    var1 = var2
                                                Else
                                                    If boolLUseSigFigsArea Then
                                                        var1 = SigFigArea(RoundToDecimalA(var3, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var1 = Format(RoundToDecimalRAFZ(var3, LSigFigArea), strAreaDec)
                                                    End If
                                                    var1 = DisplayCommas(var1)
                                                End If

                                            End If

                                            '*****

                                        End If



                                        .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, col4).Select()
                                        '.Selection.TypeText(CStr(var1))
                                        ''''''''''''''console.writeline(CStr(rows1(Count4).Item("RUNSAMPLEORDERNUMBER")) & ", " & var1)

                                        If Count4 > int3 - 1 Then
                                            .Selection.TypeText(var1)
                                        Else
                                            var2 = NZ(rows1(Count4).Item("ELIMINATEDFLAG"), "N")
                                            var3 = NZ(rows1(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                            'check for outlier
                                            boolOut = False
                                            'MF here
                                            arrInd(10, Count4 + 1) = "N"
                                            arrInd(12, Count4 + 1) = ""
                                            If StrComp(var2, "Y", vbTextCompare) = 0 Or (var3 = -1 And gAllowExclSamples And LAllowExclSamples) Then

                                                boolOut = True
                                                arrInd(10, Count4 + 1) = "Y"

                                                boolExFromAS = False
                                                vU = 0

                                                If gAllowExclSamples And LAllowExclSamples Then
                                                    If var3 = -1 Then
                                                        var2 = "Y"
                                                        boolExFromAS = True
                                                    Else
                                                        'var1 = "N"
                                                        'don't assign "N", Watson may override
                                                    End If
                                                End If

                                                'Remember, tblAssignedSamples does not have DECISIONREASON
                                                var6 = GetDECISIONREASONValue(boolExFromAS, vAnalyteID, rows1(Count4))

                                                intExp = intExp + 1
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)
                                                arrInd(12, Count4 + 1) = strA
                                                str1 = var6 '"Value excluded from summary statistics because it is a statistical outlier according to the " & ReturnOutlierMethod() & "."

                                                'Set Legend String
                                                str1 = GetLegendStringExcluded(15, 15, vU, var6, intTableID, True, "")

                                                'Add to Legend Array
                                                ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                                '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF

                                                If BOOLMFTABLE Then
                                                    '*****

                                                    var1 = NZ(rows1(Count4).Item("ANALYTEAREA"), 0)
                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If

                                                    wTbl.Cell(int1 + intInc + Count4, colRSAPA).Range.Text = var2.ToString
                                                    wTbl.Cell(int1 + intInc + Count4, colRSAPA).Select()
                                                    If boolRedBoldFont Then
                                                        .Selection.Font.Bold = True
                                                        .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    End If
                                                    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine)
                                                    Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                    If BOOLMFTABLE Then
                                                        numRSAPA = var2
                                                    End If

                                                    '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                    If Count4 + 1 > UBound(arrInd, 2) Then
                                                    Else
                                                        arrInd(4, Count4 + 1) = var2
                                                    End If

                                                    var1 = NZ(rows1(Count4).Item("INTERNALSTANDARDAREA"), 0)
                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If

                                                    wTbl.Cell(int1 + intInc + Count4, colRSISPA).Range.Text = var2.ToString
                                                    wTbl.Cell(int1 + intInc + Count4, colRSISPA).Select()
                                                    If boolRedBoldFont Then
                                                        .Selection.Font.Bold = True
                                                        .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    End If
                                                    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine)
                                                    Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                    If BOOLMFTABLE Then
                                                        numRSISPA = var2
                                                    End If

                                                    '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                    If Count4 + 1 > UBound(arrInd, 2) Then
                                                    Else
                                                        arrInd(5, Count4 + 1) = var2

                                                    End If

                                                    '*****
                                                Else

                                                    If boolRedBoldFont Then
                                                        .Selection.Font.Bold = True
                                                        .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    End If

                                                    .Selection.TypeText(CStr(var1))
                                                    Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                                    var2 = var1

                                                End If

                                            Else

                                                If BOOLMFTABLE Then

                                                    var1 = NZ(rows1(Count4).Item("ANALYTEAREA"), 0)
                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If

                                                    wTbl.Cell(int1 + intInc + Count4, colRSAPA).Range.Text = var2.ToString
                                                    If BOOLMFTABLE Then
                                                        numRSAPA = var2
                                                    End If

                                                    '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                    If Count4 + 1 > UBound(arrInd, 2) Then
                                                    Else
                                                        arrInd(4, Count4 + 1) = var2
                                                    End If

                                                    var1 = NZ(rows1(Count4).Item("INTERNALSTANDARDAREA"), 0)
                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If

                                                    wTbl.Cell(int1 + intInc + Count4, colRSISPA).Range.Text = var2.ToString
                                                    If BOOLMFTABLE Then
                                                        numRSISPA = var2
                                                    End If

                                                    '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                    If Count4 + 1 > UBound(arrInd, 2) Then
                                                    Else
                                                        arrInd(5, Count4 + 1) = var2
                                                    End If

                                                Else
                                                    .Selection.TypeText(CStr(var1))
                                                    var2 = var1
                                                End If

                                            End If

                                        End If

                                        '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                        If Count4 + 1 > UBound(arrInd, 2) Then
                                        Else
                                            arrInd(1, Count4 + 1) = var2 'var1
                                            If boolOut Then
                                                arrInd(10, Count4 + 1) = "Y"
                                            Else
                                                arrInd(10, Count4 + 1) = "N"
                                            End If
                                        End If

                                    End If

                                Next Count4

                                'now dow Means, SD, etc
                                'enter titles
                                int2 = -1
                                If boolQCREPORTACCVALUES Then

                                Else

                                    If boolE(Count3) Then
                                        int2 = int2 + 1
                                        '***
                                        '.Selection.Tables.Item(1).Cell(int1 + intInc + Count4, col4).Select()
                                        '***
                                        '.Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colNomConc).Select()
                                        If boolX Then
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colQCID + 1).Select()
                                        Else
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colNomConc + 1).Select()
                                        End If

                                        '.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                                        .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=3, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                                        '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                        Try
                                            .Selection.Cells.Merge()
                                        Catch ex As Exception

                                        End Try
                                        .Selection.TypeText(Text:="Summary Statistics Excluding Outlier Values")

                                        With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                            .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                        End With

                                    End If
                                End If

                                intStart = int2
                                intRowCol6 = int1 + intInc + intRowsT + 1 + int2 + 1

                                If boolX Then
                                    Call typeStatsLabels(wd, int2, int1 + intInc + intRowsT + 1, colQCID, True)
                                Else
                                    Call typeStatsLabels(wd, int2, int1 + intInc + intRowsT + 1, colNomConc, True)
                                End If


                                If boolQCREPORTACCVALUES Then
                                    intStart = -1
                                Else
                                    If boolE(Count3) Then
                                        int2 = int2 + 2
                                        intRowCol6I = int1 + intInc + intRowsT + 1 + int2 + 1

                                        '***
                                        '.Selection.Tables.Item(1).Cell(int1 + intInc + Count4, col4).Select()
                                        '***

                                        If boolX Then
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colQCID + 1).Select()
                                        Else
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colNomConc + 1).Select()
                                        End If


                                        '.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                                        .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=3, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                                        '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                        Try
                                            .Selection.Cells.Merge()
                                        Catch ex As Exception

                                        End Try
                                        .Selection.TypeText(Text:="Summary Statistics Including Outlier Values")

                                        '.Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colNomConc).Select()
                                        '.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                        '.Selection.TypeText(Text:="Summary Statistics Including Outlier Values")
                                        '.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                                        ''.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                        '.Selection.Cells.Merge()
                                        With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                            .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                        End With

                                        If boolX Then
                                            Call typeStatsLabels(wd, int2, int1 + intInc + intRowsT + 1, colQCID, True)
                                        Else
                                            Call typeStatsLabels(wd, int2, int1 + intInc + intRowsT + 1, colNomConc, True)
                                        End If

                                        intStart = 0

                                    End If
                                End If

                                int2 = intStart
                                If boolSTATSMEAN Then
                                    Try

                                        int2 = int2 + 1

                                        If BOOLMFTABLE Then

                                            For Count4 = 1 To 2
                                                Select Case Count4
                                                    Case 1
                                                        var1 = MeanDR(rows1E, "ANALYTEAREA", False, "gaga", False, False)
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSAPA).Select()
                                                    Case 2
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSISPA).Select()
                                                        var1 = MeanDR(rows1E, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                End Select

                                                If nE = 0 Then
                                                    .Selection.TypeText("NA")
                                                    boolHasNA = True 'for legend purposes
                                                    var2 = 0
                                                    boolNAStat = True
                                                Else

                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    .Selection.TypeText(DisplayCommas(var2))

                                                    Select Case Count4
                                                        Case 1
                                                            numMeanRSAPA = var2
                                                        Case 2
                                                            numMeanRSISPA = var2
                                                    End Select

                                                End If

                                            Next Count4

                                        Else

                                            'do mean
                                            If boolIS Then
                                                var1 = MeanDR(rows1E, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                            Else
                                                var1 = MeanDR(rows1E, "ANALYTEAREA", False, "gaga", False, False)
                                            End If

                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()

                                            If nE = 0 Then
                                                .Selection.TypeText("NA")
                                                boolHasNA = True 'for legend purposes
                                                var2 = 0
                                                boolNAStat = True
                                            Else

                                                '*****
                                                If boolIS Then
                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    .Selection.TypeText(DisplayCommas(var2))

                                                    '20181130 LEE:
                                                    numMeanRSISPA = var2

                                                Else
                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                        .Selection.TypeText(CStr(var2))
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        .Selection.TypeText(DisplayCommas(var2))
                                                    End If

                                                    '20181130 LEE:
                                                    numMeanRSAPA = var2
                                                End If
                                              
                                            End If

                                            '*****

                                            If boolCombined Or boolTrue Then 'QC
                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecMeanQC", var2, CSng(var10), Count1, strDo, 0, 0, False)
                                            ElseIf boolSE Then 'RS
                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecMeanRS", var2, CSng(var10), Count1, strDo, 0, 0, False)
                                            End If

                                            numA = var2
                                            numMean = numA
                                            numMeanFP = CDec(var1)
                                            numAFP = CDec(var1)

                                        End If


                                    Catch ex As Exception

                                    End Try

                                End If

                                If boolSTATSSD Then
                                    Try
                                        'do SD
                                        int2 = int2 + 1

                                        If BOOLMFTABLE Then

                                            For Count4 = 1 To 2
                                                Select Case Count4
                                                    Case 1
                                                        var1 = StdDevDR(rows1E, "ANALYTEAREA", False, "gaga", False, False)
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSAPA).Select()
                                                    Case 2
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSISPA).Select()
                                                        var1 = StdDevDR(rows1E, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                End Select

                                                If nE = 0 Then
                                                    .Selection.TypeText("NA")
                                                    boolHasNA = True 'for legend purposes
                                                    var2 = 0
                                                    boolNAStat = True
                                                Else

                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    .Selection.TypeText(DisplayCommas(var2))

                                                    Select Case Count4
                                                        Case 1
                                                            numSDRSAPA = var2
                                                        Case 2
                                                            numSDRSISPA = var2
                                                    End Select

                                                End If

                                            Next Count4

                                        Else
                                            If nE < gSDMax Then
                                                var2 = "NA"
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                If boolIS Then
                                                    var1 = StdDevDR(rows1E, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                Else
                                                    var1 = StdDevDR(rows1E, "ANALYTEAREA", False, "gaga", False, False)
                                                End If


                                                '*****

                                                If boolIS Then
                                                    If boolLUseSigFigsArea Then
                                                        var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    var2 = var1
                                                Else
                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                    End If
                                                End If

                                                '*****

                                                numSD = var2


                                                '''''wdd.visible = True

                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()

                                                If nE < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    If boolIS Then
                                                        .Selection.TypeText(DisplayCommas(var2))
                                                    Else
                                                        If boolRCPARatio Then
                                                            .Selection.TypeText(CStr(var2))
                                                        Else
                                                            .Selection.TypeText(DisplayCommas(var2))
                                                        End If
                                                    End If

                                                End If

                                            End If

                                        End If


                                    Catch ex As Exception

                                    End Try

                                End If
                                If boolSTATSCV Then
                                    Try
                                        'do %CV: numSD / numMean
                                        int2 = int2 + 1

                                        If BOOLMFTABLE Then

                                            For Count4 = 1 To 2

                                                Select Case Count4
                                                    Case 1
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSAPA).Select()
                                                    Case 2
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSISPA).Select()
                                                End Select

                                                If nE < gSDMax Then
                                                    var2 = "NA"
                                                    boolHasNA = True 'for legend purposes
                                                    .Selection.TypeText(var2)
                                                Else

                                                    Select Case Count4
                                                        Case 1
                                                            numPrec = CalcCVPercent(numSDRSAPA, numMeanRSAPA, intQCDec)
                                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                                        Case 2
                                                            numPrec = CalcCVPercent(numSDRSISPA, numMeanRSISPA, intQCDec)
                                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                                    End Select

                                                End If

                                            Next Count4

                                        Else
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()

                                            If nE < gSDMax Then
                                                var2 = "NA"
                                                boolHasNA = True 'for legend purposes
                                                .Selection.TypeText(var2)
                                            Else

                                                numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                .Selection.TypeText(Format(numPrec, strQCDec))

                                                If boolCombined Or boolTrue Then 'QC
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecPrecQC", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                ElseIf boolSE Then 'RS
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecPrecRS", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                End If

                                            End If
                                        End If



                                    Catch ex As Exception

                                    End Try

                                End If

                                If boolSTATSBIAS And boolSTATSMEAN And BOOLMFTABLE = False Then
                                    'do %Bias: Mean/Nominal
                                    Try
                                        int2 = int2 + 1

                                        'End If
                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                        Try

                                            numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                            If nE = 0 Then
                                                .Selection.TypeText("NA")
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                .Selection.TypeText(Format(numBias, strQCDec))
                                            End If


                                        Catch ex As Exception
                                            var2 = "NA"
                                            boolHasNA = True 'for legend purposes
                                            .Selection.TypeText(var2)
                                        End Try

                                    Catch ex As Exception

                                    End Try

                                End If

                                If boolTHEORETICAL And boolSTATSMEAN And BOOLMFTABLE = False Then
                                    'do %Bias: Mean/Nominal
                                    Try
                                        int2 = int2 + 1

                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                        Try
                                            'var1 = Format((((numMean / numNomConc) - 1) * 100), strQCDec)
                                            'var2 = Format(100 + CDec(var1), strQCDec)

                                            numTheor = CalcREPercent(numMean, numNomConc, intQCDec)
                                            numTheor = 100 + CDec(numTheor)

                                            If nE = 0 Then
                                                .Selection.TypeText("NA")
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                .Selection.TypeText(Format(numTheor, strQCDec))
                                            End If


                                        Catch ex As Exception
                                            var2 = "NA"
                                            boolHasNA = True 'for legend purposes
                                            .Selection.TypeText(var2)
                                        End Try



                                    Catch ex As Exception

                                    End Try

                                End If

                                If boolSTATSDIFF And boolSTATSMEAN And BOOLMFTABLE = False Then
                                    'do %Diff: Mean/Nominal
                                    Try
                                        int2 = int2 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                        Try
                                            numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                            If nE = 0 Then
                                                .Selection.TypeText("NA")
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                .Selection.TypeText(Format(numBias, strQCDec))
                                            End If


                                        Catch ex As Exception
                                            var2 = "NA"
                                            boolHasNA = True 'for legend purposes
                                            .Selection.TypeText(var2)
                                        End Try

                                    Catch ex As Exception

                                    End Try

                                End If

                                If BOOLSTATSRE And boolSTATSMEAN And BOOLMFTABLE = False Then
                                    'do %RE: Mean/Nominal
                                    Try
                                        int2 = int2 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                        Try
                                            numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                            If nE = 0 Then
                                                .Selection.TypeText("NA")
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                .Selection.TypeText(Format(numBias, strQCDec))
                                            End If


                                        Catch ex As Exception
                                            var2 = "NA"
                                            boolHasNA = True 'for legend purposes
                                            .Selection.TypeText(var2)
                                        End Try

                                    Catch ex As Exception

                                    End Try

                                End If

                                Try
                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "n", nE, CSng(var10), Count1, strDo, 0, 0, False)
                                Catch ex As Exception

                                End Try
                                If boolSTATSN Then
                                    Try
                                        'n
                                        int2 = int2 + 1
                                        If BOOLMFTABLE Then
                                            For Count4 = 1 To 2
                                                Select Case Count4
                                                    Case 1
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSAPA).Select()
                                                        intNRSAPA = nE
                                                        .Selection.TypeText(CStr(intNRSAPA))
                                                    Case 2
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSISPA).Select()
                                                        intNRSISPA = nE
                                                        .Selection.TypeText(CStr(intNRSISPA))
                                                End Select
                                            Next Count4
                                        Else
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                            .Selection.TypeText(CStr(nE))
                                        End If



                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolQCREPORTACCVALUES Then
                                Else
                                    If boolE(Count3) Then

                                        boolNAStat = False
                                        int2 = int2 + 2

                                        If boolSTATSMEAN Then

                                            int2 = int2 + 1



                                            Try
                                                'do mean
                                                If BOOLMFTABLE Then
                                                    For Count4 = 1 To 2
                                                        Select Case Count4
                                                            Case 1
                                                                var1 = MeanDR(rows1, "ANALYTEAREA", False, "gaga", False, False)
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSAPA).Select()
                                                            Case 2
                                                                var1 = MeanDR(rows1, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSISPA).Select()
                                                        End Select

                                                        If nI = 0 Then
                                                            .Selection.TypeText("NA")
                                                            boolHasNA = True 'for legend purposes
                                                            var2 = 0
                                                            boolNAStat = True
                                                        Else
                                                            '*****
                                                            If boolLUseSigFigsArea Then
                                                                var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                            Else
                                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                            End If
                                                            .Selection.TypeText(DisplayCommas(var2))

                                                            Select Case Count4
                                                                Case 1
                                                                    numMeanRSAPA_Out = var2
                                                                Case 2
                                                                    numMeanRSISPA_Out = var2
                                                            End Select

                                                            '*****
                                                        End If

                                                    Next Count4

                                                Else

                                                    If boolIS Then
                                                        var1 = MeanDR(rows1, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                    Else
                                                        var1 = MeanDR(rows1, "ANALYTEAREA", False, "gaga", False, False)
                                                    End If

                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()

                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                        boolHasNA = True 'for legend purposes
                                                        var2 = 0
                                                        boolNAStat = True
                                                    Else
                                                        '*****
                                                        If boolIS Then
                                                            If boolLUseSigFigsArea Then
                                                                var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                            Else
                                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                            End If
                                                            .Selection.TypeText(DisplayCommas(var2))
                                                        Else
                                                            If boolRCPARatio Then
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                                Else
                                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                                End If
                                                                .Selection.TypeText(CStr(var2))
                                                            Else
                                                                If boolLUseSigFigsArea Then
                                                                    var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                                Else
                                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                                End If
                                                                .Selection.TypeText(DisplayCommas(var2))

                                                            End If
                                                        End If

                                                        '*****
                                                    End If

                                                    numAI = var2
                                                    numMean = numAI
                                                    numMeanFP = CDec(var1)
                                                    numAIFP = CDec(var1)

                                                End If

                                            Catch ex As Exception

                                            End Try

                                        End If
                                        If boolSTATSSD Then
                                            Try
                                                'do SD
                                                int2 = int2 + 1

                                                If BOOLMFTABLE Then

                                                    For Count4 = 1 To 2

                                                        If nI < gSDMax Then
                                                            var2 = "NA"
                                                            boolHasNA = True 'for legend purposes
                                                        Else
                                                            Select Case Count4
                                                                Case 1
                                                                    var1 = StdDevDR(rows1, "ANALYTEAREA", False, "gaga", False, False)
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSAPA).Select()
                                                                Case 2
                                                                    var1 = StdDevDR(rows1, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSISPA).Select()
                                                            End Select

                                                            If boolLUseSigFigsArea Then
                                                                var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                            Else
                                                                var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                            End If
                                                            var2 = var1
                                                        End If

                                                        Select Case Count4
                                                            Case 1
                                                                numSDRSAPA = var2
                                                            Case 2
                                                                numSDRSISPA = var2
                                                        End Select


                                                        If nI < gSDMax Then
                                                            .Selection.TypeText("NA")
                                                        Else
                                                            If boolIS Then
                                                                .Selection.TypeText(DisplayCommas(var2))
                                                            Else
                                                                If boolRCPARatio Then
                                                                    .Selection.TypeText(CStr(var2))
                                                                Else
                                                                    .Selection.TypeText(DisplayCommas(var2))
                                                                End If
                                                            End If

                                                        End If

                                                    Next Count4

                                                Else

                                                    If nI < gSDMax Then
                                                        var2 = "NA"
                                                        boolHasNA = True 'for legend purposes
                                                    Else
                                                        If boolIS Then
                                                            var1 = StdDevDR(rows1, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                        Else
                                                            var1 = StdDevDR(rows1, "ANALYTEAREA", False, "gaga", False, False)
                                                        End If


                                                        '*****
                                                        If boolIS Then
                                                            If boolLUseSigFigsArea Then
                                                                var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                            Else
                                                                var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                            End If
                                                            var2 = var1
                                                        Else
                                                            If boolRCPARatio Then
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                                Else
                                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                                End If
                                                                '.Selection.TypeText(CStr(var2))
                                                            Else
                                                                If boolLUseSigFigsArea Then
                                                                    var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                                Else
                                                                    var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                                End If
                                                                var2 = var1
                                                                '.Selection.TypeText(DisplayCommas(var2))
                                                            End If
                                                        End If

                                                        '*****

                                                        numSD = var2

                                                    End If
                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                                    If nI < gSDMax Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        If boolIS Then
                                                            .Selection.TypeText(DisplayCommas(var2))
                                                        Else
                                                            If boolRCPARatio Then
                                                                .Selection.TypeText(CStr(var2))
                                                            Else
                                                                .Selection.TypeText(DisplayCommas(var2))
                                                            End If
                                                        End If

                                                    End If

                                                End If



                                            Catch ex As Exception

                                            End Try

                                        End If

                                        If boolSTATSCV Then
                                            Try
                                                'do %CV: numSD / numMean
                                                int2 = int2 + 1

                                                If BOOLMFTABLE Then
                                                    For Count4 = 1 To 2

                                                        If nI < gSDMax Then
                                                            var2 = "NA"
                                                            boolHasNA = True 'for legend purposes

                                                        Else
                                                            Select Case Count4
                                                                Case 1
                                                                    numPrec = CalcCVPercent(numSDRSAPA, numMeanRSAPA, intQCDec)
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSAPA).Select()
                                                                Case 2
                                                                    numPrec = CalcCVPercent(numSDRSISPA, numMeanRSISPA, intQCDec)
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSISPA).Select()
                                                            End Select
                                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                                        End If

                                                        If nI < gSDMax Then
                                                            .Selection.TypeText(var2)
                                                        End If

                                                    Next Count4
                                                Else

                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                                    If nI < gSDMax Then
                                                        var2 = "NA"
                                                        boolHasNA = True 'for legend purposes
                                                        .Selection.TypeText(var2)
                                                    Else
                                                        numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                        .Selection.TypeText(Format(numPrec, strQCDec))
                                                    End If

                                                End If




                                            Catch ex As Exception

                                            End Try

                                        End If
                                        If boolSTATSBIAS And boolSTATSMEAN And BOOLMFTABLE = False Then
                                            'do %Bias: Mean/Nominal
                                            Try
                                                int2 = int2 + 1

                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                                Try
                                                    'var1 = ((numMean / numNomConc) - 1) * 100
                                                    'var2 = Format(var1, strQCDec)

                                                    numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                        boolHasNA = True 'for legend purposes
                                                    Else
                                                        .Selection.TypeText(Format(numBias, strQCDec))
                                                    End If

                                                Catch ex As Exception
                                                    var2 = "NA"
                                                    boolHasNA = True 'for legend purposes
                                                    .Selection.TypeText(var2)
                                                End Try



                                            Catch ex As Exception

                                            End Try

                                        End If

                                        If boolTHEORETICAL And boolSTATSMEAN And BOOLMFTABLE = False Then
                                            'do %Theoretical: 100 + Mean/Nominal
                                            Try
                                                int2 = int2 + 1

                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                                Try
                                                    'var1 = Format((((numMean / numNomConc) - 1) * 100), strQCDec)
                                                    'var2 = Format(100 + CDec(var1), strQCDec)

                                                    numTheor = CalcREPercent(numMean, numNomConc, intQCDec)
                                                    numTheor = 100 + CDec(numTheor)
                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                        boolHasNA = True 'for legend purposes
                                                    Else
                                                        .Selection.TypeText(Format(numTheor, strQCDec))
                                                    End If

                                                Catch ex As Exception
                                                    var2 = "NA"
                                                    boolHasNA = True 'for legend purposes
                                                    .Selection.TypeText(var2)
                                                End Try



                                            Catch ex As Exception

                                            End Try

                                        End If

                                        If boolSTATSDIFF And boolSTATSMEAN And BOOLMFTABLE = False Then
                                            'do %Diff: Mean/Nominal
                                            Try
                                                int2 = int2 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                                Try
                                                    numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                        boolHasNA = True 'for legend purposes
                                                    Else
                                                        .Selection.TypeText(Format(numBias, strQCDec))
                                                    End If

                                                Catch ex As Exception
                                                    var2 = "NA"
                                                    boolHasNA = True 'for legend purposes
                                                    .Selection.TypeText(var2)
                                                End Try

                                            Catch ex As Exception

                                            End Try

                                        End If

                                        If BOOLSTATSRE And boolSTATSMEAN And BOOLMFTABLE = False Then
                                            'do %RE: Mean/Nominal
                                            Try
                                                int2 = int2 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                                Try
                                                    numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                        boolHasNA = True 'for legend purposes
                                                    Else
                                                        .Selection.TypeText(Format(numBias, strQCDec))
                                                    End If

                                                Catch ex As Exception
                                                    var2 = "NA"
                                                    boolHasNA = True 'for legend purposes
                                                    .Selection.TypeText(var2)
                                                End Try

                                            Catch ex As Exception

                                            End Try

                                        End If

                                        If boolSTATSN Then
                                            Try
                                                'n
                                                int2 = int2 + 1
                                                If BOOLMFTABLE Then
                                                    For Count4 = 1 To 2
                                                        Select Case Count4
                                                            Case 1
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSAPA).Select()
                                                                .Selection.TypeText(CStr(nI))
                                                                intNRSAPA = nI
                                                            Case 2
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, colRSISPA).Select()
                                                                .Selection.TypeText(CStr(nI))
                                                                intNRSISPA = nI
                                                        End Select
                                                    Next Count4
                                                Else
                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col4).Select()
                                                    .Selection.TypeText(CStr(nI))
                                                End If


                                            Catch ex As Exception

                                            End Try
                                        End If

                                    End If
                                End If

                                'column 5
                                'get average of peak areas for RS (PES for Sup/Enh or MF)
                                strF = "NOMCONC = " & varNom
                                strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                Erase rows2b
                                rows2b = tbl2b.Select(strF, strS)
                                int2 = rows2b.Length

                                '20181130 LEE
                                nPES = int2
                                If nRS <> nPES Then
                                    boolMeanRS = True
                                Else
                                    boolMeanRS = False
                                End If

                                If int2 > UBound(arrInd, 2) Then
                                    ReDim Preserve arrInd(intIndUP, int2)
                                End If

                                'here
                                If int2 = 0 Then
                                    'get boolis from previous
                                    boolIS = boolIS 'debug
                                Else
                                    var1 = rows2b(0).Item("BOOLINTSTD")
                                    If var1 = -1 Then
                                        boolIS = True
                                    Else
                                        boolIS = False
                                    End If
                                End If

                                strF = ""
                                'strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                '20180126 LEE: Hmmm. This statement will exclude IS because intGroup isn't -1 in tbl2 (tblAssignedSamples)
                                If boolIS Then
                                    strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ("
                                Else
                                    strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                End If

                                For Count4 = 0 To int2 - 1
                                    var2 = rows2b(Count4).Item("ANALYTEINDEX")
                                    var3 = rows2b(Count4).Item("MASTERASSAYID")
                                    var4 = rows2b(Count4).Item("RUNSAMPLEORDERNUMBER")
                                    var5 = rows2b(Count4).Item("ANALYTEID")

                                    If boolIS Then
                                        If Count4 <> int2 - 1 Then
                                            strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                        Else
                                            strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND  RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                        End If
                                    Else
                                        'If Count4 <> int2 - 1 Then
                                        '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                        'Else
                                        '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                        'End If
                                        If Count4 <> int2 - 1 Then
                                            strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & ") OR "
                                        Else
                                            strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & "))"
                                        End If
                                    End If

                                Next
                                Erase rows3

                                If int2 = 0 Then
                                    nI = 0
                                    nE = 0
                                    int3 = 0
                                    Erase rows3E
                                Else
                                    'rows3 = tbl1.Select(strF)
                                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    rows3 = tbl2.Select(strF, strS)
                                    int3 = rows3.Length 'debug
                                    nI = int3

                                    strF = ""
                                    'strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                    '20180126 LEE: Hmmm. This statement will exclude IS because intGroup isn't -1 in tbl2 (tblAssignedSamples)
                                    If boolIS Then
                                        strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ("
                                    Else
                                        strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND INTGROUP = " & intGroup & " AND ("
                                    End If

                                    For Count4 = 0 To int2 - 1
                                        var2 = rows2b(Count4).Item("ANALYTEINDEX")
                                        var3 = rows2b(Count4).Item("MASTERASSAYID")
                                        var4 = rows2b(Count4).Item("RUNSAMPLEORDERNUMBER")
                                        var5 = rows2b(Count4).Item("ANALYTEID")

                                        If boolIS Then
                                            If Count4 <> int2 - 1 Then
                                                strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)) OR "
                                            Else
                                                strF = strF & "(BOOLINTSTD = -1 AND RUNID = " & var10 & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)))"
                                            End If
                                        Else
                                            'If Count4 <> int2 - 1 Then
                                            '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)) OR "
                                            'Else
                                            '    strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND ANALYTEINDEX = " & var2 & " AND MASTERASSAYID = " & var3 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)))"
                                            'End If
                                            If Count4 <> int2 - 1 Then
                                                strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)) OR "
                                            Else
                                                strF = strF & "(BOOLINTSTD = 0 AND RUNID = " & var10 & " AND ANALYTEID = " & var5 & " AND RUNSAMPLEORDERNUMBER = " & var4 & " AND ((ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)) AND (BOOLEXCLSAMPLE = 0 OR BOOLEXCLSAMPLE IS NULL)))"
                                            End If
                                        End If

                                    Next

                                    Erase rows3E
                                    'rows3E = tbl1.Select(strF)
                                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    strS = "NOMCONC ASC, RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                                    rows3E = tbl2.Select(strF, strS)
                                    nE = rows3E.Length 'debug
                                    intNPESAPA = nE
                                    intNPESISPA = nE

                                End If

                                'get excluded

                                For Count4 = 0 To intRowsT - 1

                                    If Count4 > rows3.Length - 1 Then

                                        If boolQCNA Then

                                            If BOOLMFTABLE Then
                                                wTbl.Cell(int1 + intInc + Count4, colRSAPA).Range.Text = "NA"
                                                wTbl.Cell(int1 + intInc + Count4, colRSISPA).Range.Text = "NA"
                                            Else
                                                .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, col4).Select()
                                                .Selection.TypeText("NA")
                                            End If
                                            boolHasNA = True
                                        Else
                                            Exit For
                                        End If

                                    Else

                                        If Count4 > int3 - 1 Then
                                            'var1 = "NA"
                                            'boolHasNA = True 'for legend purposes

                                            If boolQCNA Then
                                                var1 = "NA"
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                var1 = ""
                                            End If

                                        Else
                                            If boolIS Then
                                                var1 = NZ(rows3(Count4).Item("INTERNALSTANDARDAREA"), 1)
                                                'var1 = RoundToDecimalRAFZ(var1, 0)
                                                var3 = var1
                                            Else
                                                var1 = NZ(rows3(Count4).Item("ANALYTEAREA"), 0)
                                                'var1 = RoundToDecimalRAFZ(var1, 0)
                                                varIS = NZ(rows3(Count4).Item("INTERNALSTANDARDAREA"), 1)
                                                'varIS = RoundToDecimalRAFZ(varIS, 0)
                                                If boolRCPARatio Then
                                                    If varIS = 0 Then
                                                        var3 = var1
                                                    Else
                                                        var3 = var1 / varIS
                                                    End If
                                                Else
                                                    var3 = var1
                                                End If
                                            End If
                                            '*****

                                            If boolIS Then

                                                If boolLUseSigFigsArea Then
                                                    var1 = SigFigArea(RoundToDecimalA(var3, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    var1 = Format(RoundToDecimalRAFZ(var3, LSigFigArea), strAreaDec)
                                                End If

                                            Else

                                                If boolRCPARatio Then

                                                    If boolLUseSigFigsAreaRatio Then
                                                        var2 = SigFigAreaRatio(RoundToDecimalA(var3, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var3, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                    End If
                                                    var1 = var2
                                                Else
                                                    If boolLUseSigFigsArea Then
                                                        var1 = SigFigArea(RoundToDecimalA(var3, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var1 = Format(RoundToDecimalRAFZ(var3, LSigFigArea), strAreaDec)
                                                    End If
                                                    var1 = DisplayCommas(var1)
                                                End If

                                            End If

                                        End If

                                        .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, col5).Select()

                                        If Count4 > int3 - 1 Then

                                            If BOOLMFTABLE Then
                                                For Count5 = 1 To 2
                                                    Select Case Count5
                                                        Case 1
                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colPESAPA).Select()
                                                        Case 2
                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colPESISPA).Select()
                                                    End Select
                                                Next Count5
                                            Else
                                                .Selection.TypeText(CStr(var1))
                                            End If

                                        Else

                                            var2 = NZ(rows3(Count4).Item("ELIMINATEDFLAG"), "N")
                                            var3 = NZ(rows3(Count4).Item("BOOLEXCLSAMPLE"), 0)
                                            'check for outlier
                                            boolOut = False
                                            arrInd(11, Count4 + 1) = "N"
                                            'arrInd(12, Count4 + 1) = ""'do not set this to blank here
                                            If StrComp(var2, "Y", vbTextCompare) = 0 Or (var3 = -1 And gAllowExclSamples And LAllowExclSamples) Then

                                                arrInd(11, Count4 + 1) = "Y"

                                                boolExFromAS = False
                                                boolOut = True

                                                If gAllowExclSamples And LAllowExclSamples Then
                                                    If var3 = -1 Then
                                                        var2 = "Y"
                                                        boolExFromAS = True
                                                    Else
                                                        'var1 = "N"
                                                        'don't assign "N", Watson may override
                                                    End If
                                                End If

                                                'Remember, tblAssignedSamples does not have DECISIONREASON
                                                var6 = GetDECISIONREASONValue(boolExFromAS, vAnalyteID, rows3(Count4))

                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)
                                                arrInd(12, Count4 + 1) = strA
                                                str1 = var6 '"Value excluded from summary statistics because it is a statistical outlier according to the " & ReturnOutlierMethod() & "."

                                                'Set Legend String
                                                str1 = GetLegendStringExcluded(15, 15, 0, var6, intTableID, True, "")

                                                'Add to Legend Array
                                                ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                                If BOOLMFTABLE Then

                                                    For Count5 = 1 To 2
                                                        Select Case Count5
                                                            Case 1
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colPESAPA).Select()
                                                                var3 = NZ(rows3(Count4).Item("ANALYTEAREA"), 0)
                                                                If boolLUseSigFigsArea Then
                                                                    var1 = SigFigArea(RoundToDecimalA(var3, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                                Else
                                                                    var1 = Format(RoundToDecimalRAFZ(var3, LSigFigArea), strAreaDec)
                                                                End If
                                                                numPESAPA = var1
                                                                .Selection.TypeText(DisplayCommas(var1))

                                                                '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                                If Count4 + 1 > UBound(arrInd, 2) Then
                                                                Else
                                                                    arrInd(6, Count4 + 1) = var1
                                                                End If

                                                            Case 2
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colPESISPA).Select()
                                                                var3 = NZ(rows3(Count4).Item("INTERNALSTANDARDAREA"), 0)
                                                                If boolLUseSigFigsArea Then
                                                                    var1 = SigFigArea(RoundToDecimalA(var3, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                                Else
                                                                    var1 = Format(RoundToDecimalRAFZ(var3, LSigFigArea), strAreaDec)
                                                                End If
                                                                numPESISPA = var1
                                                                .Selection.TypeText(DisplayCommas(var1))

                                                                '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                                If Count4 + 1 > UBound(arrInd, 2) Then
                                                                Else
                                                                    arrInd(7, Count4 + 1) = var1
                                                                End If

                                                        End Select

                                                        If boolRedBoldFont Then
                                                            .Selection.Font.Bold = True
                                                            .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        End If

                                                        .Selection.TypeText(CStr(var1))

                                                        Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                                    Next Count5

                                                Else
                                                    If boolRedBoldFont Then
                                                        .Selection.Font.Bold = True
                                                        .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    End If

                                                    .Selection.TypeText(DisplayCommas(var1))

                                                    Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                                End If

                                            Else
                                                If BOOLMFTABLE Then
                                                    For Count5 = 1 To 2
                                                        Select Case Count5
                                                            Case 1
                                                                'wTbl.Cell(int1 + intInc + Count4, colRSISPA).Range.Text = var2.ToString
                                                                'wTbl.Cell(int1 + intInc + Count4, colPESAPA).Select()
                                                                var3 = NZ(rows3(Count4).Item("ANALYTEAREA"), 0)
                                                                If boolLUseSigFigsArea Then
                                                                    var1 = SigFigArea(RoundToDecimalA(var3, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                                Else
                                                                    var1 = Format(RoundToDecimalRAFZ(var3, LSigFigArea), strAreaDec)
                                                                End If
                                                                numPESAPA = var1
                                                                var2 = DisplayCommas(var1)
                                                                wTbl.Cell(int1 + intInc + Count4, colPESAPA).Range.Text = var2.ToString
                                                                '.Selection.TypeText(DisplayCommas(var1))

                                                                '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                                If Count4 + 1 > UBound(arrInd, 2) Then
                                                                Else
                                                                    arrInd(6, Count4 + 1) = var1
                                                                End If

                                                            Case 2
                                                                'wTbl.Cell(int1 + intInc + Count4, colPESISPA).Select()
                                                                var3 = NZ(rows3(Count4).Item("INTERNALSTANDARDAREA"), 0)
                                                                If boolLUseSigFigsArea Then
                                                                    var1 = SigFigArea(RoundToDecimalA(var3, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                                Else
                                                                    var1 = Format(RoundToDecimalRAFZ(var3, LSigFigArea), strAreaDec)
                                                                End If
                                                                numPESISPA = var1
                                                                var2 = DisplayCommas(var1)
                                                                wTbl.Cell(int1 + intInc + Count4, colPESISPA).Range.Text = var2.ToString
                                                                '.Selection.TypeText(DisplayCommas(var1))

                                                                '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                                If Count4 + 1 > UBound(arrInd, 2) Then
                                                                Else
                                                                    arrInd(7, Count4 + 1) = var1
                                                                End If

                                                        End Select

                                                    Next Count5
                                                Else
                                                    .Selection.TypeText(DisplayCommas(var1))
                                                End If

                                            End If

                                        End If

                                        '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                        arrInd(2, Count4 + 1) = var1
                                        If boolOut Then
                                            arrInd(11, Count4 + 1) = "Y"
                                        Else
                                            arrInd(11, Count4 + 1) = "N"
                                        End If

                                    End If

                                Next Count4

                                '20181129 LEE:
                                ReDim Preserve arrInd(intIndUP, Count4 + 1)

                                int8 = -1
                                If boolQCREPORTACCVALUES Then
                                Else
                                    If boolE(Count3) Then
                                        int8 = int8 + 1
                                    End If
                                End If

                                intStart = int8


                                If boolSTATSMEAN Then
                                    Try
                                        'do Mean
                                        int8 = int8 + 1
                                        If BOOLMFTABLE Then

                                            For Count5 = 1 To 2
                                                Select Case Count5
                                                    Case 1
                                                        var1 = MeanDR(rows3E, "ANALYTEAREA", False, "gaga", False, False)
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESAPA).Select()
                                                    Case 2
                                                        var1 = MeanDR(rows3E, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESISPA).Select()
                                                End Select

                                                If boolLUseSigFigsArea Then
                                                    var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                Else
                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                End If
                                                .Selection.TypeText(DisplayCommas(var2))

                                                Select Case Count5
                                                    Case 1
                                                        numMeanPESAPA = var2
                                                    Case 2
                                                        numMeanPESISPA = var2
                                                End Select

                                            Next Count5

                                        Else

                                            If boolIS Then
                                                var1 = MeanDR(rows3E, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                            Else
                                                var1 = MeanDR(rows3E, "ANALYTEAREA", False, "gaga", False, False)
                                            End If

                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()

                                            If nE = 0 Then
                                                .Selection.TypeText("NA")
                                                boolHasNA = True 'for legend purposes
                                                var2 = 0
                                                boolNAStat = True
                                            Else
                                                '*****
                                                If boolIS Then
                                                    If boolLUseSigFigsArea Then
                                                        var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    .Selection.TypeText(DisplayCommas(var2))
                                                Else
                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                        .Selection.TypeText(CStr(var2))
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        .Selection.TypeText(DisplayCommas(var2))
                                                    End If
                                                End If

                                                '*****
                                            End If

                                            If boolCombined Then 'RS
                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecMeanRS", var2, CSng(var10), Count1, strDo, 0, 0, False)
                                            ElseIf boolTrue Then 'PES
                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecMeanPES", var2, CSng(var10), Count1, strDo, 0, 0, False)
                                            ElseIf boolSE Then 'PES
                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecMeanPES", var2, CSng(var10), Count1, strDo, 0, 0, False)
                                            End If

                                            numB = var2
                                            numMean = numB
                                            numMeanFP = CDec(var1)
                                            numBFP = CDec(var1)

                                        End If



                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSSD Then
                                    Try
                                        'do SD
                                        int8 = int8 + 1

                                        If BOOLMFTABLE Then
                                            For Count5 = 1 To 2
                                                Select Case Count5
                                                    Case 1
                                                        var1 = StdDevDR(rows3E, "ANALYTEAREA", False, "gaga", False, False)
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESAPA).Select()

                                                    Case 2
                                                        var1 = StdDevDR(rows3E, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESISPA).Select()
                                                End Select

                                                If nE < gSDMax Then
                                                    var2 = "NA"
                                                    boolHasNA = True 'for legend purposes
                                                    .Selection.TypeText(var2)
                                                Else
                                                    If boolLUseSigFigsArea Then
                                                        var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    var2 = var1
                                                    .Selection.TypeText(DisplayCommas(var2))

                                                    Select Case Count5
                                                        Case 1
                                                            numSDPESAPA = var2
                                                        Case 2
                                                            numSDPESISPA = var2
                                                    End Select

                                                End If

                                            Next Count5
                                        Else

                                            If nE < gSDMax Then
                                                var2 = "NA"
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                If boolIS Then
                                                    var1 = StdDevDR(rows3E, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                Else
                                                    var1 = StdDevDR(rows3E, "ANALYTEAREA", False, "gaga", False, False)
                                                End If

                                                '*****
                                                If boolIS Then
                                                    If boolLUseSigFigsArea Then
                                                        var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                    Else
                                                        var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                    End If
                                                    var2 = var1
                                                Else
                                                    If boolRCPARatio Then
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                        Else
                                                            var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                        End If
                                                        '.Selection.TypeText(CStr(var2))
                                                    Else
                                                        If boolLUseSigFigsArea Then
                                                            var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                        Else
                                                            var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                        End If
                                                        var2 = var1
                                                        '.Selection.TypeText(DisplayCommas(var2))
                                                    End If
                                                End If

                                                '*****

                                                numSD = var2
                                            End If
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                            If nE < gSDMax Then
                                                .Selection.TypeText("NA")
                                            Else
                                                If boolIS Then
                                                    .Selection.TypeText(DisplayCommas(var2))
                                                Else
                                                    If boolRCPARatio Then
                                                        .Selection.TypeText(CStr(var2))
                                                    Else
                                                        .Selection.TypeText(DisplayCommas(var2))
                                                    End If
                                                End If

                                            End If

                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSCV Then
                                    Try
                                        'do %CV: ((numSD/numMean)*100
                                        int8 = int8 + 1

                                        If BOOLMFTABLE Then
                                            For Count5 = 1 To 2
                                                Select Case Count5
                                                    Case 1
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESAPA).Select()
                                                        numPrec = CalcCVPercent(numSDPESAPA, numMeanPESAPA, intQCDec)
                                                    Case 2
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESISPA).Select()
                                                        numPrec = CalcCVPercent(numSDPESISPA, numMeanPESISPA, intQCDec)
                                                End Select

                                                If nE < gSDMax Then
                                                    var2 = "NA"
                                                    boolHasNA = True 'for legend purposes
                                                    .Selection.TypeText(var2)
                                                Else
                                                    .Selection.TypeText(Format(numPrec, strQCDec))
                                                End If

                                            Next Count5
                                        Else
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                            If nE < gSDMax Then
                                                var2 = "NA"
                                                boolHasNA = True 'for legend purposes
                                                .Selection.TypeText(var2)
                                            Else
                                                numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                .Selection.TypeText(Format(numPrec, strQCDec))

                                                If boolCombined Then 'RS
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecPrecRS", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                ElseIf boolTrue Then 'PES
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecPrecPES", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                ElseIf boolSE Then 'PES
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "RecPrecPES", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                End If

                                            End If
                                        End If




                                    Catch ex As Exception

                                    End Try
                                End If
                                If boolSTATSBIAS And boolSTATSMEAN And BOOLMFTABLE = False Then
                                    Try
                                        'do %Bias: ((Mean/NomConc)*100
                                        int8 = int8 + 1

                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                        '.Selection.TypeText(var2)

                                        numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                        If nE = 0 Then
                                            .Selection.TypeText("NA")
                                            boolHasNA = True 'for legend purposes
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolTHEORETICAL And boolSTATSMEAN And BOOLMFTABLE = False Then
                                    Try
                                        'do %Theor: 100 +((Mean/NomConc)*100
                                        int8 = int8 + 1

                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                        '.Selection.TypeText(var2)

                                        numTheor = CalcREPercent(numMean, numNomConc, intQCDec)
                                        numTheor = 100 + CDec(numTheor)
                                        If nE = 0 Then
                                            .Selection.TypeText("NA")
                                            boolHasNA = True 'for legend purposes
                                        Else
                                            .Selection.TypeText(Format(numTheor, strQCDec))
                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSDIFF And boolSTATSMEAN And BOOLMFTABLE = False Then
                                    Try
                                        'do %Diff: ((Mean/NomConc)*100
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                        numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                        If nE = 0 Then
                                            .Selection.TypeText("NA")
                                            boolHasNA = True 'for legend purposes
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If BOOLSTATSRE And boolSTATSMEAN And BOOLMFTABLE = False Then
                                    Try
                                        'do %RE: ((Mean/NomConc)*100
                                        int8 = int8 + 1
                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                        numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                        If nE = 0 Then
                                            .Selection.TypeText("NA")
                                            boolHasNA = True 'for legend purposes
                                        Else
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolSTATSN Then
                                    Try
                                        'n
                                        int8 = int8 + 1
                                        If BOOLMFTABLE Then
                                            For Count5 = 1 To 2
                                                Select Case Count5
                                                    Case 1
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESAPA).Select()
                                                    Case 2
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESISPA).Select()
                                                End Select
                                                .Selection.TypeText(CStr(nE))
                                            Next Count5
                                        Else
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                            .Selection.TypeText(CStr(nE))
                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolQCREPORTACCVALUES Then
                                Else
                                    If boolE(Count3) Then
                                        'int8 = int8 + 2
                                        int8 = int8 + 3
                                        boolNAStat = False

                                        If boolSTATSMEAN Then
                                            Try
                                                'do Mean

                                                If BOOLMFTABLE Then

                                                    For Count5 = 1 To 2
                                                        Select Case Count5
                                                            Case 1
                                                                var1 = MeanDR(rows3, "ANALYTEAREA", False, "gaga", False, False)
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESAPA).Select()
                                                            Case 2
                                                                var1 = MeanDR(rows3, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESISPA).Select()
                                                        End Select

                                                        If nI = 0 Then
                                                            .Selection.TypeText("NA")
                                                            boolHasNA = True 'for legend purposes
                                                            var2 = 0
                                                            boolNAStat = True
                                                        Else
                                                            If boolLUseSigFigsArea Then
                                                                var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                            Else
                                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                            End If
                                                            .Selection.TypeText(DisplayCommas(var2))

                                                            Select Case Count5
                                                                Case 1
                                                                    numMeanPESAPA_Out = var2
                                                                Case 2
                                                                    numMeanPESISPA_Out = var2
                                                            End Select
                                                        End If
                                                    Next Count5

                                                Else

                                                    If boolIS Then
                                                        var1 = MeanDR(rows3, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                    Else
                                                        var1 = MeanDR(rows3, "ANALYTEAREA", False, "gaga", False, False)
                                                    End If
                                                    'int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()


                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                        boolHasNA = True 'for legend purposes
                                                        var2 = 0
                                                        boolNAStat = True
                                                    Else
                                                        '*****
                                                        If boolIS Then
                                                            If boolLUseSigFigsArea Then
                                                                var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                            Else
                                                                var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                            End If

                                                            .Selection.TypeText(DisplayCommas(var2))
                                                        Else
                                                            If boolRCPARatio Then
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                                Else
                                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                                End If
                                                                .Selection.TypeText(CStr(var2))
                                                            Else
                                                                If boolLUseSigFigsArea Then
                                                                    var2 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                                Else
                                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                                End If

                                                                .Selection.TypeText(DisplayCommas(var2))
                                                            End If
                                                        End If

                                                        '*****
                                                    End If


                                                    numBI = var2
                                                    numMean = numBI
                                                    numMeanFP = CDec(var1)
                                                    numBIFP = CDec(var1)

                                                End If



                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSSD Then
                                            Try
                                                'do SD
                                                int8 = int8 + 1

                                                If BOOLMFTABLE Then
                                                    For Count5 = 1 To 2
                                                        Select Case Count5
                                                            Case 1
                                                                var1 = StdDevDR(rows3, "ANALYTEAREA", False, "gaga", False, False)
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESAPA).Select()
                                                            Case 2
                                                                var1 = StdDevDR(rows3, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESISPA).Select()
                                                        End Select

                                                        If nI < gSDMax Then
                                                            var2 = "NA"
                                                            boolHasNA = True 'for legend purposes
                                                            .Selection.TypeText(var2)
                                                        Else
                                                            If boolLUseSigFigsArea Then
                                                                var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                            Else
                                                                var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                            End If
                                                            var2 = var1
                                                            .Selection.TypeText(DisplayCommas(var2))

                                                            Select Case Count5
                                                                Case 1
                                                                    numSDPESAPA_Out = var2
                                                                Case 2
                                                                    numSDPESISPA_Out = var2
                                                            End Select

                                                        End If



                                                    Next Count5
                                                Else

                                                    If nI < gSDMax Then
                                                        var2 = "NA"
                                                        boolHasNA = True 'for legend purposes
                                                    Else
                                                        If boolIS Then
                                                            var1 = StdDevDR(rows3, "INTERNALSTANDARDAREA", False, "gaga", False, True)
                                                        Else
                                                            var1 = StdDevDR(rows3, "ANALYTEAREA", False, "gaga", False, False)
                                                        End If

                                                        '*****
                                                        If boolIS Then
                                                            If boolLUseSigFigsArea Then
                                                                var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                            Else
                                                                var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                            End If
                                                            var2 = var1
                                                        Else
                                                            If boolRCPARatio Then
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    var2 = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False, True)
                                                                Else
                                                                    var2 = Format(RoundToDecimalRAFZ(var1, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                                End If
                                                            Else
                                                                If boolLUseSigFigsArea Then
                                                                    var1 = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False, True) 'special rounding incorporated
                                                                Else
                                                                    var1 = Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                                                End If
                                                                var2 = var1
                                                            End If
                                                        End If


                                                        '*****

                                                        'var2 = Format(var2)
                                                        numSD = var2
                                                    End If
                                                    'this one
                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                                    If nI < gSDMax Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        If boolIS Then
                                                            .Selection.TypeText(DisplayCommas(var2))
                                                        Else
                                                            If boolRCPARatio Then
                                                                .Selection.TypeText(CStr(var2))
                                                            Else
                                                                .Selection.TypeText(DisplayCommas(var2))
                                                            End If
                                                        End If

                                                    End If

                                                End If

                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSCV Then
                                            Try
                                                'do %CV: ((numSD/numMean)*100
                                                int8 = int8 + 1
                                                If BOOLMFTABLE Then
                                                    For Count5 = 1 To 2
                                                        Select Case Count5
                                                            Case 1
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESAPA).Select()
                                                                numPrec = CalcCVPercent(numSDPESAPA_Out, numMeanPESAPA_Out, intQCDec)
                                                            Case 2
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESISPA).Select()
                                                                numPrec = CalcCVPercent(numSDPESISPA_Out, numMeanPESISPA_Out, intQCDec)
                                                        End Select

                                                        If nI < gSDMax Then
                                                            var2 = "NA"
                                                            boolHasNA = True 'for legend purposes
                                                            .Selection.TypeText(var2)
                                                        Else
                                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                                        End If

                                                    Next Count5
                                                Else
                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                                    If nI < gSDMax Then
                                                        var2 = "NA"
                                                        boolHasNA = True 'for legend purposes
                                                        .Selection.TypeText(var2)
                                                    Else
                                                        numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                        .Selection.TypeText(Format(numPrec, strQCDec))
                                                    End If
                                                End If

                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSBIAS And boolSTATSMEAN And BOOLMFTABLE = False Then
                                            Try
                                                'do %Bias: ((Mean/NomConc)*100
                                                int8 = int8 + 1

                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                                '.Selection.TypeText(var2)

                                                numBias = CalcREPercent(numMean, numNomConc, intQCDec)

                                                If nI = 0 Then
                                                    .Selection.TypeText("NA")
                                                    boolHasNA = True 'for legend purposes
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If

                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolTHEORETICAL And boolSTATSMEAN And BOOLMFTABLE = False Then
                                            Try
                                                'do %Theor: 100 + ((Mean/NomConc)*100
                                                int8 = int8 + 1

                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                                '.Selection.TypeText(var2)

                                                numTheor = CalcREPercent(numMean, numNomConc, intQCDec)
                                                numTheor = 100 + CDec(numTheor)

                                                If nI = 0 Then
                                                    .Selection.TypeText("NA")
                                                    boolHasNA = True 'for legend purposes
                                                Else
                                                    .Selection.TypeText(Format(numTheor, strQCDec))
                                                End If

                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSDIFF And boolSTATSMEAN And BOOLMFTABLE = False Then
                                            Try
                                                'do %diff: ((Mean/NomConc)*100
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                                numBias = CalcREPercent(numMean, numNomConc, intQCDec)

                                                If nI = 0 Then
                                                    .Selection.TypeText("NA")
                                                    boolHasNA = True 'for legend purposes
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If

                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If BOOLSTATSRE And boolSTATSMEAN And BOOLMFTABLE = False Then
                                            Try
                                                'do %RE: ((Mean/NomConc)*100
                                                int8 = int8 + 1
                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                                numBias = CalcREPercent(numMean, numNomConc, intQCDec)

                                                If nI = 0 Then
                                                    .Selection.TypeText("NA")
                                                    boolHasNA = True 'for legend purposes
                                                Else
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                End If

                                            Catch ex As Exception

                                            End Try
                                        End If

                                        Try
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "n", nI, CSng(var10), Count1, strDo, 0, 0, False)
                                        Catch ex As Exception

                                        End Try
                                        If boolSTATSN Then
                                            Try
                                                'n
                                                int8 = int8 + 1
                                                If BOOLMFTABLE Then
                                                    For Count5 = 1 To 2
                                                        Select Case Count5
                                                            Case 1
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESAPA).Select()
                                                            Case 2
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colPESISPA).Select()
                                                        End Select
                                                        .Selection.TypeText(CStr(nI))
                                                    Next Count5
                                                Else
                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col5).Select()
                                                    .Selection.TypeText(CStr(nI))
                                                End If


                                            Catch ex As Exception

                                            End Try
                                        End If
                                    End If
                                End If

                                'column 6
                                int2 = 0
                                var1 = 0

                                var4 = arrInd(10, Count4 + 1)
                                var5 = arrInd(11, Count4 + 1)
                                'redim preserve

                                'legend
                                'col1 = colWID
                                'col2 = colQCID
                                'col3 = colNomConc
                                'col4 = colRSAPA
                                'col5 = colRSISPA
                                'col6 = colPESAPA
                                'col7 = colPESISPA

                                'create a datatable for BOOLDOINDREC stats
                                Dim tblInd As New DataTable
                                Try
                                    Dim colId As New DataColumn
                                    colId.ColumnName = "ID"
                                    colId.DataType = System.Type.GetType("System.Int16")
                                    colId.AllowDBNull = True
                                    tblInd.Columns.Add(colId)

                                    Dim colA As New DataColumn
                                    colA.ColumnName = "Col4" 'RSAPA
                                    colA.AllowDBNull = True
                                    tblInd.Columns.Add(colA)

                                    Dim colB As New DataColumn
                                    colB.ColumnName = "Col5" 'RSISPA
                                    colB.AllowDBNull = True
                                    tblInd.Columns.Add(colB)

                                    Dim colC As New DataColumn
                                    colC.ColumnName = "Col6" 'PESAPA
                                    colC.AllowDBNull = True
                                    tblInd.Columns.Add(colC)

                                    Dim colD As New DataColumn
                                    colD.ColumnName = "ColAliq"
                                    colD.AllowDBNull = True
                                    tblInd.Columns.Add(colD)

                                    Dim colE As New DataColumn
                                    colE.ColumnName = "Type" 'NULL, AMF, ISMF
                                    colE.AllowDBNull = True
                                    tblInd.Columns.Add(colE)

                                    Dim colF As New DataColumn
                                    colF.ColumnName = "Excluded" '-1/0
                                    colF.AllowDBNull = True
                                    tblInd.Columns.Add(colF)

                                    Dim colG As New DataColumn
                                    colG.ColumnName = "Col7" 'PESIAPA
                                    colG.AllowDBNull = True
                                    tblInd.Columns.Add(colG)



                                Catch ex As Exception
                                    var1 = var1
                                End Try

                                Dim intInd As Int16 = 0

                                '*****
                                'now just record that information


                                '20181205 LEE:
                                'Record some values

                                If BOOLMFTABLE Then

                                    tblRec.Clear()

                                    For Count4 = 0 To intRowsT - 1

                                        If Count4 + 1 > UBound(arrInd, 2) Then
                                            'var1 = "NA"
                                            'boolHasNA = True 'for legend purposes
                                            If boolQCNA Then
                                                var1 = "NA"
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                var1 = ""
                                            End If
                                        Else

                                            '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 
                                            '9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF, 14=AliquotFactor
                                            intInd = intInd + 1
                                            Dim nrRec As DataRow = tblRec.NewRow

                                            nrRec("RSAPA") = arrInd(4, Count4 + 1) 'RSAPA
                                            nrRec("RSISPA") = arrInd(5, Count4 + 1) 'RSISPA
                                            nrRec("PESAPA") = arrInd(6, Count4 + 1) 'PESAPA
                                            nrRec("PESISPA") = arrInd(7, Count4 + 1) 'PESISPA

                                            'calc area ratio
                                            'Format(RoundToDecimalRAFZ(var1, LSigFigArea), strAreaDec)
                                            'calculate Analyte MF for boolMeanRS = true
                                            var1 = arrInd(4, Count4 + 1) 'RSAPA
                                            var2 = arrInd(5, Count4 + 1) 'RSISPA
                                            If IsNumeric(var1) And IsNumeric(var2) Then
                                                nrRec("RSPAR") = Format(RoundToDecimalRAFZ(var1 / var2, LSigFigAreaRatio), strAreaDecAreaRatio)
                                            End If

                                            var1 = arrInd(6, Count4 + 1) 'PESAPA
                                            var2 = arrInd(7, Count4 + 1) 'PESISPA
                                            If IsNumeric(var1) And IsNumeric(var2) Then
                                                nrRec("PESPAR") = Format(RoundToDecimalRAFZ(var1 / var2, LSigFigAreaRatio), strAreaDecAreaRatio)
                                            End If

                                            nrRec("RSOUT") = arrInd(10, Count4 + 1)
                                            nrRec("PESOUT") = arrInd(11, Count4 + 1)
                                            nrRec("ALIQF") = 1

                                            'calculate Analyte MF for boolMeanRS = true
                                            var1 = arrInd(6, Count4 + 1) 'PESAPA
                                            var2 = arrInd(4, Count4 + 1) 'RSAPA

                                            If IsNumeric(var2) Then
                                                If var2 = 0 Then
                                                Else
                                                    var3 = var1 / var2
                                                    var4 = SigFigOrDecString(RoundToDecimalA(var3, LSigFig), LSigFig, False)
                                                    nrRec("AMF") = var4
                                                End If
                                            End If

                                            tblRec.Rows.Add(nrRec)

                                        End If

                                    Next Count4

                                    'now calculate means
                                    'Legend: MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                    Dim row1() As DataRow
                                    row1 = tblRec.Select("RSAPA IS NOT NULL AND RSOUT = 'N'")
                                    var1 = MeanDRMF(row1, "RSAPA", False, "ALIQF", False, False)
                                    numMeanRSAPA = SigFigOrDecPeakAreaOrRatio(var1, LSigFigArea, False)

                                    row1 = tblRec.Select("RSAPA IS NOT NULL")
                                    var1 = MeanDRMF(row1, "RSAPA", False, "ALIQF", False, False)
                                    numMeanRSAPA_Out = SigFigOrDecPeakAreaOrRatio(var1, LSigFigArea, False)

                                    row1 = tblRec.Select("RSISPA IS NOT NULL AND RSOUT = 'N'")
                                    var1 = MeanDRMF(row1, "RSISPA", False, "ALIQF", False, False)
                                    numMeanRSISPA = SigFigOrDecPeakAreaOrRatio(var1, LSigFigArea, False)

                                    row1 = tblRec.Select("RSISPA IS NOT NULL")
                                    var1 = MeanDRMF(row1, "RSISPA", False, "ALIQF", False, False)
                                    numMeanRSISPA_Out = SigFigOrDecPeakAreaOrRatio(var1, LSigFigArea, False)

                                    row1 = tblRec.Select("PESAPA IS NOT NULL AND PESOUT= 'N'")
                                    var1 = MeanDRMF(row1, "PESAPA", False, "ALIQF", False, False)
                                    numMeanPESAPA = SigFigOrDecPeakAreaOrRatio(var1, LSigFigArea, False)

                                    row1 = tblRec.Select("PESAPA IS NOT NULL")
                                    var1 = MeanDRMF(row1, "PESAPA", False, "ALIQF", False, False)
                                    numMeanPESAPA_Out = SigFigOrDecPeakAreaOrRatio(var1, LSigFigArea, False)

                                    row1 = tblRec.Select("PESISPA IS NOT NULL AND PESOUT = 'N'")
                                    var1 = MeanDRMF(row1, "PESISPA", False, "ALIQF", False, False)
                                    numMeanPESISPA = SigFigOrDecPeakAreaOrRatio(var1, LSigFigArea, False)

                                    row1 = tblRec.Select("PESISPA IS NOT NULL")
                                    var1 = MeanDRMF(row1, "PESISPA", False, "ALIQF", False, False)
                                    numMeanPESISPA_Out = SigFigOrDecPeakAreaOrRatio(var1, LSigFigArea, False)

                                    'These are area ratios
                                    row1 = tblRec.Select("RSPAR IS NOT NULL AND RSOUT= 'N'")
                                    var1 = MeanDRMF(row1, "RSPAR", False, "ALIQF", False, False)
                                    nummeanRSPAR = SigFigOrDecPeakAreaOrRatio(var1, LSigFigAreaRatio, True)

                                    row1 = tblRec.Select("RSPAR IS NOT NULL")
                                    var1 = MeanDRMF(row1, "RSPAR", False, "ALIQF", False, False)
                                    nummeanRSPAR_Out = SigFigOrDecPeakAreaOrRatio(var1, LSigFigAreaRatio, True)

                                    row1 = tblRec.Select("PESPAR IS NOT NULL AND PESOUT= 'N'")
                                    var1 = MeanDRMF(row1, "PESPAR", False, "ALIQF", False, False)
                                    nummeanPESPAR = SigFigOrDecPeakAreaOrRatio(var1, LSigFigAreaRatio, True)

                                    row1 = tblRec.Select("PESPAR IS NOT NULL")
                                    var1 = MeanDRMF(row1, "PESPAR", False, "ALIQF", False, False)
                                    nummeanPESPAR_Out = SigFigOrDecPeakAreaOrRatio(var1, LSigFigAreaRatio, True)


                                    'These are MF
                                    'use sigfig
                                    row1 = tblRec.Select("AMF IS NOT NULL")
                                    var1 = MeanDRMF(row1, "AMF", False, "ALIQF", False, False)
                                    numMeanAMF = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)

                                    row1 = tblRec.Select("AMF IS NOT NULL AND RSOUT = 'N' AND PESOUT = 'N'")
                                    var1 = MeanDRMF(row1, "AMF", False, "ALIQF", False, False)
                                    numMeanAMF_Out = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)

                                End If
                                

                                ''debug
                                'Console.WriteLine("Start")
                                'var1 = ""
                                'For Count4 = 0 To tblRec.Columns.Count - 1
                                '    var1 = var1 & ";" & tblRec.Columns(Count4).ColumnName
                                'Next
                                'Console.WriteLine(var1)

                                'For Count5 = 0 To intRowsT - 1
                                '    var1 = ""
                                '    For Count4 = 0 To tblRec.Columns.Count - 1
                                '        var1 = var1 & ";" & tblRec.Rows(Count5).Item(Count4)
                                '    Next
                                '    Console.WriteLine(var1)
                                'Next

                                'Console.WriteLine("End")

                                '*****


                                'If BOOLDOINDREC Or (BOOLMFTABLE Or BOOLINCLMFCOLS) Then
                                'BOOLINCLMFCOLS is if Analyte and IS MF cols are to be shown
                                'If BOOLDOINDREC Or (BOOLMFTABLE And BOOLINCLMFCOLS) Then
                                'If (BOOLDOINDREC And BOOLDIFFCOLSTATS) Or BOOLMFTABLE Then
                                If BOOLDOINDREC Or BOOLMFTABLE Then

                                    For Count4 = 0 To intRowsT - 1

                                        If Count4 + 1 > UBound(arrInd, 2) Then
                                            'var1 = "NA"
                                            'boolHasNA = True 'for legend purposes
                                            If boolQCNA Then
                                                var1 = "NA"
                                                boolHasNA = True 'for legend purposes
                                            Else
                                                var1 = ""
                                            End If
                                        Else

                                            Dim strAA As String = ""
                                            'If BOOLMFTABLE Then
                                            'If BOOLMFTABLE And BOOLINCLMFCOLS And BOOLCALCINTSTDNMF Then
                                            '20180424 Do calcs, but report based on BOOLINCLMFCOLS
                                            If BOOLMFTABLE And BOOLCALCINTSTDNMF Then
                                                strAA = NZ(arrInd(12, Count4 + 1), "")
                                                For Count5 = 1 To 3
                                                    boolOut = False
                                                    Select Case Count5
                                                        Case 1

                                                            var1 = NZ(arrInd(10, Count4 + 1), "")
                                                            If StrComp(var1, "Y", CompareMethod.Text) = 0 Then
                                                                boolOut = True
                                                            End If
                                                            '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                            If BOOLINCLMFCOLS Then
                                                                If BOOLCALCINTSTDNMF Then
                                                                    var1 = arrInd(6, Count4 + 1)
                                                                    var2 = arrInd(4, Count4 + 1)
                                                                    If boolMeanRS Then
                                                                        var2 = numMeanRSAPA
                                                                    End If
                                                                Else
                                                                    '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated
                                                                    var1 = arrInd(4, Count4 + 1)
                                                                    var2 = arrInd(5, Count4 + 1)
                                                                End If
                                                            Else
                                                                '20180531 LEE:
                                                                'Use area ratios instead
                                                                var1 = arrInd(4, Count4 + 1)
                                                                var2 = arrInd(5, Count4 + 1)
                                                            End If


                                                            If IsNumeric(var1) And IsNumeric(var2) Then

                                                                If var2 = 0 Then
                                                                    If boolQCNA Then
                                                                        var3 = "NA"
                                                                        boolHasNA = True 'for legend purposes
                                                                    Else
                                                                        var3 = ""
                                                                    End If

                                                                Else
                                                                    If BOOLINCLMFCOLS Then
                                                                        var3 = var1 / var2 'MF Analyte
                                                                    Else
                                                                        '20180531 LEE:
                                                                        'need to round area ratios to get QC'd ISNMF
                                                                        var3 = Format(var1 / var2, strAreaDecAreaRatio)
                                                                    End If

                                                                End If

                                                            Else
                                                                If boolQCNA Then
                                                                    var3 = "NA"
                                                                    boolHasNA = True 'for legend purposes
                                                                Else
                                                                    var3 = ""
                                                                End If
                                                                'var3 = "NA"
                                                            End If

                                                            '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                            arrInd(8, Count4 + 1) = var3

                                                            'If BOOLINCLMFCOLS Then
                                                            '    .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colAMF).Select()
                                                            'End If
                                                            ''20180424
                                                            'If BOOLINCLMFCOLS Then
                                                            '    .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colAMF).Select()
                                                            'End If

                                                            '20180531 LEE:
                                                            'AMF column will be PAR if so desired
                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colAMF).Select()


                                                        Case 2

                                                            var1 = NZ(arrInd(11, Count4 + 1), "")
                                                            If StrComp(var1, "Y", CompareMethod.Text) = 0 Then
                                                                boolOut = True
                                                            End If

                                                            '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                            If BOOLINCLMFCOLS Then
                                                                If BOOLCALCINTSTDNMF Then
                                                                    var1 = arrInd(7, Count4 + 1)
                                                                    var2 = arrInd(5, Count4 + 1)
                                                                    If boolMeanRS Then
                                                                        var2 = numMeanRSISPA
                                                                    End If
                                                                Else
                                                                    '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated
                                                                    var1 = arrInd(6, Count4 + 1)
                                                                    var2 = arrInd(7, Count4 + 1)
                                                                End If
                                                            Else
                                                                '20180531 LEE:
                                                                'Use area ratios instead
                                                                var1 = arrInd(6, Count4 + 1)
                                                                var2 = arrInd(7, Count4 + 1)

                                                            End If


                                                            If IsNumeric(var1) And IsNumeric(var2) Then

                                                                If var2 = 0 Then
                                                                    If boolQCNA Then
                                                                        var3 = "NA"
                                                                        boolHasNA = True 'for legend purposes
                                                                    Else
                                                                        var3 = ""
                                                                    End If
                                                                Else

                                                                    If BOOLINCLMFCOLS Then
                                                                        var3 = var1 / var2 'MF IntStd
                                                                    Else
                                                                        '20180531 LEE:
                                                                        'need to round area ratios to get QC'd ISNMF
                                                                        var3 = Format(var1 / var2, strAreaDecAreaRatio)
                                                                    End If

                                                                End If

                                                            Else
                                                                If boolQCNA Then
                                                                    var3 = "NA"
                                                                    boolHasNA = True 'for legend purposes
                                                                Else
                                                                    var3 = ""
                                                                End If
                                                            End If

                                                            '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                            arrInd(9, Count4 + 1) = var3

                                                            ''20180424
                                                            'If BOOLINCLMFCOLS Then
                                                            '    .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colISMF).Select()
                                                            'End If

                                                            '20180531 LEE:
                                                            'AMF column will be PAR if so desired
                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colISMF).Select()

                                                        Case 3

                                                            '20181129 LEE:
                                                            'if nRSPAR <> nPESPAR then use average of RSPAR
                                                            If BOOLINCLINTSTDNMF Then

                                                                var1 = NZ(arrInd(10, Count4 + 1), "")
                                                                var2 = NZ(arrInd(11, Count4 + 1), "")
                                                                If StrComp(var1, "Y", CompareMethod.Text) = 0 Or StrComp(var2, "Y", CompareMethod.Text) = 0 Then
                                                                    boolOut = True
                                                                End If

                                                                If BOOLINCLMFCOLS Then
                                                                    If BOOLCALCINTSTDNMF Then
                                                                        var1 = arrInd(8, Count4 + 1)
                                                                        var2 = arrInd(9, Count4 + 1)
                                                                        '20181202 LEE:
                                                                        'no need to check for boolMeanRS
                                                                        '1 and 2 are already filled if boolMeanRS = true
                                                                    Else
                                                                        '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated
                                                                        var1 = arrInd(9, Count4 + 1)
                                                                        var2 = arrInd(8, Count4 + 1)
                                                                    End If
                                                                Else
                                                                    var1 = arrInd(9, Count4 + 1) 'PES PAR
                                                                    If boolMeanRS Then
                                                                        var2 = nummeanRSPAR
                                                                    Else
                                                                        var2 = arrInd(8, Count4 + 1) 'RS PAR
                                                                    End If

                                                                End If

                                                                '2011130 LEE:
                                                                'If boolMeanRS Then
                                                                '    var2 = numMeanRSAPA / numMeanRSISPA
                                                                '    '20181130 LEE:
                                                                '    'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                '    var2 = SigFigOrDecString(RoundToDecimalA(var2, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                '    'If BOOLRECSIGFIG Then
                                                                '    '    If boolLUseSigFigs Then
                                                                '    '        var2 = SigFigOrDecString(RoundToDecimalA(var2, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                '    '    Else
                                                                '    '        var2 = RoundToDecimalRAFZ(var2, LSigFig)
                                                                '    '    End If
                                                                '    'Else
                                                                '    '    var2 = RoundToDecimalRAFZ(var2, LSigFig)
                                                                '    'End If
                                                                'End If

                                                                If IsNumeric(var1) And IsNumeric(var2) Then

                                                                    '20181130 LEE:
                                                                    'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                    'these are all MF!!!
                                                                    '20181203 LEE:
                                                                    'but var1, var2 may be peak area ratio
                                                                    If BOOLINCLMFCOLS Then 'var1 and var2 are MF
                                                                        var1 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                        var2 = SigFigOrDecString(RoundToDecimalA(var2, LSigFig), LSigFig, False)
                                                                    Else 'var1 and var2 are peak area ratio
                                                                        var1 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                        var2 = RoundToDecimalRAFZ(var2, LSigFigAreaRatio)
                                                                    End If

                                                                    var1 = var1 'debug

                                                                    'If BOOLINCLMFCOLS Then 'column is individual MF, need sigfigs
                                                                    '    '20181130 LEE:
                                                                    '    'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                    '    var1 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                    '    'If BOOLRECSIGFIG Then
                                                                    '    '    If boolLUseSigFigs Then
                                                                    '    '        var1 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                    '    '    Else
                                                                    '    '        var1 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                    '    '    End If
                                                                    '    'Else
                                                                    '    '    var1 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                    '    'End If

                                                                    '    '20181130 LEE:
                                                                    '    'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                    '    var2 = SigFigOrDecString(RoundToDecimalA(var2, LSigFig), LSigFig, False)
                                                                    '    'If BOOLRECSIGFIG Then
                                                                    '    '    If boolLUseSigFigs Then
                                                                    '    '        var2 = SigFigOrDecString(RoundToDecimalA(var2, LSigFig), LSigFig, False)
                                                                    '    '    Else
                                                                    '    '        var2 = RoundToDecimalRAFZ(var2, LSigFig)
                                                                    '    '    End If
                                                                    '    'Else
                                                                    '    '    var2 = RoundToDecimalRAFZ(var2, LSigFig)
                                                                    '    'End If
                                                                    'Else 'column is peak area ratio, need LSigFigAreaRatio
                                                                    '    If BOOLRECSIGFIG Then
                                                                    '        If boolLUseSigFigs Then
                                                                    '            var1 = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                    '        Else
                                                                    '            var1 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                    '        End If
                                                                    '    Else
                                                                    '        var1 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                    '    End If

                                                                    '    If BOOLRECSIGFIG Then
                                                                    '        If boolLUseSigFigs Then
                                                                    '            var2 = SigFigOrDecString(RoundToDecimalA(var2, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                    '        Else
                                                                    '            var2 = RoundToDecimalRAFZ(var2, LSigFigAreaRatio)
                                                                    '        End If
                                                                    '    Else
                                                                    '        var2 = RoundToDecimalRAFZ(var2, LSigFigAreaRatio)
                                                                    '    End If
                                                                    'End If



                                                                    If var2 = 0 Then
                                                                        If boolQCNA Then
                                                                            var3 = "NA"
                                                                            boolHasNA = True 'for legend purposes
                                                                        Else
                                                                            var3 = ""
                                                                        End If
                                                                    Else
                                                                        var3 = var1 / var2
                                                                    End If

                                                                Else
                                                                    If boolQCNA Then
                                                                        var3 = "NA"
                                                                        boolHasNA = True 'for legend purposes
                                                                    Else
                                                                        var3 = ""
                                                                    End If
                                                                End If

                                                                '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF
                                                                arrInd(13, Count4 + 1) = var3

                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, colISNMF).Select()


                                                            Else
                                                                GoTo nextcount5a
                                                            End If

                                                    End Select

                                                    intInd = intInd + 1
                                                    Dim nr As DataRow = tblInd.NewRow
                                                    nr(0) = intInd

                                                    nr.BeginEdit()
                                                    If IsNumeric(var1) Then
                                                        nr(1) = CDec(var1)
                                                    Else
                                                        nr(1) = var1
                                                    End If
                                                    If IsNumeric(var2) Then
                                                        nr(2) = CDec(var2)
                                                    Else
                                                        nr(2) = var2
                                                    End If


                                                    If Count5 = 3 Then
                                                        var1 = var1 'debug
                                                    End If

                                                    If IsNumeric(var3) Then

                                                        '20181130 LEE:
                                                        'redo

                                                        If Count5 = 3 Then
                                                            If BOOLINCLINTSTDNMF Then
                                                                '20181130 LEE:
                                                                'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                var1 = SigFigOrDecString(RoundToDecimalA(var3, LSigFig), LSigFig, False)
                                                            Else
                                                                If boolQCNA Then
                                                                    var1 = "NA"
                                                                End If
                                                            End If
                                                        Else

                                                            '20181130 LEE:
                                                            'Redo this
                                                            If BOOLINCLMFCOLS Then 'values are MF
                                                                var1 = SigFigOrDecString(RoundToDecimalA(var3, LSigFig), LSigFig, False)
                                                            Else 'values are peak area ratio
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    var1 = SigFigOrDecString(RoundToDecimalA(var3, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                Else
                                                                    var1 = RoundToDecimalRAFZ(var3, LSigFigAreaRatio)
                                                                End If
                                                                'If BOOLRECSIGFIG Then
                                                                '    If boolLUseSigFigsAreaRatio Then
                                                                '        var1 = SigFigOrDecString(RoundToDecimalA(var3, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                '    Else
                                                                '        var1 = RoundToDecimalRAFZ(var3, LSigFigAreaRatio)
                                                                '    End If
                                                                'Else
                                                                '    var1 = RoundToDecimalRAFZ(var3, LSigFigAreaRatio)
                                                                'End If
                                                            End If
                                                        End If

                                                        '*****

                                                        'If Count5 = 3 Then
                                                        '    var1 = SigFigOrDecString(RoundToDecimalA(var3, LSigFig), LSigFig, False)
                                                        'Else

                                                        'End If


                                                        ''20180531 LEE:
                                                        'If Count5 < 3 And BOOLINCLMFCOLS = False Then
                                                        '    If BOOLRECSIGFIG Then
                                                        '        If boolLUseSigFigsAreaRatio Then
                                                        '            var1 = SigFigOrDecString(RoundToDecimalA(var3, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                        '        Else
                                                        '            var1 = RoundToDecimalRAFZ(var3, LSigFigAreaRatio)
                                                        '        End If
                                                        '    Else
                                                        '        var1 = RoundToDecimalRAFZ(var3, LSigFigAreaRatio)
                                                        '    End If
                                                        'Else
                                                        '    '20181130 LEE:
                                                        '    'ignore BOOLRECSIGFIG, MF is always sigfig
                                                        '    var1 = SigFigOrDecString(RoundToDecimalA(var3, LSigFig), LSigFig, False)
                                                        '    'If BOOLRECSIGFIG Then
                                                        '    '    If boolLUseSigFigs Then
                                                        '    '        var1 = SigFigOrDecString(RoundToDecimalA(var3, LSigFig), LSigFig, False)
                                                        '    '    Else
                                                        '    '        var1 = RoundToDecimalRAFZ(var3, LSigFig)
                                                        '    '    End If
                                                        '    'Else
                                                        '    '    var1 = RoundToDecimalRAFZ(var3, LSigFig)
                                                        '    'End If

                                                        'End If
                                                        ''****

                                                        If boolOut And BOOLDOINDREC Then
                                                            If boolRedBoldFont Then
                                                                .Selection.Font.Bold = True
                                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                            End If
                                                        End If


                                                        If Count5 = 3 Then
                                                            If BOOLINCLINTSTDNMF And BOOLDOINDREC Then
                                                                '20181130 LEE:
                                                                'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFig, False)))

                                                                'If BOOLRECSIGFIG Then
                                                                '    If boolLUseSigFigs Then
                                                                '        .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFig, False)))
                                                                '    Else
                                                                '        .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFig))))
                                                                '    End If
                                                                'Else
                                                                '    .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFig))))
                                                                'End If

                                                            Else
                                                                If boolQCNA Then
                                                                    .Selection.TypeText(Text:="NA")
                                                                End If
                                                            End If
                                                        Else

                                                            '20181130 LEE:
                                                            'Redo this
                                                            'If BOOLDOINDREC Then

                                                            '    If BOOLINCLMFCOLS Then 'these are matrix factors
                                                            '        .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFig, False)))
                                                            '    Else
                                                            '        If BOOLRECSIGFIG Then
                                                            '            If boolLUseSigFigsAreaRatio Then
                                                            '                .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFigAreaRatio, False)))
                                                            '            Else
                                                            '                .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFigAreaRatio))))
                                                            '            End If
                                                            '        Else
                                                            '            .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFigAreaRatio))))
                                                            '        End If
                                                            '    End If
                                                            'Else
                                                            '    If boolQCNA Then
                                                            '        .Selection.TypeText(Text:="NA")
                                                            '    End If
                                                            'End If

                                                            If BOOLDOINDREC Then
                                                                If BOOLINCLMFCOLS Then 'MF
                                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFig, False)))
                                                                Else 'PARatio
                                                                    If BOOLRECSIGFIG Then
                                                                        If boolLUseSigFigsAreaRatio Then
                                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFigAreaRatio, False)))
                                                                        Else
                                                                            .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFigAreaRatio))))
                                                                        End If
                                                                    Else
                                                                        .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFigAreaRatio))))
                                                                    End If
                                                                End If
                                                            Else
                                                                If BOOLINCLMFCOLS Then 'values are MF
                                                                    If boolQCNA Then
                                                                        .Selection.TypeText(Text:="NA")
                                                                    End If
                                                                Else 'values are peak area ratio. Report them
                                                                    If boolLUseSigFigsAreaRatio Then
                                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFigAreaRatio, False)))
                                                                    Else
                                                                        .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFigAreaRatio))))
                                                                    End If
                                                                    'If BOOLRECSIGFIG Then
                                                                    '    If boolLUseSigFigsAreaRatio Then
                                                                    '        .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFigAreaRatio, False)))
                                                                    '    Else
                                                                    '        .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFigAreaRatio))))
                                                                    '    End If
                                                                    'Else
                                                                    '    .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFigAreaRatio))))
                                                                    'End If
                                                                End If

                                                            End If

                                                            'If Count5 < 3 And BOOLINCLMFCOLS = False Then
                                                            '    If BOOLRECSIGFIG Then
                                                            '        If boolLUseSigFigsAreaRatio Then
                                                            '            .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFigAreaRatio, False)))
                                                            '        Else
                                                            '            .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFigAreaRatio))))
                                                            '        End If
                                                            '    Else
                                                            '        .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFigAreaRatio))))
                                                            '    End If
                                                            'Else
                                                            '    If BOOLRECSIGFIG Then
                                                            '        If boolLUseSigFigs Then
                                                            '            .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFig, False)))
                                                            '        Else
                                                            '            .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFig))))
                                                            '        End If
                                                            '    Else
                                                            '        .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFig))))
                                                            '    End If
                                                            'End If

                                                        End If

                                                        If boolOut And BOOLDOINDREC Then
                                                            Call typeInSuperscriptFontSize12WithSpace(wd, strAA)
                                                        End If


                                                        'If BOOLDOINDREC Then



                                                        'Else

                                                        '    Select Case Count5
                                                        '        Case 1
                                                        '            'If BOOLINCLMFCOLS Then
                                                        '            '    If boolQCNA Then
                                                        '            '        .Selection.TypeText(Text:="NA")
                                                        '            '    End If
                                                        '            'End If
                                                        '            If boolQCNA Then
                                                        '                .Selection.TypeText(Text:="NA")
                                                        '            End If
                                                        '        Case 2
                                                        '            'If BOOLINCLMFCOLS Then
                                                        '            '    If boolQCNA Then
                                                        '            '        .Selection.TypeText(Text:="NA")
                                                        '            '    End If
                                                        '            'End If
                                                        '            If boolQCNA Then
                                                        '                .Selection.TypeText(Text:="NA")
                                                        '            End If
                                                        '        Case 3
                                                        '            If boolQCNA Then
                                                        '                .Selection.TypeText(Text:="NA")
                                                        '            End If
                                                        '    End Select

                                                        'End If

                                                        If IsNumeric(var1) Then
                                                            nr(3) = CDec(var1)
                                                        Else
                                                            nr(3) = var1
                                                        End If
                                                        nr(4) = 1
                                                        Try

                                                            Select Case Count5
                                                                Case 1
                                                                    nr(5) = "AMF"
                                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "IndAMF", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                                                Case 2
                                                                    nr(5) = "ISMF"
                                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "IndISMF", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                                                Case 3
                                                                    nr(5) = "ISNMF"
                                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "IndISNMF", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                                            End Select

                                                            If boolOut Then
                                                                nr(6) = CStr(-1)
                                                            Else
                                                                nr(6) = CStr(0)
                                                            End If

                                                            'If BOOLDOINDREC Then
                                                            '    Select Case Count5
                                                            '        Case 1
                                                            '            nr(5) = "AMF"
                                                            '            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "IndAMF", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                                            '        Case 2
                                                            '            nr(5) = "ISMF"
                                                            '            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "IndISMF", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                                            '        Case 3
                                                            '            nr(5) = "ISNMF"
                                                            '            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "IndISNMF", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                                            '    End Select

                                                            '    If boolOut Then
                                                            '        nr(6) = CStr(-1)
                                                            '    Else
                                                            '        nr(6) = CStr(0)
                                                            '    End If

                                                            'End If

                                                        Catch ex As Exception
                                                            var1 = ex.Message
                                                            var1 = var1
                                                        End Try

                                                    Else

                                                        Select Case Count5
                                                            Case 1
                                                                If BOOLINCLMFCOLS Then
                                                                    .Selection.TypeText(var3)
                                                                End If
                                                            Case 2
                                                                If BOOLINCLMFCOLS Then
                                                                    .Selection.TypeText(var3)
                                                                End If
                                                            Case 3
                                                                If BOOLINCLINTSTDNMF Then
                                                                    .Selection.TypeText(var3)
                                                                End If
                                                        End Select


                                                    End If

                                                    Try
                                                        nr.EndEdit()
                                                        tblInd.Rows.Add(nr)
                                                    Catch ex As Exception
                                                        var1 = ex.Message
                                                        var1 = var1
                                                    End Try
nextCount5a:

                                                Next Count5

                                            Else

                                                If BOOLDOINDREC Or (BOOLMFTABLE And BOOLINCLMFCOLS And BOOLCALCINTSTDNMF = False) Then

                                                    '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF, 13=ISNMF
                                                    var1 = arrInd(1, Count4 + 1)
                                                    var2 = arrInd(2, Count4 + 1)
                                                    '20181130 LEE:
                                                    If boolMeanRS Then
                                                        'use meanRS
                                                        If boolX Then
                                                            var1 = numMeanRSISPA
                                                        Else
                                                            var1 = numMeanRSAPA
                                                        End If

                                                        var1 = var1 'debug
                                                    End If
                                                    If IsNumeric(var1) And IsNumeric(var2) Then

                                                        '20181130 LEE:
                                                        'This calculation for SE is a percent
                                                        If var2 = 0 Then
                                                            var3 = 0
                                                        Else
                                                            var3 = var1 / var2 * 100
                                                            var3 = RoundToDecimalRAFZ(var3, intQCDec)
                                                        End If

                                                        ''20181109 LEE:
                                                        ''This number should be rounded to QC
                                                        'var3 = RoundToDecimalRAFZ(var3, intQCDec)

                                                        'If boolCombined Or boolTrue Then
                                                        '    If var2 = 0 Then
                                                        '        var3 = 0
                                                        '    Else
                                                        '        var3 = var1 / var2 * 100
                                                        '        '20181109 LEE:
                                                        '        'This number should be rounded to QC
                                                        '        var3 = RoundToDecimalRAFZ(var3, intQCDec)
                                                        '    End If

                                                        'ElseIf boolSE Then
                                                        '    If var1 = 0 Then
                                                        '        var3 = 0
                                                        '    Else
                                                        '        'var3 = var2 / var1
                                                        '        '20181109 LEE:
                                                        '        'This calculation for SE is a percent
                                                        '        var3 = var1 / var2 * 100
                                                        '        '20181109 LEE:
                                                        '        'This number should be rounded to QC
                                                        '        var3 = RoundToDecimalRAFZ(var3, intQCDec)
                                                        '    End If
                                                        'End If

                                                    Else
                                                        var3 = "NA"
                                                    End If


                                                    arrInd(3, Count4 + 1) = var3
                                                    '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript

                                                    intInd = intInd + 1
                                                    Dim nr As DataRow = tblInd.NewRow
                                                    nr(0) = intInd

                                                    nr.BeginEdit()
                                                    If IsNumeric(var1) Then
                                                        nr(1) = CDec(var1)
                                                    Else
                                                        nr(1) = var1
                                                    End If
                                                    If IsNumeric(var2) Then
                                                        nr(2) = CDec(var2)
                                                    Else
                                                        nr(2) = var2
                                                    End If

                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, col6).Select()

                                                    '1=col4, 2=col5, 3=col5/col4, 4=RSAPA, 5=RSISPA, 6=PESAPA, 7=PESISPA, 8=AMF, 9=ISMF, 10=col4 is outlier Y/N, 11=col5 is outlier Y/N, 12=superscript, 13=ISNMF, 13=ISNMF
                                                    var4 = arrInd(10, Count4 + 1)
                                                    var5 = arrInd(11, Count4 + 1)

                                                    If StrComp(var4, "Y", CompareMethod.Text) = 0 Or StrComp(var5, "Y", CompareMethod.Text) = 0 Then
                                                        If boolRedBoldFont Then
                                                            .Selection.Font.Bold = True
                                                            .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        End If
                                                    End If
                                                    If IsNumeric(var3) Then

                                                        If BOOLRECSIGFIG Then
                                                            If boolLUseSigFigs Then
                                                                var1 = SigFigOrDecString(RoundToDecimalA(var3, LSigFig), LSigFig, False)
                                                            Else
                                                                var1 = RoundToDecimalRAFZ(var3, LSigFig)
                                                            End If

                                                            If boolLUseSigFigs Then
                                                                .Selection.TypeText(Text:=CStr(DisplayNum(var1, LSigFig, False)))
                                                            Else
                                                                .Selection.TypeText(Text:=CStr(Format(var1, GetRegrDecStr(LSigFig))))
                                                            End If
                                                        Else
                                                            var1 = RoundToDecimalRAFZ(var3, intQCDec)
                                                            .Selection.TypeText(Format(var1, strQCDec))
                                                        End If

                                                        If IsNumeric(var1) Then
                                                            nr(3) = CDec(var1)
                                                        Else
                                                            nr(3) = var1
                                                        End If
                                                        nr(4) = 1
                                                        nr(5) = "Normal"

                                                    Else
                                                        .Selection.TypeText(var3)

                                                    End If

                                                    If StrComp(var4, "Y", CompareMethod.Text) = 0 Or StrComp(var5, "Y", CompareMethod.Text) = 0 Then
                                                        'enter superscript
                                                        strAA = NZ(arrInd(12, Count4 + 1), "a")
                                                        Call typeInSuperscriptFontSize12WithSpace(wd, strAA)
                                                        nr(6) = CStr(-1)
                                                    Else
                                                        nr(6) = CStr(0)
                                                    End If

                                                    Try
                                                        nr.EndEdit()
                                                        tblInd.Rows.Add(nr)
                                                    Catch ex As Exception

                                                    End Try
                                                End If


                                            End If

                                        End If

                                    Next

                                    int8 = -1
                                    If boolQCREPORTACCVALUES Then
                                    Else
                                        If boolE(Count3) Then
                                            int8 = int8 + 1
                                        End If
                                    End If

                                    intStart = int8

                                    Dim rowsInd() As DataRow = tblInd.Select("Type = 'Normal' AND Excluded = '0'")
                                    nE = rowsInd.Length

                                    'this is mean for individual Recovery values

                                    If boolSTATSMEAN Or BOOLMFTABLE Then

                                        Try
                                            'do Mean
                                            int8 = int8 + 1

                                            'arrind(
                                            If BOOLMFTABLE Then

                                                For Count5 = 1 To 3
                                                    Select Case Count5
                                                        Case 1
                                                            '20181130 LEE:
                                                            'BOOLDOINDREC is only for Count5=3
                                                            '20181201 LEE:
                                                            'This should always be individual values
                                                            '2018123 LEE:
                                                            'No it shouldn't! Proper logic:
                                                            If BOOLINCLMFCOLS Then 'this is MF

                                                                If BOOLDOINDREC Then
                                                                    Erase rowsInd
                                                                    rowsInd = tblInd.Select("Type = 'AMF' AND Excluded = '0'")
                                                                    nE = rowsInd.Length
                                                                    var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                Else
                                                                    'get var1 from PES/RS
                                                                    var1 = numMeanPESAPA / numMeanRSAPA
                                                                End If
                                                                var1 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            Else 'this is PARatio. Ind Cols Will always be present
                                                                'If BOOLDOINDREC Then
                                                                '    Erase rowsInd
                                                                '    rowsInd = tblInd.Select("Type = 'AMF' AND Excluded = '0'")
                                                                '    nE = rowsInd.Length
                                                                '    var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                'Else
                                                                '    var1 = nummeanRSPAR
                                                                'End If
                                                                Erase rowsInd
                                                                rowsInd = tblInd.Select("Type = 'AMF' AND Excluded = '0'")
                                                                nE = rowsInd.Length
                                                                var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)

                                                                If boolLUseSigFigsAreaRatio Then
                                                                    var1 = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                Else
                                                                    var1 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                End If
                                                            End If


                                                            'If BOOLINCLMFCOLS Then
                                                            '    'get var1 from PES/RS
                                                            '    var1 = numMeanPESAPA / numMeanRSAPA
                                                            'Else
                                                            '    'get var1 from RS PAR
                                                            '    var1 = numMeanRSAPA / numMeanRSISPA
                                                            '    If boolLUseSigFigsAreaRatio Then
                                                            '        nummeanRSPAR = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                            '    Else
                                                            '        nummeanRSPAR = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                            '    End If
                                                            'End If

                                                            'If BOOLDOINDREC Then
                                                            '    Erase rowsInd
                                                            '    rowsInd = tblInd.Select("Type = 'AMF' AND Excluded = '0'")
                                                            '    nE = rowsInd.Length
                                                            '    var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                                            'Else

                                                            '    If BOOLINCLMFCOLS Then
                                                            '        'get var1 from PES/RS
                                                            '        var1 = numMeanPESAPA / numMeanRSAPA
                                                            '    Else
                                                            '        'get var1 from RS PAR
                                                            '        var1 = numMeanRSAPA / numMeanRSISPA
                                                            '        If boolLUseSigFigsAreaRatio Then
                                                            '            nummeanRSPAR = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                            '        Else
                                                            '            nummeanRSPAR = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                            '        End If
                                                            '    End If

                                                            'End If

                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()


                                                        Case 2
                                                            '20181130 LEE:
                                                            'BOOLDOINDREC is only for Count5=3
                                                            '2018123 LEE:
                                                            'No it shouldn't! Proper logic:
                                                            If BOOLINCLMFCOLS Then 'this is MF
                                                                If BOOLDOINDREC Then
                                                                    Erase rowsInd
                                                                    rowsInd = tblInd.Select("Type = 'ISMF' AND Excluded = '0'")
                                                                    nE = rowsInd.Length
                                                                    var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                Else
                                                                    'get var1 from PES/RS
                                                                    var1 = numMeanPESISPA / numMeanRSISPA
                                                                End If
                                                                var1 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            Else 'this is PARatio. Ind Cols Will always be present
                                                                'If BOOLDOINDREC Then
                                                                '    Erase rowsInd
                                                                '    rowsInd = tblInd.Select("Type = 'ISMF' AND Excluded = '0'")
                                                                '    nE = rowsInd.Length
                                                                '    var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                'Else
                                                                '    var1 = nummeanPESPAR
                                                                'End If
                                                                Erase rowsInd
                                                                rowsInd = tblInd.Select("Type = 'ISMF' AND Excluded = '0'")
                                                                nE = rowsInd.Length
                                                                var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)

                                                                If boolLUseSigFigsAreaRatio Then
                                                                    var1 = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                Else
                                                                    var1 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                End If
                                                            End If


                                                            'If BOOLDOINDREC Then
                                                            '    Erase rowsInd
                                                            '    rowsInd = tblInd.Select("Type = 'ISMF' AND Excluded = '0'")
                                                            '    nE = rowsInd.Length
                                                            '    var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                                            'Else
                                                            '    'get var1 from PES/RS
                                                            '    'var1 = numMeanPESISPA / numMeanRSISPA

                                                            '    If BOOLINCLMFCOLS Then
                                                            '        'get var1 from PES/RS
                                                            '        'var1 = numMeanPESAPA / numMeanRSAPA
                                                            '        var1 = numMeanPESISPA / numMeanRSISPA
                                                            '    Else
                                                            '        'get var1 from PES PAR
                                                            '        var1 = numMeanPESAPA / numMeanPESISPA
                                                            '        nummeanPESPAR = var1
                                                            '        If boolLUseSigFigsAreaRatio Then
                                                            '            nummeanPESPAR = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                            '        Else
                                                            '            nummeanPESPAR = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                            '        End If
                                                            '    End If

                                                            'End If

                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()

                                                        Case 3

                                                            ''20181130 LEE:
                                                            ''Maybe need something similar here
                                                            'If boolLUseSigFigsAreaRatio Then
                                                            '    nummeanRSPAR = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFig, False)
                                                            'Else
                                                            '    nummeanRSPAR = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                            'End If

                                                            If BOOLINCLINTSTDNMF Then
                                                                If BOOLDOINDREC Then
                                                                    If BOOLINCLINTSTDNMF Then
                                                                        Erase rowsInd
                                                                        rowsInd = tblInd.Select("Type = 'ISNMF' AND Excluded = '0'")
                                                                        nE = rowsInd.Length
                                                                        var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                    End If
                                                                Else
                                                                    If BOOLINCLMFCOLS Then
                                                                        'get var1 from PES/RS
                                                                        var1 = numMeanAMF / numMeanISMF
                                                                    Else
                                                                        var1 = nummeanPESPAR / nummeanRSPAR
                                                                    End If
                                                                End If
                                                            End If

                                                            If BOOLINCLINTSTDNMF Then
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                            Else
                                                                GoTo nextCount5b
                                                            End If

                                                    End Select

                                                    If boolNAStat Then
                                                        .Selection.TypeText("NA")
                                                        var2 = 0
                                                        boolHasNA = True 'for legend purposes
                                                    Else

                                                        'If Count3 < 3 And BOOLINCLMFCOLS = False Then
                                                        '    If boolLUseSigFigsAreaRatio Then
                                                        '        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                        '    Else
                                                        '        var2 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                        '    End If
                                                        'Else
                                                        '    If BOOLRECSIGFIG Then
                                                        '        If boolLUseSigFigs Then
                                                        '            var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                        '        Else
                                                        '            var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                        '        End If
                                                        '    Else
                                                        '        'RoundToDecimalRAFZ
                                                        '        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                        '    End If
                                                        'End If

                                                        '20181129 LEE:
                                                        'below is the correct logic
                                                        '*****

                                                        If Count5 = 3 Then
                                                            If BOOLINCLINTSTDNMF Then
                                                                '20181130 LEE:
                                                                'ignore BOOLRECSIGFIG here
                                                                'Matrix Factor should always be sigfig
                                                                var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                'If BOOLRECSIGFIG Then
                                                                '    If boolLUseSigFigs Then
                                                                '        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                '    Else
                                                                '        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                '    End If
                                                                'Else
                                                                '    var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                'End If
                                                            End If

                                                        Else
                                                            If BOOLINCLMFCOLS Then
                                                                '20181130 LEE:
                                                                'ignore BOOLRECSIGFIG here
                                                                'Matrix Factor should always be sigfig
                                                                var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)

                                                                'If BOOLRECSIGFIG Then
                                                                '    If boolLUseSigFigs Then
                                                                '        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                '    Else
                                                                '        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                '    End If
                                                                'Else
                                                                '    var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                'End If
                                                            Else
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                Else
                                                                    var2 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                End If
                                                            End If
                                                        End If


                                                        '*****
                                                        If Count5 = 3 Then
                                                            '20181130 LEE:
                                                            'ignore BOOLRECSIGFIG here
                                                            'Matrix Factor should always be sigfig
                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                            'If BOOLRECSIGFIG Then
                                                            '    If boolLUseSigFigs Then
                                                            '        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                            '    Else
                                                            '        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                            '    End If
                                                            'Else
                                                            '    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                            'End If

                                                        Else

                                                            If BOOLINCLMFCOLS Then
                                                                '20181130 LEE:
                                                                'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                'If BOOLRECSIGFIG Then
                                                                '    If boolLUseSigFigs Then
                                                                '        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                '    Else
                                                                '        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                '    End If
                                                                'Else
                                                                '    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                'End If

                                                            Else
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                                Else
                                                                    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFigAreaRatio))))
                                                                End If
                                                            End If

                                                        End If


                                                    End If

                                                    Select Case Count5

                                                        Case 1
                                                            numB = var2
                                                            numMeanAMF = numB

                                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "AMF", var2, CSng(var10), Count1, strDo, 0, 0, False)

                                                        Case 2
                                                            numB = var2
                                                            numMeanISMF = numB

                                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "ISMF", var2, CSng(var10), Count1, strDo, 0, 0, False)

                                                        Case 3
                                                            numB = var2
                                                            numMeanISNMF = numB

                                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "ISNMF", var2, CSng(var10), Count1, strDo, 0, 0, False)
                                                            If gboolMeanFullPrec Then
                                                                '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                                arr1(1, Count3 + 1) = var1
                                                                arr1(2, Count3 + 1) = var1
                                                            Else
                                                                arr1(1, Count3 + 1) = var2
                                                                arr1(2, Count3 + 1) = var2
                                                            End If

                                                    End Select

nextCount5b:


                                                Next Count5

                                            Else

                                                '20170726 LEE:
                                                'if no ind, then use a/b
                                                If (BOOLDOINDREC Or BOOLDIFFCOLSTATS) Then
                                                    var1 = MeanDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                Else
                                                    'var1 = numAFP / numBFP * 100
                                                    If gboolMeanFullPrec Then
                                                        '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                        If boolPOSLEG Then
                                                            If numB = 0 Then
                                                                var1 = 0
                                                            Else
                                                                var1 = numAFP / numBFP * 100
                                                            End If

                                                        Else
                                                            If numA = 0 Then
                                                                var1 = 0
                                                            Else
                                                                var1 = numBFP / numAFP * 100
                                                            End If

                                                        End If
                                                    Else
                                                        If boolPOSLEG Then
                                                            If numB = 0 Then
                                                                var1 = 0
                                                            Else
                                                                var1 = numA / numB * 100
                                                            End If

                                                        Else
                                                            If numA = 0 Then
                                                                var1 = 0
                                                            Else
                                                                var1 = numB / numA * 100
                                                            End If

                                                        End If
                                                    End If
                                                End If

                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()

                                                If boolNAStat Then
                                                    .Selection.TypeText("NA")
                                                    var2 = 0
                                                    boolHasNA = True 'for legend purposes
                                                Else

                                                    If BOOLRECSIGFIG Then
                                                        If boolLUseSigFigs Then
                                                            var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                        Else
                                                            var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                        End If
                                                    Else
                                                        var2 = RoundToDecimalRAFZ(var1, intQCDec)
                                                        .Selection.TypeText(Format(var2, strQCDec))

                                                    End If

                                                    If gboolMeanFullPrec Then
                                                        '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                        arr1(1, Count3 + 1) = var1
                                                        arr1(2, Count3 + 1) = var1
                                                    Else
                                                        arr1(1, Count3 + 1) = var2
                                                        arr1(2, Count3 + 1) = var2
                                                    End If

                                                End If

                                                numB = var2
                                                numMean = numB
                                                numMeanFP = var1
                                                numBFP = CDec(var1)

                                                If boolX And intNumLevels = 1 Then
                                                    'Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AveRecovery", numMean, CSng(var10), Count1, strDo, 0, 0, FALSE)
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "AveRecovery", numMean, CSng(var10), Count1, strDo, 0, 0, False)
                                                Else
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "Recovery", numMean, CSng(var10), Count1, strDo, 0, 0, False)
                                                End If

                                            End If

                                            var1 = var1 'debug

                                        Catch ex As Exception

                                        End Try

                                    End If

                                    If boolSTATSSD Or BOOLMFTABLE Then
                                        Try
                                            'do SD
                                            int8 = int8 + 1

                                            If BOOLMFTABLE Then

                                                For Count5 = 1 To 3

                                                    'herehere
                                                    Select Case Count5
                                                        Case 1

                                                            '2018123 LEE:
                                                            'No it shouldn't! Proper logic:
                                                            If BOOLINCLMFCOLS Then 'this is MF

                                                                If BOOLDOINDREC Then
                                                                    'Erase rowsInd
                                                                    'rowsInd = tblInd.Select("Type = 'AMF' AND Excluded = '0'")
                                                                    'nE = rowsInd.Length
                                                                    'var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                    'nummeanRSPAR = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)

                                                                    Erase rowsInd
                                                                    rowsInd = tblInd.Select("Type = 'AMF' AND Excluded = '0'")
                                                                    nE = rowsInd.Length
                                                                    var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                    var1 = var1 'debug

                                                                Else
                                                                    'get var1 from PES/RS
                                                                    var1 = "NA" ' numMeanPESAPA / numMeanRSAPA
                                                                End If

                                                            Else 'this is PARatio. Ind Cols Will always be present
                                                                Erase rowsInd
                                                                rowsInd = tblInd.Select("Type = 'AMF' AND Excluded = '0'")
                                                                nE = rowsInd.Length
                                                                var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                var1 = var1 'debug

                                                            End If


                                                            '20181130 LEE
                                                            'BOOLDOINDREC is only for Count5 = 3

                                                            ''***
                                                            ''Debug
                                                            'Dim CountAA As Int16
                                                            'Dim CountBB As Int16
                                                            'var1 = ""
                                                            'For CountBB = 0 To tblInd.Columns.Count - 1
                                                            '    var1 = var1 & ";" & tblInd.Columns(CountBB).ColumnName
                                                            'Next
                                                            'Console.WriteLine(var1)

                                                            'For CountAA = 0 To tblInd.Rows.Count - 1
                                                            '    var1 = ""
                                                            '    For CountBB = 0 To tblInd.Columns.Count - 1
                                                            '        var1 = var1 & ";" & tblInd.Rows(CountAA).Item(CountBB)
                                                            '    Next
                                                            '    Console.WriteLine(var1)
                                                            'Next
                                                            ''****

                                                            'If BOOLDOINDREC Then
                                                            '    Erase rowsInd
                                                            '    rowsInd = tblInd.Select("Type = 'AMF' AND Excluded = '0'")
                                                            '    nE = rowsInd.Length
                                                            '    var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)

                                                            'Else
                                                            '    var1 = "NA"
                                                            '    boolNAStat = True
                                                            'End If
                                                            'If BOOLINCLMFCOLS Then
                                                            '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                            'End If

                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()

                                                        Case 2

                                                            '2018123 LEE:
                                                            'No it shouldn't! Proper logic:
                                                            If BOOLINCLMFCOLS Then 'this is MF
                                                                If BOOLDOINDREC Then
                                                                    'Erase rowsInd
                                                                    'rowsInd = tblInd.Select("Type = 'AMF' AND Excluded = '0'")
                                                                    'nE = rowsInd.Length
                                                                    'var1 = MeanDRMF(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                    'nummeanRSPAR = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)

                                                                    Erase rowsInd
                                                                    rowsInd = tblInd.Select("Type = 'ISMF' AND Excluded = '0'")
                                                                    nE = rowsInd.Length
                                                                    var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                    var1 = var1 'debug

                                                                Else
                                                                    'get var1 from PES/RS
                                                                    var1 = "NA" ' numMeanPESAPA / numMeanRSAPA
                                                                End If
                                                            Else 'this is PARatio. Ind Cols Will always be present
                                                                Erase rowsInd
                                                                rowsInd = tblInd.Select("Type = 'ISMF' AND Excluded = '0'")
                                                                nE = rowsInd.Length
                                                                var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                var1 = var1 'debug
                                                            End If


                                                            ''20181130 LEE
                                                            ''BOOLDOINDREC is only for Count5 = 3
                                                            'Erase rowsInd
                                                            'rowsInd = tblInd.Select("Type = 'ISMF' AND Excluded = '0'")
                                                            'nE = rowsInd.Length
                                                            'var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                            'var1 = var1 'debug
                                                            ''If BOOLDOINDREC Then
                                                            ''    Erase rowsInd
                                                            ''    rowsInd = tblInd.Select("Type = 'ISMF' AND Excluded = '0'")
                                                            ''    nE = rowsInd.Length
                                                            ''    var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)

                                                            ''Else
                                                            ''    var1 = "NA"
                                                            ''    boolNAStat = True
                                                            ''End If
                                                            ''If BOOLINCLMFCOLS Then
                                                            ''    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                            ''End If

                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()

                                                        Case 3

                                                            If BOOLDOINDREC Then
                                                                If BOOLINCLINTSTDNMF Then
                                                                    Erase rowsInd
                                                                    rowsInd = tblInd.Select("Type = 'ISNMF' AND Excluded = '0'")
                                                                    nE = rowsInd.Length
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                                    var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                Else
                                                                    GoTo nextCount5c
                                                                End If
                                                            Else
                                                                If BOOLINCLINTSTDNMF Then
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                                    var1 = "NA"
                                                                    boolNAStat = True
                                                                Else
                                                                    GoTo nextCount5c
                                                                End If

                                                            End If



                                                    End Select

                                                    If nE < gSDMax Or boolNAStat Then
                                                        var2 = "NA"
                                                        boolHasNA = True 'for legend purposes
                                                        If Count5 = 3 Then
                                                            .Selection.TypeText("NA")
                                                        Else
                                                            'If BOOLINCLMFCOLS Then
                                                            '    .Selection.TypeText("NA")
                                                            'End If
                                                            .Selection.TypeText("NA")
                                                        End If


                                                    Else

                                                        If Count5 = 3 Then
                                                            '20181130 LEE:
                                                            'ignore BOOLRECSIGFIG here
                                                            'Matrix Factor should always be sigfig
                                                            var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            'If BOOLRECSIGFIG Then
                                                            '    If boolLUseSigFigs Then
                                                            '        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            '    Else
                                                            '        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                            '    End If
                                                            'Else
                                                            '    var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                            'End If
                                                        Else
                                                            If BOOLINCLMFCOLS Then 'values are MF
                                                                var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                'If BOOLRECSIGFIG Then
                                                                '    If boolLUseSigFigs Then
                                                                '        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                '    Else
                                                                '        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                '    End If
                                                                'Else
                                                                '    var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                'End If
                                                            Else 'values are PARatio
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                Else
                                                                    var2 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                End If
                                                            End If
                                                        End If

                                                        If Count5 = 3 Then
                                                            '20181130 LEE:
                                                            'ignore BOOLRECSIGFIG here
                                                            'Matrix Factor should always be sigfig
                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))

                                                            'If BOOLRECSIGFIG Then
                                                            '    If boolLUseSigFigs Then
                                                            '        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                            '    Else
                                                            '        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                            '    End If
                                                            'Else
                                                            '    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                            'End If

                                                        Else
                                                            If BOOLINCLMFCOLS Then 'is MF
                                                                .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                'If BOOLRECSIGFIG Then
                                                                '    If boolLUseSigFigs Then
                                                                '        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                '    Else
                                                                '        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                '    End If
                                                                'Else
                                                                '    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                'End If

                                                            Else 'is PARatio
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                                Else
                                                                    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFigAreaRatio))))
                                                                End If
                                                            End If
                                                        End If


                                                        Select Case Count5
                                                            Case 1
                                                                numSDAMF = var2
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "SDAMF", numSDAMF, CSng(var10), Count1, strDo, 0, 0, False)
                                                            Case 2
                                                                numSDISMF = var2
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "SDISMF", numSDISMF, CSng(var10), Count1, strDo, 0, 0, False)
                                                            Case 3
                                                                numSDISNMF = var2
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "SDISNMF", numSDISNMF, CSng(var10), Count1, strDo, 0, 0, False)
                                                        End Select

                                                    End If

nextCount5c:

                                                Next Count5

                                                '20181205 LEE:
                                                'BOOLDIFFCOLSTATS no longer used in Recovery/MF tables
                                                'ElseIf BOOLDIFFCOLSTATS = False Then
                                                '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                '    boolHasNA = True 'for legend purposes
                                                '    .Selection.TypeText("NA")
                                            Else

                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()

                                                If nE < gSDMax Or boolNAStat Then
                                                    var2 = "NA"
                                                    boolHasNA = True 'for legend purposes
                                                    .Selection.TypeText("NA")
                                                Else

                                                    var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)

                                                    If BOOLINCLMFCOLS Then
                                                        If BOOLRECSIGFIG Then
                                                            If boolLUseSigFigs Then
                                                                var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            Else
                                                                var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                            End If

                                                            If boolLUseSigFigs Then
                                                                .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                            Else
                                                                .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                            End If
                                                        Else
                                                            var2 = RoundToDecimalRAFZ(var1, intQCDec)
                                                            .Selection.TypeText(Format(var2, strQCDec))
                                                        End If
                                                    Else
                                                        If boolLUseSigFigsAreaRatio Then
                                                            var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                        Else
                                                            var2 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                        End If

                                                        If boolLUseSigFigsAreaRatio Then
                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                        Else
                                                            .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFigAreaRatio))))
                                                        End If
                                                    End If

                                                    numSD = var2

                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "SD", numSD, CSng(var10), Count1, strDo, 0, 0, False)

                                                End If

                                            End If

                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If boolSTATSCV Or BOOLMFTABLE Then
                                        Try
                                            'do %CV: ((numSD/numMean)*100
                                            int8 = int8 + 1

                                            If BOOLMFTABLE Then

                                                For Count5 = 1 To 3
                                                    Select Case Count5
                                                        Case 1
                                                            'If BOOLINCLMFCOLS Then
                                                            '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                            'End If
                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                            numPrec = CalcCVPercent(numSDAMF, numMeanAMF, intQCDec)
                                                        Case 2
                                                            'If BOOLINCLMFCOLS Then
                                                            '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                            'End If
                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                            numPrec = CalcCVPercent(numSDISMF, numMeanISMF, intQCDec)

                                                        Case 3
                                                            If BOOLINCLINTSTDNMF Then
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                                numPrec = CalcCVPercent(numSDISNMF, numMeanISNMF, intQCDec)
                                                            Else
                                                                GoTo nextCount5d
                                                            End If
                                                    End Select

                                                    If nE < gSDMax Then
                                                        var2 = "NA"
                                                        boolHasNA = True 'for legend purposes
                                                        If Count5 = 3 Then
                                                            .Selection.TypeText(var2)
                                                        Else
                                                            'If BOOLINCLMFCOLS Then
                                                            '    .Selection.TypeText(var2)
                                                            'End If
                                                            .Selection.TypeText(var2)
                                                        End If

                                                    Else

                                                        If Count5 = 3 Then
                                                            If BOOLDOINDREC Then
                                                                .Selection.TypeText(Format(numPrec, strQCDec))
                                                            Else
                                                                .Selection.TypeText("NA")
                                                            End If

                                                        Else
                                                            'If BOOLINCLMFCOLS Then
                                                            '    .Selection.TypeText(Format(numPrec, strQCDec))
                                                            'End If
                                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                                        End If


                                                        Select Case Count5
                                                            Case 1
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "PrecisionAMF", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                            Case 2
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "PrecisionISMF", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                            Case 3
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "PrecisionISNMF", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                        End Select

                                                    End If

nextCount5d:


                                                Next Count5

                                                '20181205 LEE:
                                                'BOOLDIFFCOLSTATS no longer used in Recovery/MF tables
                                                'ElseIf BOOLDIFFCOLSTATS = False Then
                                                '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                '    boolHasNA = True 'for legend purposes
                                                '    .Selection.TypeText("NA")
                                            Else

                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                If nE < gSDMax Or boolNAStat Then
                                                    var2 = "NA"
                                                    boolHasNA = True 'for legend purposes
                                                    .Selection.TypeText(var2)
                                                Else
                                                    numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                    .Selection.TypeText(Format(numPrec, strQCDec))
                                                    If boolX And intNumLevels = 1 Then
                                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AvePrecisionRec", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                    Else
                                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "Precision", numPrec, CSng(var10), Count1, strDo, 0, 0, False)
                                                    End If

                                                End If

                                            End If

                                        Catch ex As Exception

                                        End Try
                                    End If

                                    var1 = var1 'debug

                                    If boolSTATSBIAS And boolSTATSMEAN And BOOLMFTABLE = False Then
                                        Try
                                            'do %Bias: ((Mean/NomConc)*100
                                            int8 = int8 + 1

                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                            '.Selection.TypeText(var2)

                                            numBias = CalcREPercent(numMean, varNom, intQCDec)
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If boolTHEORETICAL And boolSTATSMEAN And BOOLMFTABLE = False Then
                                        Try
                                            'do %Theor: 100+((Mean/NomConc)*100
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                            '.Selection.TypeText(var2)

                                            numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                            numTheor = 100 + CDec(numTheor)
                                            .Selection.TypeText(Format(numTheor, strQCDec))
                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If boolSTATSDIFF And boolSTATSMEAN And BOOLMFTABLE = False Then
                                        Try
                                            'do %diff: ((Mean/NomConc)*100
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                            numBias = CalcREPercent(numMean, varNom, intQCDec)
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If BOOLSTATSRE And boolSTATSMEAN And BOOLMFTABLE = False Then
                                        Try
                                            'do %RE: ((Mean/NomConc)*100
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                            numBias = CalcREPercent(numMean, varNom, intQCDec)
                                            .Selection.TypeText(Format(numBias, strQCDec))
                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If boolSTATSN Then
                                        Try
                                            'n
                                            int8 = int8 + 1



                                            If BOOLMFTABLE Then

                                                For Count5 = 1 To 3

                                                    If BOOLINCLMFCOLS Then
                                                        Select Case Count5
                                                            Case 1
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                                If BOOLDOINDREC Then
                                                                    .Selection.TypeText(CStr(rowsInd.Length))
                                                                Else
                                                                    'If boolQCNA Then
                                                                    '    .Selection.TypeText("NA")
                                                                    'End If
                                                                    .Selection.TypeText("NA")
                                                                End If

                                                            Case 2
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                                If BOOLDOINDREC Then
                                                                    .Selection.TypeText(CStr(rowsInd.Length))
                                                                Else
                                                                    'If boolQCNA Then
                                                                    '    .Selection.TypeText("NA")
                                                                    'End If
                                                                    .Selection.TypeText("NA")
                                                                End If

                                                            Case 3
                                                                If BOOLINCLINTSTDNMF Then
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                                    If BOOLDOINDREC Then
                                                                        .Selection.TypeText(CStr(rowsInd.Length))
                                                                    Else
                                                                        'If boolQCNA Then
                                                                        '    .Selection.TypeText("NA")
                                                                        'End If
                                                                        .Selection.TypeText("NA")
                                                                    End If

                                                                Else
                                                                    GoTo nextCount5e
                                                                End If

                                                        End Select

                                                        Select Case Count5
                                                            Case 1
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "nAMF", rowsInd.Length, CSng(var10), Count1, strDo, 0, 0, False)
                                                            Case 2
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "nISMF", rowsInd.Length, CSng(var10), Count1, strDo, 0, 0, False)
                                                            Case 3
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "nISNMF", rowsInd.Length, CSng(var10), Count1, strDo, 0, 0, False)
                                                        End Select

                                                    ElseIf BOOLINCLINTSTDNMF Then

                                                        'Select Case Count5

                                                        '    Case 3

                                                        '        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                        '        If BOOLDOINDREC Then
                                                        '            .Selection.TypeText(CStr(rowsInd.Length))
                                                        '        Else
                                                        '            If boolQCNA Then
                                                        '                .Selection.TypeText("NA")
                                                        '            End If
                                                        '        End If

                                                        '        Select Case Count5

                                                        '            Case 3
                                                        '                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "nISNMF", rowsInd.Length, CSng(var10), Count1, strDo, 0, 0, False)
                                                        '        End Select

                                                        'End Select
                                                        Select Case Count5
                                                            Case 1
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                            Case 2
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                            Case 3
                                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                        End Select

                                                        If BOOLDOINDREC Then
                                                            .Selection.TypeText(CStr(rowsInd.Length))
                                                        Else
                                                            .Selection.TypeText("NA")
                                                        End If

                                                        Select Case Count5

                                                            Case 3
                                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "nISNMF", rowsInd.Length, CSng(var10), Count1, strDo, 0, 0, False)
                                                        End Select

                                                    Else
                                                        var1 = var1 'debug

                                                    End If
                                                    '
nextCount5e:

                                                Next Count5

                                                '20181205 LEE:
                                                'BOOLDIFFCOLSTATS no longer used in Recovery/MF tables
                                                'ElseIf BOOLDIFFCOLSTATS = False Then
                                                '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                '    boolHasNA = True 'for legend purposes
                                                '    .Selection.TypeText("NA")
                                            Else
                                                .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                .Selection.TypeText(CStr(rowsInd.Length))
                                                If boolX And intNumLevels = 1 Then
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "Aven", rowsInd.Length, CSng(var10), Count1, strDo, 0, 0, False)
                                                Else
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "n", rowsInd.Length, CSng(var10), Count1, strDo, 0, 0, False)
                                                End If
                                            End If



                                        Catch ex As Exception

                                        End Try
                                    End If

                                    If boolQCREPORTACCVALUES Then
                                    Else

                                        Erase rowsInd
                                        rowsInd = tblInd.Select("Type = 'Normal'")

                                        If boolE(Count3) Then
                                            int8 = int8 + 2
                                            boolNAStat = False

                                            If boolSTATSMEAN Or BOOLMFTABLE Then

                                                int8 = int8 + 1

                                                Try
                                                    'do Mean

                                                    If BOOLMFTABLE Then

                                                        For Count5 = 1 To 3
                                                            Select Case Count5

                                                                Case 1

                                                                    If BOOLDOINDREC Then
                                                                        Erase rowsInd
                                                                        rowsInd = tblInd.Select("Type = 'AMF'")
                                                                        var1 = MeanDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                    Else
                                                                        'get var1 from PES/RS
                                                                        'var1 = numMeanPESAPA_Out / numMeanRSAPA_Out

                                                                        If BOOLINCLMFCOLS Then
                                                                            'get var1 from PES/RS
                                                                            var1 = numMeanPESAPA_Out / numMeanRSAPA_Out
                                                                        Else
                                                                            'get var1 from RS PAR
                                                                            var1 = numMeanRSAPA_Out / numMeanRSISPA_Out
                                                                            If boolLUseSigFigsAreaRatio Then
                                                                                nummeanRSPAR = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                            Else
                                                                                nummeanRSPAR = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                            End If
                                                                        End If

                                                                    End If
                                                                    'If BOOLINCLMFCOLS Then
                                                                    '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                                    'End If
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                                Case 2
                                                                    If BOOLDOINDREC Then
                                                                        Erase rowsInd
                                                                        rowsInd = tblInd.Select("Type = 'ISMF'")
                                                                        var1 = MeanDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                    Else
                                                                        'get var1 from PES/RS
                                                                        'var1 = numMeanPESISPA_Out / numMeanRSISPA_Out

                                                                        If BOOLINCLMFCOLS Then
                                                                            'get var1 from PES/RS
                                                                            'var1 = numMeanPESAPA / numMeanRSAPA
                                                                            var1 = numMeanPESISPA_Out / numMeanRSISPA_Out
                                                                        Else
                                                                            'get var1 from PES PAR
                                                                            var1 = numMeanPESAPA_Out / numMeanPESISPA_Out
                                                                            'nummeanPESPAR_Out = var1
                                                                            'If boolLUseSigFigs Then
                                                                            '    nummeanPESPAR_Out = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                            'Else
                                                                            '    nummeanPESPAR_Out = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                            'End If
                                                                            '20181129 LEE:
                                                                            '????
                                                                            If boolLUseSigFigsAreaRatio Then
                                                                                nummeanPESPAR = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                            Else
                                                                                nummeanPESPAR = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                            End If

                                                                        End If

                                                                    End If

                                                                    'If BOOLINCLMFCOLS Then
                                                                    '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                                    'End If
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                                Case 3

                                                                    ''20181130 LEE:
                                                                    ''Maybe need something similar here
                                                                    'If boolLUseSigFigsAreaRatio Then
                                                                    '    nummeanRSPAR = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFig, False)
                                                                    'Else
                                                                    '    nummeanRSPAR = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                    'End If

                                                                    If BOOLDOINDREC Then
                                                                        If BOOLINCLINTSTDNMF Then
                                                                            'Erase rowsInd
                                                                            'rowsInd = tblInd.Select("Type = 'ISNMF' AND Excluded = '0'")
                                                                            'nE = rowsInd.Length
                                                                            'var1 = MeanDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                            Erase rowsInd
                                                                            rowsInd = tblInd.Select("Type = 'ISNMF'")
                                                                            var1 = MeanDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                                        End If
                                                                    Else
                                                                        If BOOLINCLINTSTDNMF Then
                                                                            'get var1 from PES/RS
                                                                            var1 = numMeanAMF_Out / numMeanISMF_Out
                                                                        End If
                                                                    End If
                                                                    If BOOLINCLINTSTDNMF Then
                                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                                    Else
                                                                        GoTo nextCount5f
                                                                    End If

                                                            End Select

                                                            If boolNAStat Then
                                                                If Count5 = 3 Then
                                                                    .Selection.TypeText("NA")
                                                                Else
                                                                    If BOOLINCLMFCOLS Then
                                                                        .Selection.TypeText("NA")
                                                                    End If
                                                                End If


                                                                boolHasNA = True 'for legend purposes
                                                                var2 = 0
                                                            Else

                                                                'If BOOLRECSIGFIG Then
                                                                '    If boolLUseSigFigs Then
                                                                '        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                '    Else
                                                                '        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                '    End If
                                                                'Else
                                                                '    var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                'End If

                                                                If Count3 < 3 And BOOLINCLMFCOLS = False Then
                                                                    If boolLUseSigFigsAreaRatio Then
                                                                        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                    Else
                                                                        var2 = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                    End If
                                                                Else
                                                                    '20181130 LEE:
                                                                    'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                    var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                    'If BOOLRECSIGFIG Then
                                                                    '    If boolLUseSigFigs Then
                                                                    '        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                    '    Else
                                                                    '        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                    '    End If
                                                                    'Else
                                                                    '    'RoundToDecimalRAFZ
                                                                    '    var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                    'End If

                                                                End If


                                                                Select Case Count5
                                                                    Case 1
                                                                        numMeanAMF_Out = var2
                                                                    Case 2
                                                                        numMeanISMF_Out = var2
                                                                    Case 3
                                                                        numMeanISNMF_Out = var2

                                                                        If gboolMeanFullPrec Then
                                                                            '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                                            arr1(2, Count3 + 1) = var1
                                                                        Else
                                                                            arr1(2, Count3 + 1) = var2
                                                                        End If

                                                                End Select

                                                                If Count5 = 3 Then
                                                                    '20181130 LEE:
                                                                    'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                    If BOOLDOINDREC Then
                                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                    End If

                                                                    'If BOOLRECSIGFIG Then
                                                                    '    If boolLUseSigFigs Then
                                                                    '        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                    '    Else
                                                                    '        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                    '    End If
                                                                    'Else
                                                                    '    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                    'End If
                                                                Else
                                                                    If BOOLDOINDREC Then
                                                                        If BOOLINCLMFCOLS Then
                                                                            If BOOLRECSIGFIG Then
                                                                                If boolLUseSigFigs Then
                                                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                                Else
                                                                                    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                                End If
                                                                            Else
                                                                                .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                            End If
                                                                        Else
                                                                            If boolLUseSigFigsAreaRatio Then
                                                                                .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                                            Else
                                                                                .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFigAreaRatio))))
                                                                            End If
                                                                        End If
                                                                    Else
                                                                        var1 = "NA"
                                                                    End If

                                                                End If


                                                            End If

nextCount5f:

                                                        Next Count5

                                                    Else

                                                        'var1 = MeanDR(rowsInd, "Col6", False, "ColAliq", False, False)

                                                        '20170726 LEE:
                                                        'if no ind, then use a/b
                                                        If (BOOLDOINDREC And BOOLDIFFCOLSTATS) Then
                                                            var1 = MeanDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                        Else

                                                            If gboolMeanFullPrec Then
                                                                '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                                If boolPOSLEG Then
                                                                    If numB = 0 Then
                                                                        var1 = 0
                                                                    Else
                                                                        var1 = numAIFP / numBIFP * 100
                                                                    End If

                                                                Else
                                                                    If numA = 0 Then
                                                                        var1 = 0
                                                                    Else
                                                                        var1 = numBIFP / numAIFP * 100
                                                                    End If

                                                                End If
                                                            Else
                                                                If boolPOSLEG Then
                                                                    If numB = 0 Then
                                                                        var1 = 0
                                                                    Else
                                                                        var1 = numAI / numBI * 100
                                                                    End If

                                                                Else
                                                                    If numA = 0 Then
                                                                        var1 = 0
                                                                    Else
                                                                        var1 = numBI / numAI * 100
                                                                    End If

                                                                End If
                                                            End If

                                                        End If

                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()

                                                        If boolNAStat Then
                                                            .Selection.TypeText("NA")
                                                            boolHasNA = True 'for legend purposes
                                                            var2 = 0
                                                        Else
                                                            If BOOLRECSIGFIG Then
                                                                If boolLUseSigFigs Then
                                                                    var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                Else
                                                                    var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                End If

                                                                If boolLUseSigFigs Then
                                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                Else
                                                                    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                End If
                                                            Else
                                                                var2 = RoundToDecimalRAFZ(var1, intQCDec)
                                                                .Selection.TypeText(Format(var2, strQCDec))
                                                            End If

                                                        End If

                                                        If gboolMeanFullPrec Then
                                                            '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                            arr1(2, Count3 + 1) = var1
                                                        Else
                                                            arr1(2, Count3 + 1) = var2
                                                        End If

                                                        numBI = var2
                                                        numMean = numBI
                                                        numMeanFP = CDec(var1)
                                                        numBIFP = CDec(var1)

                                                    End If



                                                Catch ex As Exception

                                                End Try
                                            End If

                                            If boolSTATSSD Then
                                                Try
                                                    'do SD
                                                    int8 = int8 + 1

                                                    If BOOLMFTABLE Then
                                                        For Count5 = 1 To 3
                                                            Select Case Count5
                                                                Case 1

                                                                    If BOOLDOINDREC Then
                                                                        var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                        Erase rowsInd
                                                                        rowsInd = tblInd.Select("Type = 'AMF'")
                                                                        var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                        nE = rowsInd.Length
                                                                    Else
                                                                        var1 = "NA"
                                                                        boolNAStat = True
                                                                    End If

                                                                    'If BOOLINCLMFCOLS Then
                                                                    '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                                    'End If
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                                Case 2
                                                                    Erase rowsInd
                                                                    rowsInd = tblInd.Select("Type = 'ISMF'")
                                                                    var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                    'If BOOLINCLMFCOLS Then
                                                                    '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                                    'End If
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                                Case 3
                                                                    If BOOLINCLINTSTDNMF Then
                                                                        Erase rowsInd
                                                                        rowsInd = tblInd.Select("Type = 'ISNMF'")
                                                                        var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)
                                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()

                                                                    Else
                                                                        GoTo nextCount5g
                                                                    End If
                                                            End Select

                                                            If nI < gSDMax Or boolNAStat Then
                                                                var2 = "NA"
                                                                boolHasNA = True 'for legend purposes
                                                                If Count5 = 3 Then
                                                                    .Selection.TypeText(var2)
                                                                Else
                                                                    If BOOLINCLMFCOLS Then
                                                                        .Selection.TypeText(var2)
                                                                    End If
                                                                End If
                                                            Else

                                                                If Count5 = 3 Then
                                                                    '20181130 LEE:
                                                                    'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                    var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                Else
                                                                    If BOOLRECSIGFIG Then
                                                                        If boolLUseSigFigs Then
                                                                            var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                        Else
                                                                            var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                        End If
                                                                    Else
                                                                        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                    End If
                                                                End If

                                                                If Count5 = 3 Then
                                                                    '20181130 LEE:
                                                                    'ignore BOOLRECSIGFIG, MF is always sigfig
                                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                    'If BOOLRECSIGFIG Then
                                                                    '    If boolLUseSigFigs Then
                                                                    '        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                    '    Else
                                                                    '        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                    '    End If
                                                                    'Else
                                                                    '    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                    'End If

                                                                Else
                                                                    If BOOLINCLMFCOLS Then
                                                                        If BOOLRECSIGFIG Then
                                                                            If boolLUseSigFigs Then
                                                                                .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                            Else
                                                                                .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                            End If
                                                                        Else
                                                                            .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                        End If
                                                                    Else
                                                                        If boolLUseSigFigsAreaRatio Then
                                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFigAreaRatio, False)))
                                                                        Else
                                                                            .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFigAreaRatio))))
                                                                        End If
                                                                    End If
                                                                End If

                                                                Select Case Count5
                                                                    Case 1
                                                                        numSDAMF = var2
                                                                    Case 2
                                                                        numSDISMF = var2
                                                                    Case 3
                                                                        numSDISNMF = var2
                                                                End Select


                                                            End If

nextCount5g:

                                                        Next Count5

                                                        '20181205 LEE:
                                                        'BOOLDIFFCOLSTATS no longer used in Recovery/MF tables
                                                        'ElseIf BOOLDIFFCOLSTATS = False Then
                                                        '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                        '    boolHasNA = True 'for legend purposes
                                                        '    .Selection.TypeText("NA")
                                                    Else

                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()

                                                        If nI < gSDMax Or boolNAStat Then
                                                            var2 = "NA"
                                                            boolHasNA = True 'for legend purposes
                                                        Else

                                                            var1 = StdDevDR(rowsInd, "Col6", False, "ColAliq", False, False)

                                                            If BOOLRECSIGFIG Then
                                                                If boolLUseSigFigs Then
                                                                    var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                Else
                                                                    var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                                End If

                                                                If boolLUseSigFigs Then
                                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                                Else
                                                                    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                                End If
                                                            Else
                                                                var2 = RoundToDecimalRAFZ(var1, intQCDec)
                                                                .Selection.TypeText(Format(var2, strQCDec))
                                                            End If

                                                            numSD = var2


                                                        End If

                                                    End If

                                                Catch ex As Exception

                                                End Try
                                            End If

                                            If boolSTATSCV Or BOOLMFTABLE Then
                                                Try
                                                    'do %CV: ((numSD/numMean)*100
                                                    int8 = int8 + 1

                                                    If BOOLMFTABLE Then
                                                        For Count5 = 1 To 3
                                                            Select Case Count5
                                                                Case 1
                                                                    'If BOOLINCLMFCOLS Then
                                                                    '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                                    'End If
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                                    numPrec = CalcCVPercent(numSDAMF, numMeanAMF, intQCDec)
                                                                Case 2
                                                                    'If BOOLINCLMFCOLS Then
                                                                    '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                                    'End If
                                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                                    numPrec = CalcCVPercent(numSDISMF, numMeanISMF, intQCDec)
                                                                Case 3
                                                                    If BOOLINCLINTSTDNMF Then
                                                                        If BOOLINCLMFCOLS Then
                                                                            .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISNMF).Select()
                                                                        End If
                                                                        numPrec = CalcCVPercent(numSDISNMF, numMeanISNMF, intQCDec)
                                                                    Else
                                                                        GoTo nextCount5h
                                                                    End If
                                                            End Select

                                                            If nI < gSDMax Or boolNAStat Then
                                                                var2 = "NA"
                                                                boolHasNA = True 'for legend purposes
                                                                If Count5 = 3 Then
                                                                    .Selection.TypeText(var2)
                                                                Else
                                                                    'If BOOLINCLMFCOLS Then
                                                                    '    .Selection.TypeText(var2)
                                                                    'End If
                                                                    .Selection.TypeText(var2)
                                                                End If

                                                            Else

                                                                If Count5 = 3 Then
                                                                    .Selection.TypeText(Format(numPrec, strQCDec))
                                                                Else
                                                                    'If BOOLINCLMFCOLS Then
                                                                    '    .Selection.TypeText(Format(numPrec, strQCDec))
                                                                    'End If
                                                                    .Selection.TypeText(Format(numPrec, strQCDec))
                                                                End If


                                                            End If

nextCount5h:

                                                        Next Count5

                                                        '20181205 LEE:
                                                        'BOOLDIFFCOLSTATS no longer used in Recovery/MF tables
                                                        'ElseIf BOOLDIFFCOLSTATS = False Then
                                                        '    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                        '    boolHasNA = True 'for legend purposes
                                                        '    .Selection.TypeText("NA")
                                                    Else
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                        If nI < gSDMax Or boolNAStat Then
                                                            var2 = "NA"
                                                            boolHasNA = True 'for legend purposes
                                                            .Selection.TypeText(var2)
                                                        Else
                                                            numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                                        End If
                                                    End If

                                                Catch ex As Exception

                                                End Try
                                            End If
                                            If boolSTATSBIAS And boolSTATSMEAN And BOOLMFTABLE = False Then
                                                Try
                                                    'do %Bias: ((Mean/NomConc)*100
                                                    int8 = int8 + 1

                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()

                                                    numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                Catch ex As Exception

                                                End Try
                                            End If

                                            If boolTHEORETICAL And boolSTATSMEAN And BOOLMFTABLE = False Then
                                                Try
                                                    'do %Theor:100+ ((Mean/NomConc)*100
                                                    int8 = int8 + 1

                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()

                                                    numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                                    numTheor = 100 + CDec(numTheor)
                                                    .Selection.TypeText(Format(numTheor, strQCDec))
                                                Catch ex As Exception

                                                End Try
                                            End If

                                            If boolSTATSDIFF And boolSTATSMEAN And BOOLMFTABLE = False Then
                                                Try
                                                    'do %Diff: ((Mean/NomConc)*100
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                    numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                Catch ex As Exception

                                                End Try
                                            End If

                                            If BOOLSTATSRE And boolSTATSMEAN And BOOLMFTABLE = False Then
                                                Try
                                                    'do %RE: ((Mean/NomConc)*100
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                    numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                    .Selection.TypeText(Format(numBias, strQCDec))
                                                Catch ex As Exception

                                                End Try
                                            End If

                                            Try
                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "n", nI, CSng(var10), Count1, strDo, 0, 0, False)
                                            Catch ex As Exception

                                            End Try

                                            If boolSTATSN Or BOOLMFTABLE Then
                                                Try
                                                    'n
                                                    int8 = int8 + 1

                                                    If BOOLMFTABLE Then
                                                        For Count5 = 1 To 3
                                                            Select Case Count5
                                                                Case 1
                                                                    If BOOLINCLMFCOLS Then
                                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colAMF).Select()
                                                                        .Selection.TypeText(CStr(nI))
                                                                    End If
                                                                Case 2
                                                                    If BOOLINCLMFCOLS Then
                                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                                        .Selection.TypeText(CStr(nI))
                                                                    End If
                                                                Case 3
                                                                    If BOOLINCLINTSTDNMF Then
                                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, colISMF).Select()
                                                                        .Selection.TypeText(CStr(nI))
                                                                    Else
                                                                        GoTo nextCount5i
                                                                    End If
                                                            End Select

nextCount5i:

                                                        Next Count5
                                                    Else
                                                        .Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int8, col6).Select()
                                                        .Selection.TypeText(CStr(nI))
                                                    End If


                                                Catch ex As Exception

                                                End Try
                                            End If

                                        End If

                                    End If

                                    var1 = var1

                                    'need to add IS-normalized column for Matrix Factor


                                    'end BOOLDOINDREC

                                Else

                                    'Note: Matrix Factor will not be performed here (see IF portion of this statement), so can skip Matrix factor logic
                                    'need to enter 'NA's


                                    If boolQCNA Then
                                        For Count4 = 0 To intRowsT - 1
                                            .Selection.Tables.Item(1).Cell(int1 + intInc + Count4, col6).Range.Text = "NA"
                                        Next
                                    End If


                                    If boolQCREPORTACCVALUES Then
                                        '.Selection.Tables.Item(1).Cell(int1 + intInc + intRowsT + 1 + int2, col6).Select()
                                        .Selection.Tables.Item(1).Cell(intRowCol6, col6).Select()

                                        If boolCombined Or boolTrue Then
                                            If gboolMeanFullPrec Then
                                                '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                If boolPOSLEG Then
                                                    If numB = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numAFP / numBFP * 100
                                                    End If

                                                Else
                                                    If numA = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numBFP / numAFP * 100
                                                    End If

                                                End If
                                            Else
                                                If boolPOSLEG Then
                                                    If numB = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numA / numB * 100
                                                    End If

                                                Else
                                                    If numA = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numB / numA * 100
                                                    End If

                                                End If
                                            End If
                                        ElseIf boolSE Then
                                            If gboolMeanFullPrec Then
                                                '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                If boolPOSLEG Then
                                                    If numA = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numBFP / numAFP * 100
                                                    End If

                                                Else
                                                    If numB = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numAFP / numBFP * 100
                                                    End If

                                                End If
                                            Else
                                                If boolPOSLEG Then
                                                    If numA = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numB / numA * 100
                                                    End If

                                                Else
                                                    If numB = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numA / numB * 100
                                                    End If

                                                End If
                                            End If
                                        End If

                                        ''20181109 LEE: SE should be %
                                        'If boolSE Then
                                        '    var1 = var1 / 100
                                        'End If

                                        If boolNAStat Then
                                            .Selection.TypeText("NA")
                                        Else
                                            If BOOLRECSIGFIG Then
                                                If boolLUseSigFigs Then
                                                    var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                Else
                                                    var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                End If

                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                End If
                                            Else
                                                var2 = CDec(RoundToDecimalRAFZ(var1, intQCDec))
                                                .Selection.TypeText(Format(var2, strQCDec))
                                            End If
                                            If gboolMeanFullPrec Then
                                                '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                arr1(1, Count3 + 1) = var1
                                            Else
                                                arr1(1, Count3 + 1) = var2
                                            End If
                                        End If

                                    Else
                                        If boolE(Count3) Then
                                            .Selection.Tables.Item(1).Cell(intRowCol6, col6).Select()

                                            If boolCombined Or boolTrue Then
                                                If gboolMeanFullPrec Then
                                                    '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                    If boolPOSLEG Then
                                                        If numB = 0 Then
                                                            var1 = 0
                                                        Else
                                                            var1 = numAFP / numBFP * 100
                                                        End If
                                                    Else
                                                        'var1 = numB / numA * 100
                                                        If numA = 0 Then
                                                            var1 = 0
                                                        Else
                                                            var1 = numBFP / numAFP * 100
                                                        End If
                                                    End If
                                                Else
                                                    If boolPOSLEG Then
                                                        If numB = 0 Then
                                                            var1 = 0
                                                        Else
                                                            var1 = numA / numB * 100
                                                        End If
                                                    Else
                                                        'var1 = numB / numA * 100
                                                        If numA = 0 Then
                                                            var1 = 0
                                                        Else
                                                            var1 = numB / numA * 100
                                                        End If
                                                    End If
                                                End If
                                            ElseIf boolSE Then
                                                If gboolMeanFullPrec Then
                                                    '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                    If boolPOSLEG Then
                                                        If numA = 0 Then
                                                            var1 = 0
                                                        Else
                                                            var1 = numBFP / numAFP * 100
                                                        End If
                                                    Else
                                                        'var1 = numB / numA * 100
                                                        If numB = 0 Then
                                                            var1 = 0
                                                        Else
                                                            var1 = numAFP / numBFP * 100
                                                        End If
                                                    End If
                                                Else
                                                    If boolPOSLEG Then
                                                        If numA = 0 Then
                                                            var1 = 0
                                                        Else
                                                            var1 = numB / numA * 100
                                                        End If
                                                    Else
                                                        'var1 = numB / numA * 100
                                                        If numB = 0 Then
                                                            var1 = 0
                                                        Else
                                                            var1 = numA / numB * 100
                                                        End If
                                                    End If
                                                End If
                                            End If

                                            '20181109 LEE: Why? SE should be %
                                            'If boolSE Then
                                            '    var1 = var1 / 100
                                            'End If

                                            If boolNAStat Then
                                                .Selection.TypeText("NA")
                                            Else
                                                If BOOLRECSIGFIG Then
                                                    If boolLUseSigFigs Then
                                                        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If

                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                    End If
                                                Else
                                                    var2 = CDec(RoundToDecimalRAFZ(var1, intQCDec))
                                                    .Selection.TypeText(Format(var2, strQCDec))
                                                End If
                                                If gboolMeanFullPrec Then
                                                    '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                    arr1(1, Count3 + 1) = var1
                                                Else
                                                    arr1(1, Count3 + 1) = var2
                                                End If
                                            End If

                                            '.Selection.Tables.Item(1).Cell(intRowCol6I, col6 + 1).Select()
                                            '20180123 LEE: ???
                                            .Selection.Tables.Item(1).Cell(intRowCol6I, col6).Select()

                                            If gboolMeanFullPrec Then
                                                '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                If boolPOSLEG Then

                                                    If numBI = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numAIFP / numBIFP * 100
                                                    End If
                                                Else
                                                    If numAI = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numBIFP / numAIFP * 100
                                                    End If

                                                End If
                                            Else
                                                If boolPOSLEG Then

                                                    If numBI = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numAI / numBI * 100
                                                    End If
                                                Else
                                                    If numAI = 0 Then
                                                        var1 = 0
                                                    Else
                                                        var1 = numBI / numAI * 100
                                                    End If

                                                End If
                                            End If

                                            If boolNAStat Then
                                                .Selection.TypeText("NA")
                                            Else
                                                If BOOLRECSIGFIG Then
                                                    If boolLUseSigFigs Then
                                                        var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If

                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                    End If
                                                Else
                                                    var2 = CDec(RoundToDecimalRAFZ(var1, intQCDec))
                                                    .Selection.TypeText(Format(var2, strQCDec))
                                                End If
                                                'If gboolMeanFullPrec Then
                                                '    '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                '    arr1(1, Count3 + 1) = var1
                                                'Else
                                                '    arr1(1, Count3 + 1) = var2
                                                'End If
                                                If gboolMeanFullPrec Then
                                                    '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                    arr1(2, Count3 + 1) = var1
                                                Else
                                                    arr1(2, Count3 + 1) = var2
                                                End If

                                            End If

                                        Else
                                            If boolETot And BOOLMFTABLE = False Then
                                                .Selection.Tables.Item(1).Cell(intRowCol6, col6).Select()
                                                Try
                                                    If boolCombined Or boolTrue Then
                                                        If gboolMeanFullPrec Then
                                                            '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                            If boolPOSLEG Then
                                                                If numB = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numAFP / numBFP * 100
                                                                End If

                                                            Else

                                                                If numA = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numBFP / numAFP * 100
                                                                End If
                                                            End If
                                                        Else
                                                            If boolPOSLEG Then
                                                                If numB = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numA / numB * 100
                                                                End If

                                                            Else

                                                                If numA = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numB / numA * 100
                                                                End If
                                                            End If
                                                        End If
                                                    ElseIf boolSE Then
                                                        If gboolMeanFullPrec Then
                                                            '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                            If boolPOSLEG Then
                                                                If numA = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numBFP / numAFP * 100
                                                                End If

                                                            Else

                                                                If numB = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numAFP / numBFP * 100
                                                                End If
                                                            End If
                                                        Else
                                                            If boolPOSLEG Then
                                                                If numA = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numB / numA * 100
                                                                End If

                                                            Else

                                                                If numB = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numA / numB * 100
                                                                End If
                                                            End If
                                                        End If
                                                    End If

                                                    ''20181109 LEE: SE is %
                                                    'If boolSE Then
                                                    '    var1 = var1 / 100
                                                    'End If

                                                Catch ex As Exception
                                                    var1 = 0
                                                End Try

                                                If boolNAStat Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    If BOOLRECSIGFIG Then
                                                        If boolLUseSigFigs Then
                                                            var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                        Else
                                                            var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                        End If
                                                    Else
                                                        var2 = CDec(RoundToDecimalRAFZ(var1, intQCDec))
                                                        .Selection.TypeText(Format(var2, strQCDec))
                                                    End If
                                                    If gboolMeanFullPrec Then
                                                        '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                        arr1(1, Count3 + 1) = var1
                                                        arr1(2, Count3 + 1) = var1
                                                    Else
                                                        arr1(1, Count3 + 1) = var2
                                                        arr1(2, Count3 + 1) = var2
                                                    End If
                                                End If


                                                .Selection.Tables.Item(1).Cell(intRowCol6, col6 + 1).Select()
                                                Try
                                                    If boolCombined Or boolTrue Then
                                                        If gboolMeanFullPrec Then
                                                            '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                            If boolPOSLEG Then
                                                                If numBFP = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numAFP / numBFP * 100
                                                                End If

                                                            Else
                                                                If numAFP = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numBFP / numAFP * 100
                                                                End If

                                                            End If
                                                        Else
                                                            If boolPOSLEG Then
                                                                If numB = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numA / numB * 100
                                                                End If

                                                            Else
                                                                If numA = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numB / numA * 100
                                                                End If

                                                            End If
                                                        End If
                                                    ElseIf boolSE Then
                                                        If gboolMeanFullPrec Then
                                                            '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                            If boolPOSLEG Then
                                                                If numAFP = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numBFP / numAFP * 100
                                                                End If

                                                            Else
                                                                If numBFP = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numAFP / numBFP * 100
                                                                End If

                                                            End If
                                                        Else
                                                            If boolPOSLEG Then
                                                                If numA = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numB / numA * 100
                                                                End If

                                                            Else
                                                                If numB = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numA / numB * 100
                                                                End If

                                                            End If
                                                        End If
                                                    End If


                                                Catch ex As Exception
                                                    var1 = 0
                                                End Try

                                                If boolNAStat Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    If BOOLRECSIGFIG Then
                                                        If boolLUseSigFigs Then
                                                            var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                        Else
                                                            var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                        End If
                                                    Else
                                                        var2 = CDec(RoundToDecimalRAFZ(var1, intQCDec))
                                                        .Selection.TypeText(Format(var2, strQCDec))
                                                    End If
                                                    If gboolMeanFullPrec Then
                                                        '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                        arr1(1, Count3 + 1) = var1
                                                        arr1(2, Count3 + 1) = var1
                                                    Else
                                                        arr1(1, Count3 + 1) = var2
                                                        arr1(2, Count3 + 1) = var2
                                                    End If
                                                End If

                                            Else

                                                .Selection.Tables.Item(1).Cell(intRowCol6, col6).Select()
                                                Try
                                                    If boolCombined Or boolTrue Then
                                                        If gboolMeanFullPrec Then
                                                            '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                            If boolPOSLEG Then
                                                                If numBFP = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numAFP / numBFP * 100
                                                                End If

                                                            Else
                                                                If numAFP = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numBFP / numAFP * 100
                                                                End If

                                                            End If
                                                        Else
                                                            If boolPOSLEG Then
                                                                If numB = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numA / numB * 100
                                                                End If

                                                            Else
                                                                If numA = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numB / numA * 100
                                                                End If

                                                            End If
                                                        End If
                                                    ElseIf boolSE Then
                                                        If gboolMeanFullPrec Then
                                                            '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                            If boolPOSLEG Then
                                                                If numBFP = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numBFP / numAFP * 100
                                                                End If

                                                            Else
                                                                If numBFP = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numAFP / numBFP * 100
                                                                End If

                                                            End If
                                                        Else
                                                            If boolPOSLEG Then
                                                                If numA = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numB / numA * 100
                                                                End If

                                                            Else
                                                                If numB = 0 Then
                                                                    var1 = 0
                                                                Else
                                                                    var1 = numA / numB * 100
                                                                End If

                                                            End If
                                                        End If
                                                    End If


                                                Catch ex As Exception
                                                    var1 = 0
                                                End Try

                                                If boolNAStat Then
                                                    .Selection.TypeText("NA")
                                                Else

                                                    If BOOLRECSIGFIG Then
                                                        If boolLUseSigFigs Then
                                                            var2 = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                        Else
                                                            var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(Text:=CStr(Format(var2, GetRegrDecStr(LSigFig))))
                                                        End If
                                                    Else
                                                        var2 = CDec(RoundToDecimalRAFZ(var1, intQCDec))
                                                        .Selection.TypeText(Format(var2, strQCDec))
                                                    End If
                                                    If gboolMeanFullPrec Then
                                                        '20161206 LEE: gboolMeanFullPrec has been deprecated. Only gboolMeanRounded = true (e.g. gboolMeanFullPrec = false) is allowed
                                                        arr1(1, Count3 + 1) = var1
                                                        arr1(2, Count3 + 1) = var1
                                                    Else
                                                        arr1(1, Count3 + 1) = var2
                                                        arr1(2, Count3 + 1) = var2
                                                    End If

                                                    var1 = var2

                                                End If

                                            End If

                                        End If
                                    End If

                                    ''''wdd.visible = True
                                    var1 = var2
                                    If boolX And intNumLevels = 1 Then
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "AveRecovery", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                    Else
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, Count3 + 1, "Recovery", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                    End If

                                End If

                                '20181205 LEE:
                                'Enter NA's
                                If boolQCNA And BOOLDOINDREC = False Then
                                    For Count4 = 1 To intCSN - 1
                                        .Selection.Tables.Item(1).Cell(intRowCol6 + Count4, col6).Range.Text = "NA"
                                    Next
                                End If

                                'intInc = intInc + intRowsT + 4 + 2
                                intInc = intInc + intRowsT + int8 + 1 + 2

                            Next

                            'now enter Mean/SD/%CV lables

                            int8 = 0
                            If BOOLINTRARUNSUMSTATS And intNumLevelsO > 1 Then

                                If BOOLMFTABLE Then
                                    If BOOLINCLINTSTDNMF Then
                                        'If BOOLINCLMFCOLS Then
                                        '    Call typeStatsLabels(wd, int8, intStatsStart, colISMF, True)
                                        'Else
                                        '    Call typeStatsLabels(wd, int8, intStatsStart, colPESISPA, True)
                                        'End If
                                        Call typeStatsLabels(wd, int8, intStatsStart, colISMF, True)
                                    Else
                                        'no Int Std Normalized MF column
                                        GoTo NoISNMFCol
                                    End If

                                Else
                                    Call typeStatsLabels(wd, int8, intStatsStart, col5, True)
                                End If

                                int8 = 0
                                'fill arr2
                                ReDim arr2(intNumLevelsO)
                                Dim decN As Decimal
                                Dim intDD As Short = 0
                                For Count3 = 1 To intNumLevelsO

                                    var1 = arr1(1, Count3)
                                    var2 = NZ(arr1(1, Count3), "NA")
                                    If IsNumeric(var2) Then
                                        intDD = intDD + 1
                                        'var1 = CDec(arr1(1, Count3))
                                        'arr2(intDD) = arr1(1, Count3)
                                        var1 = CDec(arr1(1, Count3))
                                        arr2(intDD) = var1 ' arr1(2, Count3)
                                    Else

                                    End If

                                Next

                                intNumLevels = intDD
                                ReDim Preserve arr2(intDD)

                                Try
                                    var1 = Mean(intNumLevels, arr2)
                                    numMeanFP = CDec(var1)

                                    '20160716 LEE:
                                    'Even though Recovery is a %, treat it as a Conc for sigfig considerations
                                    If BOOLRECSIGFIG Then
                                        If boolLUseSigFigs Then
                                            numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                        Else
                                            numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                        End If
                                    Else
                                        numMean = CDec(RoundToDecimalRAFZ(var1, intQCDec))
                                    End If

                                Catch ex As Exception

                                End Try

                                If boolSTATSMEAN Then
                                    Try
                                        int8 = int8 + 1
                                        'enter Mean

                                        If BOOLMFTABLE Then
                                            .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                        Else
                                            .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6).Select()
                                        End If

                                        var1 = Mean(intNumLevels, arr2)

                                        'NOTE: This is the mean of value whose format is always decimal
                                        'should format accordingly

                                        '
                                        numMeanFP = CDec(var1)

                                        If BOOLINCLINTSTDNMF And BOOLMFTABLE Then

                                            '20181202 LEE: use sigfigs for MF
                                            numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)

                                            .Selection.TypeText(Text:=CStr(DisplayNum(numMean, LSigFig, False)))
                                            var1 = DisplayNum(numMean, LSigFig, False)

                                        Else

                                            '20160716 LEE:
                                            'Even though Recovery is a %, treat it as a Conc for sigfig considerations
                                            '20181202 LEE:
                                            'No! Change logic back to normal logic: if a percentage, use decimals
                                            If BOOLRECSIGFIG Then
                                                If boolLUseSigFigs Then
                                                    numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                Else
                                                    numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                End If

                                                If boolLUseSigFigs Then
                                                    .Selection.TypeText(Text:=CStr(DisplayNum(numMean, LSigFig, False)))
                                                    var1 = DisplayNum(numMean, LSigFig, False)
                                                Else
                                                    .Selection.TypeText(Text:=CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                    var1 = Format(numMean, GetRegrDecStr(LSigFig))
                                                End If
                                            Else
                                                numMean = CDec(RoundToDecimalRAFZ(var1, intQCDec))
                                                .Selection.TypeText(Format(numMean, strQCDec))
                                                var1 = Format(numMean, strQCDec)
                                            End If
                                        End If
                                        

                                        If BOOLMFTABLE Then
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AveISNMF", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                        Else
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AveRecovery", var1, CSng(var10), Count1, strDo, 0, 0, False)
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                Try
                                    If intNumLevels < gSDMax Then
                                        numSD = 0
                                    Else
                                        var1 = StdDev(intNumLevels, arr2)

                                        'NOTE: This is the mean of value whose format is always decimal
                                        'should format accordingly

                                        '20160716 LEE:
                                        'Even though Recovery is a %, treat it as a Conc for sigfig considerations
                                        '20181202 LEE:
                                        'No! Change logic back to normal logic: if a percentage, use decimals
                                        If BOOLINCLINTSTDNMF And BOOLMFTABLE Then
                                            numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                        Else
                                            If BOOLRECSIGFIG Then
                                                If boolLUseSigFigs Then
                                                    numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                End If
                                            Else
                                                numSD = CDec(Format(var1, strQCDec))
                                            End If
                                        End If
                                      
                                    End If

                                    If BOOLMFTABLE Then
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AveSDISNMF", numSD, CSng(var10), Count1, strDo, 0, 0, False)
                                    Else
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AveRecSD", numSD, CSng(var10), Count1, strDo, 0, 0, False)
                                    End If



                                Catch ex As Exception

                                End Try

                                If boolSTATSSD Then
                                    Try
                                        'enter SD
                                        'numSD = StdDev(intNumLevels, arr2)
                                        int8 = int8 + 1

                                        If BOOLMFTABLE Then
                                            .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                        Else
                                            .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6).Select()
                                        End If

                                        If intNumLevels < gSDMax Then
                                            .Selection.TypeText("NA")
                                            boolHasNA = True
                                        Else
                                            var1 = StdDev(intNumLevels, arr2)

                                            'NOTE: This is the mean of value whose format is always decimal
                                            'should format accordingly

                                            '20160716 LEE:
                                            'Even though Recovery is a %, treat it as a Conc for sigfig considerations
                                            '20181202 LEE:
                                            'No! Change logic back to normal logic: if a percentage, use decimals
                                            If BOOLINCLINTSTDNMF And BOOLMFTABLE Then
                                                numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                .Selection.TypeText(Text:=CStr(DisplayNum(numSD, LSigFig, False)))
                                            Else
                                                If BOOLRECSIGFIG Then
                                                    If boolLUseSigFigs Then
                                                        numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If

                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(numSD, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                                    End If
                                                Else
                                                    numSD = CDec(Format(var1, strQCDec))
                                                    .Selection.TypeText(Format(numSD, strQCDec))
                                                End If
                                            End If
                                           

                                        End If

                                    Catch ex As Exception

                                    End Try
                                End If


                                Try

                                    If intNumLevels < gSDMax Then
                                        var1 = 0 '"NA"
                                    Else
                                        numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                        var1 = Format(numPrec, strQCDec)
                                    End If
                                    
                                    If BOOLMFTABLE Then
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AvePrecisionISNMF", CSng(var1), CSng(var10), Count1, strDo, 0, 0, False)
                                    Else
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AvePrecisionRec", CSng(var1), CSng(var10), Count1, strDo, 0, 0, False)
                                    End If
                                Catch ex As Exception
                                    var1 = var1
                                End Try
                                If boolSTATSCV Then
                                    Try
                                        'enter %CV
                                        int8 = int8 + 1
                                        If BOOLMFTABLE Then
                                            .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                        Else
                                            .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6).Select()
                                        End If

                                        If intNumLevels < gSDMax Then
                                            var1 = "NA"
                                            .Selection.TypeText(CStr(var1))
                                        Else
                                            .Selection.TypeText(Format(numPrec, strQCDec))
                                        End If


                                    Catch ex As Exception

                                    End Try
                                End If

                                '20161019 LEE:  Recovery and Matrix Factor do not have Accuracy

                                Try
                                    If BOOLMFTABLE Then
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AvenISNMF", intDD, CSng(var10), Count1, strDo, 0, 0, False)
                                    Else
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, 0, "AvenRec", intDD, CSng(var10), Count1, strDo, 0, 0, False)
                                    End If

                                Catch ex As Exception

                                End Try
                                If boolSTATSN Then
                                    Try
                                        'enter n
                                        int8 = int8 + 1
                                        If BOOLMFTABLE Then
                                            .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                        Else
                                            .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6).Select()
                                        End If
                                        var1 = intNumLevels
                                        .Selection.TypeText(CStr(var1))


                                    Catch ex As Exception

                                    End Try
                                End If

                                If boolQCREPORTACCVALUES Then
                                Else
                                    If boolETot And BOOLMFTABLE = False Then
                                        int8 = 0
                                        'fill arr2
                                        Dim intDDD As Short = 0
                                        ReDim arr2(intNumLevelsO)
                                        For Count3 = 1 To intNumLevelsO
                                            var1 = arr1(2, Count3)
                                            var2 = NZ(arr1(2, Count3), "NA")
                                            If IsNumeric(var2) Then
                                                intDDD = intDDD + 1
                                                'arr2(intDDD) = arr1(2, Count3)
                                                var1 = CDec(arr1(2, Count3))
                                                arr2(intDDD) = var1 ' arr1(1, Count3)
                                            End If

                                        Next
                                        intNumLevels = intDDD

                                        If boolSTATSMEAN Then
                                            Try
                                                int8 = int8 + 1
                                                'enter Mean

                                                If BOOLMFTABLE Then
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                                Else
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6 + 1).Select()
                                                End If

                                                var1 = Mean(intNumLevels, arr2)

                                                'NOTE: This is the mean of value whose format is always decimal
                                                'should format accordingly

                                                '
                                                numMeanFP = CDec(var1)

                                                '20160716 LEE:
                                                'Even though Recovery is a %, treat it as a Conc for sigfig considerations
                                                If BOOLRECSIGFIG Then
                                                    If boolLUseSigFigs Then
                                                        numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                    End If

                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(numMean, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                    End If
                                                Else
                                                    numMean = CDec(RoundToDecimalRAFZ(var1, intQCDec))
                                                    .Selection.TypeText(Format(numMean, strQCDec))
                                                End If

                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSSD Then
                                            Try
                                                'enter SD
                                                'numSD = StdDev(intNumLevels, arr2)
                                                int8 = int8 + 1
                                                If BOOLMFTABLE Then
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                                Else
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6 + 1).Select()
                                                End If
                                                If intNumLevels < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                    boolHasNA = True
                                                Else
                                                    var1 = StdDev(intNumLevels, arr2)
                                                    'NOTE: This is the mean of value whose format is always decimal
                                                    'should format accordingly

                                                    '20160716 LEE:
                                                    'Even though Recovery is a %, treat it as a Conc for sigfig considerations
                                                    If BOOLRECSIGFIG Then
                                                        If boolLUseSigFigs Then
                                                            numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                        End If

                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(Text:=CStr(DisplayNum(numSD, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(Text:=CStr(Format(numSD, GetRegrDecStr(LSigFig))))
                                                        End If
                                                    Else
                                                        numSD = CDec(Format(var1, strQCDec))
                                                        .Selection.TypeText(Format(numSD, strQCDec))
                                                    End If

                                                End If

                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSCV Then
                                            Try
                                                'enter %CV
                                                int8 = int8 + 1
                                                If BOOLMFTABLE Then
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                                Else
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6 + 1).Select()
                                                End If
                                                If intNumLevels < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                    .Selection.TypeText(Format(numPrec, strQCDec))
                                                End If

                                            Catch ex As Exception

                                            End Try
                                        End If
                                        If boolSTATSBIAS And boolSTATSMEAN Then
                                            Try
                                                'enter %Bias
                                                int8 = int8 + 1
                                                If BOOLMFTABLE Then
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                                Else
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6 + 1).Select()
                                                End If
                                                'var1 = Format((((numMean / numNomConc) - 1) * 100), strQCDec)
                                                '.Selection.TypeText(CStr(var1))

                                                numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                                .Selection.TypeText(Format(numBias, strQCDec))
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolTHEORETICAL And boolSTATSMEAN Then
                                            Try
                                                'enter %Theor
                                                int8 = int8 + 1
                                                If BOOLMFTABLE Then
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                                Else
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6 + 1).Select()
                                                End If
                                                'var1 = Format(100 + CDec(Format((((numMean / numNomConc) - 1) * 100), strQCDec)), strQCDec)
                                                '.Selection.TypeText(CStr(var1))

                                                numTheor = CalcREPercent(numMean, numNomConc, intQCDec)
                                                numTheor = 100 + CDec(numTheor)
                                                .Selection.TypeText(Format(numTheor, strQCDec))
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSDIFF And boolSTATSMEAN Then
                                            Try
                                                'enter %Diff
                                                int8 = int8 + 1
                                                If BOOLMFTABLE Then
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                                Else
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6 + 1).Select()
                                                End If
                                                numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                                .Selection.TypeText(Format(numBias, strQCDec))
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If BOOLSTATSRE And boolSTATSMEAN Then
                                            Try
                                                'enter %RE
                                                int8 = int8 + 1
                                                If BOOLMFTABLE Then
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                                Else
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6 + 1).Select()
                                                End If
                                                numBias = CalcREPercent(numMean, numNomConc, intQCDec)
                                                .Selection.TypeText(Format(numBias, strQCDec))
                                            Catch ex As Exception

                                            End Try
                                        End If

                                        If boolSTATSN Then
                                            Try
                                                'enter n
                                                int8 = int8 + 1
                                                If BOOLMFTABLE Then
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, colISNMF).Select()
                                                Else
                                                    .Selection.Tables.Item(1).Cell(intStatsStart + int8, col6 + 1).Select()
                                                End If
                                                var1 = intNumLevels
                                                .Selection.TypeText(CStr(var1))

                                            Catch ex As Exception

                                            End Try
                                        End If
                                    End If
                                End If

                            End If

NoISNMFCol:

                            'increase row position counter
                            If Count2 = intNumRuns - 1 Then
                                int1 = int1 + intRowsX + int8 + 1  '4
                            Else
                                int1 = int1 + intRowsX + int8 + 2 '5
                            End If

                        Next

                        'remove unused rows
                        Call RemoveRows(wd, 1)

                    Catch ex As Exception

                        str1 = "There was a problem preparing table:"
                        str1 = strM1 & ChrW(10) & ChrW(10) & str1
                        str1 = str1 & ChrW(10) & ChrW(10)
                        str1 = str1 & ex.Message
                        MsgBox(str1, vbInformation, "Problem...")

                    End Try



                    'bottom border this row
                    '.Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow)
                    '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                    ''.Selection.MoveRight Unit:=Microsoft.Office.Interop.Word.wdunits.word.wdunits.wdCharacter, Count:=ctQCs, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend
                    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.wdlinestyle.wdLineStyleSingle

                    'autofit window
                    .Selection.Tables.Item(1).Select()
                    With .Selection.Cells(1)
                        .WordWrap = False
                        .FitText = False
                    End With

                    'autofit table
                    Call AutoFitTable(wd, False)

                    'enter table number
                    If boolX Then
                        'str1 = "Summary of Internal Standard (" & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION") & ") Combined Recovery Calculations Data"
                        str1 = "Summary of Internal Standard (" & rows11(Count1 - 1).Item("AnalyteDescription") & ") Combined Recovery Calculations Data"
                    Else
                        str1 = "Summary of " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION") & " Combined Recovery Calculations Data"
                    End If

                    '***
                    If boolX Then
                        strA = "Internal Standard " & rows11(Count1 - 1).Item("AnalyteDescription")
                    Else
                        strA = rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                    End If
                    strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, boolX)
                    Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                    'Note: strTName is byRef and will return Table, number, caption, label

                    '***

                    'Call EnterTableNumber(wd, str1, 3)

                    'enter a table record in tblTableN
                    'ctTableN = ctTableN + 1
                    Dim dtblr As DataRow = tblTableN.NewRow
                    dtblr.BeginEdit()
                    dtblr.Item("TableNumber") = ctTableN
                    dtblr.Item("AnalyteName") = strDo 'arrAnalytes(1, Count1)
                    dtblr.Item("TableName") = strTNameO
                    dtblr.Item("TableID") = intTableID
                    dtblr.Item("CHARFCID") = charFCID
                    dtblr.Item("TableNameNew") = strTName
                    tblTableN.Rows.Add(dtblr)

                    'split table, if needed


                    ctLegend = ctLegend + 1
                    intLeg = intLeg + 1
                    arrLegend(1, intLeg) = "NA"
                    arrLegend(2, intLeg) = "Not Applicable"
                    arrLegend(3, intLeg) = False


                    '.Selection.Tables.item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                    '.Selection.Tables.item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)

                    Call AutoFitTable(wd, BOOLINCLUDEDATE)

                    strM = "Finalizing " & strTName & "..."
                    strM1 = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."

                    frmH.lblProgress.Text = strM1
                    frmH.Refresh()

                    str1 = frmH.lblProgress.Text

                    Call SplitTable(wd, 2, intLeg, arrLegend, str1, False, ctLegend + 2, False, False, False, intTableID)


                    Call AutoFitTable(wd, BOOLINCLUDEDATE)

                    ''wdd.visible = True

                    'move to line below table
                    Try
                        Call MoveOneCellDown(wd)
                    Catch ex As Exception

                    End Try

                    Call InsertLegend(wd, intTableID, idTR, boolX, 1)

                    var1 = "a" 'debugging

                    'Call MoveOneCellDown(wd) 'Don't Do!! called in InsertLegend

                    'enter formula

                End If

end1:
                If boolJustTable Then

                  

                    If StrComp(strX, "Yes", CompareMethod.Text) = 0 Then
                        strA = strAnalC
                    Else
                        str1 = strAnal
                        If gNumMatrix = 1 Then
                            strA = strAnalC
                        Else
                            strA = strAnal 'strAnalC has '..Matrix', don't want to pass that here
                        End If
                    End If
                    'No, just strAnal
                    strA = strAnal
                    str1 = strA

                    'Call JustTable(wd, str1, str2, strDo, strTName, intTableID)
                    If Len(str1) = 0 Then
                    Else


                        If boolX Then
                            strA = "Internal Standard " & strA
                        End If
                        strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, boolX)
                        Call JustTable(wd, str1, strTName, strDo, strTName, intTableID, strTempInfo, "", strTNameO, intGroup, idTR)
                    End If


                End If

next1:

            Next
end2:
        End With

        boolMeanRS = False

    End Sub


    Sub MVSummaryLowQCMatrixEffects_17(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal idTR As Int64)

        '20180803 LEE:
        'This table now supports Matrix Effect and Matrix Factor table as defined by 
        'H:\Team Drives\LabIntegrity_20180710\LabIntegrity\Administration\Quality System\Industry Guidelines\Europe\EuropeanBioanalyticalMethodsGuidance

        'chkboolME = boolME
        'If true, then prepare as Matrix Effect / Matrix Factor table

        'chkMFTable = BOOLMFTABLE
        'If true, then include an Overall Mean MF statistics section
        '   Mean, SD, %CV

        'chkINCLMFCOLS = BOOLINCLMFCOLS
        'If true, then calculate Mean MF = Average of Individual MF calculations
        '   - Do not show stats section for lots
        'If false, then calculate Mean MF = (Mean Lot Peak Area)/(Mean Solvent Peak Area)
        '   - Show stats section for lots

        '20180803 LEE: re-using BOOLCALCINTSTDNMF as Denominator choice


        Dim boolME As Boolean = BOOLDOINDREC
        Dim numMeanT0 As Decimal
        Dim boolMFStats As Boolean = BOOLMFTABLE


        Dim boolOC As Boolean = False 'bool if eliminated
        Dim numNomConc As Decimal
        Dim var1, var2, var3, var4, var5, var10
        Dim dvDo As System.Data.DataView
        Dim strTName As String
        Dim intDo As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim Count10 As Short
        Dim strDo As String
        Dim bool As Boolean
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim tbl1 As System.Data.DataTable
        Dim dv1 As System.Data.DataView
        Dim rows1() As DataRow
        Dim intRows1 As Short
        Dim strF1 As String
        Dim tbl2 As System.Data.DataTable
        Dim dv2 As System.Data.DataView
        Dim rows2() As DataRow
        Dim intRows2 As Short
        Dim strF2 As String
        Dim tbl3 As System.Data.DataTable
        Dim dv3 As System.Data.DataView
        Dim rows3() As DataRow
        Dim intRows3 As Short
        Dim strF3 As String
        Dim intTableID As Short
        Dim tbl4 As System.Data.DataTable
        Dim dv4 As System.Data.DataView
        Dim rows4() As DataRow
        Dim intRows4 As Short
        Dim strF4 As String
        Dim strS As String
        Dim intNumRuns As Short
        Dim dv As System.Data.DataView
        Dim tblNumRuns As System.Data.DataTable
        Dim tblLevels As System.Data.DataTable
        Dim intNumLevels As Short
        Dim intTblRows As Short
        Dim wrdSelection As Microsoft.Office.Interop.Word.Selection
        Dim strF As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim int4 As Short
        Dim int10 As Short
        Dim intRowsX As Short
        Dim tblX As System.Data.DataTable
        Dim varNom
        Dim strConcUnits As String
        Dim intLeg As Short
        Dim ctQCLegend As Short
        Dim ctDilLeg As Short
        Dim strA As String
        Dim strB As String

        Dim ctLegend As Short
        Dim fontsize
        Dim boolPro As Boolean

        Dim varConc

        Dim hi, lo
        Dim rows10() As DataRow
        Dim rows11() As DataRow
        Dim intRowsAnal As Short
        Dim arrFP(2, 20) 'FlagPercent array
        Dim strFP As String
        Dim numMean As Decimal
        Dim numBias As Decimal
        Dim numSD As Decimal
        Dim tblZ As System.Data.DataTable
        Dim dvAn As System.Data.DataView
        Dim tblAnGo As New System.Data.DataTable
        Dim p1, p2, p3, p4, p5, p6, p7, p8, p9, p10
        Dim strM As String
        Dim fonts
        Dim numDF As Decimal
        Dim DilFactor
        Dim strF2a As String
        Dim varCol
        Dim rowsX() As DataRow
        Dim intLegStart As Short
        Dim boolJustTable As Boolean
        Dim strTempInfo As String

        Dim intExp As Short
        Dim ctExp As Short
        Dim int8 As Short

        Dim rows2E() As DataRow
        Dim nE As Short
        Dim nI As Short
        Dim boolOutHeadE As Boolean = False
        Dim boolOutHeadI As Boolean = False
        Dim boolDeleteRows As Boolean = False
        Dim boolOutlier As Boolean = False
        Dim intStart As Short

        Dim tblRID As System.Data.DataTable
        Dim numRID As Short
        Dim ctTbl As Short
        Dim varAnal, varIS
        Dim varT


        Dim vAnalyteIndex
        Dim vMasterAssayID
        Dim vAnalyteID
        Dim tblAG As DataTable = tblAnalyteGroups 'tblAnalyteGroups has all analytes, not just accepted

        Dim intGroup As Short
        Dim strAnal As String
        Dim strAnalC As String
        Dim strMatrix As String
        Dim strTNameO As String
        Dim intRunID As Int16
        Dim strDECISIONREASON As String
        Dim boolExFromAS As Boolean

        Dim v1, v2, vU, vE

        Dim numPrec As Single
        Dim numTheor As Single

        Dim boolDoME As Boolean = False
        Dim arrME(1, 1) As Single
        Dim intLastRow As Short = 0

        Dim charFCID As String
        strF = "ID_TBLREPORTTABLE = " & idTR
        Dim rowsTR() As DataRow = tblReportTable.Select(strF)
        var1 = rowsTR(0).Item("CHARFCID")
        charFCID = NZ(var1, "NA")

        boolJustTable = False

        Cursor.Current = Cursors.WaitCursor

        With wd

            fontsize = wd.ActiveDocument.Styles("Normal").Font.Size '.Selection.Font.Size
            fonts = fontsize '.Selection.Font.Size

            intTableID = 17

            Dim strWRunId As String = GetWatsonColH(intTableID)

            dvDo = frmH.dgvReportTableConfiguration.DataSource
            strF = "id_tblconfigreporttables = " & intTableID
            intDo = FindRowDVNumByCol(intTableID, dvDo, "id_tblconfigreporttables")

            ''Get table name
            'var1 = dvDo(intDo).Item("Table")
            'strTName = NZ(var1, "[NONE]")

            '***
            intDo = FindRowDVNumByCol(idTR, dvDo, "ID_TBLREPORTTABLE")
            'intLeg = 0
            'intLegStart = 96
            'boolPro = False

            'Get table name
            'var1 = dvDo(intDo).Item("Table")
            var1 = dvDo(intDo).Item("CHARHEADINGTEXT")
            strTName = NZ(var1, "[NONE]")
            strTNameO = strTName

            'get Temperature info
            var1 = dvDo(intDo).Item("CHARSTABILITYPERIOD")
            strTempInfo = NZ(var1, "[NONE]")

            '***
            ctPB = ctPB + 1
            If ctPB > frmH.pb1.Maximum Then
                ctPB = 1
            End If
            frmH.pb1.Value = ctPB
            frmH.pb1.Refresh()

            tbl1 = tblAnalysisResultsHome
            tbl2 = tblAssignedSamples
            tbl3 = tblAssignedSamplesHelper
            tbl4 = tblAnalytesHome

            'ensure data has been entered
            strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR
            rowsX = tbl2.Select(strF)
            'If rowsX.Length = 0 Then
            '    strM = "Creating Summary of Interpolated Unique Low QC for Matrix Effects on Quantitation Assessments Table ...."
            '    frmH.lblProgress.Text = strM
            '    frmH.Refresh()
            '    MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
            '    GoTo end2
            'End If


            strF = "IsIntStd = 'No'"
            If boolIncludeISTbl Then
                strF = "IsIntStd = 'No' OR IsIntStd = 'Yes'"
            Else
                strF = "IsIntStd = 'No'"
            End If
            'strS = "IsIntStd ASC, AnalyteDescription ASC"
            strS = "INTORDER ASC, IsIntStd ASC, AnalyteDescription ASC"
            rows11 = tblAnalytesHome.Select(strF, strS)
            intRowsAnal = rows11.Length

            ctTbl = 0
            For Count1 = 1 To intRowsAnal

                boolJustTable = False

                Dim arrLegend(4, 20)

                strTName = strTNameO

                ctLegend = 0


                intExp = 0
                ctExp = 0

                'for legend stuff
                intLeg = 0
                ctQCLegend = 0
                ctDilLeg = 0
                ctLegend = 0
                strA = ""
                strB = ""
                arrLegend.Clear(arrLegend, 0, arrLegend.Length)
                arrFP.Clear(arrFP, 0, arrFP.Length)
                intLegStart = 96

                Dim boolOutOverall As Boolean = False

                'check if table is to be generated
                'strDo = arrAnalytes(1, Count1) 'record column name
                strDo = rows11(Count1 - 1).Item("ANALYTEDESCRIPTION")

                If boolIncludeISTbl Then
                Else
                    If UseAnalyte(CStr(strDo)) Then
                    Else
                        GoTo next1
                    End If
                End If

                'bool = dvDo.Item(intDo).Item(strDo) 'find boolean value of dvDo column, this will crash if Int Std

                Dim strX As String
                Dim boolX As Boolean

                strX = rows11(Count1 - 1).Item("IsIntStd")
                boolX = False

                '20180804 LEE:
                'create a MF table for Matrix Effect
                Dim tblMF As New System.Data.DataTable

                Dim col1 As New DataColumn
                col1.ColumnName = "ELIMINATEDFLAG"
                col1.DataType = System.Type.GetType("System.String")
                tblMF.Columns.Add(col1)

                Dim col2 As New DataColumn
                col2.ColumnName = "MF"
                col2.DataType = System.Type.GetType("System.Single")
                tblMF.Columns.Add(col2)

                Dim col3 As New DataColumn
                col3.ColumnName = "Lot"
                col3.DataType = System.Type.GetType("System.Int16")
                tblMF.Columns.Add(col3)


                '20180804 LEE:
                'create a meanMF table
                Dim tblMeanMF As New System.Data.DataTable

                Dim col1A As New DataColumn
                col1A.ColumnName = "BOOLALL"
                col1A.DataType = System.Type.GetType("System.Int16")
                tblMeanMF.Columns.Add(col1A)

                Dim col2A As New DataColumn
                col2A.ColumnName = "MF"
                col2A.DataType = System.Type.GetType("System.Single")
                tblMeanMF.Columns.Add(col2A)

                Dim col3A As New DataColumn
                col3A.ColumnName = "Lot"
                col3A.DataType = System.Type.GetType("System.Int16")
                tblMeanMF.Columns.Add(col3A)


                If StrComp(strX, "Yes", CompareMethod.Text) = 0 Then
                    'check for boolIntStd in tbl2
                    strF = "IsIntStd = 'Yes'"
                    var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    strF2 = strF2 & "BOOLINTSTD = -1"
                    Erase rowsX
                    rowsX = tbl2.Select(strF2)
                    int1 = rowsX.Length
                    If int1 > 0 Then
                        bool = True
                        boolX = True
                    Else
                        bool = True 'False
                    End If
                Else
                    bool = dvDo.Item(intDo).Item(strDo) 'find boolean value of dvDo column
                End If

                Dim int11 As Short
                If (boolSTATSDIFFCOL And boolX = False) Or boolME Then
                    int11 = 2
                Else
                    int11 = 1
                End If

                Dim strM1 As String
                If bool Then 'continue

                    intTCur = intTCur + 1

                    ctTbl = ctTbl + 1

                    'ensure data has been entered
                    strF = "id_tblconfigreporttables = " & intTableID & " AND ID_TBLSTUDIES = " & id_tblStudies & " AND CHARANALYTE = '" & CleanText(strDo) & "' AND ID_TBLREPORTTABLE = " & idTR
                    rowsX = tbl2.Select(strF)

                    'setup tables
                    If boolUseGroups Then
                        If boolX Then
                            intGroup = -1 'tblAG.Rows(Count1 - 1).Item("INTGROUP")
                            strAnal = tbl4.Rows.Item(Count1 - 1).Item("OriginalAnalyteDescription") ' tblAG.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                            strAnalC = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription") 'tblAG.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                            vAnalyteID = 0 'tblAG.Rows.Item(Count1 - 1).Item("ANALYTEID")

                            'find matrix
                            Dim strFF As String
                            strFF = "INTSTD = '" & CleanText(strAnal) & "'"
                            Dim rowsFF() As DataRow = tblAG.Select(strFF, "", DataViewRowState.CurrentRows)
                            If rowsFF.Length = 0 Then
                                strMatrix = "NA"
                            Else
                                strMatrix = NZ(rowsFF(0).Item("MATRIX"), "NA")
                            End If

                        Else
                            intGroup = tblAG.Rows(Count1 - 1).Item("INTGROUP")
                            strAnal = tblAG.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                            strAnalC = tblAG.Rows(Count1 - 1).Item("ANALYTEDESCRIPTION_C")
                            vAnalyteID = tblAG.Rows.Item(Count1 - 1).Item("ANALYTEID")
                            strMatrix = tblAG.Rows(Count1 - 1).Item("MATRIX")
                        End If
                    Else
                        var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                        var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                        var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        var4 = tbl4.Rows.Item(Count1 - 1).Item("ANALYTEID")
                        intGroup = 0
                        vAnalyteIndex = var1
                        vMasterAssayID = var2
                        vAnalyteID = var4
                        strMatrix = ""
                    End If

                    If rowsX.Length = 0 Then
                        strM = "Creating Summary of Interpolated Unique Low QC for Matrix Effects on Quantitation Assessments Table ...."
                        strM = "Table " & intTCur & " of " & intTTot & " tables..." & ChrW(10)
                        strM = strM & "Creating " & strTName & "...."
                        strM1 = strM
                        frmH.lblProgress.Text = strM
                        frmH.Refresh()
                        'MsgBox("Samples have not been assigned to this table.", MsgBoxStyle.Information, "Samples have not been assigned...")
                        boolJustTable = True
                        'page setup according to configuration
                        str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                        'insert page break
                        'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                        Call InsertPageBreak(wd)
                        Call PageSetup(wd, str1) 'L=Landscape, P=Portrait
                        GoTo end1
                    Else
                        boolJustTable = False
                    End If


                    'page setup according to configuration
                    str1 = dvDo.Item(intDo).Item("CHARPAGEORIENTATION")
                    'insert page break
                    'wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
                    Call InsertPageBreak(wd)
                    Call PageSetup(wd, str1) 'L=Landscape, P=Portrait

                    'ReDim arrBCQCs(8, 50) '1=LevelNumber, 2=NomConcentration, 3=ID, 4=FlagPercent, 5=Hello, 6=Lo, 7=#ofReplicates, 8=ASSAYID
                    strM = "Creating " & strTName & " For " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION") & "..."
                    strM = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."
                    strM1 = strM
                    frmH.lblProgress.Text = strM
                    frmH.Refresh()

                    ''determine if there are any outliers
                    'var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    'var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    'var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    'var4 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteID")

                    'vAnalyteIndex = var1
                    'vMasterAssayID = var2
                    'vAnalyteID = var4

                    'setup tables
                    If boolX Then
                        var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        strF2 = "BOOLINTSTD = -1 AND "
                        strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                        strF2 = strF2 & "CHARANALYTE = '" & CleanText(cstr(var3)) & "' AND (ELIMINATEDFLAG = 'Y' OR BOOLEXCLSAMPLE = -1)"
                    Else

                        If boolUseGroups Then
                            strF2 = "BOOLINTSTD = 0 AND ID_TBLSTUDIES = " & id_tblStudies & " AND "
                            strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                            strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                            strF2 = strF2 & "INTGROUP = " & intGroup & " AND (ELIMINATEDFLAG = 'Y' OR BOOLEXCLSAMPLE = -1)"
                        Else
                            strF2 = "BOOLINTSTD = 0 AND "
                            var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                            var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                            var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                            strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                            strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                            strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                            strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                            strF2 = strF2 & "MASTERASSAYID = " & var2 & " AND (ELIMINATEDFLAG = 'Y' OR BOOLEXCLSAMPLE = -1)"
                        End If

                    End If

                    'If boolX Then
                    '    'strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    '    'strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    '    'strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    '    'strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                    '    'strF2 = strF2 & "MASTERASSAYID = " & var2 & " AND (ELIMINATEDFLAG = 'Y' OR BOOLEXCLSAMPLE = -1)"

                    '    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    '    strF2 = "BOOLINTSTD = -1 AND "
                    '    strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    '    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    '    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    '    strF2 = strF2 & "CHARANALYTE = '" & CleanText(cstr(var3)) & "' AND (ELIMINATEDFLAG = 'Y' OR BOOLEXCLSAMPLE = -1)"

                    'Else
                    '    strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    '    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    '    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    '    strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                    '    strF2 = strF2 & "MASTERASSAYID = " & var2 & " AND (ELIMINATEDFLAG = 'Y' OR BOOLEXCLSAMPLE = -1)"

                    'End If

                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    rows2 = tbl2.Select(strF2, strS)
                    int1 = rows2.Length

                    If int1 > 0 And boolME = False Then
                        boolOutlier = True
                    End If

                    'setup tables
                    '****

                    'setup tables
                    If boolX Then
                        var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                        strF2 = "BOOLINTSTD = -1 AND "
                        strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                        strF2 = strF2 & "CHARANALYTE = '" & CleanText(cstr(var3)) & "'"
                    Else

                        If boolUseGroups Then
                            strF2 = "BOOLINTSTD = 0 AND ID_TBLSTUDIES = " & id_tblStudies & " AND "
                            strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                            strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                            strF2 = strF2 & "INTGROUP = " & intGroup
                        Else
                            strF2 = "BOOLINTSTD = 0 AND "
                            var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                            var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                            var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                            strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                            strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                            strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                            strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                            strF2 = strF2 & "MASTERASSAYID = " & var2 ' & " AND "
                        End If

                    End If

                    'If boolX Then
                    '    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    '    strF2 = "BOOLINTSTD = -1 AND "
                    '    strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    '    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    '    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    '    strF2 = strF2 & "CHARANALYTE = '" & CleanText(cstr(var3)) & "'"
                    'Else
                    '    strF2 = "BOOLINTSTD = 0 AND "
                    '    var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    '    var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    '    var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    '    var4 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteID")
                    '    strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    '    strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    '    strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    '    strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                    '    strF2 = strF2 & "ANALYTEID = " & var4 & " AND "
                    '    strF2 = strF2 & "MASTERASSAYID = " & var2 ' & " AND "
                    'End If

                    '****
                    'var1 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteIndex")
                    'var2 = tbl4.Rows.Item(Count1 - 1).Item("MasterAssayID")
                    'var3 = tbl4.Rows.Item(Count1 - 1).Item("AnalyteDescription")
                    'strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                    'strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                    'strF2 = strF2 & "ID_TBLREPORTTABLE = " & idTR & " AND "
                    'strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                    'strF2 = strF2 & "MASTERASSAYID = " & var2 ' & " AND "
                    strS = "RUNID ASC, RUNSAMPLEORDERNUMBER ASC"
                    Erase rows2
                    rows2 = tbl2.Select(strF2, strS)
                    int1 = rows2.Length 'debug
                    dv2 = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                    int1 = dv2.Count 'debug

                    'find number of runs used
                    tblNumRuns = dv2.ToTable("a", True, "RUNID")
                    intNumRuns = tblNumRuns.Rows.Count

                    'find number of different Run Identifiers
                    tblRID = dv2.ToTable("b", True, "RUNID", "CHARHELPER2")
                    numRID = tblRID.Rows.Count
                    '20160905 LEE: Don't do matrix effect anymore. Can't find an example of current users who have this definition of matrix effect in this context
                    boolDoME = False
                    'If numRID > 1 Then
                    '    boolDoME = True 'must do matrix effect
                    'End If

                    '20180724 LEE:
                    Dim boolHasIdentifier As Boolean = False
                    Dim rowsHID() As DataRow = tblRID.Select("CHARHELPER2 IS NOT NULL")
                    If rowsHID.Length = 0 Then
                        boolHasIdentifier = False
                    Else
                        boolHasIdentifier = True
                    End If

                    'establish table of level numbers
                    'must be sorted by nomconc!
                    'make new dv

                    If boolME Then
                        strS = "NOMCONC ASC, ID_TBLASSIGNEDSAMPLES ASC"
                    Else
                        strS = "NOMCONC ASC, RUNSAMPLEORDERNUMBER ASC"
                    End If

                    Dim dvNL As New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                    tblLevels = dvNL.ToTable("c", True, "NOMCONC", "CHARHELPER1")
                    intNumLevels = tblLevels.Rows.Count

                    'get strConcUnits
                    intRunID = 0
                    int1 = 0
                    Do Until intRunID > 0
                        var1 = tblNumRuns.Rows(int1).Item("RUNID")
                        If IsDBNull(var1) Then
                        Else
                            intRunID = var1
                        End If
                        int1 = int1 + 1
                    Loop
                    strConcUnits = GetConcUnits(intRunID)

                    ReDim arrME(numRID, intNumLevels)

                    For Count2 = 0 To intNumLevels - 1 'check for any null values
                        var3 = tblLevels.Rows.Item(Count2).Item("NOMCONC")
                        If IsDBNull(var3) Then
                            str1 = "The Nominal Concentration for some assigned samples for " & var3 & " has not been configured."
                            str1 = str1 & ChrW(10) & "When this action is finished, please navigate to the Assigned Samples window and correct this problem."
                            If boolDisableWarnings Then
                            Else
                                MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                            End If
                            GoTo end1
                        End If
                        var4 = tblLevels.Rows.Item(Count2).Item("CHARHELPER1")
                        If IsDBNull(var3) Then
                            str1 = "The Term 1 designation for some assigned samples for " & var3 & " has not been configured."
                            str1 = str1 & ChrW(10) & "When this action is finished, please navigate to the Assigned Samples window and correct this problem."
                            If boolDisableWarnings Then
                            Else
                                MsgBox(str1, MsgBoxStyle.Information, "Nom Conc problem...")
                            End If
                            GoTo end1
                        End If

                    Next

                    'establish combo table of level numbers and run identifiers
                    Dim tblLevelsRID As System.Data.DataTable
                    Dim intNumLevelsRID As Short

                    tblLevelsRID = dv2.ToTable("d", True, "NOMCONC", "CHARHELPER1", "CHARHELPER2")
                    intNumLevelsRID = tblLevelsRID.Rows.Count

                    Dim intRowsXTot As Short = 0

                    'find number of table rows to generate
                    intRowsX = 0
                    For Count2 = 0 To intNumRuns - 1
                        '.Selection.Tables.item(1).Cell(int1, 1).Select()
                        'enter runid
                        var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")
                        '.Selection.TypeText(CStr(var10))
                        '.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)

                        intRowsX = 0
                        For Count3 = 0 To intNumLevels - 1
                            'varNom = tblLevels.Rows.item(Count3).Item("NOMCONC")
                            varCol = tblLevels.Rows.Item(Count3).Item("CHARHELPER1")
                            dv2.RowFilter = ""
                            'don't know why, but must make a long filter here or
                            'both analytes get returned in dv2.rowfilter
                            'strF = strF2 & " AND RUNID = " & var10 & " AND CHARHELPER1 = '" & varCol & "'"
                            'dv2.RowFilter = strF
                            strF = strF2 & " AND RUNID = " & var10 & " AND CHARHELPER1 = '" & varCol & "'"
                            dv2.RowFilter = strF
                            int2 = dv2.Count
                            If int2 > intRowsX Then
                                intRowsX = int2
                            End If
                        Next
                        intRowsXTot = intRowsXTot + intRowsX
                    Next

                    'generate table
                    intTblRows = 0
                    intTblRows = intTblRows + 2 'for header
                    intTblRows = intTblRows + 1 'for blank row
                    intTblRows = intTblRows + (intRowsXTot) 'for number of data rows
                    intTblRows = intTblRows + (1 * intNumRuns) 'for a blank row after each run set
                    'intTblRows = intTblRows + (5 * intNumRuns) 'for Mean/Bias/n section for each run set

                    'Increment for Statistics Sections
                    Dim intCSN As Short
                    intCSN = countNumStatsRows()
                    intTblRows = intTblRows + (intCSN * intNumRuns) + (intCSN * numRID)

                    ''20180904 LEE:
                    'intTblRows = intTblRows + (intCSN * intNumRuns) + ((intCSN * numRID) * (numRID - 1))

                    If intCSN > 0 Then
                        intTblRows = intTblRows + (1 * intNumRuns) - 1 'for a blank row after each Mean/Bias/n set, except last set
                        intTblRows = intTblRows + (2 * numRID) 'for two blank rows after each run identifier Mean/Bias/n set
                    Else
                        intTblRows = intTblRows - 1 'subtract an unneeded blank row
                    End If

                    '20181108 LEE: Depracate this
                    'Only used by CRL-WIL, and they have stopped using it
                    'If boolDoME Then
                    '    '20160905 LEE: Note that boolDoME is deprecated for the time being
                    '    intTblRows = intTblRows + 1 'line for an ME line
                    '    intTblRows = intTblRows + 1 'blank line
                    '    intTblRows = intTblRows + 3 'two lines for overall ME and SD and n
                    'End If

                    If boolME Then
                        '20181108 LEE: Depracate this
                        'Only used by CRL-WIL, and they have stopped using it
                        'intTblRows = intTblRows + 1 'for Matrix Effect row

                        If boolMFStats Then
                            intTblRows = intTblRows + 1 'blank line
                            intTblRows = intTblRows + intCSN 'stats lines
                        End If

                    End If

                    If boolQCREPORTACCVALUES Then

                    Else
                        If boolOutlier Then

                            intTblRows = intTblRows + (3 * intNumRuns) 'for stats headings
                            ctExp = ctExp + 3 'for stats headings

                            'Increment for Statistics Sections
                            intTblRows = intTblRows + (intCSN * intNumRuns) + (intCSN * numRID)
                            ctExp = ctExp + (intCSN * intNumRuns) + (intCSN * numRID)  'NDL: Wierd that theoretical is included here.

                            If intCSN > 0 Then
                                intTblRows = intTblRows + (1 * intNumRuns) - 1 'for a blank row after each Mean/Bias/n set, except last set
                                intTblRows = intTblRows + (2 * numRID) 'for two blank rows after each run identifier Mean/Bias/n set
                                ctExp = ctExp + (1 * intNumRuns) - 1
                                ctExp = ctExp + (2 * numRID)

                            End If

                        End If

                    End If

                    wrdSelection = wd.Selection()

                    ''''''''''''''wdd.visible = True

                    Dim intCols As Short
                    If (boolSTATSDIFFCOL And boolX = False) Or boolME Then
                        intCols = (intNumLevels * 2) + 1
                    Else
                        intCols = intNumLevels + 1
                    End If

                    Try

                        Dim tbl As Word.Table
                        Dim rng As Word.Range

                        '20180913 LEE:
                        Call IncrNextTableNumber(wd)

                        If boolPlaceHolder Then
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=1, NumColumns:=1, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        Else
                            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=intTblRows, NumColumns:=intCols, DefaultTableBehavior:=Microsoft.Office.Interop.Word.WdDefaultTableBehavior.wdWord9TableBehavior, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
                        End If

                        .Selection.Tables.Item(1).Select()

                        tbl = .Selection.Tables.Item(1)

                        Call SetCellPaddingZero(.Selection.Tables.Item(1))

                        .Selection.Tables.Item(1).Rows.AllowBreakAcrossPages = False
                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                        .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                        .Selection.Tables.Item(1).Columns.PreferredWidth = Microsoft.Office.Interop.Word.WdPreferredWidthType.wdPreferredWidthPoints
                        '.Selection.Tables.Item(1).Columns.Item(1).Width = 86
                        For Count2 = 1 To intNumLevels
                            '.Selection.Tables.item(1).Columns.item(Count2 + 1).Width = 50
                        Next
                        .Selection.Tables.Item(1).Select()


                        'remove border, but leave top and bottom
                        removeBorderButLeaveTopAndBottom(wd)

                        If boolPlaceHolder Then

                            .Selection.Tables.Item(1).Select()
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone


                            strA = arrAnalytes(14, Count1)
                            If boolX Then
                                strA = "Internal Standard " & strA
                            End If
                            strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, boolX)
                            Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                            'Note: strTName is byRef and will return Table, number, caption, label

                            Call MoveOneCellDown(wd)

                            .Selection.TypeParagraph()
                            .Selection.TypeParagraph()

                            'enter a table record in tblTableN
                            'ctTableN = ctTableN + 1
                            Dim dtblr1 As DataRow = tblTableN.NewRow
                            dtblr1.BeginEdit()
                            dtblr1.Item("TableNumber") = ctTableN
                            dtblr1.Item("AnalyteName") = arrAnalytes(1, Count1)
                            dtblr1.Item("TableName") = strTNameO
                            dtblr1.Item("TableID") = intTableID
                            dtblr1.Item("CHARFCID") = charFCID
                            dtblr1.Item("TableNameNew") = strTName
                            tblTableN.Rows.Add(dtblr1)

                            GoTo next1
                        End If

                        .Selection.Tables.Item(1).Select()
                        Call GlobalTableParaFormat(wd)

                        '20171220 LEE: Do not set table size, use the style default table
                        '.Selection.Font.Size = fontsize - 1
                        .Selection.Tables.Item(1).Cell(1, 1).Select()


                        'border top and bottom of range
                        .Selection.Tables.Item(1).Cell(1, 1).Select()
                        .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        '.Selection.MoveRight Unit:=Microsoft.Office.Interop.Word.wdunits.word.wdunits.wdCharacter, Count:=ctQCs, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        '''wdd.visible = True

                        '.Selection.MoveLeft(Microsoft.Office.Interop.Word.WdUnits.wdCharacter, 1)

                        'Enter nom. conc. row titles
                        .Selection.Tables.Item(1).Cell(2, 2).Select()
                        For Count2 = 0 To intNumLevels - 1

                            var1 = tblLevels.Rows.Item(Count2).Item("CHARHELPER1")

                            .Selection.TypeText(Text:=NZ(var1, "NA"))
                            '.Selection.TypeText(Text:=var1)

                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            If (boolSTATSDIFFCOL And boolX = False) Or boolME Then
                                If boolME Then
                                    .Selection.TypeText(Text:=ReturnMForMEAbbr)
                                Else
                                    .Selection.TypeText(Text:=ReturnDiffLabel)
                                End If

                                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                            End If
                        Next

                        .Selection.Tables.Item(1).Cell(2, 1).Select()
                        'bottom border this row
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        .Selection.Tables.Item(1).Cell(2, 1).Select()

                        'begin entering data'

                        '20180724 LEE:
                        If boolHasIdentifier Then
                            str1 = " / " & ChrW(10) & "Identifier /" & ChrW(10)
                        Else
                            str1 = ChrW(10)
                        End If

                        If BOOLINCLUDEDATE Then

                            If numRID > 1 Then
                                '.Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & " /" & ChrW(10) & "Identifier /" & ChrW(10) & "(Analysis Date)")
                                '20180420 LEE:
                                '20180724 LEE:
                                .Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & str1 & "(" & GetAnalysisDateLabel(intTableID) & ")")
                            Else
                                '.Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & " /" & ChrW(10) & "(Analysis Date)")
                                '20180420 LEE:
                                '20180724 LEE:
                                .Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & str1 & "(" & GetAnalysisDateLabel(intTableID) & ")")
                            End If

                        Else

                            If numRID > 1 And boolHasIdentifier = True Then
                                .Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & " /" & ChrW(10) & "Identifier")
                            Else
                                .Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text))
                            End If

                        End If

                        'If BOOLINCLUDEDATE Then

                        '    If numRID > 1 Then
                        '        '.Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & " /" & ChrW(10) & "Identifier /" & ChrW(10) & "(Analysis Date)")
                        '        '20180420 LEE:
                        '        .Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & " /" & ChrW(10) & "Identifier /" & ChrW(10) & "(" & GetAnalysisDateLabel(intTableID) & ")")
                        '    Else
                        '        '.Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & " /" & ChrW(10) & "(Analysis Date)")
                        '        '20180420 LEE:
                        '        .Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & " /" & ChrW(10) & "(" & GetAnalysisDateLabel(intTableID) & ")")
                        '    End If

                        'Else

                        '    If numRID > 1 Then
                        '        .Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text) & " /" & ChrW(10) & "Identifier")
                        '    Else
                        '        .Selection.TypeText(Replace(strWRunId, " ", ChrW(10), 1, -1, CompareMethod.Text))
                        '    End If

                        'End If

                        int1 = 4 'row position counter
                        Dim int12 As Short
                        Dim boolEnterDiff As Boolean

                        '''wdd.visible = True


                        For Count2 = 0 To intNumRuns - 1

                            'For Count10 = 0 To 0 ' numRID - 1

                            .Selection.Tables.Item(1).Cell(int1, 1).Select()
                            'enter runid
                            var10 = tblNumRuns.Rows.Item(Count2).Item("RUNID")

                            'strM = "Creating Summary of Interpolated Unique Low QC for Matrix Effects on Quantitation Assessment For " & rows11(Count1 - 1).Item("ANALYTEDESCRIPTION") & "..."
                            frmH.lblProgress.Text = strM1 & ChrW(10) & "Processing Run ID " & var10
                            frmH.Refresh()

                            Dim strH As String
                            'strH = NZ(tblRID.Rows(Count10).Item("CHARHELPER2"), "[NONE]")
                            strH = NZ(tblRID.Rows(Count2).Item("CHARHELPER2"), "[NONE]")

                            .Selection.TypeText(CStr(var10))
                            If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                                If BOOLINCLUDEDATE Then
                                    .Selection.Tables.Item(1).Cell(int1 + 1, 1).Select()
                                    str1 = GetDateFromRunID(NZ(var10, 0), LDateFormat, intGroup, idTR)
                                    .Selection.TypeText("(" & str1 & ")")
                                End If
                            Else
                                .Selection.Tables.Item(1).Cell(int1 + 1, 1).Select()
                                .Selection.TypeText(strH)
                                .Selection.Tables.Item(1).Cell(int1, 1).Select()
                                If BOOLINCLUDEDATE Then
                                    .Selection.Tables.Item(1).Cell(int1 + 2, 1).Select()
                                    str1 = GetDateFromRunID(NZ(var10, 0), LDateFormat, intGroup, idTR)
                                    .Selection.TypeText("(" & str1 & ")")
                                End If
                            End If

                            .Selection.Tables.Item(1).Cell(int1, 1).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)


                            'start filling in data by columns
                            'intRowsX = 0
                            int12 = -1

                            ''''''''wdd.visible = True

                            For Count3 = 0 To (intNumLevels * int11) - 1 Step int11
                                int12 = int12 + 1
                                boolEnterDiff = False

                                varNom = tblLevels.Rows.Item(int12).Item("NOMCONC")
                                varCol = tblLevels.Rows.Item(int12).Item("CHARHELPER1")

                                ''determine hi and lo (nom*flagpercent)
                                'strF = "CONCENTRATION = '" & varNom & "'"
                                'rows10 = tblBCQCs.Select(strF)
                                'var1 = CDec(NZ(rows10(0).Item("FLAGPERCENT"), 15))


                                'determine hi and lo (nom*flagpercent)
                                If boolX Then 'don't need to do this
                                    hi = 0
                                    lo = 0
                                    arrFP(1, int12) = hi
                                    arrFP(2, int12) = hi
                                    v1 = 0
                                    v1 = 0
                                    vU = 0
                                Else
                                    'strF = "CONCENTRATION = " & varNom & " AND ANALYTEID = " & vAnalyteID & " AND MASTERASSAYID = " & vMasterAssayID & " AND ANALYTEINDEX = " & vAnalyteIndex & " AND CONCENTRATION = " & varNom & " AND RUNID = " & var10
                                    'don't need masterassayid and analyteindex anymore
                                    'strF = "CONCENTRATION = " & varNom & " AND ANALYTEID = " & vAnalyteID & " AND CONCENTRATION = " & varNom & " AND RUNID = " & var10

                                    'if Conc < 1, then the query return 0 records
                                    'must do something different
                                    var1 = GetANALYTEFLAGPERCENT(varNom, var10, vAnalyteID)

                                    arrFP(1, int12) = var1
                                    arrFP(2, int12) = var1
                                    Call SetHighAndLowCriteria(varNom, var1, var1, hi, lo)
                                    v1 = var1
                                    v2 = var1
                                    vU = 0

                                End If

                                'start entering data
                                dv2.RowFilter = ""
                                'don't know why, but must make a long filter here or
                                'both analytes get returned in dv2.rowfilter
                                'strF = strF2 & " AND RUNID = " & var10 & " AND NOMCONC = " & varNom

                                If StrComp(strH, "[NONE]", CompareMethod.Text) = 0 Then
                                    strF = strF2 & " AND RUNID = " & var10 & " AND CHARHELPER1 = '" & varCol & "' AND (CHARHELPER2 IS NULL OR CHARHELPER2 = '')"
                                Else
                                    strF = strF2 & " AND RUNID = " & var10 & " AND CHARHELPER1 = '" & varCol & "' AND CHARHELPER2 = '" & strH & "'"
                                End If
                                'strF = strF2 & " AND RUNID = " & var10 & " AND CHARHELPER1 = '" & varCol & "'"

                                dv2.RowFilter = strF
                                int2 = dv2.Count

                                strF = ""

                                Erase rows2

                                Dim boolNoData As Boolean = False

                                If int2 = 0 Then
                                    intRowsX = 0
                                    boolNoData = True
                                Else
                                    Dim tbl2s As System.Data.DataTable = dv2.ToTable

                                    rows2 = tbl2s.Select("RUNID > -1")
                                    int3 = rows2.Length

                                    'redo hi/lo
                                    vU = rows2(0).Item("BOOLUSEGUWUACCCRIT")
                                    If gAllowGuWuAccCrit And LAllowGuWuAccCrit And vU = -1 Then
                                        v1 = CDec(NZ(rows2(0).Item("NUMMAXACCCRIT"), 0))
                                        v2 = CDec(NZ(rows2(0).Item("NUMMINACCCRIT"), 0))
                                        arrFP(1, int12) = v1
                                        arrFP(2, int12) = v2
                                        Call SetHighAndLowCriteria(varNom, v1, v2, hi, lo)
                                    End If

                                    If int3 = 0 Then
                                        intRowsX = 0
                                        int3 = 0
                                        nI = int3
                                    Else
                                        'strF = strF3 & strF
                                        'rows2 = tbl1.Select(strF)
                                        int3 = rows2.Length
                                        nI = int3
                                        intRowsX = int3 'new introwsx
                                    End If

                                    'now do included

                                    strF = ""

                                    Erase rows2E

                                    'If gAllowExclSamples And LAllowExclSamples And vU = -1 Then
                                    If gAllowExclSamples And LAllowExclSamples Then
                                        rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL) AND BOOLEXCLSAMPLE = 0")
                                    Else
                                        rows2E = tbl2s.Select("(ELIMINATEDFLAG = 'N' OR ELIMINATEDFLAG IS NULL)")
                                    End If

                                    nE = rows2E.Length
                                End If

                                '
                                '20180803 LEE:
                                'if Matrix Factor, need mean data ahead of time
                                Dim numMeanME As Decimal = 0
                                Dim numMeanMEAll As Decimal = 0
                                Dim numME As Decimal = 0
                                Dim numMEAll As Decimal = 0
                                Dim nME As Short = 0
                                Dim nMEAll As Short = 0
                                Dim numX As Decimal
                                Dim numXAll As Decimal

                                If boolNoData Then
                                Else

                                    If boolME And int12 > 0 Then

                                        For Count4 = 0 To intRowsX - 1

                                            If Count4 > int3 - 1 Then

                                                boolOC = True

                                                If boolQCNA Then
                                                    str1 = "NA"
                                                Else
                                                    str1 = ""
                                                End If

                                            Else

                                                varAnal = RoundToDecimalRAFZ(NZ(rows2(Count4).Item("ANALYTEAREA"), 0), 0)
                                                varIS = RoundToDecimalRAFZ(NZ(rows2(Count4).Item("INTERNALSTANDARDAREA"), 0), 0)
                                                var1 = NZ(rows2(Count4).Item("ELIMINATEDFLAG"), "N")
                                                vE = NZ(rows2(Count4).Item("BOOLEXCLSAMPLE"), 0)

                                                If boolRCPA Or boolX Then
                                                    If boolLUseSigFigsArea Then
                                                        varT = SigFigArea(RoundToDecimalA(varAnal, LSigFigArea), LSigFigArea, False, True) ' SigFigOrDec(varAnal, LSigFigArea, False)
                                                    Else
                                                        varT = RoundToDecimalRAFZ(varAnal, LSigFigArea)
                                                    End If

                                                ElseIf boolRCPARatio Then
                                                    If varIS = 0 Then
                                                        varT = Format(0, strAreaDecAreaRatio)

                                                    Else
                                                        If boolLUseSigFigsAreaRatio Then
                                                            varT = SigFigAreaRatio(RoundToDecimalA(varAnal / varIS, LSigFigAreaRatio), LSigFigAreaRatio, False, True) ' SigFigOrDec(varAnal, LSigFigArea, False)
                                                        Else
                                                            varT = RoundToDecimalRAFZ(varAnal / varIS, LSigFigAreaRatio)
                                                        End If
                                                        'varT = SigFigArea(RoundToDecimal(varAnal / varIS, LSigFigAreaRatio), LSigFigAreaRatio, False, True) ' RoundToDecimalRAFZ(varAnal / varIS, 10)
                                                    End If

                                                End If

                                                'Add to tblMF
                                                Dim nr As DataRow = tblMF.NewRow
                                                If vE = -1 Then
                                                    nr("ELIMINATEDFLAG") = "Y"
                                                Else
                                                    nr("ELIMINATEDFLAG") = var1
                                                End If

                                                var2 = varT / numMeanT0
                                                If boolLUseSigFigs Then
                                                    var3 = SigFigOrDecString(var2, LSigFig, False)
                                                Else
                                                    var3 = Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))
                                                End If

                                                nr("MF") = CSng(var3)
                                                nr("Lot") = int12 + 1
                                                tblMF.Rows.Add(nr)

                                                nMEAll = nMEAll + 1
                                                nME = nME + 1

                                                numMEAll = numMEAll + CDec(varT)

                                                If (StrComp(var1, "Y", vbTextCompare) = 0 Or (gAllowExclSamples And LAllowExclSamples And vE = -1) And (boolRCPA = False And boolRCPARatio = False And boolX = False)) Then
                                                    nME = nME - 1
                                                Else
                                                    numME = numME + varT
                                                End If

                                            End If

                                        Next Count4

                                        numXAll = numMEAll / nMEAll
                                        numX = numME / nME

                                        If boolRCPA Or boolX Then
                                            If boolLUseSigFigsArea Then
                                                numMeanMEAll = SigFigArea(RoundToDecimalA(numXAll, LSigFigArea), LSigFigArea, False, True) ' SigFigOrDec(varAnal, LSigFigArea, False)
                                            Else
                                                numMeanMEAll = RoundToDecimalRAFZ(numXAll, LSigFigArea)
                                            End If

                                            If boolLUseSigFigsArea Then
                                                numMeanME = SigFigArea(RoundToDecimalA(numX, LSigFigArea), LSigFigArea, False, True) ' SigFigOrDec(varAnal, LSigFigArea, False)
                                            Else
                                                numMeanME = RoundToDecimalRAFZ(numX, LSigFigArea)
                                            End If

                                        ElseIf boolRCPARatio Then
                                            If boolLUseSigFigsAreaRatio Then
                                                numMeanMEAll = SigFigAreaRatio(RoundToDecimalA(numXAll, LSigFigAreaRatio), LSigFigAreaRatio, False, True) ' SigFigOrDec(varAnal, LSigFigArea, False)
                                            Else
                                                numMeanMEAll = RoundToDecimalRAFZ(numXAll, LSigFigAreaRatio)
                                            End If

                                            If boolLUseSigFigsAreaRatio Then
                                                numMeanME = SigFigAreaRatio(RoundToDecimalA(numX, LSigFigAreaRatio), LSigFigAreaRatio, False, True) ' SigFigOrDec(varAnal, LSigFigArea, False)
                                            Else
                                                numMeanME = RoundToDecimalRAFZ(numX, LSigFigAreaRatio)
                                            End If

                                        End If

                                    End If

                                    'enter data
                                    For Count4 = 0 To intRowsX - 1 'int3 - 1

                                        '''''''''wdd.visible = True
                                        boolOC = False

                                        .Selection.Tables.Item(1).Cell(int1 + Count4, Count3 + 2).Select()
                                        If Count4 > int3 - 1 Then

                                            boolOC = True

                                            If boolQCNA Then
                                                str1 = "NA"
                                            Else
                                                str1 = ""
                                            End If

                                            .Selection.TypeText(str1)
                                            boolEnterDiff = False
                                            boolOC = True

                                        Else
                                            var1 = rows2(Count4).Item("CONCENTRATION")
                                            varConc = var1

                                            varAnal = RoundToDecimalRAFZ(NZ(rows2(Count4).Item("ANALYTEAREA"), 0), 0)
                                            varIS = RoundToDecimalRAFZ(NZ(rows2(Count4).Item("INTERNALSTANDARDAREA"), 0), 0)

                                            var1 = NZ(var1, 0)
                                            numDF = rows2(Count4).Item("ALIQUOTFACTOR")
                                            var1 = var1 / numDF
                                            If boolLUseSigFigs Then
                                                var2 = SigFigOrDec(var1, LSigFig, False)
                                            Else
                                                var2 = RoundToDecimalRAFZ(var1, LSigFig)
                                            End If
                                            var1 = NZ(rows2(Count4).Item("ELIMINATEDFLAG"), "N")
                                            vE = NZ(rows2(Count4).Item("BOOLEXCLSAMPLE"), 0)

                                            If IsDBNull(varConc) And boolME = False Then

                                                boolExFromAS = False
                                                boolOC = True

                                                If gAllowExclSamples And LAllowExclSamples Then
                                                    If vE = -1 Then
                                                        var1 = "Y"
                                                        boolExFromAS = True
                                                    Else
                                                        'var1 = "N"
                                                        'don't assign "N", Watson may override
                                                    End If
                                                End If

                                                var1 = "Y"

                                                'Remember, tblAssignedSamples does not have DECISIONREASON
                                                Dim var6
                                                var6 = "No Value: " & GetDECISIONREASONValue(boolExFromAS, vAnalyteID, rows2(Count4))

                                                boolEnterDiff = True 'FALSE
                                                intExp = intExp + 1
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                str1 = GetLegendStringExcluded(arrFP(1, int12), arrFP(2, int12), vU, var6, intTableID, True, "")
                                                v1 = arrFP(1, int12)
                                                v2 = arrFP(2, int12)

                                                'Add to Legend Array
                                                ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                .Selection.TypeText(Text:="NV")

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                                'ElseIf (StrComp(var1, "Y", vbTextCompare) = 0 Or (gAllowExclSamples And LAllowExclSamples And vE = -1) And (boolRCPA = False And boolRCPARatio = False And boolX = False)) Then
                                                '20180806 Evaluate AreaRatio and IS

                                            ElseIf (StrComp(var1, "Y", vbTextCompare) = 0 Or (gAllowExclSamples And LAllowExclSamples And vE = -1)) Then

                                                boolExFromAS = False
                                                boolOC = True

                                                If gAllowExclSamples And LAllowExclSamples Then
                                                    If vE = -1 Then
                                                        var1 = "Y"
                                                        boolExFromAS = True
                                                    Else
                                                        'var1 = "N"
                                                        'don't assign "N", Watson may override
                                                    End If
                                                End If

                                                'Remember, tblAssignedSamples does not have DECISIONREASON
                                                Dim var6
                                                var6 = GetDECISIONREASONValue(boolExFromAS, vAnalyteID, rows2(Count4))

                                                boolEnterDiff = True 'FALSE
                                                intExp = intExp + 1
                                                intLeg = intLeg + 1
                                                strA = ChrW(intLeg + intLegStart)

                                                str1 = GetLegendStringExcluded(arrFP(1, int12), arrFP(2, int12), vU, var6, intTableID, True, "")
                                                v1 = arrFP(1, int12)
                                                v2 = arrFP(2, int12)

                                                'Add to Legend Array
                                                ctLegend = ctLegend + SetLegendArray(arrLegend, intLeg, str1, strA, True)

                                                If boolRedBoldFont Then
                                                    .Selection.Font.Bold = True
                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                End If

                                                If boolRCPA Then
                                                    If boolLUseSigFigsArea Then
                                                        varAnal = SigFigArea(RoundToDecimalA(varAnal, LSigFigArea), LSigFigArea, False, True) ' SigFigOrDec(varAnal, LSigFigArea, False)
                                                        .Selection.TypeText(CStr(DisplayNum(varAnal, LSigFigArea, False)))
                                                    Else
                                                        varAnal = RoundToDecimalRAFZ(varAnal, LSigFigArea)
                                                        .Selection.TypeText(Text:=Format(varAnal, strAreaDec))
                                                    End If

                                                ElseIf boolRCPARatio Then
                                                    If varIS = 0 Then
                                                        varT = Format(0, strAreaDecAreaRatio)
                                                        .Selection.TypeText(Text:=Format(varT, strAreaDecAreaRatio))
                                                    Else
                                                        If boolLUseSigFigsAreaRatio Then
                                                            varT = SigFigAreaRatio(RoundToDecimalA(varAnal / varIS, LSigFigAreaRatio), LSigFigAreaRatio, False, True) ' SigFigOrDec(varAnal, LSigFigArea, False)
                                                            .Selection.TypeText(CStr(DisplayNum(varT, LSigFigAreaRatio, False)))
                                                        Else
                                                            varT = RoundToDecimalRAFZ(varAnal / varIS, LSigFigAreaRatio)
                                                            .Selection.TypeText(Text:=Format(varT, strAreaDecAreaRatio))
                                                        End If
                                                        'varT = SigFigArea(RoundToDecimal(varAnal / varIS, LSigFigAreaRatio), LSigFigAreaRatio, False, True) ' RoundToDecimalRAFZ(varAnal / varIS, 10)
                                                    End If

                                                Else
                                                    If boolLUseSigFigs Then
                                                        .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                    Else
                                                        .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                    End If

                                                End If

                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)

                                            Else
                                                'determine if value is outside acceptance criteria
                                                boolEnterDiff = True
                                                'If (var2 > hi Or var2 < lo) And (boolRCPA = False And boolRCPARatio = False And boolX = False) Then 'flag
                                                If (OutsideAccCrit(var2, varNom, v1, v2, NZ(vU, 0))) And (boolRCPA = False And boolRCPARatio = False And boolX = False) Then 'flag
                                                    intLeg = intLeg + 1
                                                    strA = ChrW(intLeg + intLegStart)

                                                    If gAllowGuWuAccCrit And LAllowGuWuAccCrit And vU = -1 Then
                                                        v1 = RoundToDecimal(arrFP(1, int12), 0)
                                                        v2 = RoundToDecimal(arrFP(2, int12), 0)
                                                        If v1 = v2 Then
                                                            str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                        Else
                                                            str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                        End If
                                                        'str1 = "Value outside of acceptance criteria (+" & RoundToDecimal(arrFP(1, int12), 0) & "/-" & RoundToDecimal(arrFP(2, int12), 0) & "% theoretical) but included in summary statistics."
                                                    Else
                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                    End If
                                                    'str1 = "Value outside of acceptance criteria (" & RoundToDecimal(arrFP(int12), 0) & "% theoretical) but included in summary statistics."
                                                    'search for str1 in arrLegend
                                                    If intLeg = 1 Then
                                                        arrLegend(1, intLeg) = strA
                                                        arrLegend(2, intLeg) = str1
                                                        arrLegend(3, intLeg) = True
                                                        ctLegend = ctLegend + 1
                                                    Else
                                                        boolPro = True
                                                        For Count5 = 1 To intLeg - 1
                                                            str2 = arrLegend(2, Count5)
                                                            If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                                intLeg = intLeg - 1
                                                                strA = arrLegend(1, Count5)
                                                                boolPro = False
                                                                Exit For
                                                            End If
                                                        Next
                                                        If boolPro Then
                                                            arrLegend(1, intLeg) = strA
                                                            arrLegend(2, intLeg) = str1
                                                            arrLegend(3, intLeg) = True
                                                            ctLegend = ctLegend + 1
                                                        End If
                                                    End If


                                                    If boolRedBoldFont Then
                                                        .Selection.Font.Bold = True
                                                        .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    End If



                                                    If boolRCPA Then
                                                        If boolLUseSigFigsArea Then
                                                            varAnal = SigFigArea(RoundToDecimalA(varAnal, LSigFigArea), LSigFigArea, True, False)
                                                            .Selection.TypeText(CStr(DisplayNum(varAnal, LSigFigArea, False)))
                                                        Else
                                                            varAnal = Format(RoundToDecimalRAFZ(varAnal, LSigFigArea), strAreaDec)
                                                            .Selection.TypeText(Text:=CStr(DisplayCommas(varAnal)))
                                                        End If


                                                    ElseIf boolRCPARatio Then
                                                        'varT = RoundToDecimalRAFZ(varAnal / varIS, 10)
                                                        If varIS = 0 Then
                                                            varT = 0
                                                        Else
                                                            If boolLUseSigFigsAreaRatio Then
                                                                varT = SigFigAreaRatio(RoundToDecimalA(varAnal / varIS, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                                .Selection.TypeText(CStr(DisplayNum(numMean, LSigFigAreaRatio, False)))
                                                            Else
                                                                varT = Format(RoundToDecimalRAFZ(varAnal / varIS, LSigFigAreaRatio), strAreaDecAreaRatio)
                                                                .Selection.TypeText(Text:=Format(varT, strAreaDecAreaRatio))
                                                            End If
                                                        End If


                                                    Else
                                                        If boolLUseSigFigs Then
                                                            .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                        Else
                                                            .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                        End If

                                                    End If

                                                    Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                Else
                                                    If boolX Then 'IntStd can't have area ratio, use Peak Area logic
                                                        If LSigFigArea Then
                                                            varT = SigFigArea(RoundToDecimalA(varIS, LSigFigArea), LSigFigArea, False, False)
                                                            .Selection.TypeText(Text:=CStr(varT))
                                                        Else
                                                            varT = RoundToDecimalRAFZ(varIS, LSigFigArea)
                                                            .Selection.TypeText(Text:=CStr(DisplayCommas(Format(varT, GetRegrDecStr(LSigFigArea)))))
                                                        End If

                                                    Else
                                                        If boolRCPA Then
                                                            If boolLUseSigFigsArea Then
                                                                varAnal = SigFigArea(RoundToDecimalA(varAnal, LSigFigArea), LSigFigArea, True, False)
                                                                .Selection.TypeText(CStr(DisplayNum(varAnal, LSigFigArea, False)))
                                                            Else
                                                                varAnal = RoundToDecimalRAFZ(varAnal, LSigFigArea)
                                                                .Selection.TypeText(Text:=CStr(DisplayCommas(Format(varAnal, GetRegrDecStr(LSigFigArea)))))
                                                            End If

                                                        ElseIf boolRCPARatio Then
                                                            'varT = RoundToDecimalRAFZ(varAnal / varIS, 10)
                                                            '.Selection.TypeText(Text:=Format(varT, "0.00000"))

                                                            If varIS = 0 Then
                                                                varT = 0
                                                                .Selection.TypeText(Text:=Format(varT, GetRegrDecStr(LSigFigAreaRatio)))
                                                            Else
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    varT = SigFigAreaRatio(RoundToDecimalA(varAnal / varIS, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                                    .Selection.TypeText(CStr(DisplayNum(varT, LSigFigAreaRatio, False)))
                                                                Else
                                                                    varT = RoundToDecimalRAFZ(varAnal / varIS, LSigFigAreaRatio)
                                                                    .Selection.TypeText(Text:=Format(varT, GetRegrDecStr(LSigFigAreaRatio)))
                                                                End If
                                                            End If



                                                        Else
                                                            If boolLUseSigFigs Then
                                                                .Selection.TypeText(Text:=CStr(DisplayNum(var2, LSigFig, False)))
                                                            Else
                                                                .Selection.TypeText(Text:=CStr(Format(RoundToDecimalRAFZ(var2, LSigFig), GetRegrDecStr(LSigFig))))
                                                            End If

                                                        End If
                                                    End If

                                                    boolEnterDiff = True
                                                End If
                                            End If

                                        End If

                                        If (boolSTATSDIFFCOL And boolX = False) Or boolME Then
                                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)
                                            If boolME Then

                                                If Count3 = 0 Then
                                                    If boolQCNA Then
                                                        var3 = "NA"
                                                    Else
                                                        var3 = ""
                                                    End If
                                                Else
                                                    'need mean Solvent/Lot first
                                                    'temporary
                                                    'var3 = ""
                                                    If boolRCPA Then
                                                        var1 = varAnal / numMeanT0
                                                    ElseIf boolRCPARatio Then
                                                        var1 = varT / numMeanT0
                                                    End If


                                                    If boolLUseSigFigs Then
                                                        var2 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                    Else
                                                        var2 = CStr(Format(RoundToDecimalRAFZ(var1, LSigFig), GetRegrDecStr(LSigFig)))
                                                    End If

                                                    var3 = var2

                                                    var3 = var3

                                                End If
                                            Else
                                                If boolEnterDiff Then
                                                    'var3 = Format(((var2 / varNom) - 1) * 100, strQCDec)
                                                    var3 = Format(RoundToDecimal(((var2 / varNom) - 1) * 100, intQCDec), strQCDec)

                                                    If boolTHEORETICAL Then
                                                        var3 = CalcREPercent(var2, varNom, intQCDec)
                                                        numTheor = 100 + CDec(var3)

                                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numTheor, CSng(var10), Count1, strDo, v1, v2, boolOC)

                                                    Else
                                                        var3 = Format(RoundToDecimal(CalcREPercent(var2, varNom, intQCDec), intQCDec), strQCDec)

                                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", var3, CSng(var10), Count1, strDo, v1, v2, boolOC)

                                                    End If
                                                Else

                                                    If boolQCNA Then
                                                        var3 = "NA"
                                                    Else
                                                        var3 = ""
                                                    End If

                                                End If

                                            End If

                                            If boolRedBoldFont And boolOC Then
                                                .Selection.Font.Bold = True
                                                .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                            End If

                                            .Selection.TypeText(Text:=CStr(var3))

                                            'check for outlier

                                            If boolOC Then
                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                            End If

                                            .Selection.MoveLeft(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCell)

                                        End If

                                    Next Count4

                                    'now enter Mean/Bias/n
                                    int8 = 0

                                    If boolQCREPORTACCVALUES Then
                                    Else
                                        If boolOutlier Then
                                            int8 = int8 + 1
                                        End If
                                        If intRowsX = 1 And StrComp(strH, "[NONE]", CompareMethod.Text) <> 0 Then
                                            int8 = int8 + 1
                                        End If
                                        If Count3 = 0 And boolOutlier Then

                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 2).Select()
                                            .Selection.TypeText(Text:="Summary Statistics Excluding Outlier Values")
                                            .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                            Try
                                                .Selection.Cells.Merge()
                                            Catch ex As Exception

                                            End Try
                                            With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                            End With

                                        End If
                                    End If

                                    intStart = int8

                                    If Count3 = 0 Then
                                        If boolSTATSMEAN Then
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                            .Selection.TypeText("Mean")
                                        End If
                                        If boolSTATSSD Then
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                            .Selection.TypeText("S.D.") '((Mean/NomConc)-1)*100)
                                        End If
                                        If boolSTATSCV Then
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                            .Selection.TypeText(ReturnPrecLabel()) '(sd/mean)*100)
                                        End If
                                        If boolSTATSBIAS And boolRCConc And boolSTATSMEAN Then
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                            .Selection.TypeText("%Bias") '((Mean/NomConc)-1)*100)
                                        End If
                                        If boolTHEORETICAL And boolSTATSMEAN Then
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                            .Selection.TypeText("%Theoretical") '((Mean/NomConc)-1)*100)
                                        End If

                                        If boolSTATSDIFF And boolRCConc And boolSTATSMEAN Then
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                            .Selection.TypeText("%Diff") '((Mean/NomConc)-1)*100)
                                        End If

                                        If BOOLSTATSRE And boolRCConc And boolSTATSMEAN Then
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                            .Selection.TypeText("%RE") '((Mean/NomConc)-1)*100)
                                        End If

                                        If boolSTATSN Then
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                            .Selection.TypeText("n")
                                        End If

                                        '20181108 LEE: Depracate this
                                        'Only used by CRL-WIL, and they have stopped using it
                                        'If boolDoME Then
                                        '    int8 = int8 + 1
                                        '    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                        '    .Selection.TypeText("Matrix Effect")
                                        'End If

                                        '20180806 LEE:
                                        'must make these rows top aligned
                                        If intCSN = 0 Then
                                        Else
                                            Try
                                                rng = .ActiveDocument.Range(Start:=tbl.Cell(int1 + intRowsX + 1, 1).Range.Start, End:=tbl.Cell(int1 + intRowsX + int8, tbl.Columns.Count).Range.End)
                                                rng.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalTop
                                            Catch ex As Exception
                                                var1 = var1
                                            End Try

                                        End If

                                    End If

                                    '20180804 LEE:
                                    'prepare matrix effect stuff
                                    Dim rowsMFAll() As DataRow
                                    Dim rowsMF() As DataRow
                                    Dim numSDME As Decimal
                                    Dim numSDMEAll As Decimal

                                    Dim numMeanAll As Decimal

                                    If boolME Then
                                        strF = "Lot = " & int12 + 1
                                        rowsMFAll = tblMF.Select(strF)
                                        strF = "Lot = " & int12 + 1 & " AND ELIMINATEDFLAG = 'N'"
                                        rowsMF = tblMF.Select(strF)
                                    End If


                                    If boolQCREPORTACCVALUES Then
                                    Else
                                        If boolOutlier And boolME = False Then
                                            int8 = int8 + 2
                                        End If
                                        If boolOutlier And boolME = False Then
                                            If Count3 = 0 Then
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 2).Select()
                                                .Selection.TypeText(Text:="Summary Statistics Including Outlier Values")
                                                .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                                                Try
                                                    .Selection.Cells.Merge()
                                                Catch ex As Exception

                                                End Try
                                                With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                                    .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                                                End With

                                                If boolSTATSMEAN Then
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                                    .Selection.TypeText("Mean")
                                                End If
                                                If boolSTATSSD Then
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                                    .Selection.TypeText("S.D.") '((Mean/NomConc)-1)*100)
                                                End If
                                                If boolSTATSCV Then
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                                    .Selection.TypeText(ReturnPrecLabel()) '(sd/mean)*100)
                                                End If
                                                If boolSTATSBIAS And boolRCConc And boolSTATSMEAN Then
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                                    .Selection.TypeText("%Bias") '((Mean/NomConc)-1)*100)
                                                End If
                                                If boolTHEORETICAL And boolSTATSMEAN Then
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                                    .Selection.TypeText("%Theoretical") '((Mean/NomConc)-1)*100)
                                                End If
                                                If boolSTATSDIFF And boolRCConc And boolSTATSMEAN Then
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                                    .Selection.TypeText("%Diff") '((Mean/NomConc)-1)*100)
                                                End If
                                                If BOOLSTATSRE And boolRCConc And boolSTATSMEAN Then
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                                    .Selection.TypeText("%RE") '((Mean/NomConc)-1)*100)
                                                End If
                                                If boolSTATSN Then
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, 1).Select()
                                                    .Selection.TypeText("n")
                                                End If
                                            End If

                                        End If
                                    End If



                                    int8 = intStart


                                    Try
                                        If boolX Then
                                            var1 = MeanDR(rows2E, "INTERNALSTANDARDAREA", False, "gaga", False, False)
                                        Else
                                            If boolRCConc Then
                                                var1 = MeanDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                            ElseIf boolRCPA Then
                                                var1 = MeanDR(rows2E, "ANALYTEAREA", False, "gaga", False, False)
                                            ElseIf boolRCPARatio Then
                                                var1 = MeanDR(rows2E, "ANALYTEAREA", False, "gaga", False, False)
                                            End If
                                        End If

                                        numMean = 0

                                        If nE = 0 Then
                                            numMean = 0
                                        Else
                                            If boolRCPA Or boolX Then
                                                If boolLUseSigFigsArea Then
                                                    numMean = SigFigOrDec(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False)
                                                    var2 = DisplayNum(numMean, LSigFigArea, False)
                                                Else
                                                    numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                    var2 = Format(numMean, GetRegrDecStr(LSigFigArea))
                                                End If


                                            ElseIf boolRCPARatio Then
                                                If boolX Then 'IntStd can't have area ratio, use Peak Area logic
                                                    If boolLUseSigFigsArea Then
                                                        numMean = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                        var2 = DisplayNum(numMean, LSigFigArea, False)
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                        var2 = Format(numMean, GetRegrDecStr(LSigFigArea))
                                                    End If

                                                Else
                                                    If boolLUseSigFigsAreaRatio Then
                                                        numMean = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                        var2 = DisplayNum(numMean, LSigFigAreaRatio, False)
                                                    Else
                                                        numMean = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                        var2 = Format(var1, GetRegrDecStr(LSigFigAreaRatio))
                                                    End If

                                                End If
                                                var2 = DisplayCommas(numMean)

                                            Else
                                                If boolLUseSigFigs Then
                                                    numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                Else
                                                    numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                End If

                                            End If
                                        End If

                                        arrME(Count2, int12) = numMean
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Mean", numMean, CSng(var10), Count1, strDo, v1, v2, False)

                                    Catch ex As Exception

                                    End Try

                                    Dim var1All = ""
                                    Dim boolOut As Boolean = False
                                    Dim numMeanOut As Decimal = 0

                                    If boolSTATSMEAN Then

                                        Try

                                            'enter Mean
                                            int8 = int8 + 1

                                            If BOOLINCLMFCOLS Then
                                                'skip lots
                                            Else
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()

                                                If boolX Then
                                                    var1 = MeanDR(rows2E, "INTERNALSTANDARDAREA", False, "gaga", False, False)
                                                Else
                                                    If boolRCConc Then
                                                        var1 = MeanDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                    ElseIf boolRCPA Then
                                                        var1 = MeanDR(rows2E, "ANALYTEAREA", False, "gaga", False, False)
                                                    ElseIf boolRCPARatio Then
                                                        var1 = MeanDR(rows2E, "ANALYTEAREA", False, "gaga", False, False)
                                                    End If
                                                End If

                                                If rows2E.Length = rows2.Length Or boolME = False Then
                                                Else
                                                    'determine var1All
                                                    boolOut = True
                                                    boolOutOverall = True

                                                    If boolX Then
                                                        var1All = MeanDR(rows2, "INTERNALSTANDARDAREA", False, "gaga", False, False)
                                                    Else
                                                        If boolRCConc Then
                                                            var1All = MeanDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                        ElseIf boolRCPA Then
                                                            var1All = MeanDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                        ElseIf boolRCPARatio Then
                                                            var1All = MeanDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                        End If
                                                    End If
                                                End If

                                                numMean = 0

                                                If nE = 0 Then
                                                    .Selection.TypeText("NA")
                                                Else
                                                    If boolRCPA Or boolX Then

                                                        If boolLUseSigFigsArea Then
                                                            numMean = SigFigOrDec(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, False)
                                                            var2 = DisplayNum(numMean, LSigFigArea, False)
                                                        Else
                                                            numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                            var2 = Format(numMean, GetRegrDecStr(LSigFigArea))
                                                        End If


                                                        If nE = 0 Then
                                                            .Selection.TypeText("NA")
                                                        Else
                                                            var2 = DisplayCommas(var2)
                                                            .Selection.TypeText(CStr(var2))

                                                            If boolOut Then
                                                                If boolLUseSigFigsArea Then
                                                                    numMeanOut = SigFigOrDec(RoundToDecimalA(var1All, LSigFigArea), LSigFigArea, False)
                                                                    var2 = DisplayNum(numMeanOut, LSigFigArea, False)
                                                                Else
                                                                    numMeanOut = RoundToDecimalRAFZ(var1All, LSigFigArea)
                                                                    var2 = Format(numMeanOut, GetRegrDecStr(LSigFigArea))
                                                                End If

                                                                var2 = DisplayCommas(var2)
                                                                var3 = ChrW(10) & "(" & var2 & ")"
                                                                .Selection.TypeText(CStr(var3))

                                                            End If

                                                        End If


                                                    ElseIf boolRCPARatio Then

                                                        If boolX Then 'IntStd can't have area ratio, use Peak Area logic
                                                            If boolLUseSigFigsArea Then
                                                                numMean = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                                var2 = DisplayNum(numMean, LSigFigArea, False)
                                                            Else
                                                                numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                                var2 = Format(numMean, GetRegrDecStr(LSigFigArea))
                                                            End If

                                                        Else
                                                            If boolLUseSigFigsAreaRatio Then
                                                                numMean = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                                var2 = DisplayNum(numMean, LSigFigAreaRatio, False)
                                                            Else
                                                                numMean = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                var2 = Format(var1, GetRegrDecStr(LSigFigAreaRatio))
                                                            End If

                                                        End If
                                                        var2 = DisplayCommas(numMean)
                                                        If nE = 0 Then
                                                            .Selection.TypeText("NA")
                                                        Else
                                                            .Selection.TypeText(CStr(var2))

                                                            If boolOut Then
                                                                If boolX Then
                                                                    If boolLUseSigFigsArea Then
                                                                        numMeanOut = SigFigOrDec(RoundToDecimalA(var1All, LSigFigArea), LSigFigArea, False)
                                                                        var2 = DisplayNum(numMeanOut, LSigFigArea, False)
                                                                    Else
                                                                        numMeanOut = RoundToDecimalRAFZ(var1All, LSigFigArea)
                                                                        var2 = Format(numMeanOut, GetRegrDecStr(LSigFigArea))
                                                                    End If
                                                                Else
                                                                    If boolLUseSigFigsArea Then
                                                                        numMeanOut = SigFigOrDec(RoundToDecimalA(var1All, LSigFigAreaRatio), LSigFigAreaRatio, False)
                                                                        var2 = DisplayNum(numMeanOut, LSigFigAreaRatio, False)
                                                                    Else
                                                                        numMeanOut = RoundToDecimalRAFZ(var1All, LSigFigAreaRatio)
                                                                        var2 = Format(numMeanOut, GetRegrDecStr(LSigFigAreaRatio))
                                                                    End If
                                                                End If


                                                                var2 = DisplayCommas(var2)
                                                                var3 = ChrW(10) & "(" & var2 & ")"
                                                                .Selection.TypeText(CStr(var3))

                                                            End If

                                                        End If


                                                    Else
                                                        If boolLUseSigFigs Then
                                                            numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                        Else
                                                            numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                        End If

                                                        'determine if value is outside acceptance criteria
                                                        'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag
                                                        If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                            intLeg = intLeg + 1
                                                            strA = ChrW(intLeg + intLegStart)
                                                            If gAllowGuWuAccCrit And LAllowGuWuAccCrit And vU = -1 Then
                                                                v1 = RoundToDecimal(arrFP(1, int12), 0)
                                                                v2 = RoundToDecimal(arrFP(2, int12), 0)

                                                                If v1 = v2 Then
                                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                                Else
                                                                    str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                                End If

                                                                'str1 = "Value outside of acceptance criteria (+" & RoundToDecimal(arrFP(1, int12), 0) & "/-" & RoundToDecimal(arrFP(2, int12), 0) & "% theoretical) but included in summary statistics."
                                                            Else
                                                                str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                            End If
                                                            'str1 = "Value outside of acceptance criteria (" & RoundToDecimal(arrFP(Count3), 0) & "% theoretical) but included in summary statistics."
                                                            'search for str1 in arrLegend
                                                            If intLeg = 1 Then
                                                                arrLegend(1, intLeg) = strA
                                                                arrLegend(2, intLeg) = str1
                                                                arrLegend(3, intLeg) = True
                                                                ctLegend = ctLegend + 1
                                                            Else
                                                                boolPro = True
                                                                For Count5 = 1 To intLeg - 1
                                                                    str2 = arrLegend(2, Count5)
                                                                    If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                                        intLeg = intLeg - 1
                                                                        strA = arrLegend(1, Count5)
                                                                        boolPro = False
                                                                        Exit For

                                                                    End If
                                                                Next
                                                                If boolPro Then
                                                                    arrLegend(1, intLeg) = strA
                                                                    arrLegend(2, intLeg) = str1
                                                                    arrLegend(3, intLeg) = True
                                                                    ctLegend = ctLegend + 1
                                                                End If
                                                            End If

                                                            If nE = 0 Then
                                                                .Selection.TypeText("NA")
                                                            Else
                                                                If boolRedBoldFont Then
                                                                    .Selection.Font.Bold = True
                                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                                End If

                                                                '.Selection.TypeText(Text:=CStr(numMean))
                                                                If boolLUseSigFigs Then
                                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                                Else
                                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                                End If

                                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                            End If

                                                            boolEnterDiff = True
                                                        Else
                                                            '.Selection.TypeText(Text:=CStr(numMean))
                                                            If nE = 0 Then
                                                                .Selection.TypeText("NA")
                                                            Else
                                                                If boolLUseSigFigs Then
                                                                    .Selection.TypeText(CStr(DisplayNum(numMean, LSigFig, False)))
                                                                Else
                                                                    .Selection.TypeText(CStr(Format(numMean, GetRegrDecStr(LSigFig))))
                                                                End If
                                                            End If

                                                            boolEnterDiff = True
                                                        End If

                                                    End If
                                                End If

                                            End If

                                            'arrME(Count10, int12) = numMean
                                            arrME(Count2, int12) = numMean
                                            '.Selection.TypeText(CStr(nummean))

skipLots01:


                                            If boolME Then

                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 3).Select()

                                                If int12 = 0 Then
                                                    numMeanT0 = numMean
                                                    var5 = "NA"
                                                Else
                                                    If BOOLINCLMFCOLS Then 'use average MF values

                                                        var1 = MeanDR(rowsMFAll, "MF", False, "gaga", True, False)
                                                        var2 = MeanDR(rowsMF, "MF", False, "gaga", True, False)

                                                        If boolLUseSigFigs Then
                                                            numMeanMEAll = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            numMeanME = SigFigOrDecString(RoundToDecimalA(var2, LSigFig), LSigFig, False)
                                                        Else
                                                            numMeanMEAll = RoundToDecimalRAFZ(var1, LSigFig)
                                                            numMeanME = RoundToDecimalRAFZ(var2, LSigFig)
                                                        End If

                                                        var3 = CStr(DisplayNum(numMeanMEAll, LSigFig, False))
                                                        var4 = CStr(DisplayNum(numMeanME, LSigFig, False))


                                                        If rowsMFAll.Length = rowsMF.Length Then
                                                            var5 = var4
                                                        Else
                                                            var5 = var4 & ChrW(10) & "(" & var3 & ")"
                                                        End If

                                                    Else 'use average peak area

                                                        If boolRCConc Then
                                                            var1 = MeanDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                        ElseIf boolRCPA Then
                                                            var1 = MeanDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                        ElseIf boolRCPARatio Then
                                                            var1 = MeanDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                        End If

                                                        If boolLUseSigFigsArea Or boolX Then
                                                            numMeanAll = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                        ElseIf boolRCPARatio Then
                                                            numMeanAll = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                        End If

                                                        var1 = numMeanAll / numMeanT0
                                                        var2 = numMean / numMeanT0

                                                        If boolLUseSigFigs Then
                                                            numMeanMEAll = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            numMeanME = SigFigOrDecString(RoundToDecimalA(var2, LSigFig), LSigFig, False)
                                                        Else
                                                            numMeanMEAll = RoundToDecimalRAFZ(var1, LSigFig)
                                                            numMeanME = RoundToDecimalRAFZ(var2, LSigFig)
                                                        End If

                                                        var3 = CStr(DisplayNum(numMeanMEAll, LSigFig, False))
                                                        var4 = CStr(DisplayNum(numMeanME, LSigFig, False))

                                                        If rowsMFAll.Length = rowsMF.Length Then
                                                            var5 = var4
                                                        Else
                                                            var5 = var4 & ChrW(10) & "(" & var3 & ")"
                                                        End If

                                                    End If

                                                    'record in tblMeanMF
                                                    Dim nr As DataRow = tblMeanMF.NewRow
                                                    nr("BOOLALL") = -1
                                                    nr("MF") = numMeanMEAll
                                                    nr("Lot") = int12
                                                    tblMeanMF.Rows.Add(nr)

                                                    Dim nr1 As DataRow = tblMeanMF.NewRow
                                                    nr1("BOOLALL") = 0
                                                    nr1("MF") = numMeanME
                                                    nr1("Lot") = int12
                                                    tblMeanMF.Rows.Add(nr1)

                                                End If

                                                .Selection.TypeText(CStr(var5))

                                            End If

                                        Catch ex As Exception

                                        End Try

                                    End If


                                    'SD
                                    Try

                                        If nE < gSDMax Then
                                            numSD = 0
                                        Else

                                            If boolX Then '
                                                var1 = StdDevDR(rows2E, "INTERNALSTANDARDAREA", False, "gaga", False, False)
                                            Else
                                                If boolRCConc Then
                                                    var1 = StdDevDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                ElseIf boolRCPA Then
                                                    var1 = StdDevDR(rows2E, "ANALYTEAREA", False, "gaga", False, False)
                                                ElseIf boolRCPARatio Then
                                                    var1 = StdDevDR(rows2E, "ANALYTEAREA", False, "gaga", False, False)
                                                End If
                                            End If


                                            'var1 = StdDevDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True)
                                            numSD = 0
                                            If boolRCPA Or boolX Then
                                                If boolLUseSigFigsArea Then
                                                    numSD = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                End If

                                            ElseIf boolRCPARatio Then
                                                If boolX Then 'IntStd can't have area ratio, use Peak Area logic
                                                    If boolLUseSigFigsArea Then
                                                        numSD = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                    Else
                                                        numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                    End If
                                                    var2 = DisplayCommas(numSD)
                                                Else
                                                    If boolLUseSigFigsAreaRatio Then
                                                        numSD = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                        var2 = DisplayNum(numSD, LSigFigAreaRatio, False)
                                                    Else
                                                        numSD = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                        var2 = Format(numSD, GetRegrDecStr(LSigFigAreaRatio))
                                                    End If
                                                End If

                                            Else
                                                If boolLUseSigFigs Then
                                                    numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                Else
                                                    numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                End If

                                            End If

                                        End If

                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "SD", numSD, CSng(var10), Count1, strDo, v1, v2, False)

                                    Catch ex As Exception

                                    End Try

                                    Dim numSDAll As Decimal

                                    If boolSTATSSD Then
                                        Try
                                            'enter SD
                                            int8 = int8 + 1

                                            If BOOLINCLMFCOLS Then
                                                'skip lots
                                            Else
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                                If nE < gSDMax Then
                                                    .Selection.TypeText("NA")
                                                Else

                                                    If boolX Then '
                                                        var1 = StdDevDR(rows2E, "INTERNALSTANDARDAREA", False, "gaga", False, False)
                                                    Else
                                                        If boolRCConc Then
                                                            var1 = StdDevDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                        ElseIf boolRCPA Then
                                                            var1 = StdDevDR(rows2E, "ANALYTEAREA", False, "gaga", False, False)
                                                        ElseIf boolRCPARatio Then
                                                            var1 = StdDevDR(rows2E, "ANALYTEAREA", False, "gaga", False, False)
                                                        End If
                                                    End If

                                                    If rows2E.Length = rows2.Length Or boolME = False Then
                                                    Else
                                                        'determine var1All
                                                        If boolX Then
                                                            var1All = StdDevDR(rows2, "INTERNALSTANDARDAREA", False, "gaga", False, False)
                                                        Else
                                                            If boolRCConc Then
                                                                var1All = StdDevDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", False, False)
                                                            ElseIf boolRCPA Then
                                                                var1All = StdDevDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                            ElseIf boolRCPARatio Then
                                                                var1All = StdDevDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                            End If
                                                        End If
                                                    End If

                                                    'var1 = StdDevDR(rows2E, "CONCENTRATION", True, "ALIQUOTFACTOR", True)
                                                    numSD = 0
                                                    If boolRCPA Or boolX Then
                                                        If boolLUseSigFigsArea Then
                                                            numSD = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                            '.Selection.TypeText(DisplayNum(numSD, LSigFigArea, False))
                                                            var2 = DisplayNum(numSD, LSigFigArea, False)
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                            '.Selection.TypeText(Format(numSD, GetRegrDecStr(LSigFigArea)))
                                                            var2 = Format(numSD, GetRegrDecStr(LSigFigArea))
                                                        End If

                                                    ElseIf boolRCPARatio Then
                                                        If boolX Then 'IntStd can't have area ratio, use Peak Area logic
                                                            If boolLUseSigFigsArea Then
                                                                numSD = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                                .Selection.TypeText(DisplayNum(numSD, LSigFigArea, False))
                                                            Else
                                                                numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                                .Selection.TypeText(Format(numSD, GetRegrDecStr(LSigFigArea)))
                                                            End If
                                                            var2 = DisplayCommas(numSD)
                                                        Else
                                                            If boolLUseSigFigsAreaRatio Then
                                                                numSD = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                                var2 = DisplayNum(numSD, LSigFigAreaRatio, False)
                                                            Else
                                                                numSD = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                var2 = Format(numSD, GetRegrDecStr(LSigFigAreaRatio))
                                                            End If
                                                        End If
                                                        '.Selection.TypeText(CStr(var2))
                                                    Else
                                                        If boolLUseSigFigs Then
                                                            numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            '.Selection.TypeText(DisplaySigFig(numSD, LSigFig))
                                                            var2 = DisplaySigFig(numSD, LSigFig)
                                                        Else
                                                            numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                            '.Selection.TypeText(Format(numSD, GetRegrDecStr(LSigFig)))
                                                            var2 = Format(numSD, GetRegrDecStr(LSigFig))
                                                        End If

                                                    End If

                                                    .Selection.TypeText(CStr(var2))

                                                    If boolOut Then
                                                        If boolLUseSigFigsArea Then
                                                            numSDAll = SigFigOrDec(RoundToDecimalA(var1All, LSigFigArea), LSigFigArea, False)
                                                            var2 = DisplayNum(numSDAll, LSigFigArea, False)
                                                        Else
                                                            numSDAll = RoundToDecimalRAFZ(var1All, LSigFigArea)
                                                            var2 = Format(numSDAll, GetRegrDecStr(LSigFigArea))
                                                        End If

                                                        var2 = DisplayCommas(var2)
                                                        var3 = ChrW(10) & "(" & var2 & ")"
                                                        .Selection.TypeText(CStr(var3))

                                                    End If

                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "SD", numSD, CSng(var10), Count1, strDo, v1, v2, False)


                                                End If
                                            End If

                                            If boolME Then

                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 3).Select()

                                                If int12 = 0 Or nE < gSDMax Or BOOLINCLMFCOLS = False Then
                                                    var5 = "NA"
                                                Else
                                                    var1 = StdDevDR(rowsMFAll, "MF", False, "gaga", True, False)
                                                    var2 = StdDevDR(rowsMF, "MF", False, "gaga", True, False)

                                                    If boolLUseSigFigs Then
                                                        numSDMEAll = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                        numSDME = SigFigOrDecString(RoundToDecimalA(var2, LSigFig), LSigFig, False)
                                                    Else
                                                        numSDMEAll = RoundToDecimalRAFZ(var1, LSigFig)
                                                        numSDME = RoundToDecimalRAFZ(var2, LSigFig)
                                                    End If

                                                    var3 = CStr(DisplayNum(numSDMEAll, LSigFig, False))
                                                    var4 = CStr(DisplayNum(numSDME, LSigFig, False))

                                                    If rowsMFAll.Length = rowsMF.Length Then
                                                        var5 = var4
                                                    Else
                                                        var5 = var4 & ChrW(10) & "(" & var3 & ")"
                                                    End If
                                                End If

                                                .Selection.TypeText(CStr(var5))

                                            End If


                                        Catch ex As Exception

                                        End Try

                                    End If


                                    'CV
                                    Dim numPrecMEAll As Decimal
                                    Dim numPrecME As Decimal
                                    Dim numPrecAll As Decimal

                                    Try
                                        If nE < gSDMax Then
                                        Else
                                            numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                            Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Precision", numPrec, CSng(var10), Count1, strDo, v1, v2, False)

                                            If boolOut Then
                                                numPrecAll = CalcCVPercent(numSDAll, numMeanOut, intQCDec)
                                            End If

                                            If boolME Then

                                                If int12 = 0 Or nE < gSDMax Or BOOLINCLMFCOLS = False Then
                                                    var5 = "NA"
                                                Else
                                                    numPrecMEAll = CalcCVPercent(numSDMEAll, numMeanMEAll, intQCDec)
                                                    numPrecME = CalcCVPercent(numSDME, numMeanME, intQCDec)
                                                End If

                                            End If

                                        End If

                                    Catch ex As Exception

                                    End Try

                                    If boolSTATSCV Then
                                        Try

                                            'enter %CV
                                            int8 = int8 + 1
                                            .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                            If nE < gSDMax Then
                                                If BOOLINCLMFCOLS Then
                                                    'skip lots
                                                Else
                                                    .Selection.TypeText("NA")
                                                End If

                                            Else

                                                If BOOLINCLMFCOLS Then
                                                    'skip lots
                                                Else

                                                    .Selection.TypeText(Format(numPrec, strQCDec))

                                                    If boolOut Then
                                                        var3 = ChrW(10) & "(" & Format(numPrecAll, strQCDec) & ")"
                                                        .Selection.TypeText(CStr(var3))
                                                    End If
                                                End If

                                                If boolME Then

                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 3).Select()

                                                    If int12 = 0 Or nE < gSDMax Or BOOLINCLMFCOLS = False Then
                                                        var5 = "NA"
                                                    Else
                                                        var3 = Format(numPrecMEAll, strQCDec)
                                                        var4 = Format(numPrecME, strQCDec)

                                                        If rowsMFAll.Length = rowsMF.Length Then
                                                            var5 = var4
                                                        Else
                                                            var5 = var4 & ChrW(10) & "(" & var3 & ")"
                                                        End If
                                                    End If

                                                    .Selection.TypeText(CStr(var5))

                                                End If

                                            End If

                                        Catch ex As Exception

                                        End Try
                                    End If


                                    '%Bias

                                    Dim numBiasAll As Decimal
                                    If boolSTATSBIAS Then

                                        If boolSTATSBIAS And (boolSTATSDIFFCOL = False Or (boolSTATSDIFFCOL And BOOLDIFFCOLSTATS = False)) Then
                                            Try

                                                numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                If nE = 0 Then
                                                Else
                                                    Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, v1, v2, False)
                                                End If

                                                If boolOut Then
                                                    numBiasAll = CalcREPercent(numMeanAll, varNom, intQCDec)
                                                End If

                                            Catch ex As Exception

                                            End Try

                                        Else
                                            'get numbias from average of %Bias columns
                                            numBias = GetBiasFromDiffCol(idTR, varNom, int12, 0, False)
                                        End If

                                    End If

                                    If boolSTATSBIAS And boolRCConc And boolSTATSMEAN Then
                                        Try
                                            'enter %Bias
                                            int8 = int8 + 1

                                            If BOOLINCLMFCOLS Then
                                                'skip lots
                                            Else
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                                'var1 = (((numMean / varNom) - 1) * 100)
                                                'var1 = Format(var1, strQCDec)
                                                '.Selection.TypeText(CStr(var1))

                                                If boolX Then
                                                    .Selection.TypeText("NA")
                                                Else

                                                    If nE = 0 Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        .Selection.TypeText(Format(numBias, strQCDec))

                                                        If boolOut Then
                                                            .Selection.TypeText(ChrW(10) & "(" & Format(numBiasAll, strQCDec) & ")")
                                                        End If

                                                    End If

                                                End If
                                            End If

                                            If boolME Then
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 3).Select()
                                                .Selection.TypeText("NA")
                                            End If


                                        Catch ex As Exception

                                        End Try

                                    End If

                                    Dim numTheorAll As Decimal

                                    If boolTHEORETICAL And (boolSTATSDIFFCOL = False Or (boolSTATSDIFFCOL And BOOLDIFFCOLSTATS = False)) Then
                                        Try
                                            numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                            numTheor = 100 + CDec(numTheor)
                                            If nE = 0 Then
                                            Else
                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numTheor, CSng(var10), Count1, strDo, v1, v2, False)
                                            End If

                                            If boolOut Then
                                                numTheorAll = CalcREPercent(numMeanAll, varNom, intQCDec)
                                                numTheorAll = 100 + CDec(numTheorAll)
                                            End If

                                        Catch ex As Exception

                                        End Try

                                    Else
                                        'get numbias from average of %Bias columns
                                        numBias = GetBiasFromDiffCol(idTR, varNom, int12 + 1, 0, False)
                                    End If

                                    If boolTHEORETICAL And boolRCConc And boolSTATSMEAN Then
                                        Try
                                            'enter %theoretical
                                            int8 = int8 + 1

                                            If BOOLINCLMFCOLS Then
                                                'skip lots
                                            Else
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()

                                                If boolX Then
                                                    .Selection.TypeText("NA")
                                                Else

                                                    If nE = 0 Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        .Selection.TypeText(Format(numTheor, strQCDec))

                                                        If boolOut Then
                                                            .Selection.TypeText(ChrW(10) & "(" & Format(numTheorAll, strQCDec) & ")")
                                                        End If
                                                    End If

                                                End If
                                            End If

                                            If boolME Then
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 3).Select()
                                                .Selection.TypeText("NA")
                                            End If

                                        Catch ex As Exception

                                        End Try
                                    Else
                                        'get numbias from average of %Bias columns
                                        numBias = GetBiasFromDiffCol(idTR, varNom, int12, 0, False)
                                    End If


                                    If boolSTATSDIFF And (boolSTATSDIFFCOL = False Or (boolSTATSDIFFCOL And BOOLDIFFCOLSTATS = False)) Then
                                        Try
                                            numBias = CalcREPercent(numMean, varNom, intQCDec)
                                            If nE = 0 Then
                                            Else
                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, v1, v2, False)
                                            End If

                                            If boolOut Then
                                                numBiasAll = CalcREPercent(numMeanAll, varNom, intQCDec)
                                            End If

                                        Catch ex As Exception

                                        End Try

                                    Else

                                        'get numbias from average of %Bias columns
                                        numBias = GetBiasFromDiffCol(idTR, varNom, int12 + 1, 0, False)
                                    End If

                                    If boolSTATSDIFF And boolRCConc And boolSTATSMEAN Then
                                        Try
                                            'enter %Bias
                                            int8 = int8 + 1

                                            If BOOLINCLMFCOLS Then
                                                'skip lots
                                            Else
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()

                                                If boolX Then
                                                    .Selection.TypeText("NA")
                                                Else

                                                    If nE = 0 Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        .Selection.TypeText(Format(numBias, strQCDec))

                                                        If boolOut Then
                                                            .Selection.TypeText(ChrW(10) & "(" & Format(numBiasAll, strQCDec) & ")")
                                                        End If

                                                    End If

                                                End If
                                            End If

                                            If boolME Then
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 3).Select()
                                                .Selection.TypeText("NA")
                                            End If

                                        Catch ex As Exception

                                        End Try
                                    End If


                                    If BOOLSTATSRE And (boolSTATSDIFFCOL = False Or (boolSTATSDIFFCOL And BOOLDIFFCOLSTATS = False)) Then
                                        Try
                                            numBias = CalcREPercent(numMean, varNom, intQCDec)
                                            If nE = 0 Then
                                            Else
                                                Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "Accuracy", numBias, CSng(var10), Count1, strDo, v1, v2, False)
                                            End If

                                            If boolOut Then
                                                numBiasAll = CalcREPercent(numMeanAll, varNom, intQCDec)
                                            End If


                                        Catch ex As Exception

                                        End Try
                                    Else
                                        'get numbias from average of %Bias columns
                                        numBias = GetBiasFromDiffCol(idTR, varNom, int12 + 1, 0, False)
                                    End If

                                    If BOOLSTATSRE And boolRCConc And boolSTATSMEAN Then
                                        Try
                                            'enter %RE
                                            int8 = int8 + 1

                                            If BOOLINCLMFCOLS Then
                                                'skip lots
                                            Else
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()

                                                If boolX Then
                                                    .Selection.TypeText("NA")
                                                Else

                                                    If nE = 0 Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        .Selection.TypeText(Format(numBias, strQCDec))

                                                        If boolOut Then
                                                            .Selection.TypeText(ChrW(10) & "(" & Format(numBiasAll, strQCDec) & ")")
                                                        End If

                                                    End If

                                                End If
                                            End If


                                            If boolME Then
                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 3).Select()
                                                .Selection.TypeText("NA")
                                            End If

                                        Catch ex As Exception

                                        End Try
                                    End If


                                    Try
                                        Call InsertQCTables(intTableID, idTR, charFCID, varNom, int12 + 1, "n", nE, CSng(var10), Count1, strDo, v1, v2, False)
                                    Catch ex As Exception

                                    End Try

                                    If boolSTATSN Then
                                        Try
                                            'enter n
                                            int8 = int8 + 1

                                            If BOOLINCLMFCOLS Then
                                                'skip lots
                                            Else

                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                                .Selection.TypeText(CStr(nE))

                                                If boolOut Then
                                                    .Selection.TypeText(ChrW(10) & "(" & rows2.Length & ")")
                                                End If

                                            End If

                                            If boolME Then

                                                .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 3).Select()

                                                If int12 = 0 Or nE < gSDMax Or BOOLINCLMFCOLS = False Then
                                                    var5 = "NA"
                                                Else
                                                    var3 = rowsMFAll.Length
                                                    var4 = rowsMF.Length

                                                    If BOOLINCLMFCOLS Then
                                                        var3 = rowsMFAll.Length
                                                        var4 = rowsMF.Length

                                                        If rowsMFAll.Length = rowsMF.Length Then
                                                            var5 = var4
                                                        Else
                                                            var5 = var4 & ChrW(10) & "(" & var3 & ")"
                                                        End If
                                                    Else
                                                        var5 = "NA"
                                                    End If

                                                End If

                                                .Selection.TypeText(var5)
                                            End If

                                        Catch ex As Exception

                                        End Try
                                    End If


                                    ''20181108 LEE:
                                    ''Deprecate Matrix Effect calcualtions
                                    'If boolME Then

                                    '    int8 = int8 + 1
                                    '    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 3).Select()

                                    '    Try
                                    '        If int12 = 0 Then
                                    '            var5 = "NA"
                                    '        Else

                                    '            var3 = Format((numMeanMEAll * 100) - 100, "0.0")
                                    '            var4 = Format((numMeanME * 100) - 100, "0.0")

                                    '            If rowsMFAll.Length = rowsMF.Length Then
                                    '                var5 = var4
                                    '            Else
                                    '                var5 = var4 & ChrW(10) & "(" & var3 & ")"
                                    '            End If

                                    '        End If
                                    '    Catch ex As Exception
                                    '        var5 = "NA"
                                    '    End Try

                                    '    .Selection.TypeText(var5)

                                    'End If

                                    var1 = int1 + intRowsX + int8
                                    If var1 > intLastRow Then
                                        intLastRow = var1
                                    End If

                                    If boolQCREPORTACCVALUES Then 'Endif 1
                                    Else
                                        If boolOutlier Then 'Endif 2

                                            int8 = int8 + 2

                                            If boolSTATSMEAN Then
                                                Try
                                                    'enter Mean
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                                    If boolX Then
                                                        var1 = MeanDR(rows2, "INTERNALSTANDARDAREA", False, "gaga", False, False)
                                                    Else
                                                        If boolRCConc Then
                                                            var1 = MeanDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                        ElseIf boolRCPA Then
                                                            var1 = MeanDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                        ElseIf boolRCPARatio Then
                                                            var1 = MeanDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                        End If
                                                    End If

                                                    'var1 = MeanDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True)
                                                    numMean = 0
                                                    If nI = 0 Then

                                                        .Selection.TypeText("NA")
                                                    Else
                                                        If boolRCPA Or boolX Then
                                                            If boolLUseSigFigsArea Then
                                                                numMean = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                                .Selection.TypeText(DisplayNum(numMean, LSigFigArea, False))
                                                            Else
                                                                numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                                .Selection.TypeText(Format(numMean, GetRegrDecStr(LSigFigArea)))
                                                            End If

                                                        ElseIf boolRCPARatio Then
                                                            If boolX Then 'IntStd can't have area ratio, use Peak Area logic
                                                                If boolLUseSigFigsArea Then
                                                                    numMean = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                                    .Selection.TypeText(DisplayNum(numMean, LSigFigArea, False))
                                                                Else
                                                                    numMean = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                                    .Selection.TypeText(Format(numMean, GetRegrDecStr(LSigFigArea)))
                                                                End If
                                                                var2 = DisplayCommas(numMean)
                                                            Else
                                                                If boolLUseSigFigsAreaRatio Then
                                                                    numMean = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                                    .Selection.TypeText(DisplayNum(numMean, LSigFigAreaRatio, False))
                                                                Else
                                                                    numMean = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                    .Selection.TypeText(Format(numMean, GetRegrDecStr(LSigFigAreaRatio)))
                                                                End If

                                                            End If

                                                            '.Selection.TypeText(CStr(var2))
                                                        Else
                                                            If boolLUseSigFigs Then
                                                                numMean = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                            Else
                                                                numMean = RoundToDecimalRAFZ(var1, LSigFig)
                                                            End If

                                                            '.Selection.TypeText(DisplaySigFig(numMean, LSigFig))

                                                            'determine if value is outside acceptance criteria
                                                            'If (numMean > hi Or numMean < lo) And boolFootNoteQCMean Then 'flag
                                                            If (OutsideAccCrit(numMean, varNom, v1, v2, NZ(vU, 0))) And boolFootNoteQCMean Then 'flag
                                                                intLeg = intLeg + 1
                                                                strA = ChrW(intLeg + intLegStart)
                                                                If gAllowGuWuAccCrit And LAllowGuWuAccCrit And vU = -1 Then
                                                                    v1 = RoundToDecimal(arrFP(1, int12), 0)
                                                                    v2 = RoundToDecimal(arrFP(2, int12), 0)

                                                                    If v1 = v2 Then
                                                                        str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & v1 & " % theoretical) but included in summary statistics."
                                                                    Else
                                                                        str1 = "Value outside of acceptance criteria (+" & v1 & "/-" & v2 & " % theoretical) but included in summary statistics."
                                                                    End If

                                                                    'str1 = "Value outside of acceptance criteria (+" & RoundToDecimal(arrFP(1, int12), 0) & "/-" & RoundToDecimal(arrFP(2, int12), 0) & "% theoretical) but included in summary statistics."
                                                                Else
                                                                    str1 = "Value outside of acceptance criteria (" & ChrW(177) & " " & RoundToDecimal(arrFP(1, int12), 0) & "% theoretical) but included in summary statistics."
                                                                End If
                                                                'str1 = "Value outside of acceptance criteria (" & RoundToDecimal(arrFP(Count3), 0) & "% theoretical) but included in summary statistics."
                                                                'search for str1 in arrLegend
                                                                If intLeg = 1 Then
                                                                    arrLegend(1, intLeg) = strA
                                                                    arrLegend(2, intLeg) = str1
                                                                    arrLegend(3, intLeg) = True
                                                                    ctLegend = ctLegend + 1
                                                                Else
                                                                    boolPro = True
                                                                    For Count5 = 1 To intLeg - 1
                                                                        str2 = arrLegend(2, Count5)
                                                                        If StrComp(str1, str2, CompareMethod.Text) = 0 Then 'abort
                                                                            intLeg = intLeg - 1
                                                                            strA = arrLegend(1, Count5)
                                                                            boolPro = False
                                                                            Exit For

                                                                        End If
                                                                    Next
                                                                    If boolPro Then
                                                                        arrLegend(1, intLeg) = strA
                                                                        arrLegend(2, intLeg) = str1
                                                                        arrLegend(3, intLeg) = True
                                                                        ctLegend = ctLegend + 1
                                                                    End If
                                                                End If


                                                                If boolRedBoldFont Then
                                                                    .Selection.Font.Bold = True
                                                                    .Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                                End If

                                                                '.Selection.TypeText(Text:=CStr(numMean))
                                                                If boolLUseSigFigs Then
                                                                    .Selection.TypeText(DisplayNum(numMean, LSigFig, False))
                                                                Else
                                                                    .Selection.TypeText(Format(numMean, GetRegrDecStr(LSigFig)))
                                                                End If


                                                                Call typeInSuperscriptFontSize12WithSpace(wd, strA)
                                                                boolEnterDiff = True
                                                            Else
                                                                '.Selection.TypeText(Text:=CStr(numMean))
                                                                If boolLUseSigFigs Then
                                                                    .Selection.TypeText(DisplayNum(numMean, LSigFig, False))
                                                                Else
                                                                    .Selection.TypeText(Format(numMean, GetRegrDecStr(LSigFig)))
                                                                End If
                                                                boolEnterDiff = True
                                                            End If

                                                        End If
                                                    End If


                                                    'numMean = SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False)
                                                    '.Selection.TypeText(CStr(numMean))

                                                Catch ex As Exception

                                                End Try
                                            End If
                                            If boolSTATSSD Then
                                                Try
                                                    'enter SD
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                                    If nI < gSDMax Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        If boolX Then
                                                            var1 = StdDevDR(rows2, "INTERNALSTANDARDAREA", False, "gaga", False, False)
                                                        Else
                                                            If boolRCConc Then
                                                                var1 = StdDevDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True, False)
                                                            ElseIf boolRCPA Then
                                                                var1 = StdDevDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                            ElseIf boolRCPARatio Then
                                                                var1 = StdDevDR(rows2, "ANALYTEAREA", False, "gaga", False, False)
                                                            End If
                                                        End If

                                                        'var1 = StdDevDR(rows2, "CONCENTRATION", True, "ALIQUOTFACTOR", True)
                                                        If boolRCPA Or boolX Then
                                                            If boolLUseSigFigsArea Then
                                                                numSD = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                                .Selection.TypeText(DisplayNum(numSD, LSigFigArea, False))
                                                            Else
                                                                numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                                .Selection.TypeText(Format(numSD, GetRegrDecStr(LSigFigArea)))
                                                            End If

                                                        ElseIf boolRCPARatio Then
                                                            If boolX Then 'IntStd can't have area ratio, use Peak Area logic
                                                                If boolLUseSigFigsArea Then
                                                                    numSD = SigFigArea(RoundToDecimalA(var1, LSigFigArea), LSigFigArea, True, False)
                                                                    .Selection.TypeText(DisplayNum(numSD, LSigFigArea, False))
                                                                Else
                                                                    numSD = RoundToDecimalRAFZ(var1, LSigFigArea)
                                                                    .Selection.TypeText(Format(numSD, GetRegrDecStr(LSigFigArea)))
                                                                End If
                                                                var2 = DisplayCommas(numSD)
                                                                .Selection.TypeText(var2)
                                                            Else
                                                                ''var2 = RoundToDecimalRAFZ( SigFigOrDecString(RoundToDecimal(var1, 5), LSigFig, False)
                                                                'numSD = RoundToDecimalRAFZ(var2, 5) ' var2 ' RoundToDecimal(var1, 5)
                                                                '.Selection.TypeText(CStr(Format(numSD, "0.00000")))

                                                                If boolLUseSigFigsAreaRatio Then
                                                                    numSD = SigFigAreaRatio(RoundToDecimalA(var1, LSigFigAreaRatio), LSigFigAreaRatio, True, False)
                                                                    .Selection.TypeText(DisplayNum(numSD, LSigFigAreaRatio, False))
                                                                Else
                                                                    numSD = RoundToDecimalRAFZ(var1, LSigFigAreaRatio)
                                                                    .Selection.TypeText(Format(numSD, GetRegrDecStr(LSigFigAreaRatio)))
                                                                End If
                                                                var2 = DisplayCommas(numSD)
                                                                .Selection.TypeText(var2)

                                                            End If

                                                        Else
                                                            If boolLUseSigFigs Then
                                                                numSD = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                                                .Selection.TypeText(DisplaySigFig(numSD, LSigFig))
                                                            Else
                                                                numSD = RoundToDecimalRAFZ(var1, LSigFig)
                                                                .Selection.TypeText(Format(numSD, GetRegrDecStr(LSigFig)))
                                                            End If

                                                        End If

                                                    End If

                                                Catch ex As Exception

                                                End Try
                                            End If

                                            If boolSTATSCV Then
                                                Try
                                                    'enter %CV
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                                    If nI < gSDMax Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        numPrec = CalcCVPercent(numSD, numMean, intQCDec)
                                                        .Selection.TypeText(Format(numPrec, strQCDec))
                                                    End If

                                                Catch ex As Exception

                                                End Try
                                            End If
                                            If boolSTATSBIAS And boolRCConc Then
                                                Try
                                                    'enter %Bias
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()

                                                    numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        .Selection.TypeText(Format(numBias, strQCDec))
                                                    End If

                                                Catch ex As Exception

                                                End Try
                                            End If

                                            If boolTHEORETICAL Then
                                                Try
                                                    'enter %theoretical
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()

                                                    numTheor = CalcREPercent(numMean, varNom, intQCDec)
                                                    numTheor = 100 + CDec(numTheor)
                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        .Selection.TypeText(Format(numTheor, strQCDec))
                                                    End If

                                                Catch ex As Exception

                                                End Try

                                            End If

                                            If boolSTATSDIFF And boolRCConc And boolSTATSMEAN Then
                                                Try
                                                    'enter %Bias
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                                    numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        .Selection.TypeText(Format(numBias, strQCDec))
                                                    End If

                                                Catch ex As Exception

                                                End Try
                                            End If

                                            If BOOLSTATSRE And boolRCConc Then
                                                Try
                                                    'enter %RE
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                                    numBias = CalcREPercent(numMean, varNom, intQCDec)
                                                    If nI = 0 Then
                                                        .Selection.TypeText("NA")
                                                    Else
                                                        .Selection.TypeText(Format(numBias, strQCDec))
                                                    End If

                                                Catch ex As Exception

                                                End Try
                                            End If

                                            If boolSTATSN Then
                                                Try
                                                    'enter n
                                                    int8 = int8 + 1
                                                    .Selection.Tables.Item(1).Cell(int1 + intRowsX + int8, Count3 + 2).Select()
                                                    .Selection.TypeText(CStr(nI))

                                                Catch ex As Exception

                                                End Try
                                            End If

                                        End If 'Endif 2

                                    End If 'Endif 1

                                End If

                            Next Count3

                            'increase row position counter
                            If Count2 = intNumRuns - 1 Then
                                'int1 = int1 + intRowsX + 6
                                'inttblrows
                                '20180904 LEE:
                                If boolME Then 'there is only one run
                                    If intCSN = 0 Then
                                        int1 = int1 + intRowsX + int8
                                    Else
                                        int1 = int1 + intRowsX + int8
                                    End If
                                Else
                                    If intCSN = 0 Then
                                        int1 = int1 + intRowsX + int8 + 1
                                    Else
                                        int1 = int1 + intRowsX + int8 + 2
                                    End If
                                End If
                               

                            Else
                                'int1 = int1 + intRowsX + 7
                                If intCSN = 0 Then
                                    int1 = int1 + intRowsX + int8 + 1
                                Else
                                    int1 = int1 + intRowsX + int8 + 2
                                End If

                            End If

                            'Next Count10

                        Next Count2 'numRuns

                        '''wdd.visible = True
                        ''' 

                   

                        'bottom border this row
                        '20180805 LEE:
                        intLastRow = .Selection.Tables(1).Rows.Count
                        '20180904 LEE:
                        'Hmm. Sometimes there are more rows
                        If boolME Then
                            intLastRow = int1
                        End If

                        With .Selection.Tables(1).Rows(intLastRow).Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                            .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        End With

                        Dim intNRow As Short


                        'If boolDoME Then 'this is deprecated for the time being

                        '    str1 = "Matrix Effect (ME)"
                        '    .Selection.TypeText(str1)

                        '    Dim arrMEF(intNumLevels)
                        '    Dim intK As Short = 0

                        '    For Count2 = 0 To intNumLevels - 1
                        '        var1 = arrME(0, Count2)
                        '        var2 = arrME(1, Count2)
                        '        If IsDBNull(var1) Or IsDBNull(var2) Or var2 = 0 Then
                        '        Else
                        '            intK = intK + 1
                        '            var3 = var1 / var2
                        '            var4 = Format(var3, strQCDec)
                        '            arrMEF(intK) = var4
                        '            .Selection.Tables.Item(1).Cell(intNRow, Count2 + 2).Select()
                        '            .Selection.TypeText(Format(var3, strQCDec))
                        '        End If
                        '    Next

                        '    'now enter overall matrix effect
                        '    intNRow = intNRow + 2
                        '    str1 = "ME Mean"
                        '    .Selection.Tables.Item(1).Cell(intNRow, 1).Select()
                        '    .Selection.TypeText(str1)
                        '    str1 = "ME SD"
                        '    .Selection.Tables.Item(1).Cell(intNRow + 1, 1).Select()
                        '    .Selection.TypeText(str1)

                        '    'determine mean
                        '    var1 = 0
                        '    For Count2 = 1 To intK
                        '        var2 = arrMEF(Count2)
                        '        var1 = var1 + var2
                        '    Next
                        '    If intK > 0 Then
                        '        var2 = var1 / intK
                        '    Else
                        '        var2 = "NA"
                        '    End If
                        '    .Selection.Tables.Item(1).Cell(intNRow, 2).Select()
                        '    Try
                        '        .Selection.TypeText(Format(var2, strQCDec))
                        '    Catch ex As Exception
                        '        .Selection.TypeText("NA")
                        '    End Try

                        '    'determine SD
                        '    If intK > 2 Then
                        '        var2 = intK
                        '        var1 = StdDev(var2, arrMEF)
                        '    Else
                        '        var1 = "NA"
                        '    End If
                        '    .Selection.Tables.Item(1).Cell(intNRow + 1, 2).Select()
                        '    .Selection.TypeText(var1)

                        '    'record n
                        '    .Selection.Tables.Item(1).Cell(intNRow + 2, 1).Select()
                        '    .Selection.TypeText("n")
                        '    .Selection.Tables.Item(1).Cell(intNRow + 2, 2).Select()
                        '    .Selection.TypeText(CStr(intK))

                        '    intLastRow = intNRow + 2

                        'End If


                        If boolME Then

                            If boolMFStats And intCSN > 0 Then

                                intNRow = intLastRow + 1

                                'first merge cells 1 and 2
                                For Count2 = 1 To intCSN
                                    rng = .ActiveDocument.Range(Start:=tbl.Cell(intNRow + Count2 - 1, 1).Range.Start, End:=tbl.Cell(intNRow + Count2 - 1, 2).Range.End)
                                    rng.Select()
                                    .Selection.Cells.Merge()
                                    'left align
                                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                                Next

                                If boolOutOverall Then
                                    'do the same for column 2
                                    For Count2 = 1 To intCSN
                                        rng = .ActiveDocument.Range(Start:=tbl.Cell(intNRow + Count2 - 1, 2).Range.Start, End:=tbl.Cell(intNRow + Count2 - 1, 3).Range.End)
                                        rng.Select()
                                        .Selection.Cells.Merge()
                                        'left align
                                        .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                                    Next
                                End If

                                tbl.Cell(intNRow, 1).Select()

                                strF = "BOOLALL = -1"
                                Dim rowsMeanMFAll() As DataRow = tblMeanMF.Select(strF)
                                strF = "BOOLALL = 0"
                                Dim rowsMeanMF() As DataRow = tblMeanMF.Select(strF)

                                Dim numMeanMFAll As Decimal
                                Dim numMeanMF As Decimal

                                Dim numMeanMFSDAll As Decimal
                                Dim numMeanMFSD As Decimal

                                'mean
                                If boolSTATSMEAN Then


                                    'str1 = "Overall Matrix Factor Mean"
                                    '20181108 LEE
                                    str1 = "Overall " & ReturnMForME() & " Mean"
                                    .Selection.TypeText(CStr(str1))
                                    tbl.Cell(intNRow, 2).Select()

                                    var1 = MeanDR(rowsMeanMFAll, "MF", False, "gaga", True, False)
                                    var2 = MeanDR(rowsMeanMF, "MF", False, "gaga", True, False)

                                    If boolLUseSigFigs Then
                                        numMeanMFAll = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                        numMeanMF = SigFigOrDecString(RoundToDecimalA(var2, LSigFig), LSigFig, False)
                                    Else
                                        numMeanMFAll = RoundToDecimalRAFZ(var1, LSigFig)
                                        numMeanMF = RoundToDecimalRAFZ(var2, LSigFig)
                                    End If

                                    var3 = CStr(DisplayNum(numMeanMFAll, LSigFig, False))
                                    var4 = CStr(DisplayNum(numMeanMF, LSigFig, False))

                                    'boolout

                                    If boolOutOverall Then
                                        var5 = var4 & " (" & var3 & ")"
                                    Else
                                        var5 = var4
                                    End If

                                    .Selection.TypeText(CStr(var5))

                                End If

                                'sd
                                If boolSTATSSD Then
                                    intNRow = intNRow + 1
                                    tbl.Cell(intNRow, 1).Select()
                                    str1 = "Overall " & ReturnMForME() & " S.D."
                                    .Selection.TypeText(CStr(str1))
                                    tbl.Cell(intNRow, 2).Select()

                                    var1 = StdDevDR(rowsMeanMFAll, "MF", False, "gaga", True, False)
                                    var2 = StdDevDR(rowsMeanMF, "MF", False, "gaga", True, False)

                                    If boolLUseSigFigs Then
                                        numMeanMFSDAll = SigFigOrDecString(RoundToDecimalA(var1, LSigFig), LSigFig, False)
                                        numMeanMFSD = SigFigOrDecString(RoundToDecimalA(var2, LSigFig), LSigFig, False)
                                    Else
                                        numMeanMFSDAll = RoundToDecimalRAFZ(var1, LSigFig)
                                        numMeanMFSD = RoundToDecimalRAFZ(var2, LSigFig)
                                    End If

                                    var3 = CStr(DisplayNum(numMeanMFSDAll, LSigFig, False))
                                    var4 = CStr(DisplayNum(numMeanMFSD, LSigFig, False))

                                    If boolOutOverall Then
                                        var5 = var4 & " (" & var3 & ")"
                                    Else
                                        var5 = var4
                                    End If

                                End If

                                .Selection.TypeText(CStr(var5))

                                'CV
                                If boolSTATSCV Then
                                    intNRow = intNRow + 1
                                    tbl.Cell(intNRow, 1).Select()
                                    'str1 = "Overall Matrix Factor " & ReturnPrecLabel()
                                    str1 = "Overall " & ReturnMForME() & " " & ReturnPrecLabel()
                                    .Selection.TypeText(CStr(str1))
                                    tbl.Cell(intNRow, 2).Select()

                                    var1 = numMeanMFSDAll / numMeanMFAll * 100
                                    var2 = numMeanMFSD / numMeanMF * 100

                                    var3 = Format(var1, strQCDec)
                                    var4 = Format(var2, strQCDec)

                                    If boolOutOverall Then
                                        var5 = var4 & " (" & var3 & ")"
                                    Else
                                        var5 = var4
                                    End If

                                    .Selection.TypeText(CStr(var5))

                                End If

                                'n
                                If boolSTATSN Then
                                    intNRow = intNRow + 1
                                    tbl.Cell(intNRow, 1).Select()
                                    str1 = "Overall " & ReturnMForME() & " n"
                                    .Selection.TypeText(CStr(str1))
                                    tbl.Cell(intNRow, 2).Select()

                                    var3 = rowsMeanMFAll.Length
                                    var4 = rowsMeanMF.Length

                                    var5 = var3 'will always have same n

                                    .Selection.TypeText(CStr(var5))

                                End If

                            End If
                        End If

                        With .Selection.Tables(1).Rows(.Selection.Tables(1).Rows.Count).Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                            .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                        End With

                        '.Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow)
                        '.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        ''.Selection.MoveRight Unit:=Microsoft.Office.Interop.Word.wdunits.word.wdunits.wdCharacter, Count:=ctQCs, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend
                        '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

                        'autofit table
                        Call AutoFitTable(wd, False)

                        'go back and merge line 1
                        .Selection.Tables.Item(1).Cell(1, 2).Select()
                        .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
                        '.Selection.Cells.Merge()
                        If intNumLevels < 2 Then
                        Else
                            Try
                                .Selection.Cells.Merge()
                            Catch ex As Exception

                            End Try
                            With .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                            End With
                        End If
                        .Selection.Font.Bold = False
                        If boolRCPA Or boolX Then
                            .Selection.TypeText(Text:="QC Low Peak Areas (Nominal Concentration " & SigFigOrDecString(varNom, LSigFig, False) & " " & strConcUnits & ")")
                        ElseIf boolRCPARatio Then
                            .Selection.TypeText(Text:="QC Low Peak Area Ratios (Nominal Concentration " & SigFigOrDecString(varNom, LSigFig, False) & " " & strConcUnits & ")")
                        Else
                            .Selection.TypeText(Text:="QC Low Nominal Concentrations (" & SigFigOrDecString(varNom, LSigFig, False) & " " & strConcUnits & ")")
                        End If
                       
                    Catch ex As Exception

                        str1 = "There was a problem preparing table:"
                        str1 = strM1 & ChrW(10) & ChrW(10) & str1
                        str1 = str1 & ChrW(10) & ChrW(10)
                        str1 = str1 & ex.Message
                        MsgBox(str1, vbInformation, "Problem...")

                    End Try


                    .Selection.Tables.Item(1).Cell(1, 1).Select()
                    'go to end of table
                    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdColumn)

                    ''''''wdd.visible = True

                    'remove unused rows
                    Call RemoveRows(wd, ctTbl)

                    'enter table number
                    str1 = "Summary of " & rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION") & " Unique Low QC for Matrix Effects on Quantitation Assessments"

                    strA = NZ(rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION"), strDo)

                    If boolX Then
                        strA = "Internal Standard " & strA
                    End If
                    strTName = UpdateAnalyteMatrix(strTName, strA, strMatrix, True, intGroup, boolX)
                    Call EnterTableNumber(wd, strTName, 3, strA, strTempInfo, intTableID, intGroup, idTR)
                    'Note: strTName is byRef and will return Table, number, caption, label
                    'enter a table record in tblTableN
                    'ctTableN = ctTableN + 1
                    Dim dtblr As DataRow = tblTableN.NewRow
                    dtblr.BeginEdit()
                    dtblr.Item("TableNumber") = ctTableN
                    dtblr.Item("AnalyteName") = strDo 'arrAnalytes(1, Count1)
                    dtblr.Item("TableName") = strTNameO
                    dtblr.Item("TableID") = intTableID
                    dtblr.Item("CHARFCID") = charFCID
                    dtblr.Item("TableNameNew") = strTName
                    tblTableN.Rows.Add(dtblr)

                    'split table, if needed


                    If boolME Then

                        ctLegend = ctLegend + 1
                        intLeg = intLeg + 1
                        arrLegend(1, intLeg) = ReturnMForMEAbbr()
                        arrLegend(2, intLeg) = ReturnMForME() & ": (Peak Area Lot)/(Mean Peak Area Solvent)"
                        arrLegend(3, intLeg) = False

                        If BOOLINCLMFCOLS Then 'use average MF values
                            ctLegend = ctLegend + 1
                            intLeg = intLeg + 1
                            arrLegend(1, intLeg) = "Mean " & ReturnMForMEAbbr()
                            'arrLegend(2, intLeg) = "Mean " & ReturnMForME() & ":  Mean of " & ReturnMForMEAbbr() & " column"
                            arrLegend(2, intLeg) = "Mean of " & ReturnMForMEAbbr() & " column"
                            arrLegend(3, intLeg) = False
                        Else 'use average peak area
                            ctLegend = ctLegend + 1
                            intLeg = intLeg + 1
                            arrLegend(1, intLeg) = ReturnMForMEAbbr() & " Mean"
                            'arrLegend(2, intLeg) = ReturnMForME() & " Mean:  (Mean Peak Area Lot)/(Mean Peak Area Solvent)"
                            arrLegend(2, intLeg) = "(Mean Peak Area Lot)/(Mean Peak Area Solvent)"
                            arrLegend(3, intLeg) = False
                        End If

                        '20181108 LEE: Depracate this
                        'Only used by CRL-WIL, and they have stopped using it
                        ctLegend = ctLegend + 1
                        'intLeg = intLeg + 1
                        'arrLegend(1, intLeg) = "Matrix Effect"
                        'arrLegend(2, intLeg) = "Matrix Effect:  (Mean Matrix Factor * 100)  100"
                        'arrLegend(3, intLeg) = False

                    End If

                    ctLegend = ctLegend + 1
                    intLeg = intLeg + 1
                    arrLegend(1, intLeg) = "NA"
                    arrLegend(2, intLeg) = "Not Applicable"
                    arrLegend(3, intLeg) = False

                    Call AutoFitTable(wd, BOOLINCLUDEDATE)


                    strM = "Finalizing " & strTName & "..."
                    strM1 = strM & ChrW(10) & "Table " & intTCur & " of " & intTTot & " tables..."

                    frmH.lblProgress.Text = strM1
                    frmH.Refresh()

                    str1 = frmH.lblProgress.Text

                    'make this
                    Call SplitTable(wd, 4, intLeg, arrLegend, str1, True, ctLegend + 2, False, False, False, intTableID)

                    'move to line below table
                    '.Selection.Tables.item(1).Select()
                    '.Selection.MoveDown(Microsoft.Office.Interop.Word.WdUnits.wdLine, 1)
                    Call MoveOneCellDown(wd)

                    Call InsertLegend(wd, intTableID, idTR, boolX, 1)

                    'Call MoveOneCellDown(wd) 'Don't Do!! called in InsertLegend

                End If

end1:
                If boolJustTable Then

                    'str1 = rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION")
                    'Call JustTable(wd, str1, strTName, strDo, strTName, intTableID, strTempInfo, "")

                    str1 = NZ(rows11(Count1 - 1).Item("ORIGINALANALYTEDESCRIPTION"), "")
                    'Call JustTable(wd, str1, str2, strDo, strTName, intTableID)
                    If Len(str1) = 0 Then
                    Else
                        Call JustTable(wd, str1, strTName, strDo, strTName, intTableID, strTempInfo, "", strTNameO, 1, idTR)
                    End If

                End If

next1:

            Next
end2:
        End With

    End Sub

    Sub AddReportTemplates()

        Dim boolDD As Boolean
        Dim dtbl1 As System.Data.DataTable
        Dim dtbl2 As System.Data.DataTable
        Dim dtbl3 As System.Data.DataTable
        Dim rows1() As DataRow
        Dim rows2() As DataRow
        Dim rows3() As DataRow
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim strS As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim Count6 As Short
        Dim Count7 As Short
        Dim intMaxID As Int64
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim dt As Date
        Dim intRows1 As Short
        Dim intRows2 As Short
        Dim intRows3 As Short
        Dim id1 As Int16
        Dim id2 As Int16
        Dim id3 As Int16
        Dim strRepTemplate As String
        Dim strA As String
        Dim strB As String
        Dim strC As String
        Dim strD As String
        Dim strE As String
        Dim idR As Int16
        Dim strFCID As String
        Dim strTab As String
        Dim boolSkip As Boolean
        Dim idCR As Int64
        Dim boolDo As Boolean
        Dim intPH As Short

        Dim var1, var2, var3, var4

        Dim boolNFC As Boolean = False 'needs tblFieldCodeEntry

        Dim strNomConc As String = "NOMCONC"

        dt = Now

        dtbl1 = tblFieldCodes

        BOOLTEMPLATEFIELDCODESLOADED = False  'NDL: If FC's are loaded, this will be set to True

        'add column to tblfieldcodes
        If dtbl1.Columns.Contains("ID_TBLREPORTTABLE") Then
        Else
            Dim col1 As New DataColumn
            str1 = "ID_TBLREPORTTABLE"
            str2 = str1
            col1.ColumnName = str1
            col1.Caption = str2
            col1.DataType = System.Type.GetType("System.Int16")
            col1.DefaultValue = -1
            col1.AllowDBNull = True
            dtbl1.Columns.Add(col1)

        End If


        'find intMaxID
        strF1 = "ID_TBLFIELDCODES > -1"
        strS = "ID_TBLFIELDCODES ASC"
        rows1 = dtbl1.Select(strF2, strS)
        intMaxID = rows1(rows1.Length - 1).Item("ID_TBLFIELDCODES")

        dtbl3 = tblReportTable

        'add new stand-alone field codes
        For Count4 = 1 To 16 '13

            boolSkip = False

            Select Case Count4
                Case 1
                    strA = "[STUDYSTARTDATE]"
                    strB = "Study Items"
                    strC = "Field code for the starting date of the study"
                    strTab = "Report Table Configuration"
                    strD = "Data table"
                Case 2
                    strA = "[STUDYENDDATE]"
                    strB = "Study Items"
                    strC = "Field code for the ending date of the study"
                    strTab = "Report Table Configuration"
                    strD = "Data table"
                Case 3
                    strA = "[#Cycles]"
                    strB = "Study Items"
                    strC = "Field code used in the table heading for the number of Freeze/Thaw cycles performed in the Freeze/Thaw experiment"
                    strTab = "Report Table Configuration"
                    strD = "NA"
                Case 4
                    '20190302 LEE: deprecate. Replace with 14, 15, and 16 below
                    boolSkip = True
                    strA = "[Period Temp]"
                    strB = "Study Items"
                    strC = "Field code used in the table heading for the phrase that summarizes the Time Period and Temperature for the experiment stability conditions"
                    strTab = "Report Table Configuration"
                    strD = "NA"



                Case 5
                    strA = "[UC_SPECIES]"
                    strB = "Watson: Species"
                    strC = "First letter capitalized Species."
                    strTab = "Watson Analytical Reference Standard Table"

                Case 6
                    strA = "[LC_SPECIES]"
                    strB = "Watson: Species"
                    strC = "First letter UNcapitalized Species."
                    strTab = "Watson Analytical Reference Standard Table"

                Case 7
                    strA = "[UC_MATRIX]"
                    strB = "Watson: Matrix"
                    strC = "First letter capitalized Matrix."
                    strTab = "Watson Analytical Reference Standard Table"

                Case 8
                    strA = "[LC_MATRIX]"
                    strB = "Watson: Matrix"
                    strC = "First letter UNcapitalized Matrix."
                    strTab = "Watson Analytical Reference Standard Table"

                Case 9
                    strA = "[UC_ANTICOAGULANT]"
                    strB = "Study-specific variables"
                    strC = "First letter capitalized Anticoagulant."
                    strTab = "Data Tab"

                Case 10
                    strA = "[LC_ANTICOAGULANT]"
                    strB = "Study-specific variables"
                    strC = "First letter UNcapitalized Anticoagulant."
                    strTab = "Data Tab"

                Case 11
                    strA = "[SAMPLERECEIPTDATES_01]"
                    strB = "Study-specific variables"
                    strC = "Stacked list of sample receipt dates"
                    strTab = "Sample Receipt Tab"


                Case 12
                    strA = "[SPONSORSTUDYTITLE]"
                    strB = "Study-specific variables"
                    strC = "First letter capitalized Anticoagulant."
                    strTab = "Data Tab"

                Case 13

                    '20180816 LEE:
                    'Add field code for MethodSummaryTable
                    strA = "[METHODSUMMARYTABLE]"
                    strB = "Study-specific variables"
                    strC = "Generate Method Validation Summary Table for Sample Analysis report."
                    strTab = "Data Tab"


                    '20190220 LEE: Add some more stability parameters for table title
                Case 14
                    strA = "[Period]"
                    strB = "Study Items"
                    strC = "Field code used in the table heading that returns the Time Period (e.g. 4) for the experiment stability conditions"
                    strTab = "Report Table Configuration"
                    strD = "NA"
                Case 15
                    strA = "[Period Units]"
                    strB = "Study Items"
                    strC = "Field code used in the table heading that returns the Time Period Units (e.g. Days) for the experiment stability conditions"
                    strTab = "Report Table Configuration"
                    strD = "NA"
                Case 16
                    strA = "[Temp]"
                    strB = "Study Items"
                    strC = "Field code used in the table heading that returns the Temperature (e.g. -20degC) for the experiment stability conditions"
                    strTab = "Report Table Configuration"
                    strD = "NA"

            End Select

            'see if str3 already exists with id_tblReportTable

            strF3 = "CHARFIELDCODE = '" & strA & "'"

            boolNFC = boolNeedsFC(strA, strC, idR, dtbl1)
            If boolNFC And boolSkip = False Then
                'Erase rows3
                'rows3 = dtbl1.Select(strF3)
                'int2 = rows3.Length
                'If int2 > 0 Then
                'Else

                'End If
                Dim newRow As DataRow = dtbl1.NewRow
                newRow.BeginEdit()
                intMaxID = intMaxID + 1
                newRow("ID_TBLFIELDCODES") = intMaxID
                newRow("CHARFIELDCODE") = strA
                newRow("CHARDESCRIPTION") = strC ' & " for Role " & str2
                newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                newRow("CHARTABLE") = strD 'rows1(Count1).Item("CHARTABLE")
                newRow("CHAREXAMPLE") = "NA" 'rows1(Count1).Item("CHAREXAMPLE")
                newRow("CHARGROUP") = strB ' & strRepTemplate
                newRow("ID_TBLREPORTTABLE") = idR
                newRow("UPSIZE_TS") = dt

                newRow("intAdded") = -1
                'newRow("intAddedStatic") = -1

                newRow.EndEdit()

                dtbl1.Rows.Add(newRow)

            End If

        Next Count4

        'prepare stuff for Anova table
        'strF2 = "BOOLINCLUDE = -1 AND ID_TBLCONFIGREPORTTABLES = 19 AND ID_TBLSTUDIES = " & id_tblStudies
        'make this shorter by filtering for boolplaceholder
        strF2 = "BOOLINCLUDE = -1 AND ID_TBLCONFIGREPORTTABLES = 19 AND ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLPLACEHOLDER = 0"
        strS = "ID_TBLCONFIGREPORTTABLES ASC"
        Dim dv3 As System.Data.DataView = New DataView(dtbl3, strF2, strS, DataViewRowState.CurrentRows)
        intRows3 = dv3.Count

        'str1 = dv2(Count1).Item("CHARTEMPLATENAME")
        'id2 = dv2(Count1).Item("ID_TBLSTUDIES")

        'JEEZJEEZ
        'strF3 = "ID_TBLSTUDIES = " & id2 & " AND BOOLINCLUDE = -1 AND ID_TBLSTUDIES = " & id_tblStudies
        'strF3 = "BOOLINCLUDE = -1 AND ID_TBLSTUDIES = " & id_tblStudies
        'make this shorter by filtering for boolplaceholder
        '20160926 LEE: For this group, must include placeholers
        'strF3 = "BOOLINCLUDE = -1 AND ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLPLACEHOLDER = 0"
        strF3 = "BOOLINCLUDE = -1 AND ID_TBLSTUDIES = " & id_tblStudies
        strS = "INTORDER ASC"
        Dim dv3a As System.Data.DataView = New DataView(dtbl3, strF3, strS, DataViewRowState.CurrentRows)
        intRows3 = dv3a.Count

        strRepTemplate = str1


        For Count4 = 1 To 7

            boolDo = True

            Select Case Count4

                Case 1
                    strA = "TableREFTable_"
                    strB = "Tables for Table - "
                    strB = "Table-specific variables"
                    strC = "Field code for inserting a reference to table: "
                    strTab = "Report Table Configuration"
                Case 2
                    strA = "RunIDTable_"
                    strB = "Run IDs of runs for Table - "
                    strB = "Table-specific variables"
                    strC = "List of Run IDs for runs in table: "
                    strTab = "Report Table Configuration"
                Case 3
                    strA = "FirstAnalysisDateTable_"
                    strB = "First Analysis Date of runs for Table - "
                    strB = "Table-specific variables"
                    strC = "First Analysis Date of runs in table: "
                    strTab = "Report Table Configuration"
                Case 4
                    strA = "LastAnalysisDateTable_"
                    strB = "Last Analysis Date of runs for Table - "
                    strB = "Table-specific variables"
                    strC = "Last Analysis Date of runs in table: "
                    strTab = "Report Table Configuration"
                Case 5
                    strA = "TableINSERTTable_"
                    strB = "Tables for Table - "
                    strB = "Table-specific variables"
                    strC = "Field code for table: "
                    strTab = "Report Table Configuration"
                    strTab = "Report Table Configuration"
                Case 6 'don't do 6 'YES DO 6
                    strA = "AnalyteREFTable_"
                    strB = "Analyte(s) associated with runs for Table - "
                    strB = "Table-specific variables"
                    strC = "Analyte(s) associated with table: "
                    strTab = "Report Table Configuration"


                Case 7
                    strA = "IS_TableREFTable_"
                    strB = "Int Std Tables for Table - "
                    strB = "Table-specific variables"
                    strC = "Int Std Field code for inserting a reference to table: "
                    strTab = "Report Table Configuration"

                    'Case 8
                    '    strA = "IS_TableINSERTTable_"
                    '    strB = "Int Std Tables for Table - "
                    '    strB = "Table-specific variables"
                    '    strC = "Int Std Field code for table: "
                    '    strTab = "Report Table Configuration"
                    '    strTab = "Report Table Configuration"

            End Select

            Dim intInclude As Short

            If boolDo Then

                For Count2 = 0 To intRows3 - 1

                    idR = dv3a(Count2).Item("ID_TBLREPORTTABLE")
                    idCR = dv3a(Count2).Item("ID_TBLCONFIGREPORTTABLES")
                    intPH = NZ(dv3a(Count2).Item("BOOLPLACEHOLDER"), 0)
                    intInclude = NZ(dv3a(Count2).Item("BOOLINCLUDE"), 0)

                    Select Case Count4
                        Case 2, 3, 4 'RunID,FirstAnalysisDate,LastAnalysisDate

                            Select Case idCR
                                Case 6, 7, 30 'ignore
                                    GoTo nextCount2
                            End Select
                    End Select

                    strFCID = NZ(dv3a(Count2).Item("CHARFCID"), "LABIntegrityAAA")

                    str1 = Mid(strFCID, 1, 2)
                    If StrComp(str1, "PH", CompareMethod.Text) = 0 And Count4 <> 1 Then
                        strFCID = "LABIntegrityAAA"
                    End If

                    'No. In this set, want one field code for PH tables
                    'If intPH <> 0 Then
                    '    GoTo NExtcount2
                    'End If

                    If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                        GoTo NExtcount2
                    End If

                    'The following is for Intervet
                    Dim strInt As String
                    Dim intU As Short
                    intU = InStr(1, strFCID, "_", CompareMethod.Text)
                    If intU < 1 Then
                    Else
                        strInt = Mid(strFCID, 1, intU)
                        If StrComp(strInt, "SSS_", CompareMethod.Text) = 0 Then
                            GoTo nextCount2
                        ElseIf StrComp(strInt, "CFQC_", CompareMethod.Text) = 0 Then
                            GoTo nextCount2
                        ElseIf StrComp(strInt, "IBS_", CompareMethod.Text) = 0 Then
                            GoTo nextCount2
                        ElseIf StrComp(strInt, "CFQCNC_", CompareMethod.Text) = 0 Then
                            GoTo nextCount2
                        ElseIf StrComp(strInt, "CT_", CompareMethod.Text) = 0 Then
                            GoTo nextCount2
                        ElseIf StrComp(strInt, "MTIBS_", CompareMethod.Text) = 0 Then
                            GoTo nextCount2
                        End If
                    End If
                    'end Intervet

                    Select Case Count4
                        Case 7, 8
                            Select Case idCR
                                Case 13, 14, 15, 22, 31, 32
                                    If intPH <> 0 Then
                                        GoTo nextCount2
                                    End If
                                Case Else
                                    GoTo nextCount2
                            End Select
                    End Select

                    'debugging
                    If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                    Else


                        str1 = dv3a(Count2).Item("CHARHEADINGTEXT")
                        str2 = Replace(str1, " ", "_", 1, -1, CompareMethod.Text)
                        'str3 = "[" & strA & str2 & "]"
                        str3 = "[" & strA & strFCID & "]"
                        str4 = strC & str1

                        'see if str3 already exists
                        strF3 = "CHARFIELDCODE = '" & str3 & "'"

                        boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                        If boolNFC Then
                            'Erase rows3
                            'rows3 = dtbl1.Select(strF3)
                            'int2 = rows3.Length
                            'If int2 > 0 Then
                            'Else

                            'End If

                            Dim newRow As DataRow = dtbl1.NewRow
                            newRow.BeginEdit()
                            intMaxID = intMaxID + 1
                            newRow("ID_TBLFIELDCODES") = intMaxID
                            newRow("CHARFIELDCODE") = str3
                            newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                            newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                            newRow("CHARTABLE") = "NA" '
                            newRow("CHAREXAMPLE") = "NA" '
                            newRow("CHARGROUP") = strB ' & strRepTemplate
                            newRow("ID_TBLREPORTTABLE") = idR
                            newRow("UPSIZE_TS") = dt

                            newRow("intAdded") = -1

                            newRow.EndEdit()

                            dtbl1.Rows.Add(newRow)
                            BOOLTEMPLATEFIELDCODESLOADED = True   'NDL IF we reach here, we will load the template-specific Field Codes

                        End If

                    End If
nextCount2:

                Next Count2
            End If
        Next

        'add PrecAcc stuff for Anova table
        'first add nomConc
        Dim strF As String
        Dim strS1 As String
        Dim strS2 As String
        Dim strS3 As String
        Dim rows11() As DataRow
        Dim intRowsAnal As Short
        Dim strH As String
        Dim strAnalyte As String
        Dim tbl2 As System.Data.DataTable
        Dim tbl4 As System.Data.DataTable

        Dim tblNumRuns As System.Data.DataTable
        Dim intNumRuns As Int16
        Dim tblLevels As System.Data.DataTable
        Dim intNumLevels As Short
        Dim idT As Int64
        Dim boolDoIS As Boolean
        Dim boolIsIS As Boolean

        Dim intG As Short

        tbl4 = tblAnalytesHome
        tbl2 = tblAssignedSamples
        strF = "IsIntStd = 'No'" ' or IsIntStd = 'Yes'"
        Try
            rows11 = tbl4.Select(strF)
        Catch ex As Exception
            GoTo end1
        End Try
        intRowsAnal = rows11.Length

        'jeer
        strF3 = "ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLINCLUDE = -1 AND ID_TBLCONFIGREPORTTABLES = 11"
        'make this shorter by filtering for boolplaceholder
        strF3 = "ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLINCLUDE = -1 AND ID_TBLCONFIGREPORTTABLES = 11 AND BOOLPLACEHOLDER = 0"
        strS = "INTORDER ASC"
        Dim dv310 As System.Data.DataView = New DataView(dtbl3, strF3, strS, DataViewRowState.CurrentRows)
        'legend: dtbl3 = tblReportTable
        intRows3 = dv310.Count

        Dim boolHit As Boolean

        For Count4 = 0 To intRows3 - 1

            idR = dv310(Count4).Item("ID_TBLREPORTTABLE")
            strFCID = NZ(dv310(Count4).Item("CHARFCID"), "LABIntegrityAAA")
            intPH = NZ(dv310(Count4).Item("BOOLPLACEHOLDER"), 0)
            If intPH <> 0 Then
                strFCID = "LABIntegrityAAA"
            End If
            str1 = Mid(strFCID, 1, 2)
            If StrComp(str1, "PH", CompareMethod.Text) = 0 Then
                strFCID = "LABIntegrityAAA"
            End If
            If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                GoTo nextCount4
            End If

            'The following is for Intervet
            Dim strInt As String
            Dim intU As Short
            intU = InStr(1, strFCID, "_", CompareMethod.Text)
            If intU < 1 Then
            Else
                strInt = Mid(strFCID, 1, intU)
                If StrComp(strInt, "SSS_", CompareMethod.Text) = 0 Then
                    GoTo nextCount4
                ElseIf StrComp(strInt, "CFQC_", CompareMethod.Text) = 0 Then
                    GoTo nextCount4
                ElseIf StrComp(strInt, "IBS_", CompareMethod.Text) = 0 Then
                    GoTo nextCount4
                ElseIf StrComp(strInt, "CFQCNC_", CompareMethod.Text) = 0 Then
                    GoTo nextCount4
                ElseIf StrComp(strInt, "CT_", CompareMethod.Text) = 0 Then
                    GoTo nextCount4
                ElseIf StrComp(strInt, "MTIBS_", CompareMethod.Text) = 0 Then
                    GoTo nextCount4
                End If
            End If
            'end Intervet

            For Count1 = 0 To intRowsAnal - 1


                str1 = rows11(Count1).Item("IsIntStd")
                If StrComp(str1, "Yes", CompareMethod.Text) = 0 Then
                    boolIsIS = True
                Else
                    boolIsIS = False
                End If

                'get first analyte
                '****
                'setup tables
                var1 = rows11(Count1).Item("AnalyteIndex")
                var2 = rows11(Count1).Item("MasterAssayID")
                var3 = rows11(Count1).Item("AnalyteDescription")
                strAnalyte = var3
                var4 = rows11(Count1).Item("INTGROUP")
                intG = var4

                'check to see if analyte is used
                If boolIsIS Then
                    'check to see if related analyte is used
                    boolHit = DoIntStd(intRowsAnal, rows11, strAnalyte)
                    If boolHit Then
                    Else
                        GoTo nextCount1a
                    End If
                Else
                    If UseAnalyte(strAnalyte) Then
                    Else
                        GoTo nextCount1a
                    End If
                End If


                strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                strF2 = strF2 & "ID_TBLREPORTTABLE = " & idR & " AND "
                strF2 = strF2 & "INTGROUP = " & intG


                strS = "RUNID ASC, RUNSAMPLESEQUENCENUMBER ASC"
                rows2 = tbl2.Select(strF2, strS)
                int1 = rows2.Length 'debug
                Dim dv2 As System.Data.DataView = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                int1 = dv2.Count 'debug

                'find number of runs used
                tblNumRuns = dv2.ToTable("a", True, "RUNID")
                intNumRuns = tblNumRuns.Rows.Count

                'establish table of level numbers
                'tblLevels = dv2.ToTable("b", True, "NOMCONC", "CHARHELPER1")
                tblLevels = dv2.ToTable("b", True, "NOMCONC")
                intNumLevels = tblLevels.Rows.Count

                '

                'make intra-report stuff for each run in the table
                For Count3 = 1 To 10 '8 ' 12

                    Select Case Count3
                        Case 1
                            'do PrecisionMin
                            strA = "IntraRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "Minimum Intra-Run Precision for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for Minimum Intra-Run Precision (for all Nom. Concs.) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"
                        Case 2
                            'do PrecisionMax
                            strA = "IntraRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "Maximum Intra-Run Precision for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for Maximum Intra-Run Precision (for all Nom. Concs.) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"
                        Case 3
                            'do PrecisionMin exclude LLOQ
                            strA = "IntraRunPrecisionMinExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "Minimum Intra-Run Precision for QC Tables (excluding LLOQ)" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for Minimum Intra-Run Precision (for all Nom. Concs., excluding LLOQ) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"
                        Case 4
                            'do PrecisionMax exclude LLOQ
                            strA = "IntraRunPrecisionMaxExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "Maximum Intra-Run Precision for QC Tables (excluding LLOQ)" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for Maximum Intra-Run Precision (for all Nom. Concs., excluding LLOQ) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"


                        Case 5
                            'do AccuracyMin
                            strA = "IntraRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "Minimum Intra-Run Accuracy for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for Minimum Intra-Run Accuracy (for all Nom. Concs.) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"
                        Case 6
                            'do AccuracyMax
                            strA = "IntraRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "Maximum Intra-Run Accuracy for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for Maximum Intra-Run Accuracy (for all Nom. Concs.) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"
                        Case 7
                            'do AccuracyMin exclude LLOQ
                            strA = "IntraRunAccuracyMinExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "Minimum Intra-Run Accuracy for QC Tables (excluding LLOQ)" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for Minimum Intra-Run Accuracy (for all Nom. Concs., excluding LLOQ) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"
                        Case 8
                            'do AccuracyMax exclude LLOQ
                            strA = "IntraRunAccuracyMaxExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "Maximum Intra-Run Accuracy for QC Tables (excluding LLOQ)" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for Maximum Intra-Run Accuracy (for all Nom. Concs., excluding LLOQ) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"

                        Case 9
                            'SummaryIntraRun[n]ForAnalyte
                            strA = "SummaryIntraRun[n]ForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "(n) number of accepted samples for Intra- and Inter-run QC table Intra-Run Summary Section" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for number of accepted samples in Intra- and Inter-run QC table Intra-Run Summary Section for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"

                        Case 10
                            'SummaryInterRun[n]ForAnalyte
                            strA = "SummaryInterRun[n]ForAnalyte_" & Count1 + 1 & "_Table_"
                            strB = "(n) number of accepted samples for Intra- and Inter-run QC table Inter-Run Summary Section" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            strB = "Table-specific variables"
                            strC = "Field code for number of accepted samples for Intra- and Inter-run QC table Inter-Run Summary Section for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            strTab = "Report Table Configuration"

                            'don't need to do 9 - 12

                            'Case 9
                            '    'do AccuracyMin
                            '    strA = "InterRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                            '    strB = "Minimum Inter-Run Accuracy for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            '    strB = "Table-specific variables"
                            '    strC = "Field code for Minimum Inter-Run Accuracy (for all Nom. Concs.) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            '    strTab = "Report Table Configuration"
                            'Case 10
                            '    'do AccuracyMax
                            '    strA = "InterRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                            '    strB = "Maximum Inter-Run Accuracy for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            '    strB = "Table-specific variables"
                            '    strC = "Field code for Maximum Inter-Run Accuracy (for all Nom. Concs.) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            '    strTab = "Report Table Configuration"
                            'Case 11
                            '    'do AccuracyMin exclude LLOQ
                            '    strA = "InterRunAccuracyMinExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                            '    strB = "Minimum Inter-Run Accuracy for QC Tables (excluding LLOQ)" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            '    strB = "Table-specific variables"
                            '    strC = "Field code for Minimum Inter-Run Accuracy (for all Nom. Concs., excluding LLOQ) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            '    strTab = "Report Table Configuration"
                            'Case 12
                            '    'do AccuracyMax exclude LLOQ
                            '    strA = "InterRunAccuracyMaxExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                            '    strB = "Maximum Inter-Run Accuracy for QC Tables (excluding LLOQ)" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                            '    strB = "Table-specific variables"
                            '    strC = "Field code for Maximum Inter-Run Accuracy (for all Nom. Concs., excluding LLOQ) for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                            '    strTab = "Report Table Configuration"



                    End Select

                    str3 = "[" & strA & strFCID & "]"
                    str4 = strC & strH

                    boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                    If boolNFC Then

                        'strF3 = "CHARFIELDCODE = '" & str3 & "'"
                        'Erase rows3
                        'rows3 = dtbl1.Select(strF3)
                        'int2 = rows3.Length
                        'If int2 > 0 Then
                        'Else

                        'End If

                        Dim newRow As DataRow = dtbl1.NewRow
                        newRow.BeginEdit()

                        intMaxID = intMaxID + 1
                        newRow("ID_TBLFIELDCODES") = intMaxID
                        newRow("CHARFIELDCODE") = str3
                        newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                        newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                        newRow("CHARTABLE") = "NA" '
                        newRow("CHAREXAMPLE") = "NA" '
                        newRow("CHARGROUP") = strB
                        newRow("ID_TBLREPORTTABLE") = idR
                        newRow("UPSIZE_TS") = dt

                        newRow("intAdded") = -1

                        newRow.EndEdit()

                        dtbl1.Rows.Add(newRow)

                    End If

                    var1 = var1

                Next Count3

                'make intra-report stuff for each run in the table
                For Count2 = 0 To intNumLevels - 1

                    strAnalyte = var3 'rows20(Count2).Item("CHARANALYTE")
                    Dim rowsAAA() As DataRow
                    strF2 = "ID_TBLREPORTTABLE = " & idR
                    rowsAAA = tblReportTable.Select(strF2)
                    'strFCID = NZ(rowsAAA(0).Item("CHARFCID"), "LABIntegrityAAA")
                    'debugging
                    If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                    Else

                        strH = rowsAAA(0).Item("CHARHEADINGTEXT")

                        For Count5 = 0 To intNumRuns - 1

                            For Count3 = 1 To 2

                                Select Case Count3
                                    Case 1
                                        'do Precision
                                        strA = "IntraRunPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                        strB = "Intra-Run Precision for individual runs for Method Validation Intra/Inter QC Table" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                        strB = "Table-specific variables"
                                        strC = "Field code for Intra-Run Precision (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for individual runs (" & Count5 + 1 & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for Method Validation Intra/Inter QC Table: "
                                        strTab = "Report Table Configuration"
                                    Case 2
                                        'do Accuracy
                                        strA = "IntraRunAccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                        strB = "Intra-Run Accuracy for individual runs for Method Validation Intra/Inter QC Table" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                        strB = "Table-specific variables"
                                        strC = "Field code for Intra-Run Accuracy (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for individual runs (" & Count5 + 1 & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for Method Validation Intra/Inter QC Table: "
                                        strTab = "Report Table Configuration"

                                End Select

                                str3 = "[" & strA & strFCID & "]"
                                str4 = strC & strH

                                'see if str3 already exists
                                boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                                If boolNFC Then

                                    'strF3 = "CHARFIELDCODE = '" & str3 & "'"
                                    'Erase rows3
                                    'rows3 = dtbl1.Select(strF3)
                                    'int2 = rows3.Length
                                    'If int2 > 0 Then
                                    'Else

                                    'End If

                                    Dim newRow As DataRow = dtbl1.NewRow
                                    newRow.BeginEdit()

                                    intMaxID = intMaxID + 1
                                    newRow("ID_TBLFIELDCODES") = intMaxID
                                    newRow("CHARFIELDCODE") = str3
                                    newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                                    newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                                    newRow("CHARTABLE") = "NA" '
                                    newRow("CHAREXAMPLE") = "NA" '
                                    newRow("CHARGROUP") = strB
                                    newRow("ID_TBLREPORTTABLE") = idR
                                    newRow("UPSIZE_TS") = dt

                                    newRow("intAdded") = -1

                                    newRow.EndEdit()

                                    dtbl1.Rows.Add(newRow)

                                End If

                            Next Count3

                        Next Count5

                    End If

                Next Count2

  
                '****
                For Count2 = 0 To intNumLevels - 1

                    'debug
                    Select Case idR
                        Case 3879, 3880, 3881
                            var1 = var1
                    End Select

                    strAnalyte = var3 'rows20(Count2).Item("CHARANALYTE")
                    Dim rowsAAA() As DataRow
                    strF2 = "ID_TBLREPORTTABLE = " & idR
                    rowsAAA = tblReportTable.Select(strF2)
                    'strFCID = NZ(rowsAAA(0).Item("CHARFCID"), "LABIntegrityAAA")
                    'debugging
                    If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                    Else


                        strH = rowsAAA(0).Item("CHARHEADINGTEXT")

                        boolDo = True

                        For Count3 = 2 To 16
                            Select Case Count3
                                Case 1
                                    'do nomconc
                                    'do this one later
                                    strA = "NomConcForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Nominal Concentration for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Nominal Concentration (" & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                Case 2
                                    'do Precision
                                    strA = "InterRunPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Inter-Run Precision for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Inter-Run Precision (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                Case 3
                                    'do Accuracy
                                    strA = "InterRunAccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Inter-Run Accuracy for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Inter-Run Accuracy (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                Case 4
                                    'do PrecisionMin
                                    strA = "IntraRunPrecisionMinForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Minimum Intra-Run Precision for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Minimum Intra-Run Precision (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                Case 5
                                    'do PrecisionMax
                                    strA = "IntraRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Maximum Intra-Run Precision for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Maximum Intra-Run Precision (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                Case 6
                                    'do AccuracyMin
                                    strA = "IntraRunAccuracyMinForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Minimum Intra-Run Accuracy for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Minimum Intra-Run Accuracy (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                Case 7
                                    'do AccuracyMax
                                    strA = "IntraRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Maximum Intra-Run Accuracy for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Maximum Intra-Run Accuracy (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"

                                Case 8
                                    'do InterRun[n]
                                    strA = "InterRun[n]ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Inter-Run [n] for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Inter-Run [n] (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                Case 9
                                    'do IntraRun[n]
                                    strA = "IntraRun[n]ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Maximum Intra-Run [n] for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Maximum Intra-Run [n] (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"

                                Case 10
                                    strA = "NumberofAcceptedCalibrCurvesTable_"
                                    strB = "Number of Accepted Calibration Curves for Report Template - "
                                    strB = "Table-specific variables"
                                    strC = "Number of Accepted Calibration Curves for table: "
                                    strTab = "Report Table Configuration"
                                Case 11
                                    strA = "AverageSlopeOfCalibrCurvesTable_"
                                    strB = "Average Slope of Calibration Curves for Report Template - "
                                    strB = "Table-specific variables"
                                    strC = "Average Slope of Calibration Curves for table: "
                                    strTab = "Report Table Configuration"
                                Case 12
                                    strA = "AverageInterceptOfCalibrCurvesTable_"
                                    strB = "Average Intercept of Calibration Curves for Report Template - "
                                    strB = "Table-specific variables"
                                    strC = "Average Intercept of Calibration Curves for table: "
                                    strTab = "Report Table Configuration"
                                Case 13
                                    strA = "AverageRSQOfCalibrCurvesTable_"
                                    strB = "Average RSQ of Calibration Curves for Report Template - "
                                    strB = "Table-specific variables"
                                    strC = "Average RSQ of Calibration Curves for table: "
                                    strTab = "Report Table Configuration"


                                Case 14
                                    'do Precision
                                    strA = "SummaryIntraRunPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "QC Level Intra-Run Precision Summary section for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Minimum Intra-Run Precision (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                Case 15
                                    'do Accuracy
                                    strA = "SummaryIntraRunAccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "QC Level Intra-Run Accuracy Summary section for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Minimum Intra-Run Accuracy (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                Case 16
                                    'do n
                                    strA = "SummaryIntraRun[n]ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "QC Level Intra-Run Number of runs [n] Summary section for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Minimum Intra-Run Number of runs [n] (for Nom. Conc.: " & tblLevels.Rows(Count2).Item("NomConc") & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                            End Select

                            str3 = "[" & strA & strFCID & "]"
                            str4 = strC & strH

                            boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                            If boolNFC Then

                                'strF3 = "CHARFIELDCODE = '" & str3 & "'"
                                'Erase rows3
                                'rows3 = dtbl1.Select(strF3)
                                'int2 = rows3.Length
                                'If int2 > 0 Then
                                'Else

                                'End If

                                Dim newRow As DataRow = dtbl1.NewRow
                                newRow.BeginEdit()

                                intMaxID = intMaxID + 1
                                newRow("ID_TBLFIELDCODES") = intMaxID
                                newRow("CHARFIELDCODE") = str3
                                newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                                newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                                newRow("CHARTABLE") = "NA" '
                                newRow("CHAREXAMPLE") = "NA" '
                                newRow("CHARGROUP") = strB
                                newRow("ID_TBLREPORTTABLE") = idR
                                newRow("UPSIZE_TS") = dt

                                newRow("intAdded") = -1

                                newRow.EndEdit()

                                dtbl1.Rows.Add(newRow)

                            End If

                        Next Count3
                    End If
                Next Count2


                '******

nextCount1a:

            Next Count1

nextCount4:

        Next Count4


        '*****

        For Count7 = 1 To 2

            boolDoIS = False

            Select Case Count7

                Case 1
                    idCR = 29
                Case 2
                    idCR = 32
            End Select

            strF3 = "ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLINCLUDE = -1 AND BOOLPLACEHOLDER = 0 AND ID_TBLCONFIGREPORTTABLES = " & idCR
            strS = "INTORDER ASC"
            Dim dv3b As System.Data.DataView = New DataView(dtbl3, strF3, strS, DataViewRowState.CurrentRows)
            Dim intRows31 = dv3b.Count

            For Count6 = 0 To intRows31 - 1

                strFCID = NZ(dv3b(Count6).Item("CHARFCID"), "LABIntegrityAAA")
                intPH = NZ(dv3b(Count6).Item("BOOLPLACEHOLDER"), 0)

                If intPH <> 0 Then
                    strFCID = "LABIntegrityAAA"
                End If

                str1 = Mid(strFCID, 1, 2)
                If StrComp(str1, "PH", CompareMethod.Text) = 0 Then
                    strFCID = "LABIntegrityAAA"
                End If
                If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                    GoTo nextCount6
                End If
                idR = dv3b(Count6).Item("ID_TBLREPORTTABLE")
                intPH = NZ(dv3b(Count6).Item("BOOLPLACEHOLDER"), 0)

                strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                strF2 = strF2 & "ID_TBLREPORTTABLE = " & idR & " AND "
                strF2 = strF2 & "INTGROUP = " & intG

                strS = "RUNID ASC, RUNSAMPLESEQUENCENUMBER ASC"
                rows2 = tbl2.Select(strF2, strS)
                int1 = rows2.Length 'debug
                Dim dv2a As System.Data.DataView = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                int1 = dv2a.Count 'debug

                'find number of runs used
                Dim tblNumRuns1 = dv2a.ToTable("a", True, "RUNID")
                Dim intNumRuns1 = tblNumRuns1.Rows.Count

                For Count5 = 0 To intNumRuns1 - 1

                    For Count3 = 1 To 2

                        Select Case Count3
                            Case 1
                                'do Accuracy Min
                                strA = "AccuracyMinIndForAnalyte_" & Count1 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                strB = "Accuracy Min for individual runs for individual analytical runs" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Table-specific variables"
                                strC = "Field code for Accuracy for individual runs (" & Count5 + 1 & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & "): "
                                strTab = "Report Table Configuration"
                            Case 2
                                'do Accuracy Max
                                strA = "AccuracyMaxIndForAnalyte_" & Count1 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                strB = "Accuracy Max for individual runs for individual analytical runs" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Table-specific variables"
                                strC = "Field code for Accuracy Min for individual runs (" & Count5 + 1 & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & "): "
                                strTab = "Report Table Configuration"

                        End Select

                        str3 = "[" & strA & strFCID & "]"
                        str4 = strC & strH

                        'see if str3 already exists
                        boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                        If boolNFC Then

                            'strF3 = "CHARFIELDCODE = '" & str3 & "'"
                            'Erase rows3
                            'rows3 = dtbl1.Select(strF3)
                            'int2 = rows3.Length
                            'If int2 > 0 Then
                            'Else

                            'End If

                            Dim newRow As DataRow = dtbl1.NewRow
                            newRow.BeginEdit()

                            intMaxID = intMaxID + 1
                            newRow("ID_TBLFIELDCODES") = intMaxID
                            newRow("CHARFIELDCODE") = str3
                            newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                            newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                            newRow("CHARTABLE") = "NA" '
                            newRow("CHAREXAMPLE") = "NA" '
                            newRow("CHARGROUP") = strB
                            newRow("ID_TBLREPORTTABLE") = idR
                            newRow("UPSIZE_TS") = dt

                            newRow("intAdded") = -1

                            newRow.EndEdit()

                            dtbl1.Rows.Add(newRow)

                        End If

                    Next Count3

                Next Count5

nextCount6:

            Next Count6

        Next Count7
      

        'now do individual prec and acc
        strF3 = "ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLINCLUDE = -1"
        'make this shorter by filtering for boolplaceholder
        strF3 = "ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLINCLUDE = -1 AND BOOLPLACEHOLDER = 0"

        strS = "INTORDER ASC"
        Dim dv4 As System.Data.DataView = New DataView(dtbl3, strF3, strS, DataViewRowState.CurrentRows)
        'legend: dtbl3 = tblReportTable
        intRows3 = dv4.Count

        strF = "IsIntStd = 'No' or IsIntStd = 'Yes'"
        Try
            rows11 = tbl4.Select(strF)
        Catch ex As Exception
            GoTo end1
        End Try
        intRowsAnal = rows11.Length

        For Count3 = 0 To intRows3 - 1

            idR = dv4(Count3).Item("ID_TBLREPORTTABLE")

            idCR = dv4(Count3).Item("ID_TBLCONFIGREPORTTABLES")

            strFCID = NZ(dv4(Count3).Item("CHARFCID"), "LABIntegrityAAA")
            If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                GoTo nextCount3
            End If

            'The following is for Intervet
            Dim strInt As String
            Dim intU As Short
            intU = InStr(1, strFCID, "_", CompareMethod.Text)
            If intU < 1 Then
            Else
                strInt = Mid(strFCID, 1, intU)
                If StrComp(strInt, "CFQC_", CompareMethod.Text) = 0 Then
                    GoTo nextCount3
                ElseIf StrComp(strInt, "IBS_", CompareMethod.Text) = 0 Then
                    GoTo nextCount3
                ElseIf StrComp(strInt, "CFQCNC_", CompareMethod.Text) = 0 Then
                    GoTo nextCount3
                ElseIf StrComp(strInt, "CT_", CompareMethod.Text) = 0 Then
                    GoTo nextCount3
                ElseIf StrComp(strInt, "MTIBS_", CompareMethod.Text) = 0 Then
                    GoTo nextCount3
                ElseIf StrComp(strInt, "SSS_", CompareMethod.Text) = 0 Then
                    GoTo nextCount3
                End If
            End If
            'end Intervet


            For Count1 = 0 To intRowsAnal - 1


                str1 = rows11(Count1).Item("IsIntStd")
                If StrComp(str1, "Yes", CompareMethod.Text) = 0 Then
                    boolIsIS = True
                Else
                    boolIsIS = False
                End If

                strAnalyte = rows11(Count1).Item("AnalyteDescription")

                If boolIsIS Then
                    'check to see if related analyte is used
                    boolHit = DoIntStd(intRowsAnal, rows11, strAnalyte)
                    If boolHit Then
                    Else
                        GoTo nextCount1b
                    End If
                Else
                    If UseAnalyte(strAnalyte) Then
                    Else
                        GoTo nextCount1b
                    End If
                End If

                'first do some stuff that is just for analytes


                If boolIsIS Or Count3 <> 0 Then 'do only once
                Else
                    For Count4 = 1 To 20
                        strE = "NA"
                        Select Case Count4
                            Case 1
                                strA = "LLOQForAnalyte_"
                                strB = "LLOQ value for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for LLOQ for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Data Tab"
                            Case 2
                                strA = "ULOQForAnalyte_"
                                strB = "ULOQ value for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for ULOQ for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Data Tab"
                            Case 3
                                strA = "CALIBRATIONLEVELSForAnalyte_"
                                strB = "Number of Calibration Levels for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Number of Calibration Levels for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Data Tab"
                            Case 4
                                strA = "CALIBRSTANDARDLISTForAnalyte_"
                                strB = "Calibration List for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Calibration List for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strE = "5, 10, 30, 75, 200, 750, 1250, and 2000 ng/mL"
                                strTab = "Data Tab"
                            Case 5
                                strA = "LLOQUnitsForAnalyte_"
                                strB = "LLOQ Units for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for LLOQ Units for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Data Tab"
                            Case 6
                                strA = "ULOQUnitsForAnalyte_"
                                strB = "ULOQ Units value for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for ULOQ Units for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Data Tab"
                            Case 7
                                strA = "MINIMUMR2ForAnalyte_"
                                strB = "Minimum R2 value for specific analyte calibration curve" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Minimum R2 value for calibration curve for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Report Table Configuration Tab"
                            Case 8
                                strA = "WEIGHTINGForAnalyte_"
                                strB = "Weighting value for specific analyte calibration curve" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Weighting value for calibration curve for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Report Table Configuration Tab"


                            Case 9
                                strA = "QCLEVELSForAnalyte_"
                                strB = "Number of QC Levels for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Number of QC Levels for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Data Tab"

                            Case 10
                                strA = "QCLEVELSVerboseForAnalyte_"
                                strB = "Number of QC Levels for specific analyte, number is spelled out lower case (e.g. 4 => 'four')" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Number of QC Levels (number is spelled out lower case (e.g. 4 => 'four')) for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Data Tab"


                            Case 11
                                strA = "CALIBRATIONLEVELSVerboseForAnalyte_"
                                strB = "Number of Calibration Levels for specific analyte, number is spelled out lower case (e.g. 4 => 'four')" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Number of Calibration Levels (number is spelled out lower case (e.g. 4 => 'four')) for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Data Tab"

                            Case 12
                                strA = "REGRESSIONForAnalyte_"
                                strB = "Regression type (lower case) for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Regression type (lower case) for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Watson Analytical Reference Standard Table"


                            Case 13
                                strA = "INTEGRATIONTYPEForAnalyte_"
                                strB = "Integration type (lower case) for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for integration type (lower case) for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Watson Analytical Reference Standard Table"

                            Case 14
                                strA = "REGRESSIONLSQForAnalyte_"
                                strB = "Regression type (lower case) for specific analyte. If regression is ""linear"", reports ""least-squares linear""." ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Regression type (lower case) for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Watson Analytical Reference Standard Table"



                            Case 15
                                strA = "UC_REGRESSIONForAnalyte_"
                                strB = "First letter capitalized Regression type for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Regression type for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Watson Analytical Reference Standard Table"

                            Case 16
                                strA = "LC_REGRESSIONForAnalyte_"
                                strB = "First letter UNcapitalized Regression type for specific analyte" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Regression type for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Watson Analytical Reference Standard Table"

                            Case 17
                                strA = "UC_REGRESSIONLSQForAnalyte_"
                                strB = "First letter capitalized Regression type for specific analyte. If regression is ""linear"", reports ""least-squares linear""." ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Regression type for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Watson Analytical Reference Standard Table"

                            Case 18
                                strA = "LC_REGRESSIONLSQForAnalyte_"
                                strB = "First letter UNcapitalized Regression type for specific analyte. If regression is ""linear"", reports ""least-squares linear""." ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Regression type for Analyte " & Count1 + 1 & " (" & strAnalyte & "):"
                                strTab = "Watson Analytical Reference Standard Table"


                                '20190220 LEE:
                            Case 19
                                strA = "CALIBRSTANDARDCOLUMNForAnalyte_"
                                strB = "Calibration List for specific analyte in columnar format" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for Calibration List for Analyte " & Count1 + 1 & " (" & strAnalyte & ") in columnar format:"
                                strE = "5, 10, 30, 75, 200, 750, 1250, 2000"
                                strTab = "Data Tab"

                            Case 20
                                strA = "QCSTANDARDCOLUMNForAnalyte_"
                                strB = "QC Level List for specific analyte in columnar format" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Study-specific variables"
                                strC = "Field code for QC Level List for Analyte " & Count1 + 1 & " (" & strAnalyte & ") in columnar format:"
                                strE = "10, 300, 1000, 2000, 5000"
                                strTab = "Data Tab"

                        End Select

                        str3 = "[" & strA & Count1 + 1 & "]"
                        str4 = strC

                        boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                        If boolNFC Then

                            Dim newRow As DataRow = dtbl1.NewRow
                            newRow.BeginEdit()

                            intMaxID = intMaxID + 1
                            newRow("ID_TBLFIELDCODES") = intMaxID
                            newRow("CHARFIELDCODE") = str3
                            newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                            newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                            newRow("CHARTABLE") = "NA" '
                            newRow("CHAREXAMPLE") = strE
                            newRow("CHARGROUP") = strB
                            newRow("ID_TBLREPORTTABLE") = idR
                            newRow("UPSIZE_TS") = dt

                            newRow("intAdded") = -1

                            newRow.EndEdit()

                            dtbl1.Rows.Add(newRow)

                        End If

                    Next

                End If

                'get first analyte
                '****

                'check to see if samples are assigned
                strF2 = "ID_TBLREPORTTABLE = " & idR
                Dim rowsIDR() As DataRow = tblReportTable.Select(strF2)
                var1 = rowsIDR(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")
                Dim boolAssigned As Boolean = True
                Select Case idCR
                    Case 3
                        If var1 = 0 Then
                            tbl2 = tblBCStdConcs
                            boolAssigned = False
                        Else
                            tbl2 = tblAssignedSamples

                        End If
                    Case 4
                        If var1 = 0 Then
                            tbl2 = tblBCQCConcs
                            boolAssigned = False
                        Else
                            tbl2 = tblAssignedSamples
                        End If

                    Case Else
                        tbl2 = tblAssignedSamples
                End Select


                If boolAssigned Then
                    If boolIsIS Then
                        var3 = rows11(Count1).Item("AnalyteDescription")
                        strF2 = "BOOLINTSTD = -1 AND "
                        strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        'strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        strF2 = strF2 & "ID_TBLREPORTTABLE = " & idR & " AND "
                        strF2 = strF2 & "CHARANALYTE = '" & CleanText(CStr(var3)) & "'"
                    Else
                        strF2 = "BOOLINTSTD = 0 AND "
                        var1 = rows11(Count1).Item("AnalyteIndex")

                        var3 = rows11(Count1).Item("AnalyteDescription")

                        If boolAssigned Then
                            var2 = rows11(Count1).Item("INTGROUP")
                        Else
                            var2 = rows11(Count1).Item("MasterAssayID")
                        End If

                        strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        'strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        strF2 = strF2 & "ID_TBLREPORTTABLE = " & idR & " AND "


                        If boolAssigned Then
                            strF2 = strF2 & "INTGROUP = " & var2 ' & " AND "
                        Else
                            strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                            strF2 = strF2 & "MASTERASSAYID = " & var2 ' & " AND "
                        End If

                        '
                    End If
                Else
                    If boolIsIS Then 'this will never happen for non-assigned samples
                        GoTo nextCount1b
                    Else

                        'evaluate only 3 and 4 for now
                        Select Case idCR
                            Case 3, 4
                            Case Else
                                GoTo nextCount1b
                        End Select

                        strF2 = "" ' "BOOLINTSTD = 0 AND "
                        var1 = rows11(Count1).Item("AnalyteIndex")

                        var3 = rows11(Count1).Item("AnalyteDescription")
                        var4 = rows11(Count1).Item("AnalyteID")

                        If boolAssigned Then
                            var2 = rows11(Count1).Item("INTGROUP")
                        Else
                            var2 = rows11(Count1).Item("MasterAssayID")
                        End If

                        'strF2 = strF2 & "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                        'strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                        'strF2 = strF2 & "ID_TBLREPORTTABLE = " & idR & " AND "
                        strF2 = strF2 & "ANALYTEID = " & var4 & " AND "

                        If boolAssigned Then
                            strF2 = strF2 & "INTGROUP = " & var2
                        Else
                            strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                            strF2 = strF2 & "MASTERASSAYID = " & var2 ' & " AND "
                        End If

                    End If
                End If

                strS = "RUNID ASC, RUNSAMPLESEQUENCENUMBER ASC"
                rows2 = tbl2.Select(strF2, strS)
                int1 = rows2.Length 'debug
                Dim dv2 As System.Data.DataView = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                int1 = dv2.Count 'debug

                'find number of runs used
                tblNumRuns = dv2.ToTable("a", True, "RUNID")
                intNumRuns = tblNumRuns.Rows.Count

                ''find number of runs used
                'tblNumRuns = dv2.ToTable("a", True, "RUNID")
                'intNumRuns = tblNumRuns.Rows.Count

                'establish table of level numbers
                'tblLevels = dv2.ToTable("b", True, "NOMCONC", "CHARHELPER1")
                If boolAssigned Then
                    tblLevels = dv2.ToTable("b", True, "NOMCONC")
                    intNumLevels = tblLevels.Rows.Count
                    strNomConc = "NOMCONC"
                Else
                    strNomConc = "CONCENTRATION"
                    strF2 = "(" & strF2 & ") AND CONCENTRATION > 0"
                    Select Case idCR

                        Case 3

                            Dim dv2QC As System.Data.DataView = New DataView(tblBCStds, strF2, "LEVELNUMBER ASC", DataViewRowState.CurrentRows)
                            tblLevels = dv2QC.ToTable("b", True, "LEVELNUMBER", "CONCENTRATION")
                            intNumLevels = tblLevels.Rows.Count

                            'debug
                            Dim cccc As Short
                            For cccc = 0 To tblLevels.Columns.Count - 1
                                var1 = tblLevels.Columns(cccc).ColumnName
                                var2 = var1
                            Next

                        Case 4
                            Dim dv2QC As System.Data.DataView = New DataView(tblBCQCs, strF2, "LEVELNUMBER ASC", DataViewRowState.CurrentRows)
                            tblLevels = dv2QC.ToTable("b", True, "LEVELNUMBER", "CONCENTRATION")

                            'tblLevels = dv2QC.ToTable("b", True, "CONCENTRATION")
                            'tblBCQCs isn't good here. 

                            intNumLevels = tblLevels.Rows.Count
                    End Select
                End If



                ''xxx

                ''setup tables
                'var1 = rows11(Count1).Item("AnalyteIndex")
                'var2 = rows11(Count1).Item("MasterAssayID")
                'var3 = rows11(Count1).Item("AnalyteDescription")
                'strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND "
                ''strF2 = strF2 & "ID_TBLCONFIGREPORTTABLES = " & intTableID & " AND "
                'strF2 = strF2 & "ID_TBLREPORTTABLE = " & idR & " AND "
                'strF2 = strF2 & "ANALYTEINDEX = " & var1 & " AND "
                'strF2 = strF2 & "MASTERASSAYID = " & var2 & " AND "
                'strF2 = strF2 & "CHARANALYTE = '" & CleanText(cstr(var3)) & "'"
                ''strF2 = strF2 & "BOOLINTSTD = 0"
                'strS = "RUNID ASC, RUNSAMPLESEQUENCENUMBER ASC"
                'rows2 = tbl2.Select(strF2, strS)
                'int1 = rows2.Length 'debug
                'dv2 = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                'int1 = dv2.Count 'debug

                ''xxx

                strAnalyte = var3 'rows20(Count2).Item("CHARANALYTE")

                'debugging
                If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                Else

                    strH = NZ(dv4(Count3).Item("CHARHEADINGTEXT"), "")

                    For Count4 = 1 To 50

                        boolDo = True
                        boolDoIS = False

                        Select Case Count4

                            Case 1
                                'do Stability Conditions
                                strA = "StabilityConditionsForTable_"
                                strB = "Stability Conditions for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Table-specific variables"
                                strC = "Field code for Stability Conditions for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                If Count1 = 0 Then
                                    Select Case idCR
                                        Case 4, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case 31, 32
                                            boolDoIS = True
                                        Case Else
                                            boolDo = False
                                    End Select
                                Else
                                    boolDo = False
                                End If

                            Case 2
                                'do Time Period
                                strA = "TimePeriodForTable_"
                                strB = "Time Period for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Table-specific variables"
                                strC = "Field code for Time Period for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                If Count1 = 0 Then
                                    Select Case idCR
                                        Case 4, 18, 19, 21, 22, 23, 29
                                            var1 = var1 'debug
                                        Case 31, 32
                                            boolDoIS = True
                                        Case Else
                                            boolDo = False
                                    End Select
                                Else
                                    boolDo = False
                                End If
                            Case 3
                                'do Time Frame
                                strA = "TimeFrameForTable_"
                                strB = "Time Frame for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Table-specific variables"
                                strC = "Field code for Time Frame for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                If Count1 = 0 Then
                                    Select Case idCR
                                        Case 4, 18, 19, 21, 22, 23, 29
                                            var1 = var1 'debug
                                        Case 31, 32
                                            boolDoIS = True
                                        Case Else
                                            boolDo = False
                                    End Select
                                Else
                                    boolDo = False
                                End If

                            Case 4
                                'do Period Temp
                                strA = "PeriodTempForTable_"
                                strB = "Period Temperature for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Table-specific variables"
                                strC = "Field code for Period Temperature for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                If Count1 = 0 Then
                                    Select Case idCR
                                        Case 4, 18, 19, 21, 22, 23, 29
                                            var1 = var1 'debug
                                        Case 31, 32
                                            boolDoIS = True
                                        Case Else
                                            boolDo = False
                                    End Select
                                Else
                                    boolDo = False
                                End If
                            Case 5
                                'do Number of Cycles
                                strA = "NumberOfFTCyclesForTable_"
                                strB = "Number of Freeze/Thaw Cycles for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                strB = "Table-specific variables"
                                strC = "Field code for Number of Freeze/Thaw Cycles for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                If Count1 = 0 Then
                                    Select Case idCR
                                        Case 19
                                        Case Else
                                            boolDo = False
                                    End Select
                                Else
                                    boolDo = False
                                End If

                            Case 6
                                strA = "(n)ForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Number of samples associated with QC statistics for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Number of samples associated with QC statistics for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    'Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                    Case 22, 32
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            If int1 = -1 Then
                                            Else
                                                strA = "(n)ForAnalyte_" & int1 + 1 & "_Table_"
                                                strB = "Number of Int Std samples associated with QC statistics for QC Table - "
                                                strB = "Table-specific variables"
                                                strC = "Number of samples associated with QC statistics for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "
                                            End If

                                        End If
                                    Case 5, 6, 7, 30
                                        strB = "Number of samples associated with Table - "
                                        strC = "Number of samples associated with Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    Case 1, 2, 11 '11 is QCCore and uses tblAnova
                                        boolDo = False

                                End Select
                            Case 7
                                strA = "PrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Minimum Precision value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field Code for Minimum Precision value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 8
                                strA = "PrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Maximum Precision value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field Code for Maximum Precision value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Maximum Configuration"
                                Select Case idCR
                                    Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 9
                                strA = "AccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Minimum Accuracy value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Minimum Accuracy value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 10
                                strA = "AccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Maximum Accuracy value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Maximum Accuracy value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 11
                                strA = "AverageRecoveryPrecisionForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Average Recovery Precision value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Average Recovery Precision value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 13, 14, 15
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            If int1 = -1 Then
                                            Else
                                                strA = "AverageRecoveryPrecisionForAnalyte_" & int1 + 1 & "_Table_"
                                                strB = "Int Std Average Recovery Precision value associated with QC runs for QC Table - "
                                                strB = "Table-specific variables"
                                                strC = "Field code for Average Recovery Precision value for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "

                                            End If
                                        End If

                                    Case Else
                                        boolDo = False
                                End Select
                                'depricated
                                '20161002 LEE:  Why?
                                'boolDo = False
                            Case 12
                                'depricated, Recovery doesn't have accuracy
                                strA = "AverageRecoveryAccuracyForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Average Recovery Accuracy value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Average Recovery Accuracy value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 13, 14, 15
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            strA = "IS_AverageRecoveryAccuracyForAnalyte_" & int1 + 1 & "_Table_"
                                            strB = "Int Std Average Recovery Accuracy value associated with QC runs for QC Table - "
                                            strB = "Table-specific variables"
                                            strC = "Field code forAverage Recovery Accuracy value for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select
                                'depricated, Recovery doesn't have accuracy
                                boolDo = False
                            Case 13
                                strA = "AverageRecoveryForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Average Recovery value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Average Recovery value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 13, 14, 15
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            If int1 = -1 Then
                                            Else
                                                strA = "AverageRecoveryForAnalyte_" & int1 + 1 & "_Table_"
                                                strB = "Int Std Average Recovery value associated with QC runs for QC Table - "
                                                strB = "Table-specific variables"
                                                strC = "Field code for Average Recovery value for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "

                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 14
                                strA = "Analyte_" & Count1 + 1
                                strB = "Analyte associated with this study"
                                strB = "Table-specific variables"
                                strC = "Field code for Analyte " & Count1 + 1 & " (" & strAnalyte & ")"
                                strTab = "Report Table Configuration"
                                If Count3 = 0 Then
                                    boolDoIS = True
                                    boolDo = True
                                Else
                                    boolDo = False
                                End If
                            Case 15
                                strA = "DilutionFactorForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Dilution Factor associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Dilution Factor for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 12, 31
                                        If idCR = 12 Then
                                        Else
                                            'check for BOOLSTATSNR. Must = 12 for Dilution
                                            If boolHasSTATSNR(12, idCR, idR) Then
                                                boolDo = boolDo
                                            Else
                                                boolDo = False
                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 16
                                strA = "IntStdConcForTable_"
                                strB = "Table-specific variables"
                                strC = "Field code for Internal Standard Concentration for table: "
                                strTab = "Report Table Configuration"
                                If Count1 = 0 Then
                                    Select Case idCR
                                        Case 17, 32
                                        Case 13, 14, 15
                                            boolDoIS = True
                                        Case Else
                                            boolDo = False
                                    End Select
                                Else
                                    boolDo = False
                                End If
                            Case 17
                                Select Case idCR
                                    Case 2
                                        strA = "MeanSlopeForAnalyte_" & Count1 + 1 & "_Table_"
                                        strB = "Table-specific variables"
                                        strC = "Field code for Mean Slope for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 18
                                Select Case idCR
                                    Case 2
                                        strA = "MeanYIntForAnalyte_" & Count1 + 1 & "_Table_"
                                        strB = "Table-specific variables"
                                        strC = "Field code for Mean Y-Intercept for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 19
                                Select Case idCR
                                    Case 2
                                        strA = "MeanR2ForAnalyte_" & Count1 + 1 & "_Table_"
                                        strB = "Table-specific variables"
                                        strC = "Field code for Mean R-Squared for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select


                            Case 20
                                strA = "SummaryIntraRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                Select Case idCR
                                    Case 11
                                        strB = "Table-specific variables"
                                        strC = "Field code for Summary Intra-Run Minimum Accuracy for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 21
                                strA = "SummaryIntraRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                Select Case idCR
                                    Case 11
                                        strB = "Table-specific variables"
                                        strC = "Field code for Summary Intra-Run Maximum Accuracy for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 22
                                strA = "SummaryIntraRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                Select Case idCR
                                    Case 11
                                        strB = "Table-specific variables"
                                        strC = "Field code for Summary Intra-Run Minimum Precision for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 23
                                strA = "SummaryIntraRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                Select Case idCR
                                    Case 11
                                        strB = "Table-specific variables"
                                        strC = "Field code for Summary Intra-Run Maximum Precision for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 24
                                strA = "SummaryInterRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                Select Case idCR
                                    Case 11
                                        strB = "Table-specific variables"
                                        strC = "Field code for Summary Inter-Run Minimum Accuracy for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 25
                                strA = "SummaryInterRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                Select Case idCR
                                    Case 11
                                        strB = "Table-specific variables"
                                        strC = "Field code for Summary Inter-Run Maximum Accuracy for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 26
                                strA = "SummaryInterRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                Select Case idCR
                                    Case 11
                                        strB = "Table-specific variables"
                                        strC = "Field code for Summary Inter-Run Minimum Precision for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 27
                                strA = "SummaryInterRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                Select Case idCR
                                    Case 11
                                        strB = "Table-specific variables"
                                        strC = "Field code for Summary Inter-Run Maximum Precision for table: "
                                        strTab = "Report Table Configuration"
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 28
                                strA = "FirstAnalysisDateForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "First Analysis Date of runs for Analyte_" & Count1 + 1 & " in Table - "
                                strB = "Table-specific variables"
                                strC = "First Analysis Date of runs for Analyte " & Count1 + 1 & " (" & strAnalyte & ") in table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 1, 2, 6, 7, 30
                                        boolDo = False

                                End Select
                            Case 29
                                strA = "LastAnalysisDateForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Last Analysis Date of runs for Analyte_" & Count1 + 1 & " in Table - "
                                strB = "Table-specific variables"
                                strC = "Last Analysis Date of runs in for Analyte " & Count1 + 1 & " (" & strAnalyte & ") in table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 1, 2, 6, 7, 30
                                        boolDo = False

                                End Select
                            Case 30
                                strA = "RunIDForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "List of Run ID's for Analyte_" & Count1 + 1 & " in Table - "
                                strB = "Table-specific variables"
                                strC = "List of Run ID's for Analyte " & Count1 + 1 & " (" & strAnalyte & ") in table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 6, 7, 30
                                        boolDo = False
                                End Select
                            Case 31
                                strA = "(n)Table_"
                                strB = "Number of samples for Table - "
                                strB = "Table-specific variables"
                                strC = "Number of Samples for table: "
                                strTab = "Report Table Configuration"
                                If Count1 = 0 Then
                                    Select Case idCR
                                        Case 5, 6, 7, 30
                                            boolDo = True
                                        Case Else
                                            boolDo = False
                                    End Select
                                Else
                                    boolDo = False
                                End If

                            Case 32
                                strA = "DilutionConcentrationForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Dilution Concentration associated with Dilution QC runs for Dilution QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Dilution Concentration for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    'Case 12
                                    Case 12, 31 '20190228 LEE: Diln table can also be Ad Hoc Stability, 
                                        If idCR = 12 Then
                                        Else
                                            'check for BOOLSTATSNR. Must = 12 for Dilution
                                            If boolHasSTATSNR(12, idCR, idR) Then
                                                boolDo = boolDo
                                            Else
                                                boolDo = False
                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 33
                                strA = "AccuracyMinIndForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Minimum Accuracy Individual Accepted value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Minimum Accuracy Individual Accepted values for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 34
                                strA = "AccuracyMaxIndForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Maximum Accuracy Individual Accepted value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Maximum Accuracy Individual Accepted values for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                    Case Else
                                        boolDo = False
                                End Select


                            Case 35
                                strA = "AccuracyMinLotForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Minimum Accuracy Unique Lots Accepted value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Minimum Accuracy Unique Lots Accepted values for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 36
                                strA = "AccuracyMaxLotForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Maximum Accuracy Unique Lots Accepted value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Maximum Accuracy Unique Lots Accepted values for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 37
                                strA = "PrecisionMinLotForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Minimum Precision Unique Lots Accepted value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Minimum Precision Unique Lots Accepted values for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 17
                                    Case Else
                                        boolDo = False
                                End Select
                            Case 38
                                strA = "PrecsionMaxLotForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Maximum Precision Unique Lots Accepted value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Maximum Precision Unique Lots Accepted values for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 17
                                    Case Else
                                        boolDo = False
                                End Select


                            Case 39
                                strA = "IS_Analyte_" & Count1 + 1
                                strB = "Analyte Int Std associated with this study"
                                strB = "Table-specific variables"
                                strC = "Field code for Analyte " & Count1 + 1 & " (" & strAnalyte & ") Int Std"
                                strTab = "Report Table Configuration"
                                If Count3 = 0 Then
                                    boolDoIS = True
                                    boolDo = True
                                    If boolIsIS Then
                                        boolDo = False
                                    End If
                                Else
                                    boolDo = False
                                End If




                            Case 40 '20161019 LEE: Added
                                strA = "AverageISNMFForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Average Internal Standard-Normalized Matrix Factor value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Average Internal Standard-Normalized Matrix Factor value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 15
                                        boolDoIS = False
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 41 '20161019 LEE: Added
                                strA = "AverageSDISNMFForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Average Internal Standard-Normalized Matrix Factor SD value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Average Internal Standard-Normalized Matrix Factor SD value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 15
                                        boolDoIS = False
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 42 '20161019 LEE: Added
                                strA = "AveragePrecisionISNMFForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Average Internal Standard-Normalized Matrix Factor Precision value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Average Internal Standard-Normalized Matrix Factor Precision value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 15
                                        boolDoIS = False
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 43 '20161019 LEE: Added
                                strA = "AveragenISNMFForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Average Internal Standard-Normalized Matrix Factor (n) value associated with QC runs for QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Average Internal Standard-Normalized Matrix Factor (n) value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    Case 15
                                        boolDoIS = False
                                    Case Else
                                        boolDo = False
                                End Select




                                '*****

                            Case 44 '20161021 LEE: Added
                                strA = "RecoveryMinPrecisionQCForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Minimum Precision Extracted QC value associated with QC Tables"
                                strB = "Table-specific variables"
                                strC = "Field Code for Minimum Precision Extracted QC value associated for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Minimum Configuration"
                                Select Case idCR
                                    Case 13, 14
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            If int1 = -1 Then
                                            Else
                                                strA = "RecoveryMinPrecisionQCForAnalyte_" & int1 + 1 & "_Table_"
                                                strB = "Int Std Minimum Precision Extracted QC value associated with QC Tables"
                                                strB = "Table-specific variables"
                                                strC = "Field Code for Int Std Minimum Precision Extracted QC value associated for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "

                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 45 '20161021 LEE: Added
                                strA = "RecoveryMaxPrecisionQCForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Maximum Precision Extracted QC value associated with QC Tables"
                                strB = "Table-specific variables"
                                strC = "Field Code for Maximum Precision Extracted QC value associated for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Maximum Configuration"
                                Select Case idCR
                                    Case 13, 14
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            If int1 = -1 Then
                                            Else
                                                strA = "RecoveryMaxPrecisionQCForAnalyte_" & int1 + 1 & "_Table_"
                                                strB = "Int Std Maximum Precision Extracted QC value associated with QC Tables"
                                                strB = "Table-specific variables"
                                                strC = "Field Code for Int Std Maximum Precision Extracted QC value associated for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "
                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select


                            Case 46 '20161021 LEE: Added
                                strA = "RecoveryMinPrecisionRSForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Minimum Precision Recovery Solution (RS) value associated with QC Tables"
                                strB = "Table-specific variables"
                                strC = "Field Code for Minimum Precision Recovery Solution (RS) value associated for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Minimum Configuration"
                                Select Case idCR
                                    Case 13, 15
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            If int1 = -1 Then
                                            Else
                                                strA = "RecoveryMinPrecisionRSForAnalyte_" & int1 + 1 & "_Table_"
                                                strB = "Int Std Minimum Precision Recovery Solution (RS) value associated with QC Tables"
                                                strB = "Table-specific variables"
                                                strC = "Field Code for Int Std Minimum Precision Recovery Solution (RS) value associated for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "

                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 47 '20161021 LEE: Added
                                strA = "RecoveryMaxPrecisionRSForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Maximum Precision Recovery Solution (RS) value associated with QC Tables"
                                strB = "Table-specific variables"
                                strC = "Field Code for Maximum Precision Recovery Solution (RS) value associated for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Maximum Configuration"
                                Select Case idCR
                                    Case 13, 15
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            If int1 = -1 Then
                                            Else
                                                strA = "RecoveryMaxPrecisionRSForAnalyte_" & int1 + 1 & "_Table_"
                                                strB = "Int Std Maximum Precision Recovery Solution (RS) value associated with QC Tables"
                                                strB = "Table-specific variables"
                                                strC = "Field Code for Int Std Maximum Recovery Solution (RS) value associated for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "
                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 48 '20161021 LEE: Added
                                strA = "RecoveryMinPrecisionPESForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Minimum Precision Post Extraction Spiking (PES) value associated with QC Tables"
                                strB = "Table-specific variables"
                                strC = "Field Code for Minimum Precision Post Extraction Spiking (PES) value associated for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Minimum Configuration"
                                Select Case idCR
                                    Case 14, 15
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            If int1 = -1 Then
                                            Else
                                                strA = "RecoveryMinPrecisionPESForAnalyte_" & int1 + 1 & "_Table_"
                                                strB = "Int Std Minimum Precision Post Extraction Spiking (PES) value associated with QC Tables"
                                                strB = "Table-specific variables"
                                                strC = "Field Code for Int Std Minimum Precision Post Extraction Spiking (PES) value associated for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "

                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select

                            Case 49 '20161021 LEE: Added
                                strA = "RecoveryMaxPrecisionPESForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Maximum Precision Post Extraction Spiking (PES) value associated with QC Tables"
                                strB = "Table-specific variables"
                                strC = "Field Code for Maximum Precision Post Extraction Spiking (PES) value associated for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Maximum Configuration"
                                Select Case idCR
                                    Case 14, 15
                                        boolDoIS = True
                                        If boolIsIS Then
                                            int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                            If int1 = -1 Then
                                            Else
                                                strA = "RecoveryMaxPrecisionPESForAnalyte_" & int1 + 1 & "_Table_"
                                                strB = "Int Std Maximum Precision Post Extraction Spiking (PES) value associated with QC Tables"
                                                strB = "Table-specific variables"
                                                strC = "Field Code for Int Std Maximum Precision Post Extraction Spiking (PES) value associated for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "
                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select


                                '*****
                                '20190228 LEE:
                            Case 50
                                strA = "DilutionReplicateNumberForAnalyte_" & Count1 + 1 & "_Table_"
                                strB = "Number of Dilution replicates associated with Dilution QC runs for Dilution QC Table - "
                                strB = "Table-specific variables"
                                strC = "Field code for Dilution Concentration for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                strTab = "Report Table Configuration"
                                Select Case idCR
                                    'Case 12
                                    Case 12, 31 '20190228 LEE: Diln table can also be Ad Hoc Stability, 
                                        If idCR = 12 Then
                                        Else
                                            'check for BOOLSTATSNR. Must = 12 for Dilution
                                            If boolHasSTATSNR(12, idCR, idR) Then
                                            Else
                                                boolDo = False
                                            End If
                                        End If
                                    Case Else
                                        boolDo = False
                                End Select

                        End Select

                        If boolDo Then

                            If boolIsIS Then
                                If boolDoIS Then

                                    Select Case Count4
                                        Case 14, 39
                                            str3 = "[" & strA & "]"
                                            str4 = strC
                                        Case Else
                                            str3 = "[IS_" & strA & strFCID & "]"
                                            str4 = strC & strH
                                    End Select

                                    'If Count4 = 14 Then
                                    '    str3 = "[" & strA & "]"
                                    '    str4 = strC
                                    'Else
                                    '    'str3 = "[" & strA & strFCID & "]"
                                    '    str3 = "[IS_" & strA & strFCID & "]"
                                    '    str4 = strC & strH
                                    'End If

                                    'see if str3 already exists
                                    strF3 = "CHARFIELDCODE = '" & str3 & "'"

                                    boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                                    If boolNFC Then

                                        'Erase rows3
                                        'rows3 = dtbl1.Select(strF3)
                                        'int2 = rows3.Length
                                        'If int2 > 0 Then
                                        'Else

                                        'End If

                                        Dim newRow As DataRow = dtbl1.NewRow
                                        newRow.BeginEdit()

                                        intMaxID = intMaxID + 1
                                        newRow("ID_TBLFIELDCODES") = intMaxID
                                        newRow("CHARFIELDCODE") = str3
                                        newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                                        newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                                        newRow("CHARTABLE") = "NA" '
                                        newRow("CHAREXAMPLE") = "NA" '
                                        newRow("CHARGROUP") = strB
                                        newRow("ID_TBLREPORTTABLE") = idR
                                        newRow("UPSIZE_TS") = dt

                                        newRow("intAdded") = -1

                                        newRow.EndEdit()

                                        dtbl1.Rows.Add(newRow)

                                    End If

                                End If
                            Else

                                Select Case Count4
                                    Case 14, 39
                                        str3 = "[" & strA & "]"
                                        str4 = strC
                                    Case Else
                                        str3 = "[" & strA & strFCID & "]"
                                        str4 = strC & strH
                                End Select

                                'If Count4 = 14 Then
                                '    str3 = "[" & strA & "]"
                                '    str4 = strC
                                'Else
                                '    str3 = "[" & strA & strFCID & "]"
                                '    str4 = strC & strH
                                'End If

                                'see if str3 already exists
                                strF3 = "CHARFIELDCODE = '" & str3 & "'"

                                boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                                If boolNFC Then

                                    Erase rows3
                                    rows3 = dtbl1.Select(strF3)
                                    int2 = rows3.Length
                                    If int2 > 0 Then
                                    Else

                                    End If


                                    Dim newRow As DataRow = dtbl1.NewRow
                                    newRow.BeginEdit()

                                    intMaxID = intMaxID + 1
                                    newRow("ID_TBLFIELDCODES") = intMaxID
                                    newRow("CHARFIELDCODE") = str3
                                    newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                                    newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                                    newRow("CHARTABLE") = "NA" '
                                    newRow("CHAREXAMPLE") = "NA" '
                                    newRow("CHARGROUP") = strB
                                    newRow("ID_TBLREPORTTABLE") = idR
                                    newRow("UPSIZE_TS") = dt

                                    newRow("intAdded") = -1

                                    newRow.EndEdit()

                                    dtbl1.Rows.Add(newRow)

                                End If

                            End If

                        End If
                    Next

                    'these have already been assigned
                    'Dim dv2 As System.Data.DataView = New DataView(tbl2, strF2, strS, DataViewRowState.CurrentRows)
                    ''find number of runs used
                    'tblNumRuns = dv2.ToTable("a", True, "RUNID")
                    'intNumRuns = tblNumRuns.Rows.Count

                    ''establish table of level numbers
                    ''tblLevels = dv2.ToTable("b", True, "NOMCONC", "CHARHELPER1")
                    'tblLevels = dv2.ToTable("b", True, "NOMCONC")
                    'intNumLevels = tblLevels.Rows.Count

                    Dim ixyz As Int32
                    ixyz = idR

                    For Count2 = 0 To intNumLevels - 1

                        For Count4 = 1 To 26

                            boolDo = True
                            boolDoIS = False

                            Select Case Count4
                                Case 1
                                    'do nomconc
                                    strA = "NomConcForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Nominal Concentration for QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                    Select Case idCR
                                        Case 4, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 2
                                    strA = "PrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Precision value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Precision value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Maximum Configuration"
                                    Select Case idCR
                                        'Case 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case 4, 12, 17, 18, 19, 21, 31
                                        Case Else
                                            boolDo = False
                                    End Select
                                Case 3
                                    strA = "AccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Accuracy value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field code for Accuracy value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                    Select Case idCR
                                        Case 4, 12, 17, 18, 19, 21, 31
                                        Case Else
                                            boolDo = False
                                    End Select
                                Case 4
                                    strA = "RecoveryForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Recovery value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field code for Recovery value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") at QC Level " & Count2 + 1 & " for table: "
                                    strTab = "Report Table Configuration"
                                    Select Case idCR
                                        Case 13, 14, 15
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryForAnalyte_" & int1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                                    strB = "Int Std Recovery value associated with QC Tables"
                                                    strB = "Table-specific variables"
                                                    strC = "Field code for Recovery value for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") at QC Level " & Count2 + 1 & " for table: "

                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 5
                                    'do %Diff
                                    strA = "DiffValueForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Difference Value associated with QC Tables" ' Analyte " & Count1 + 1 & ": " & strAnalyte & ", Level " & Count2 + 1 & ", Table Field Code " & strFCID
                                    strB = "Table-specific variables"
                                    strC = "Field code for Difference Value for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                    Select Case idCR
                                        Case 23, 29
                                        Case 22, 32
                                            boolDoIS = True
                                        Case Else
                                            boolDo = False
                                    End Select
                                Case 6
                                    strA = "(n)ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Number of samples associated with QC statistics for QC Table - "
                                    strB = "Table-specific variables"
                                    strC = "Field code for number of samples associated with QC statistics for Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                    Select Case idCR
                                        'Case 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        'Case 4, 12, 17, 18, 19, 21, 31
                                        'Case 1, 2, 3, 4, 5, 6, 7, 11
                                        Case 1, 2, 3, 5, 6, 7, 11
                                            boolDo = False

                                    End Select
                                Case 7
                                    strA = "MeanForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Mean value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Precision value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Configuration"
                                    Select Case idCR
                                        'Case 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case 4, 12, 17, 18, 19, 21, 31
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 8
                                    strA = "RecoveryPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Precision value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Precision value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Maximum Configuration"
                                    Select Case idCR
                                        Case 13, 14, 15
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryPrecisionForAnalyte_" & int1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                                    strB = "Int Std Precision value associated with QC Tables"
                                                    strB = "Table-specific variables"
                                                    strC = "Field Code for Int Std Precision value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "

                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select


                                Case 9 '20161019 LEE: Added
                                    strA = "MatrixFactorOfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Matrix Factor Value of Analyte value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Matrix Factor of Analyte value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 10 '20161019 LEE: Added
                                    strA = "MatrixFactorOfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Matrix Factor Value of Int Std value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Matrix Factor of Int Std value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 11 '20161019 LEE: Added
                                    strA = "ISNMatrixFactorForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Int Std-Normalized Matrix Factor Value value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Int Std-Normalized Matrix Factor value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select


                                Case 12 '20161019 LEE: Added
                                    strA = "MatrixFactorPrecisionOfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Matrix Factor Precision Value of Analyte Precision value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Matrix Factor Precision of Analyte value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 13 '20161019 LEE: Added
                                    strA = "MatrixFactorPrecisionOfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Matrix Factor Value of Int Std Precision value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Matrix Factor Precision of Int Std value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 14 '20161019 LEE: Added
                                    strA = "ISNMatrixFactorPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Int Std-Normalized Matrix Factor Precision Value value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Int Std-Normalized Matrix Factor Precision value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select


                                Case 15 '20161019 LEE: Added
                                    strA = "MatrixFactor(n)OfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Matrix Factor (n) Value of Analyte value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Matrix Factor (n) of Analyte value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 16 '20161019 LEE: Added
                                    strA = "MatrixFactor(n)OfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Matrix Factor (n) Value of Int Std value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Matrix Factor (n) of Int Std value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 17 '20161019 LEE: Added
                                    strA = "ISNMatrixFactor(n)ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Int Std-Normalized Matrix Factor (n) Value value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Int Std-Normalized Matrix Factor (n) value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select


                                Case 18 '20161019 LEE: Added
                                    strA = "MinIndMatrixFactorOfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Minimum Individual Matrix Factor Values of Analyte value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Minimum Individual Matrix Factor of Analyte value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 19 '20161019 LEE: Added
                                    strA = "MinIndMatrixFactorOfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Minimum Individual Matrix Factor Value of Int Std value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Minimum Individual Matrix Factor of Int Std value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 20 '20161019 LEE: Added
                                    strA = "MinIndISNMatrixFactorForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Minimum Individual Int Std-Normalized Matrix Factor Value value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Minimum Individual Int Std-Normalized Matrix Factor value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 21 '20161019 LEE: Added
                                    strA = "MaxIndMatrixFactorOfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Maximum Individual Matrix Factor Values of Analyte value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Maximum Individual Matrix Factor of Analyte value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 22 '20161019 LEE: Added
                                    strA = "MaxIndMatrixFactorOfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Maximum Individual Matrix Factor Value of Int Std value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Maximum Individual Matrix Factor of Int Std value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 23 '20161019 LEE: Added
                                    strA = "MaxIndISNMatrixFactorForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Maximum Individual Int Std-Normalized Matrix Factor Value value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Maximum Individual Int Std-Normalized Matrix Factor value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Matrix Factor Configuration"
                                    Select Case idCR
                                        Case 15
                                            boolDoIS = False
                                        Case Else
                                            boolDo = False
                                    End Select




                                Case 24
                                    strA = "RecoveryMeanQCForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Mean Extracted QC value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Mean Extracted QC value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Maximum Configuration"
                                    Select Case idCR
                                        Case 13, 14
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryMeanQCForAnalyte_" & int1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                                    strB = "Int Std Mean Extracted QC value associated with QC Tables"
                                                    strB = "Table-specific variables"
                                                    strC = "Field Code for Int Std Mean Extracted QC value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "

                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select


                                Case 25
                                    strA = "RecoveryMeanRSForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Mean Recovery Solution (RS) value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Mean Recovery Solution (RS) value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Maximum Configuration"
                                    Select Case idCR
                                        Case 13, 15
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryMeanRSForAnalyte_" & int1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                                    strB = "Int Std Mean Recovery Solution (RS) value associated with QC Tables"
                                                    strB = "Table-specific variables"
                                                    strC = "Field Code for Int Std Mean Recovery Solution (RS) value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "

                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 26
                                    strA = "RecoveryMeanPESForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                    strB = "Mean Post Extraction Spiking (PES) value associated with QC Tables"
                                    strB = "Table-specific variables"
                                    strC = "Field Code for Mean Post Extraction Spiking (PES) value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                    strTab = "Report Table Maximum Configuration"
                                    Select Case idCR
                                        Case 14, 15
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rows11, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryMeanPESForAnalyte_" & int1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                                    strB = "Int Std Mean Post Extraction Spiking (PES) value associated with QC Tables"
                                                    strB = "Table-specific variables"
                                                    strC = "Field Code for Int Std Mean Post Extraction Spiking (PES) value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Int Std of Analyte " & int1 + 1 & " (" & strAnalyte & ") for table: "

                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select



                            End Select

                            If boolDo Then

                                If boolIsIS Then
                                    If boolDoIS Then
                                        str3 = "[IS_" & strA & strFCID & "]"
                                        str4 = strC & strH

                                        'see if str3 already exists
                                        strF3 = "CHARFIELDCODE = '" & str3 & "'"

                                        boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                                        If boolNFC Then

                                            'Erase rows3
                                            'rows3 = dtbl1.Select(strF3)
                                            'int2 = rows3.Length
                                            'If int2 > 0 Then
                                            'Else

                                            'End If


                                            Dim newRow As DataRow = dtbl1.NewRow
                                            newRow.BeginEdit()

                                            intMaxID = intMaxID + 1
                                            newRow("ID_TBLFIELDCODES") = intMaxID
                                            newRow("CHARFIELDCODE") = str3
                                            newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                                            newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                                            newRow("CHARTABLE") = "NA" '
                                            newRow("CHAREXAMPLE") = "NA" '
                                            newRow("CHARGROUP") = strB
                                            newRow("ID_TBLREPORTTABLE") = idR
                                            newRow("UPSIZE_TS") = dt

                                            newRow("intAdded") = -1

                                            newRow.EndEdit()

                                            dtbl1.Rows.Add(newRow)

                                        End If

                                    End If
                                Else
                                    str3 = "[" & strA & strFCID & "]"
                                    str4 = strC & strH

                                    'see if str3 already exists
                                    strF3 = "CHARFIELDCODE = '" & str3 & "'"

                                    boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                                    If boolNFC Then

                                        'Erase rows3
                                        'rows3 = dtbl1.Select(strF3)
                                        'int2 = rows3.Length
                                        'If int2 > 0 Then
                                        'Else

                                        'End If


                                        Dim newRow As DataRow = dtbl1.NewRow
                                        newRow.BeginEdit()

                                        intMaxID = intMaxID + 1
                                        newRow("ID_TBLFIELDCODES") = intMaxID
                                        newRow("CHARFIELDCODE") = str3
                                        newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                                        newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                                        newRow("CHARTABLE") = "NA" '
                                        newRow("CHAREXAMPLE") = "NA" '
                                        newRow("CHARGROUP") = strB
                                        newRow("ID_TBLREPORTTABLE") = idR
                                        newRow("UPSIZE_TS") = dt

                                        newRow("intAdded") = -1

                                        newRow.EndEdit()

                                        dtbl1.Rows.Add(newRow)

                                    End If
                                End If

                            End If

                            'here
                            For Count5 = 0 To intNumRuns - 1

                                For Count6 = 1 To 3

                                    Select Case Count6

                                        Case 1
                                            'strA = "PrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                            strA = "PrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                            strB = "Precision value associated with QC Tables"
                                            strB = "Table-specific variables"
                                            strC = "Field Code for Precision value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                            strTab = "Report Table Maximum Configuration"
                                            Select Case idCR
                                                Case 22, 23, 29, 32
                                                Case Else
                                                    boolDo = False
                                            End Select
                                        Case 2
                                            'strA = "AccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                            strA = "AccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                            strB = "Accuracy value associated with QC Tables"
                                            strB = "Table-specific variables"
                                            strC = "Field code for Accuracy value associated with Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                            strTab = "Report Table Configuration"
                                            Select Case idCR
                                                Case 22, 23, 29, 32
                                                Case Else
                                                    boolDo = False
                                            End Select
                                        Case 3
                                            strA = "(n)ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count2 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                            strB = "Number of samples associated with QC statistics for QC Table - "
                                            strB = "Table-specific variables"
                                            strC = "Field code for number of samples associated with QC statistics for Nominal Concentration (" & tblLevels.Rows(Count2).Item(strNomConc) & ") for Analyte " & Count1 + 1 & " (" & strAnalyte & ") for table: "
                                            strTab = "Report Table Configuration"
                                            Select Case idCR
                                                Case 22, 23, 29, 32
                                                Case Else
                                                    boolDo = False
                                            End Select

                                    End Select

                                    If boolDo Then

                                        str3 = "[" & strA & strFCID & "]"
                                        str4 = strC & strH

                                        'see if str3 already exists
                                        strF3 = "CHARFIELDCODE = '" & str3 & "'"

                                        boolNFC = boolNeedsFC(str3, str4, idR, dtbl1)
                                        If boolNFC Then

                                            'Erase rows3
                                            'rows3 = dtbl1.Select(strF3)
                                            'int2 = rows3.Length
                                            'If int2 > 0 Then
                                            'Else

                                            'End If


                                            Dim newRow As DataRow = dtbl1.NewRow
                                            newRow.BeginEdit()

                                            intMaxID = intMaxID + 1
                                            newRow("ID_TBLFIELDCODES") = intMaxID
                                            newRow("CHARFIELDCODE") = str3
                                            newRow("CHARDESCRIPTION") = str4 ' & " for Role " & str2
                                            newRow("CHARTAB") = strTab ' rows1(Count1).Item("CHARTAB")
                                            newRow("CHARTABLE") = "NA" '
                                            newRow("CHAREXAMPLE") = "NA" '
                                            newRow("CHARGROUP") = strB
                                            newRow("ID_TBLREPORTTABLE") = idR
                                            newRow("UPSIZE_TS") = dt

                                            newRow("intAdded") = -1

                                            newRow.EndEdit()

                                            dtbl1.Rows.Add(newRow)

                                        End If


                                    End If

                                Next

                            Next

                        Next
                    Next

                End If

nextCount1b:

            Next Count1

nextCount3:

        Next Count3





end1:

        dtbl1.AcceptChanges()


    End Sub

End Module

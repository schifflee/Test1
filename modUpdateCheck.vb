Option Compare Text



Module modUpdateCheck

    Public tMaxID As Int64
    Public intRecs As Int64
    Public arrLater(5, 500) '1=idT, 2=userlabel, 3=intOrder, 4=ID_TBLCONFIGHEADERLOOKUP, 5=ID_TBLREPORTTABLEHEADERCONFIG
    Public intLater As Int16
    Public numLater As Int64
    Public maxLater As Int64

    '20170107 LEE: from now on, modUpdateCheck will be used only when columns need to be added to database tables
    'all record mods or record additions will be done in modConserved.DatabaseCorrections 
    'Remember that all Columns that get added need a companion tblDataTableRowTitles entry in modConserved.DatabaseCorrections

    Sub AddFields_TBLAUTOASSIGNSAMPLES_CHARNEW2(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim rs5 As New ADODB.Recordset
        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim boolText As Boolean

        boolAdd = False

        strT = "TBLAUTOASSIGNSAMPLES"
        boolCont = False

        Try

            intCount = intCount + 1

            'now add fields
            For Count2 = 1 To 4

                boolText = False
                boolAdd = False
                str1 = ""
                str2 = ""
                int1 = 200
                intText = 255
                numTy = 202
                numU = 0

                Select Case Count2
                    Case 1
                        strF = "CHARNEW2"
                    Case 2
                        strF = "CHARNEW3"
                    Case 3
                        strF = "CHARRUNIDENTIFIER3"
                    Case 4
                        strF = "CHARRUNIDENTIFIER4"
                End Select

                'strSQL = "alter table " & strT & " ADD ID_TBLFINALREPORT double"
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                Try
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    'strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Call WriteInstall("SUCCESSFUL:" & ChrW(9) & "AddFields_TBLAUTOASSIGNSAMPLES_CHARNEW2: " & strM) '20190131 LEE
                Catch ex2 As Exception
                    boolProb = True
                    'strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ": " & ex2.Message '& vbCrLf
                    Call WriteInstall("UNSUCCESSFUL:" & ChrW(9) & "AddFields_TBLAUTOASSIGNSAMPLES_CHARNEW2: " & strM) '20190131 LEE
                End Try

            Next

        Catch ex3 As Exception

            boolProb = False
            strM = "Table " & strT & " already exists. No need to create."
            boolCont = True
            rs5.Close()
            rs5 = Nothing

            intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        End Try

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLMETHODVALIDATIONDATA_CHARBLOOD(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 5
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARBLOOD"
                    numU = 0
                    strT = "TBLMETHODVALIDATIONDATA"
                    numTy = 202
                    intText = 200
                    strU = ""

                Case 2
                    strF = "CHARSTOCKSOLUTION"
                    numU = 0
                    strT = "TBLMETHODVALIDATIONDATA"
                    numTy = 202
                    intText = 200
                    strU = ""
                Case 3
                    strF = "CHARSPIKING"
                    numU = 0
                    strT = "TBLMETHODVALIDATIONDATA"
                    numTy = 202
                    intText = 200
                    strU = ""
                Case 4
                    strF = "CHARAUTOSAMPLER"
                    numU = 0
                    strT = "TBLMETHODVALIDATIONDATA"
                    numTy = 202
                    intText = 200
                    strU = ""
                Case 5
                    strF = "CHARBATCHREINJECTION"
                    numU = 0
                    strT = "TBLMETHODVALIDATIONDATA"
                    numTy = 202
                    intText = 200
                    strU = ""
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Call WriteInstall("SUCCESSFUL:" & ChrW(9) & "AddFields_TBLMETHODVALIDATIONDATA_CHARBLOOD: " & strM) '20190131 LEE
                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ": " & ex.Message '& vbCrLf
                    Call WriteInstall("UNSUCCESSFUL:" & ChrW(9) & "AddFields_TBLMETHODVALIDATIONDATA_CHARBLOOD: " & strM) '20190131 LEE
                End Try

                boolAdd = False

            Else 'ignore
                boolProb = False
                strM = "NO ACTION:" & ChrW(9) & "AddFields_TBLMETHODVALIDATIONDATA_CHARBLOOD: Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
                Call WriteInstall(strM) '20190131 LEE
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub AddFields_TBLDATA_BOOLCALIBRTABLETITLE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLDATA"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255

            strU = "Tab"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "BOOLCALIBRTABLETITLE"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    boolAdd = True
                    strU = "Tab"
                    lenChar = 25
                    boolText = False

            End Select

            strF1 = "ID_" & strT

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Call WriteInstall("SUCCESSFUL:" & ChrW(9) & "AddFields_TBLDATA_BOOLCALIBRTABLETITLE: " & strM) '20190131 LEE

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    'strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ": " & ex.Message '& vbCrLf
                    Call WriteInstall("UNSUCCESSFUL:" & ChrW(9) & "AddFields_TBLDATA_BOOLCALIBRTABLETITLE: " & strM) '20190131 LEE

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If


                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                        Call WriteInstall("SUCCESSFUL:" & ChrW(9) & "AddFields_TBLDATA_BOOLCALIBRTABLETITLE: " & strM) '20190131 LEE

                    Catch ex As Exception
                        boolProb = True
                        'strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ": " & ex.Message '& vbCrLf
                        Call WriteInstall("UNSUCCESSFUL:" & ChrW(9) & "AddFields_TBLDATA_BOOLCALIBRTABLETITLE: " & strM) '20190131 LEE

                    End Try

                End If

            Else 'ignore
                boolProb = False
                'strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
                strM = "NO ACTION:" & ChrW(9) & "AddFields_TBLDATA_BOOLCALIBRTABLETITLE: Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
                Call WriteInstall(strM) '20190131 LEE
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLAUTOASSIGNSAMPLES_CHARLOTWOIS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim rs5 As New ADODB.Recordset
        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim boolText As Boolean

        boolAdd = False

        strT = "TBLAUTOASSIGNSAMPLES"
        boolCont = False

        Try

            intCount = intCount + 1

            'now add fields
            For Count2 = 1 To 10

                boolText = False
                boolAdd = False
                str1 = ""
                str2 = ""
                int1 = 200
                intText = 255
                numTy = 202
                numU = 0

                strF = "CHARLOTWOIS" & Count2

                'strSQL = "alter table " & strT & " ADD ID_TBLFINALREPORT double"
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                Try
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                Catch ex2 As Exception
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

            Next

        Catch ex3 As Exception

            boolProb = False
            strM = "Table " & strT & " already exists. No need to create."
            boolCont = True
            rs5.Close()
            rs5 = Nothing

            intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        End Try

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLSTUDYDOCANALYTES_CHARUSERANALNAME(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLSTUDYDOCANALYTES"
        intEnd = 2

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255

            strU = "Tab"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "CHARUSERANALYTE"
                    numU = -1
                    numTy = 202
                    boolAdd = True
                    strU = ""
                    lenChar = 255
                    boolText = True

                Case 2
                    strF = "CHARUSERIS"
                    numU = -1
                    numTy = 202
                    boolAdd = True
                    strU = ""
                    lenChar = 255
                    boolText = True

            End Select

            strF1 = "ID_" & strT

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                'If boolAdd Then 'update records

                '    'strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                '    strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"

                '    cmd.CommandText = strSQL
                '    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                '    Try
                '        cmd.ExecuteNonQuery()
                '        boolProb = False
                '        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                '    Catch ex As Exception
                '        boolProb = True
                '        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                '    End Try

                'End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If boolAdd Then


            Dim rs2 As New ADODB.Recordset
            rs2.CursorLocation = CursorLocationEnum.adUseClient
            rs2.Open(strT, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
            rs2.ActiveConnection = Nothing

            Do Until rs2.EOF


                Try
                    var1 = NZ(rs2.Fields("AnalyteDescription").Value, "")
                    var2 = NZ(rs2.Fields("IntStd").Value, "")
                    var3 = rs2.Fields("ID_TBLSTUDYDOCANALYTES").Value

                    strSQL = "UPDATE " & strT & " SET CHARUSERANALYTE = '" & var1 & "', CHARUSERIS  = '" & var2 & "' WHERE ID_TBLSTUDYDOCANALYTES = " & var3 & ";"

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try
                Catch ex As Exception
                    var1 = var1
                End Try

                rs2.MoveNext()

            Loop


            If rs2.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs2.Close()
            End If
            rs2 = Nothing

        End If

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub


    Sub AddFields_TBLDATA_NUMTABLEFONTSIZE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLDATA"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255

            strU = "Tab"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "NUMTABLEFONTSIZE"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 1 'single
                    boolAdd = True
                    strU = "Tab"
                    lenChar = 25
                    boolText = False

            End Select

            strF1 = "ID_" & strT

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If


                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_BOOLADHOCSTABCOMPCOLUMNS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False



            Select Case Count2

                Case 1
                    strF = "BOOLADHOCSTABCOMPCOLUMNS"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    boolAdd = True
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_BOOLCONCCOMMENTS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False



            Select Case Count2

                Case 1
                    strF = "BOOLCONCCOMMENTS"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    boolAdd = True
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLCUSTOMFIELDCODES_INTORDER(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLCUSTOMFIELDCODES"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255

            strU = "Tab"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "INTORDER"
                    numU = 1
                    strT = "TBLCUSTOMFIELDCODES"
                    numTy = 2
                    boolAdd = True
                    strU = "Tab"
                    lenChar = 25
                    boolText = False

            End Select

            strF1 = "ID_" & strT

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If


                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLDATA_BOOLTABLELABELSECTION(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLDATA"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255

            strU = "Tab"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "BOOLTABLELABELSECTION"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    boolAdd = True
                    strU = "Tab"
                    lenChar = 25
                    boolText = False

            End Select

            strF1 = "ID_" & strT

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If


                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLDATA_BOOLUSERSD(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLDATA"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255

            strU = "Tab"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "BOOLUSERSD"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    boolAdd = True
                    strU = "Tab"
                    lenChar = 25
                    boolText = False

            End Select

            strF1 = "ID_" & strT

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If


                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLTABLES_TBLSTUDYDOCANALYTES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTABLES"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 63 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTABLES VALUES(64,'TBLSTUDYDOCANALYTES')"


            End Select

            Try

                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddRecords_TBLMAXID_TBLSTUDYDOCANALYTES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date = Now
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 68 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLMAXID VALUES(69,'TBLSTUDYDOCANALYTES',1," & ReturnDate(dt) & ")"

            End Select

            Try

                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub CreateTable_TBLSTUDYDOCANALYTES(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        'this stores tblAnalytesHome


        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short
        Dim var1, var2
        Dim numTy As Short
        Dim intText As Short
        Dim numU As Short

        strT = "TBLSTUDYDOCANALYTES"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'now add fields

                For Count1 = 1 To 20

                    intText = 255
                    numU = 0

                    Select Case Count1
                        Case 1
                            str1 = "AnalyteDescription"
                            var1 = System.Type.GetType("System.String")
                            numTy = 202
                        Case 2
                            str1 = "AnalyteID"
                            var1 = System.Type.GetType("System.Int64")
                            numTy = 3
                        Case 3
                            str1 = "AnalyteIndex"
                            var1 = System.Type.GetType("System.Int64") 'doesn't need to be long
                            numTy = 2
                        Case 4
                            str1 = "BQL"
                            var1 = System.Type.GetType("System.Single")
                            numTy = 1
                        Case 5
                            str1 = "AQL"
                            var1 = System.Type.GetType("System.Single")
                            numTy = 1
                        Case 6
                            str1 = "ConcUnits"
                            var1 = System.Type.GetType("System.String")
                            numTy = 202
                        Case 7
                            str1 = "AcceptedRuns"
                            var1 = System.Type.GetType("System.Int64")
                            numTy = 2
                        Case 8
                            str1 = "IsReplicate"
                            var1 = System.Type.GetType("System.String")
                            numTy = 202
                            intText = 20
                        Case 9
                            str1 = "IsIntStd"
                            var1 = System.Type.GetType("System.String")
                            numTy = 202
                            intText = 20
                        Case 10
                            str1 = "UseIntStd"
                            var1 = System.Type.GetType("System.String")
                            numTy = 202
                            intText = 20
                        Case 11
                            str1 = "IntStd"
                            var1 = System.Type.GetType("System.String")
                            numTy = 202
                        Case 12
                            str1 = "MasterAssayID"
                            var1 = System.Type.GetType("System.Int64")
                            numTy = 3
                        Case 13
                            str1 = "IsCoadminCmpd"
                            var1 = System.Type.GetType("System.String")
                            numTy = 202
                            intText = 20
                        Case 14
                            str1 = "ORIGINALANALYTEDESCRIPTION"
                            var1 = System.Type.GetType("System.String")
                            numTy = 202
                        Case 15
                            str1 = "INTGROUP"
                            var1 = System.Type.GetType("System.Int16")
                            numTy = 2
                        Case 16
                            str1 = "MATRIX"
                            var1 = System.Type.GetType("System.String")
                            numTy = 202
                        Case 17
                            str1 = "INTORDER"
                            var1 = System.Type.GetType("System.Int16")
                            numTy = 2
                        Case 18
                            str1 = "CALIBRSET"
                            numTy = 202
                        Case 19
                            str1 = "ID_TBLSTUDIES"
                            numTy = 5
                        Case 20
                            str1 = "UPSIZE_TS"
                            numTy = 7
                    End Select

                    strSQL = "alter table " & strT & " ADD " & str1 & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    intCount = intCount + 1

                Next


            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)

    End Sub

    Sub AddFields_TBLDATA_CHARCAPTIONFOLLOW(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLDATA"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255

            strU = "Tab"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "CHARCAPTIONFOLLOW"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 202
                    boolAdd = True
                    strU = "Tab"
                    lenChar = 25
                    boolText = True

            End Select

            strF1 = "ID_" & strT

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLPERMISSIONS_BOOLLOCKFINALREPORT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim intU As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLLOCKFINALREPORT"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 255
                    boolAdd = True
                    intU = -1


            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = True

            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = False
                    Exit For
                End If
            Next


            If boolCont Then 'field needs to be added
                boolAdd = True

                rs1.Close()
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'strSQL = "UPDATE " & strT & " SET " & strF & " = 'Administrator' WHERE ID_TBLPERMISSIONS = 1"
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & intU
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddFields_TBLDATA_CHARLLOQ(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLDATA"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255

            strU = "Blank"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "CHARBQL"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 202
                    boolAdd = True
                    strU = "ASC"
                    lenChar = 25
                    boolText = True

            End Select

            strF1 = "ID_" & strT

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    For Count3 = 1 To 2
                        Select Case Count3
                            Case 1
                                int1 = -1
                                strU = "BQL/AQL"
                            Case 2
                                int1 = 0
                                strU = "BLQ/ALQ"
                        End Select

                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE BOOLBQL = " & int1 & ";"

                        cmd.CommandText = strSQL
                        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                        Try
                            cmd.ExecuteNonQuery()
                            boolProb = False
                            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                    Next

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_CHARSAMPLESAD5(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 4

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False



            Select Case Count2

                Case 1
                    strF = "CHARSAMPLESAD5"
                    numU = -1
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 202
                    boolAdd = True
                    strU = "ASC"
                    lenChar = 10
                    boolText = True

                Case 2
                    strF = "CHARSAMPLESAD6"
                    numU = -1
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 202
                    boolAdd = True
                    strU = "ASC"
                    lenChar = 10
                    boolText = True

                Case 3
                    strF = "NUMSAMPLES5"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    boolAdd = True
                    boolText = False

                Case 4
                    strF = "NUMSAMPLES6"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    boolAdd = True
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLAPPFIGS_CHARRDB(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLAPPFIGS"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255
            strU = "Blank"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "CHARRDB"
                    numU = -1
                    strT = "TBLAPPFIGS"
                    numTy = 202
                    boolAdd = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLFINALREPORT_CHARPASSWORD(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLFINALREPORT"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255
            strU = "Blank"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "CHARPASSWORD"
                    numU = -1
                    strT = "TBLFINALREPORT"
                    numTy = 202
                    boolAdd = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLCUSTOMFIELDCODES_BOOLINCLUDE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLCUSTOMFIELDCODES"
        intEnd = 2

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255
            strF1 = "ID_TBLCONFIGREPORTTABLES"
            strU = "Blank"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "BOOLINCLUDE"
                    numU = -1
                    strT = "TBLCUSTOMFIELDCODES"
                    numTy = 1
                    boolDo = False
                    boolAdd = True

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_INTQCLEVELGROUP(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 2

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255
            strF1 = "ID_TBLCONFIGREPORTTABLES"
            strU = "Blank"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "INTQCLEVELGROUP"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 1
                    boolDo = False
                    boolAdd = True

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLDATA_BOOLSD2(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLDATA"
        intEnd = 2

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255

            strU = "Blank"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "BOOLSD2"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    boolDo = False
                    boolAdd = True

                Case 2
                    strF = "BOOLDIFFCOLSTATS"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    boolDo = False
                    boolAdd = True

            End Select

            strF1 = "ID_" & strT

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_NUMPRECCRITLOTS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date = Now
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim int1 As Short
        Dim int2 As Int16
        Dim int3 As Int16
        Dim strF As String


        strT = "TBLDATATABLEROWTITLES"

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1.CursorLocation = CursorLocationEnum.adUseClient

        'check to see if this has been run
        str1 = "SELECT TBLDATATABLEROWTITLES.* "
        str2 = "FROM TBLDATATABLEROWTITLES;"
        strSQL = str1 & str2

        Try
            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If
            rs1.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        rs1.ActiveConnection = Nothing


        For Count1 = 1 To 7

            'ID_TBLDATATABLEROWTITLES	CHARDATATABLENAME	CHARROWNAME	INTORDER	CHARTABLEREF	CHARTABLEREFCOLUMNNAME	BOOLINCLUDE	UPSIZE_TS	CHARHOOK


            'NUMPRECCRITLOTS
            'CHARCARRYOVERLABEL
            'BOOLMFTABLE
            'BOOLINCLMFCOLS
            'BOOLINCLINTSTDNMF
            'BOOLCALCINTSTDNMF
            '



            Select Case Count1

                Case 1
                    int1 = 592
                    str1 = "Precision criteria for Individual Lots table"
                    int2 = 1
                    str2 = "NUMPRECCRITLOTS"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3

                Case 2
                    int1 = 593
                    str1 = "Blank label for Carryover table"
                    int2 = 1
                    str2 = "CHARCARRYOVERLABEL"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3


                Case 3
                    int1 = 594
                    str1 = "Configure table as Matrix Factor"
                    int2 = 1
                    str2 = "BOOLMFTABLE"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3

                Case 4
                    int1 = 595
                    str1 = "Include Analyte and IntStd Matrix Factor columns"
                    int2 = 1
                    str2 = "BOOLINCLMFCOLS"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3

                Case 5
                    int1 = 596
                    str1 = "Include Internal Standard-Normalized Matrix Factor column"
                    int2 = 1
                    str2 = "BOOLINCLINTSTDNMF"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3

                Case 6
                    int1 = 597
                    str1 = "Calculate Internal Standard-Normalized Matrix Factor as MF(Analyte)/MF(IntStd)"
                    int2 = 1
                    str2 = "BOOLCALCINTSTDNMF"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3

                Case 7

                    int1 = 598
                    str1 = "Include LLOQ and ULOQ columns in Regression table"
                    int2 = 1
                    str2 = "BOOLREGRULOQ"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3

            End Select


            'check to see if data needs to be modified
            strF = "CHARTABLEREFCOLUMNNAME = '" & str2 & "' AND CHARDATATABLENAME = '" & str3 & "'"
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then 'continue
            Else
                GoTo next1
            End If

            rs1.Filter = ""


            strSQL = "INSERT INTO " & strT & " VALUES(" & int1 & ", '" & str3 & "', '" & str1 & "', " & int2 & ", '" & str4 & "', '" & str2 & "', -1, " & ReturnDate(dt) & ", NULL)"

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = strM & ChrW(10) & ChrW(10)
                strM = strM & ex.Message
                boolCont = False
            End Try

next1:

        Next

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_NUMPRECCRITLOTS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 2

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255
            strF1 = "ID_TBLCONFIGREPORTTABLES"
            strU = "Blank"
            boolText = False
            Select Case Count2

                Case 1
                    strF = "NUMPRECCRITLOTS"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 1
                    boolDo = False
                    boolAdd = True

                Case 2
                    strF = "BOOLREGRULOQ"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_CHARLDAP(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date = Now
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim int1 As Short
        Dim int2 As Int16
        Dim int3 As Int16
        Dim strF As String


        strT = "TBLDATATABLEROWTITLES"

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1.CursorLocation = CursorLocationEnum.adUseClient

        'check to see if this has been run
        str1 = "SELECT TBLDATATABLEROWTITLES.* "
        str2 = "FROM TBLDATATABLEROWTITLES;"
        strSQL = str1 & str2

        Try
            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If
            rs1.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        rs1.ActiveConnection = Nothing


        For Count1 = 1 To 3

            'ID_TBLDATATABLEROWTITLES	CHARDATATABLENAME	CHARROWNAME	INTORDER	CHARTABLEREF	CHARTABLEREFCOLUMNNAME	BOOLINCLUDE	UPSIZE_TS	CHARHOOK

            'NUMSIGFIGSAREARATIO
            'BOOLUSESIGFIGSAREARATIO
            'BOOLUSESPECRNDAREARATIO


            Select Case Count1

                Case 1
                    int1 = 589
                    str1 = "LDAP Address for Windows Authentication"
                    int2 = 1
                    str2 = "CHARLDAP"
                    str3 = "TBLUSERACCOUNTS"
                    str4 = str3

                Case 2
                    int1 = 590
                    str1 = "Network account to use for Windows Authentication"
                    int2 = 1
                    str2 = "CHARNETWORKACCOUNT"
                    str3 = "TBLUSERACCOUNTS"
                    str4 = str3


                Case 3
                    int1 = 591
                    str1 = "Watson account assigned to StudyDoc user"
                    int2 = 1
                    str2 = "ID_TBLWATSONACCOUNT"
                    str3 = "TBLUSERACCOUNTS"
                    str4 = str3


            End Select


            'check to see if data needs to be modified
            strF = "CHARTABLEREFCOLUMNNAME = '" & str2 & "' AND CHARDATATABLENAME = '" & str3 & "'"
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then 'continue
            Else
                GoTo next1
            End If

            rs1.Filter = ""


            strSQL = "INSERT INTO " & strT & " VALUES(" & int1 & ", '" & str3 & "', '" & str1 & "', " & int2 & ", '" & str4 & "', '" & str2 & "', -1, " & ReturnDate(dt) & ", NULL)"

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = strM & ChrW(10) & ChrW(10)
                strM = strM & ex.Message
                boolCont = False
            End Try

next1:

        Next

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing

    End Sub

    Sub AddFields_tblUserAccounts_CHARLDAP(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim numTy As Short
        Dim lenChar As Short

        Dim dtNow As Date = Now

        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARLDAP"
                    strT = "TBLUSERACCOUNTS"
                    numTy = 202
                    lenChar = 255
                    numU = 0
                Case 2
                    strF = "CHARNETWORKACCOUNT"
                    strT = "TBLUSERACCOUNTS"
                    numTy = 202
                    lenChar = 255
                    numU = 0
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    boolAdd = False
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = strM & ChrW(10) & ex.Message
                    MsgBox(strM)
                End Try

                'If boolAdd Then 'update records

                '    strSQL = "UPDATE " & strT & " SET " & strF & " = #" & dtNow & "# WHERE " & strF & " IS NULL"
                '    cmd.CommandText = strSQL
                '    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                '    Try
                '        cmd.ExecuteNonQuery()
                '        boolProb = False
                '        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                '    Catch ex As Exception
                '        boolProb = True
                '        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                '        strM = strM & ChrW(10) & ex.Message
                '        strM = strM

                '    End Try

                '    'intCount = intCount + 1
                '    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                '    'If boolProb Then
                '    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    '    intRed = intRed + 1
                '    'Else
                '    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                '    'End If

                'End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_BOOLINCLMFCOLS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 5

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 255
            strF1 = "ID_TBLCONFIGREPORTTABLES"
            strU = "Blank"
            boolText = False
            Select Case Count2
                Case 1
                    strF = "CHARCARRYOVERLABEL"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 202
                    boolDo = False
                    boolText = True
                    boolAdd = True
                Case 2
                    strF = "BOOLMFTABLE"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True
                Case 3
                    strF = "BOOLINCLMFCOLS"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True
                Case 4
                    strF = "BOOLINCLINTSTDNMF"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True
                Case 5
                    strF = "BOOLCALCINTSTDNMF"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "';"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try
                 

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLREPORTS_ANALRUNSUMMARY(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 6
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            strT = "TBLREPORTS"

            Select Case Count2
                Case 1
                    strF = "BOOLALLAR"
                    numU = -1
                    numTy = 2
                    intText = 100
                    strU = "."

                Case 2
                    strF = "BOOLACCAR"
                    numU = 0
                    numTy = 2
                    intText = 100
                    strU = ""

                Case 3
                    strF = "BOOLREJAR"
                    numU = 0
                    numTy = 2
                    intText = 100
                    strU = ""

                Case 4
                    strF = "BOOLREGRAR"
                    numU = 0
                    numTy = 2
                    intText = 100
                    strU = ""

                Case 5
                    strF = "BOOLNOREGRAR"
                    numU = 0
                    numTy = 2
                    intText = 100
                    strU = ""

                Case 6
                    strF = "BOOLINCLPSAE"
                    numU = 0
                    numTy = 2
                    intText = 100
                    strU = ""

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added

                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLTABLES_TBLAPPFIGWORDDOCS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTABLES"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 62 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTABLES VALUES(63,'TBLAPPFIGWORDDOCS')"


            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddRecords_TBLMAXID_TBLAPPFIGWORDDOCS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date = Now
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 67 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLMAXID VALUES(68,'TBLAPPFIGWORDDOCS',1," & ReturnDate(dt) & ")"


            End Select

            Try

                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub CreateTable_TBLAPPFIGWORDDOCS(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLAPPFIGWORDDOCS"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'now add fields
                For Count1 = 1 To 5
                    If boolAccess Then
                        Select Case Count1
                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLCONFIGAPPFIG double"
                            Case 2
                                strSQL = "alter table " & strT & " ADD ID_TBLAPPFIGS double"
                            Case 3
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES double"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARXML memo NULL"
                            Case 5
                                strSQL = "alter table " & strT & " ADD UPSIZE_TS date NULL"

                        End Select
                    Else
                        Select Case Count1
                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLCONFIGAPPFIG float"
                            Case 2
                                strSQL = "alter table " & strT & " ADD ID_TBLAPPFIGS float"
                            Case 3
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES float"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARXML nvarchar2 NULL"
                            Case 5
                                strSQL = "alter table " & strT & " ADD UPSIZE_TS datetime NULL"

                        End Select

                    End If

                    '        If boolAccess Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " Single"
                    '        Else'If boolSQLServer Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " real"
                    '        End If
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                Next

            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)

    End Sub

    Sub AddRecords_TBLCONFIGHEADERLOOKUP_Carryover(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64
        Dim strF1 As String

        'ANALYTICALRUNSAMPLE.ASSAYDATETIME

        '        ID_TBLCONFIGHEADERLOOKUP 214
        '        ID_TBLCONFIGREPORTTABLES 5
        '       CHARCOLUMNLABEL	Assay Date
        '        INTORDER 15
        '        CHARWATSONTABLE ANALYTICALRUNSAMPLE
        '        CHARWATSONFIELD ASSAYDATETIME
        '        BOOLDEFAULT 0
        '        UPSIZE_TS 1 - Mar - 6



        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now

        maxID = 246

        'see if record already exists
        Dim rs1 As New ADODB.Recordset

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > maxID Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        'rs1 = Nothing
        Pause(1) 'need to give database time to catch up for next subroutine

        'get maxid for TBLREPORTTABLEHEADERCONFIG
        'NOTE: for some reason during development, tblMaxID is coming from the dev StudyDoc_01
        'must use recordset
        'maxID = GetMaxID("TBLREPORTTABLEHEADERCONFIG")

        Dim maxIDTRHC As Int64

        str1 = "SELECT TBLMAXID.NUMMAXID FROM TBLMAXID "
        str2 = "WHERE CHARTABLE = 'TBLREPORTTABLEHEADERCONFIG';"
        strSQL = str1 & str2
        cmd.CommandText = strSQL
        Try
            maxIDTRHC = cmd.ExecuteScalar
        Catch ex As Exception
            var1 = var1
        End Try

        Dim omaxIDTRHC As Int64 = maxIDTRHC

        omaxID = maxID

        'get current studies
        str1 = "SELECT TBLSTUDIES.ID_TBLSTUDIES FROM TBLSTUDIES;"
        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(str1, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs1.ActiveConnection = Nothing


        For Count1 = 1 To 2

            strT = "TBLCONFIGHEADERLOOKUP"

            maxID = maxID + 1

            Select Case Count1

                Case 1
                    var1 = maxID
                    var2 = 35
                    var3 = "Watson Run ID"
                    var4 = 1
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1

                    var8 = "Watson" & ChrW(10) & "Run ID"

                Case 2
                    var1 = maxID
                    var2 = 35
                    var3 = "Blank Sample Name"
                    var4 = 2
                    var5 = "NA"
                    var6 = "NA"
                    var7 = 0

                    var8 = "Blank" & ChrW(10) & "Sample Name"

            End Select

            Try

                strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & "," & ReturnDate(dt) & ");"

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                'ElseIf boolSQLSer Then
                'End If

                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
                var1 = ex.Message
                var2 = var1
            End Try

            If boolCont Then

                strT = "TBLREPORTTABLEHEADERCONFIG"
                'ID_TBLREPORTTABLEHEADERCONFIG	ID_TBLSTUDIES	ID_TBLCONFIGREPORTTABLES	ID_TBLCONFIGHEADERLOOKUP	CHARUSERLABEL	INTORDER	BOOLINCLUDE	UPSIZE_TS
                '4741	65	38	205	Reported Conc. (ng/g)	14	-1	date

                Dim idS As Int64
                rs1.MoveFirst()
                Do Until rs1.EOF

                    maxIDTRHC = maxIDTRHC + 1

                    idS = rs1.Fields("ID_TBLSTUDIES").Value

                    strSQL = "INSERT INTO " & strT & "  VALUES (" & maxIDTRHC & "," & idS & ",35," & maxID & ",'" & var8 & "','" & var4 & "'," & var7 & "," & ReturnDate(dt) & ");"

                    Try
                        cmd.CommandText = strSQL
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = str1 & " executed successfully."

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        var1 = ex.Message
                        var2 = var1
                    End Try

                    rs1.MoveNext()
                Loop

            End If

        Next

end1:
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


        'Dim omaxIDTRHC As Int64 = maxIDTRHC
        If omaxIDTRHC = maxIDTRHC Then
        Else
            'strSQL = "UPDATE TBLMAXID SET NUMMAXID = " & maxIDTRHC & " WHERE CHARTABLE = 'TBLCONFIGHEADERLOOKUP';"
            strSQL = "UPDATE TBLMAXID SET NUMMAXID = " & maxIDTRHC & " WHERE CHARTABLE = 'TBLREPORTTABLEHEADERCONFIG';"

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try
        End If

        Pause(1) 'need to give database time to catch up for next subroutine

    End Sub

    Sub CREATETABLE_TBLAUTOASSIGNSAMPLES(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByRef con, ByRef cmd, ByRef constr)

        Dim rs5 As New ADODB.Recordset
        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim boolText As Boolean

        boolAdd = False

        strT = "TBLAUTOASSIGNSAMPLES"
        boolCont = False
        Try

            strSQL = "SELECT " & strT & ".* FROM " & strT & " WHERE ID_" & strT & " < 0"
            rs5.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)

        Catch ex As Exception

            'MUST RE-ESTABLISH CON to get earlier tblMaxID addition
            If con.State = ADODB.ObjectStateEnum.adStateOpen Then
                con.Close()
            End If

            con.Open(constr)
            Pause(1)


            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                If boolCont Then
                Else
                    GoTo end1
                End If

                intCount = intCount + 1

                'now add fields
                For Count2 = 2 To 36

                    boolText = False
                    boolAdd = False
                    str1 = ""
                    str2 = ""
                    int1 = 200
                    intText = 255
                    numTy = 202
                    numU = 0

                    Select Case Count2


                        'Case Is = 1
                        '    str1 = "ID_TBLAUTOASSIGNSAMPLES"
                        '    numTy = 5
                        Case Is = 2
                            strF = "ID_TBLSTUDIES"
                            numTy = 5
                        Case Is = 3
                            strF = "ID_TBLCONFIGREPORTTABLES"
                            numTy = 5
                        Case Is = 4
                            strF = "ID_TBLREPORTTABLE"
                            numTy = 5


                        Case Is = 5
                            strF = "BOOLUSESTDCOLLABELS"
                            boolText = True
                            numTy = 2
                            numU = -1

                        Case Is = 6
                            strF = "CHARRECPES"
                        Case Is = 7
                            strF = "CHARRECRS"
                        Case Is = 8
                            strF = "CHARRECQC"
                        Case Is = 9
                            strF = "CHARLOT1"
                        Case Is = 10
                            strF = "CHARLOT2"
                        Case Is = 11
                            strF = "CHARLOT3"
                        Case Is = 12
                            strF = "CHARLOT4"
                        Case Is = 13
                            strF = "CHARLOT5"
                        Case Is = 14
                            strF = "CHARLOT6"
                        Case Is = 15
                            strF = "CHARLOT7"
                        Case Is = 16
                            strF = "CHARLOT8"
                        Case Is = 17
                            strF = "CHARLOT9"
                        Case Is = 18
                            strF = "CHARLOT10"
                        Case Is = 19
                            strF = "CHARDILN"
                        Case Is = 20
                            strF = "CHARDILNFACTOR"
                        Case Is = 21
                            strF = "CHARCALSTD"
                        Case Is = 22
                            strF = "CHARNONCOREQC"
                        Case Is = 23
                            strF = "CHARCOREQC"
                        Case Is = 24
                            strF = "CHAROLD"
                        Case Is = 25
                            strF = "CHARNEW"
                        Case Is = 26
                            strF = "CHARLLOQ"
                        Case Is = 27
                            strF = "CHARULOQ"
                        Case Is = 28
                            strF = "CHARBLANK"
                        Case Is = 29
                            strF = "CHARSTOCKSOLNCONC"
                        Case Is = 30
                            strF = "CHARRUNIDENTIFIER1"
                        Case Is = 31
                            strF = "CHARRUNIDENTIFIER2"

                        Case Is = 32
                            strF = "CHARSAMPLETYPE"

                        Case Is = 33
                            strF = "CHARRUNDESCR1"
                        Case Is = 34
                            strF = "CHARRUNDESCR2"

                        Case Is = 35
                            strF = "BOOLACCEPTEDONLY"
                            boolText = True
                            numTy = 2
                            numU = -1

                        Case Is = 36
                            strF = "UPSIZE_TS"
                            numTy = 7

                    End Select

                    'strSQL = "alter table " & strT & " ADD ID_TBLFINALREPORT double"
                    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                Next


                'now add records

                Dim strT1 As String = "TBLREPORTTABLE"
                Dim rs11 As New ADODB.Recordset

                strSQL = "SELECT " & strT1 & ".* FROM " & strT1

                rs11.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)

                Dim int11 As Int64
                Dim int22 As Int64
                Dim int33 As Int64
                Dim intMaxID As Int64 = 0
                Dim dt As Date = Now

                Do Until rs11.EOF

                    intMaxID = intMaxID + 1

                    int11 = rs11.Fields("ID_TBLSTUDIES").Value
                    int22 = rs11.Fields("ID_TBLCONFIGREPORTTABLES").Value
                    int33 = rs11.Fields("ID_TBLREPORTTABLE").Value


                    'INSERT INTO table_name (column1,column2,column3,...)
                    'VALUES (value1,value2,value3,...);

                    'strSQL = "INSERT INTO TBLDATEFORMATS VALUES (15,'01 Sep 2006','dd MMM yyyy',16," & ReturnDate(dt) & ";"

                    Select Case int22
                        Case 13, 14, 15, 22, 23
                            'make BOOLACCEPTEDONLY false for these tables
                            strSQL = "INSERT INTO " & strT & " (ID_" & strT & ",ID_TBLSTUDIES,ID_TBLCONFIGREPORTTABLES,ID_TBLREPORTTABLE,BOOLUSESTDCOLLABELS,BOOLACCEPTEDONLY,UPSIZE_TS) VALUES (" & intMaxID & "," & int11 & "," & int22 & "," & int33 & ",-1,0," & ReturnDate(dt) & ")"
                        Case Else
                            strSQL = "INSERT INTO " & strT & " (ID_" & strT & ",ID_TBLSTUDIES,ID_TBLCONFIGREPORTTABLES,ID_TBLREPORTTABLE,BOOLUSESTDCOLLABELS,BOOLACCEPTEDONLY,UPSIZE_TS) VALUES (" & intMaxID & "," & int11 & "," & int22 & "," & int33 & ",-1,-1," & ReturnDate(dt) & ")"
                    End Select


                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex1 As Exception

                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ChrW(10) & ex1.Message

                    End Try

                    rs11.MoveNext()
                Loop

                If rs11.State = ADODB.ObjectStateEnum.adStateOpen Then
                    rs11.Close()
                End If
                rs11 = Nothing

                'update tblMaxID
                Dim rsM As New ADODB.Recordset
                strSQL = "SELECT TBLMAXID.* FROM TBLMAXID WHERE CHARTABLE = '" & strT & "';"
                rsM.CursorLocation = CursorLocationEnum.adUseClient
                rsM.Open(strSQL, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                Try
                    rsM.Fields("NUMMAXID").Value = intMaxID
                    rsM.Update()
                    rsM.UpdateBatch()
                    strM = "SUCCESSFUL:" & ChrW(9) & "rsM.UpdateBatch: Sub CREATETABLE_TBLAUTOASSIGNSAMPLES"
                Catch ex2 As Exception
                    boolProb = True
                    strM = "UNSUCCESSFUL:" & ChrW(9) & "rsM.UpdateBatch: Sub CREATETABLE_TBLAUTOASSIGNSAMPLES: Error: " & ex.Message
                    'strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ChrW(10) & ex2.Message
                End Try

                Call WriteInstall(strM)

                If rsM.State = ADODB.ObjectStateEnum.adStateOpen Then
                    rsM.Close()
                End If
                rsM = Nothing

            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.Open(constr)
        Pause(1)

        'conA.CommitTrans()

    End Sub


    Sub AddRecords_TBLTABLES_TBLAUTOASSIGNSAMPLES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTABLES"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 61 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTABLES VALUES(62,'TBLAUTOASSIGNSAMPLES')"


            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddRecords_TBLMAXID_TBLAUTOASSIGNSAMPLES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim dt As Date = Now

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 66 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1

                    strSQL = "INSERT INTO TBLMAXID VALUES(67,'TBLAUTOASSIGNSAMPLES',1," & ReturnDate(dt) & ");"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub ISR_01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        'ISR columns int tblheaderconfig need to be cleaned up

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date = Now
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64
        Dim strF1 As String
        Dim strF2 As String
        Dim boolCont As Boolean = True
        Dim idTStudies As Int64

        Dim rs1 As New ADODB.Recordset
        Dim rs2 As New ADODB.Recordset
        Dim rs3 As New ADODB.Recordset
        Dim rsM As New ADODB.Recordset
        Dim idS As Int64

        Dim idCFL As Int64
        Dim strUL As String
        Dim boolGoCheck As Boolean = False
        Dim intNumA As Short
        Dim idT As Short
        Dim intOrder As Short
        Dim intOrderStart As Short
        Dim int1 As Short

        'AAACKK!! This code is repeating itself!!!
        'DOUBLE CHECK during testing!!!

        'need to pause here
        'seems to run without error, but no fields created
        Pause(2)

        'get maxid for TBLREPORTTABLEHEADERCONFIG
        'NOTE: for some reason during development, tblMaxID is coming from the dev StudyDoc_01
        'must use recordset
        'maxID = GetMaxID("TBLREPORTTABLEHEADERCONFIG")

        'first delete all ISR data from TBLCONFIGHEADERLOOKUP
        strT = "TBLCONFIGHEADERLOOKUP"
        strSQL = "DELETE FROM " & strT & " WHERE ID_TBLCONFIGREPORTTABLES = 30"

        cmd.CommandText = strSQL
        Try
            cmd.ExecuteNonQuery()
            var2 = "Hi"
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        Catch ex As Exception
            var1 = ex.Message.ToString
            var2 = var1
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

        End Try

        'do the same for TBLREPORTTABLEHEADERCONFIG
        strT = "TBLREPORTTABLEHEADERCONFIG"
        strSQL = "DELETE FROM " & strT & " WHERE ID_TBLCONFIGREPORTTABLES = 30"

        cmd.CommandText = strSQL
        Try
            cmd.ExecuteNonQuery()
            var2 = "Hi"
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        Catch ex As Exception
            var1 = ex.Message.ToString
            var2 = var1
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

        End Try

        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now

        maxID = 231

        'don't check to see if this has been run
        'will only be run once

        Pause(1) 'need to give database time to catch up for next subroutine

        'now add records to TBLCONFIGHEADERLOOKUP
        'SUBJECT
        'TREATMENT

        'DAY
        'TIME
        'ORIGINAL CONC
        'ORIGINAL RUNID
        'ISR VALUE
        'ISR RUNID
        'MEAN VALUE
        '%DIFFERENCE
        'PASS/FAIL

        'Group
        'Gender
        'Visit Text
        'Time Text

        Dim intNF As Short = 15

        For Count1 = 1 To intNF

            maxID = maxID + 1

            var7 = -1

            Select Case Count1
                Case 1
                    str1 = "Subject"
                Case 2
                    str1 = "Treatment"
                Case 3
                    str1 = "Day"
                Case 4
                    str1 = "Time"
                Case 5
                    str1 = "Original Conc."
                Case 6
                    str1 = "Original Run ID"
                Case 7
                    str1 = "ISR Conc."
                Case 8
                    str1 = "ISR Run ID"
                Case 9
                    str1 = "Mean Original+ISR"
                    var7 = 0
                Case 10
                    str1 = "%Difference"
                Case 11
                    str1 = "Pass/Fail"
                    var7 = 0

                Case 12
                    str1 = "Group"
                    var7 = 0
                Case 13
                    str1 = "Gender"
                    var7 = 0
                Case 14
                    str1 = "Visit Text"
                    var7 = 0
                Case 15
                    str1 = "Time Text"
                    var7 = 0
            End Select

            var1 = maxID
            var2 = 30
            var3 = str1
            var4 = Count1
            var5 = "NA"
            var6 = "NA"


            arrLater(1, Count1) = var2 ' rs2.Fields("ID_TBLCONFIGREPORTTABLES").Value
            arrLater(2, Count1) = var3 'rs2.Fields("CHARCOLUMNLABEL").Value
            arrLater(3, Count1) = Count1 ' rs2.Fields("INTORDER").Value
            arrLater(4, Count1) = maxID ' rs2.Fields("ID_TBLCONFIGHEADERLOOKUP").Value
            arrLater(5, Count1) = var7 ' rs2.Fields("ID_TBLCONFIGHEADERLOOKUP").Value

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & "," & ReturnDate(dt) & ");"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & "," & ReturnDate(dt) & ");"
                ElseIf boolSQLSer Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & "," & ReturnDate(dt) & ");"
                End If

                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
                var1 = ex.Message
                var2 = var1

            End Try

        Next

        'now update TBLREPORTTABLEHEADERCONFIG
        'start maxid with intLater



        '****


        rsM.CursorLocation = CursorLocationEnum.adUseClient
        rsM.Open("TBLMAXID", con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rsM.ActiveConnection = Nothing
        strF1 = "CHARTABLE = 'TBLREPORTTABLEHEADERCONFIG'"
        rsM.Filter = strF1
        ''this connection was opened earlier, can't use to get maxid
        'use maxlater instead        
        'maxID = rsM.Fields("NUMMAXID").Value

        maxID = maxLater
        omaxID = maxID

        'get current studies
        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open("TBLSTUDIES", con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs1.ActiveConnection = Nothing

        'ID_TBLREPORTTABLEHEADERCONFIG	ID_TBLSTUDIES	ID_TBLCONFIGREPORTTABLES	ID_TBLCONFIGHEADERLOOKUP	CHARUSERLABEL	INTORDER	BOOLINCLUDE	UPSIZE_TS
        '4741	65	38	205	Reported Conc. (ng/g)	14	-1	date


        str1 = "SELECT TBLCONFIGHEADERLOOKUP.* FROM TBLCONFIGHEADERLOOKUP;"
        'str2 = "WHERE ID_TBLCONFIGREPORTTABLES = 30;"
        strSQL = str1

        rs2.CursorLocation = CursorLocationEnum.adUseClient
        rs2.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs2.ActiveConnection = Nothing

        str1 = "SELECT TBLREPORTTABLEHEADERCONFIG.* FROM TBLREPORTTABLEHEADERCONFIG;"
        strSQL = str1
        rs3.CursorLocation = CursorLocationEnum.adUseClient
        rs3.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs3.ActiveConnection = Nothing

        strT = "TBLREPORTTABLEHEADERCONFIG"
        dt = Now

        intLater = intNF 'int1

        Dim intInclude As Short

        Do Until rs1.EOF

            idTStudies = rs1.Fields("ID_TBLSTUDIES").Value

            For Count2 = 1 To intLater

                '1=idT, 2=userlabel, 3=intOrder, 4=ID_TBLCONFIGHEADERLOOKUP, 5=include
                idT = arrLater(1, Count2)
                strUL = arrLater(2, Count2)
                intOrder = arrLater(3, Count2)
                idCFL = arrLater(4, Count2)
                intInclude = arrLater(5, Count2)

                'strF2 = "ID_TBLCONFIGREPORTTABLES = " & idT & " AND CHARUSERLABEL = '" & strUL & "' AND ID_TBLSTUDIES = " & idTStudies
                'rs3.Filter = ""
                'rs3.Filter = strF2

                'Can't evaluate because rs3.con hasn't been updated
                'If rs3.RecordCount = 0 Then

                'ID_TBLREPORTTABLEHEADERCONFIG	ID_TBLSTUDIES	ID_TBLCONFIGREPORTTABLES	ID_TBLCONFIGHEADERLOOKUP	CHARUSERLABEL	INTORDER	BOOLINCLUDE	UPSIZE_TS
                '4741	65	38	205	Reported Conc. (ng/g)	14	-1	date

                maxID = maxID + 1

                var1 = maxID
                var2 = idTStudies
                var3 = idT
                var4 = idCFL
                var5 = strUL
                var6 = intOrder
                var7 = intInclude

                Try

                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & "," & ReturnDate(dt) & ");"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & "," & ReturnDate(dt) & ");"
                    ElseIf boolSQLSer Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & "," & ReturnDate(dt) & ");"
                    End If

                    '''''''''''console.writeline(strSQL)
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    boolCont = False
                    var1 = ex.Message
                    var2 = var1
                End Try

                'End If

            Next

            rs1.MoveNext()

        Loop

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        If rs2.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs2.Close()
        End If

        If rs3.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs3.Close()
        End If

        If omaxID = maxID Then
        Else
            'Call PutMaxID("TBLREPORTTABLEHEADERCONFIG", maxID)
            rsM.Fields("NUMMAXID").Value = maxID
            rsM.ActiveConnection = con
            rsM.UpdateBatch()

        End If

        If rsM.State = ADODB.ObjectStateEnum.adStateOpen Then
            rsM.Close()
        End If

        rs1 = Nothing
        rs2 = Nothing
        rs3 = Nothing

        Pause(2) 'need to give database time to catch up for next subroutine

    End Sub

    Sub AddRecords_TBLREPORTTABLEHEADERCONFIG_FIX01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        'ID_CONFIGHEADERLOOKUP 214 - 129 are missing in development TBLREPORTTABLEHEADERCONFIG

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date = Now
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64
        Dim strF1 As String
        Dim strF2 As String
        Dim boolCont As Boolean = True
        Dim idTStudies As Int64

        Dim rs1 As New ADODB.Recordset
        Dim rs2 As New ADODB.Recordset
        Dim rs3 As New ADODB.Recordset
        Dim idS As Int64

        Dim idCFL As Int64
        Dim strUL As String
        Dim boolGoCheck As Boolean = False
        Dim intNumA As Short
        Dim idT As Short
        Dim intOrder As Short
        Dim intOrderStart As Short
        Dim int1 As Short

        'AAACKK!! This code is repeating itself!!!
        'DOUBLE CHECK during testing!!!

        'need to pause here
        'seems to run without error, but no fields created
        Pause(2)

        'get maxid for TBLREPORTTABLEHEADERCONFIG
        'NOTE: for some reason during development, tblMaxID is coming from the dev StudyDoc_01
        'must use recordset
        'maxID = GetMaxID("TBLREPORTTABLEHEADERCONFIG")

        Dim rsM As New ADODB.Recordset
        rsM.CursorLocation = CursorLocationEnum.adUseClient
        rsM.Open("TBLMAXID", con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rsM.ActiveConnection = Nothing
        strF1 = "CHARTABLE = 'TBLREPORTTABLEHEADERCONFIG'"
        rsM.Filter = strF1
        ''this connection was opened earlier, can't use to get maxid
        'use numLater instead        
        'maxID = rsM.Fields("NUMMAXID").Value

        maxID = numLater
        omaxID = maxID

        'get current studies
        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open("TBLSTUDIES", con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs1.ActiveConnection = Nothing

        'ID_TBLREPORTTABLEHEADERCONFIG	ID_TBLSTUDIES	ID_TBLCONFIGREPORTTABLES	ID_TBLCONFIGHEADERLOOKUP	CHARUSERLABEL	INTORDER	BOOLINCLUDE	UPSIZE_TS
        '4741	65	38	205	Reported Conc. (ng/g)	14	-1	date


        str1 = "SELECT TBLCONFIGHEADERLOOKUP.* FROM TBLCONFIGHEADERLOOKUP;"
        'str2 = "WHERE ID_TBLCONFIGREPORTTABLES = 30;"
        strSQL = str1

        rs2.CursorLocation = CursorLocationEnum.adUseClient
        rs2.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs2.ActiveConnection = Nothing

        str1 = "SELECT TBLREPORTTABLEHEADERCONFIG.* FROM TBLREPORTTABLEHEADERCONFIG;"
        strSQL = str1
        rs3.CursorLocation = CursorLocationEnum.adUseClient
        rs3.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs3.ActiveConnection = Nothing

        strT = "TBLREPORTTABLEHEADERCONFIG"
        dt = Now

        'set arrlater

        int1 = 0
        For Count1 = 214 To 219

            int1 = int1 + 1

            strF1 = "ID_TBLCONFIGHEADERLOOKUP = " & Count1
            rs2.Filter = ""
            rs2.Filter = strF1

            '1=idT, 2=userlabel, 3=intOrder, 4=ID_TBLCONFIGHEADERLOOKUP, 5=ID_TBLREPORTTABLEHEADERCONFIG
            arrLater(1, int1) = rs2.Fields("ID_TBLCONFIGREPORTTABLES").Value
            arrLater(2, int1) = rs2.Fields("CHARCOLUMNLABEL").Value
            arrLater(3, int1) = rs2.Fields("INTORDER").Value
            arrLater(4, int1) = rs2.Fields("ID_TBLCONFIGHEADERLOOKUP").Value
            arrLater(5, int1) = rs2.Fields("BOOLDEFAULT").Value

        Next
        intLater = int1

        Dim intIncl As Short

        Do Until rs1.EOF

            idTStudies = rs1.Fields("ID_TBLSTUDIES").Value

            For Count2 = 1 To intLater

                '1=idT, 2=userlabel, 3=intOrder, 4=ID_TBLCONFIGHEADERLOOKUP
                idT = arrLater(1, Count2)
                strUL = arrLater(2, Count2)
                intOrder = arrLater(3, Count2)
                idCFL = arrLater(4, Count2)
                intIncl = arrLater(5, Count2)

                strF2 = "ID_TBLCONFIGREPORTTABLES = " & idT & " AND CHARUSERLABEL = '" & strUL & "' AND ID_TBLSTUDIES = " & idTStudies
                rs3.Filter = ""
                rs3.Filter = strF2

                'Can't evaluate because rs3.con hasn't been updated
                'If rs3.RecordCount = 0 Then

                'ID_TBLREPORTTABLEHEADERCONFIG	ID_TBLSTUDIES	ID_TBLCONFIGREPORTTABLES	ID_TBLCONFIGHEADERLOOKUP	CHARUSERLABEL	INTORDER	BOOLINCLUDE	UPSIZE_TS
                '4741	65	38	205	Reported Conc. (ng/g)	14	-1	date

                maxID = maxID + 1

                var1 = maxID
                var2 = idTStudies
                var3 = idT
                var4 = idCFL
                var5 = strUL
                var6 = intOrder
                var7 = intIncl

                Try

                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & "," & ReturnDate(dt) & ");"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & "," & ReturnDate(dt) & ");"
                    ElseIf boolSQLSer Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & "," & ReturnDate(dt) & ");"
                    End If

                    '''''''''''console.writeline(strSQL)
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    boolCont = False
                    var1 = ex.Message
                    var2 = var1
                End Try

                'End If

            Next

            rs1.MoveNext()

        Loop

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        If rs2.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs2.Close()
        End If

        If rs3.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs3.Close()
        End If

        If omaxID = maxID Then
        Else
            'Call PutMaxID("TBLREPORTTABLEHEADERCONFIG", maxID)
            rsM.Fields("NUMMAXID").Value = maxID
            rsM.ActiveConnection = con
            rsM.UpdateBatch()

        End If

        If rsM.State = ADODB.ObjectStateEnum.adStateOpen Then
            rsM.Close()
        End If

        rs1 = Nothing
        rs2 = Nothing
        rs3 = Nothing

        maxLater = maxID

        Pause(2) 'need to give database time to catch up for next subroutine

    End Sub

    Sub AddRecords_TBLREPORTTABLEHEADERCONFIG_RECOVERYTABLES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date = Now
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64
        Dim strF1 As String
        Dim strF2 As String
        Dim boolCont As Boolean = True
        Dim idTStudies As Int64

        Dim rs1 As New ADODB.Recordset
        Dim rs2 As New ADODB.Recordset
        Dim rs3 As New ADODB.Recordset
        Dim idS As Int64

        'AAACKK!! This code is repeating itself!!!
        'DOUBLE CHECK during testing!!!

        'need to pause here
        'seems to run without error, but no fields created
        Pause(2)

        'get maxid for TBLREPORTTABLEHEADERCONFIG
        'NOTE: for some reason during development, tblMaxID is coming from the dev StudyDoc_01
        'must use recordset
        'maxID = GetMaxID("TBLREPORTTABLEHEADERCONFIG")
        Dim rsM As New ADODB.Recordset
        rsM.CursorLocation = CursorLocationEnum.adUseClient
        rsM.Open("TBLMAXID", con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rsM.ActiveConnection = Nothing
        strF1 = "CHARTABLE = 'TBLREPORTTABLEHEADERCONFIG'"
        rsM.Filter = strF1
        maxID = rsM.Fields("NUMMAXID").Value
        omaxID = maxID

        'get current studies
        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open("TBLSTUDIES", con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs1.ActiveConnection = Nothing

        'ID_TBLREPORTTABLEHEADERCONFIG	ID_TBLSTUDIES	ID_TBLCONFIGREPORTTABLES	ID_TBLCONFIGHEADERLOOKUP	CHARUSERLABEL	INTORDER	BOOLINCLUDE	UPSIZE_TS
        '4741	65	38	205	Reported Conc. (ng/g)	14	-1	date


        str1 = "SELECT TBLCONFIGHEADERLOOKUP.* FROM TBLCONFIGHEADERLOOKUP;"
        'str2 = "WHERE ID_TBLCONFIGREPORTTABLES = 30;"
        strSQL = str1

        rs2.CursorLocation = CursorLocationEnum.adUseClient
        rs2.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs2.ActiveConnection = Nothing

        str1 = "SELECT TBLREPORTTABLEHEADERCONFIG.* FROM TBLREPORTTABLEHEADERCONFIG;"
        strSQL = str1
        rs3.CursorLocation = CursorLocationEnum.adUseClient
        rs3.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs3.ActiveConnection = Nothing

        strT = "TBLREPORTTABLEHEADERCONFIG"
        dt = Now

        Dim idCFL As Int64
        Dim strUL As String
        Dim boolGoCheck As Boolean = False
        Dim intNumA As Short
        Dim idT As Short
        Dim intOrder As Short
        Dim intOrderStart As Short
        Dim intIncl As Short

        Do Until rs1.EOF

            idTStudies = rs1.Fields("ID_TBLSTUDIES").Value

            For Count2 = 1 To intLater

                '1=idT, 2=userlabel, 3=intOrder, 4=ID_TBLCONFIGHEADERLOOKUP
                idT = arrLater(1, Count2)
                strUL = arrLater(2, Count2)
                intOrder = arrLater(3, Count2)
                idCFL = arrLater(4, Count2)
                intIncl = arrLater(5, Count2)

                strF2 = "ID_TBLCONFIGREPORTTABLES = " & idT & " AND CHARUSERLABEL = '" & strUL & "' AND ID_TBLSTUDIES = " & idTStudies
                rs3.Filter = ""
                rs3.Filter = strF2

                If rs3.RecordCount = 0 Then

                    'ID_TBLREPORTTABLEHEADERCONFIG	ID_TBLSTUDIES	ID_TBLCONFIGREPORTTABLES	ID_TBLCONFIGHEADERLOOKUP	CHARUSERLABEL	INTORDER	BOOLINCLUDE	UPSIZE_TS
                    '4741	65	38	205	Reported Conc. (ng/g)	14	-1	date

                    maxID = maxID + 1

                    var1 = maxID
                    var2 = idTStudies
                    var3 = idT
                    var4 = idCFL
                    var5 = strUL
                    var6 = intOrder
                    var7 = intIncl


                    Try

                        If boolAccess Then
                            strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & "," & ReturnDate(dt) & ");"
                        ElseIf boolOra Then
                            strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & "," & ReturnDate(dt) & ");"
                        ElseIf boolSQLSer Then
                            strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & "," & ReturnDate(dt) & ");"
                        End If

                        '''''''''''console.writeline(strSQL)
                        cmd.CommandText = strSQL
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = str1 & " executed successfully."
                        boolCont = True

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        boolCont = False
                        var1 = ex.Message
                        var2 = var1
                    End Try

                End If

            Next

            rs1.MoveNext()

        Loop

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        If rs2.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs2.Close()
        End If

        If rs3.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs3.Close()
        End If

        If omaxID = maxID Then
        Else
            'Call PutMaxID("TBLREPORTTABLEHEADERCONFIG", maxID)
            rsM.Fields("NUMMAXID").Value = maxID
            rsM.ActiveConnection = con
            rsM.UpdateBatch()

        End If
        numLater = maxID

        If rsM.State = ADODB.ObjectStateEnum.adStateOpen Then
            rsM.Close()
        End If

        rs1 = Nothing
        rs2 = Nothing
        rs3 = Nothing

        Pause(2) 'need to give database time to catch up for next subroutine

    End Sub

    Sub AddRecords_TBLCONFIGHEADERLOOKUP_RECOVERYTABLES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64

        'ANALYTICALRUNSAMPLE.ASSAYDATETIME

        '        ID_TBLCONFIGHEADERLOOKUP 214
        '        ID_TBLCONFIGREPORTTABLES 5
        '       CHARCOLUMNLABEL	Assay Date
        '        INTORDER 15
        '        CHARWATSONTABLE ANALYTICALRUNSAMPLE
        '        CHARWATSONFIELD ASSAYDATETIME
        '        BOOLDEFAULT 0
        '        UPSIZE_TS 1 - Mar - 6



        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now

        maxID = 219

        'see if record already exists
        Dim rs1 As New ADODB.Recordset

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > maxID Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing
        Pause(1) 'need to give database time to catch up for next subroutine

        intLater = 12

        For Count1 = 1 To intLater

            maxID = maxID + 1

            Select Case Count1

                Case 1
                    var1 = maxID
                    var2 = 13
                    var3 = "Extracted" & ChrW(10) & "QC Standard"
                    var4 = 1
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1
                Case 2
                    var1 = maxID
                    var2 = 13
                    var3 = "Recovery" & ChrW(10) & "Solution"
                    var4 = 2
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1
                Case 3
                    var1 = maxID
                    var2 = 13
                    var3 = "%" & ChrW(10) & "Recovery"
                    var4 = 3
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1


                Case 4
                    var1 = maxID
                    var2 = 14
                    var3 = "Extracted" & ChrW(10) & "QC Standard"
                    var4 = 1
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1
                Case 5
                    var1 = maxID
                    var2 = 14
                    var3 = "Post Extraction" & ChrW(10) & "Spike Solution"
                    var4 = 2
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1
                Case 6
                    var1 = maxID
                    var2 = 14
                    var3 = "%" & ChrW(10) & "Recovery"
                    var4 = 3
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1


                Case 7
                    var1 = maxID
                    var2 = 15
                    var3 = "Recovery" & ChrW(10) & "Solution"
                    var4 = 1
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1
                Case 8
                    var1 = maxID
                    var2 = 15
                    var3 = "Post Extraction" & ChrW(10) & "Spike Solution"
                    var4 = 2
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1
                Case 9
                    var1 = maxID
                    var2 = 15
                    var3 = "Suppression\" & ChrW(10) & "Enhancement"
                    var4 = 3
                    var5 = "NA"
                    var6 = "NA"
                    var7 = -1

                Case 10
                    var1 = maxID
                    var2 = 6
                    var3 = "Original" & "Conc."
                    var4 = 11
                    var5 = "NA"
                    var6 = "NA"
                    var7 = 0

                Case 11
                    var1 = maxID
                    var2 = 6
                    var3 = "Reassay" & "Conc."
                    var4 = 12
                    var5 = "NA"
                    var6 = "NA"
                    var7 = 0

                Case 12
                    var1 = maxID
                    var2 = 6
                    var3 = "Reported" & "Conc."
                    var4 = 13
                    var5 = "NA"
                    var6 = "NA"
                    var7 = 0

            End Select

            arrLater(1, Count1) = var2
            arrLater(2, Count1) = var3
            arrLater(3, Count1) = var4
            arrLater(4, Count1) = maxID
            arrLater(5, Count1) = var7

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & "," & ReturnDate(dt) & ");"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & "," & ReturnDate(dt) & ");"
                ElseIf boolSQLSer Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & "," & ReturnDate(dt) & ");"
                End If

                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
                var1 = ex.Message
                var2 = var1
            End Try


        Next

end1:

        Pause(2) 'need to give database time to catch up for next subroutine

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLRECSIGFIG(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date = Now
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim int1 As Short
        Dim int2 As Int16
        Dim int3 As Int16
        Dim strF As String


        strT = "TBLDATATABLEROWTITLES"

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1.CursorLocation = CursorLocationEnum.adUseClient

        'check to see if this has been run
        str1 = "SELECT TBLDATATABLEROWTITLES.* "
        str2 = "FROM TBLDATATABLEROWTITLES;"
        strSQL = str1 & str2

        Try
            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If
            rs1.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        rs1.ActiveConnection = Nothing


        For Count1 = 1 To 35

            'ID_TBLDATATABLEROWTITLES	CHARDATATABLENAME	CHARROWNAME	INTORDER	CHARTABLEREF	CHARTABLEREFCOLUMNNAME	BOOLINCLUDE	UPSIZE_TS	CHARHOOK

            'NUMSIGFIGSAREARATIO
            'BOOLUSESIGFIGSAREARATIO
            'BOOLUSESPECRNDAREARATIO


            Select Case Count1

                Case 1
                    int1 = 554
                    str1 = "Use SigFigs/Decimals for Recovery/MatrixFactor values"
                    int2 = 44
                    str2 = "BOOLRECSIGFIG"
                    str3 = "tblCompanyData"
                    str4 = "tblData"

                Case 2
                    int1 = 555
                    str1 = "Create individual Recovery/MatrixFactor values"
                    int2 = 1
                    str2 = "BOOLDOINDREC"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3

                Case 3 '20161021 LEE: Not executing for some reason
                    int1 = 556
                    str1 = "Combine all Int Std data into one level"
                    int2 = 1
                    str2 = "BOOLISCOMBINELEVELS"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3


                    'now add for new tblAutoAssignSamples
                Case 4
                    int1 = 557
                    str1 = "Auto Assign Samples Label: Use Standard QC Label Conventions"
                    int2 = 1
                    str2 = "BOOLUSESTDCOLLABELS"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 5
                    int1 = 558
                    str1 = "Auto Assign Samples Label: Post-Extraction Spike Solution"
                    int2 = 1
                    str2 = "CHARRECPES"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 6
                    int1 = 559
                    str1 = "Auto Assign Samples Label: Recovery Solution"
                    int2 = 1
                    str2 = "CHARRECRS"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 7
                    int1 = 560
                    str1 = "Auto Assign Samples Label: Extracted QC Standard"
                    int2 = 1
                    str2 = "CHARRECQC"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 8
                    int1 = 561
                    str1 = "Auto Assign Samples Label: Lot 1"
                    int2 = 1
                    str2 = "CHARLOT1"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 9
                    int1 = 562
                    str1 = "Auto Assign Samples Label: Lot 2"
                    int2 = 1
                    str1 = "CHARLOT2"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 10
                    int1 = 563
                    str1 = "Auto Assign Samples Label: Lot 3"
                    int2 = 1
                    str2 = "CHARLOT3"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 11
                    int1 = 564
                    str1 = "Auto Assign Samples Label: Lot 4"
                    int2 = 1
                    str2 = "CHARLOT4"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 12
                    int1 = 565
                    str1 = "Auto Assign Samples Label: Lot 5"
                    int2 = 1
                    str2 = "CHARLOT5"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 13
                    int1 = 566
                    str1 = "Auto Assign Samples Label: Lot 6"
                    int2 = 1
                    str2 = "CHARLOT6"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 14
                    int1 = 567
                    str1 = "Auto Assign Samples Label: Lot 7"
                    int2 = 1
                    str2 = "CHARLOT7"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 15
                    int1 = 568
                    str1 = "Auto Assign Samples Label: Lot 8"
                    int2 = 1
                    str2 = "CHARLOT8"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 16
                    int1 = 569
                    str1 = "Auto Assign Samples Label: Lot 9"
                    int2 = 1
                    str2 = "CHARLOT9"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 17
                    int1 = 570
                    str1 = "Auto Assign Samples Label: Lot 10"
                    int2 = 1
                    str2 = "CHARLOT10"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 18
                    int1 = 571
                    str1 = "Auto Assign Samples Label: Dilution QC Samples"
                    int2 = 1
                    str2 = "CHARDILN"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 19
                    int1 = 572
                    str1 = "Auto Assign Samples Label: Dilution QC Samples Dilution Factor (Ignore if there is only one Dilution QC table in this study)"
                    int2 = 1
                    str2 = "CHARDILNFACTOR"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 20
                    int1 = 573
                    str1 = "Auto Assign Samples Label: Calibration Standards"
                    int2 = 1
                    str2 = "CHARCALSTD"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 21
                    int1 = 574
                    str1 = "Auto Assign Samples Label: Non Intra/Inter Run QC"
                    int2 = 1
                    str2 = "CHARNONCOREQC"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 22
                    int1 = 575
                    str1 = "Auto Assign Samples Label: Intra/Inter Run QC"
                    int2 = 1
                    str2 = "CHARCOREQC"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 23
                    int1 = 576
                    str1 = "Auto Assign Samples Label: Old or First Measurement"
                    int2 = 1
                    str2 = "CHAROLD"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 24
                    int1 = 577
                    str1 = "Auto Assign Samples Label: New or Second Measurement"
                    int2 = 1
                    str2 = "CHARNEW"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 25
                    int1 = 578
                    str1 = "Auto Assign Samples Label: LLOQ"
                    int2 = 1
                    str2 = "CHARLLOQ"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 26
                    int1 = 579
                    str1 = "Auto Assign Samples Label: ULOQ"
                    int2 = 1
                    str2 = "CHARULOQ"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 27
                    int1 = 580
                    str1 = "Auto Assign Samples Label: Blank"
                    int2 = 1
                    str2 = "CHARBLANK"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 28
                    int1 = 581
                    str1 = "Auto Assign Samples Label: Stock Solution Concentration (Optional)"
                    int2 = 1
                    str2 = "CHARSTOCKSOLNCONC"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 29
                    int1 = 582
                    str1 = "Auto Assign Samples Label: Run Identifier 1 (Optional)"
                    int2 = 1
                    str2 = "CHARRUNIDENTIFIER1"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 30
                    int1 = 583
                    str1 = "Auto Assign Samples Label: Run Identifier 2 (Optional)"
                    int2 = 1
                    str2 = "CHARRUNIDENTIFIER2"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 31
                    int1 = 584
                    str1 = "Auto Assign Samples Label: Sample Type"
                    int2 = 1
                    str2 = "CHARSAMPLETYPE"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 32
                    int1 = 585
                    str1 = "Auto Assign Samples Label: Text contained in Analytical Run Description 1"
                    int2 = 1
                    str2 = "CHARRUNDESCR1"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 33
                    int1 = 586
                    str1 = "Auto Assign Samples Label: Text contained in Analytical Run Description 2"
                    int2 = 1
                    str2 = "CHARRUNDESCR2"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3


                    'do one more tblTableProperties
                Case 34 '20161021 LEE: Not executing for some reason
                    int1 = 587
                    str1 = "Use letters for [Reason for Reported Conc.] column and legend"
                    int2 = 1
                    str2 = "BOOLREASSAYREASLETTERS"
                    str3 = "TBLTABLEPROPERTIES"
                    str4 = str3

                Case 35
                    int1 = 588
                    str1 = "Query ONLY analytical runs with Accepted regression"
                    int2 = 1
                    str2 = "BOOLACCEPTEDONLY"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3

            End Select


            'check to see if data needs to be modified
            strF = "CHARTABLEREFCOLUMNNAME = '" & str2 & "' AND CHARDATATABLENAME = '" & str3 & "'"
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then 'continue
            Else
                GoTo next1
            End If

            rs1.Filter = ""


            strSQL = "INSERT INTO " & strT & " VALUES(" & int1 & ", '" & str3 & "', '" & str1 & "', " & int2 & ", '" & str4 & "', '" & str2 & "', -1, " & ReturnDate(dt) & ", NULL)"

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = strM & ChrW(10) & ChrW(10)
                strM = strM & ex.Message
                boolCont = False
            End Try

next1:

        Next

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing

    End Sub

    Sub AddFields_TBLDATA_BOOLRECSIGFIG(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 4
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLRECSIGFIG"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
                    strU = "."

                Case 2
                    strF = "BOOLDOINDREC"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    intText = 100
                    strU = ""

                Case 3
                    strF = "BOOLISCOMBINELEVELS"
                    numU = -1
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    intText = 100
                    strU = ""

                Case 4
                    strF = "BOOLREASSAYREASLETTERS"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    intText = 100
                    strU = ""

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLPERMISSIONS_01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim intU As Short

        boolAdd = False
        For Count2 = 1 To 8
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLALLOWRTEMPLATEPRINT"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 255
                    boolAdd = True
                    intU = -1

                Case 2
                    strF = "BOOLALLOWFINALREPORTPRINT"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 255
                    boolAdd = True
                    intU = -1

                Case 3
                    strF = "BOOLALLOWFINALREPORTWORD"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 255
                    boolAdd = True
                    intU = -1

                Case 4
                    strF = "BOOLALLOWREPORTTEMPLATEWORD"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 255
                    boolAdd = True
                    intU = -1

                Case 5
                    strF = "BOOLVIEWFINALREPORT"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 255
                    boolAdd = True
                    intU = -1

                Case 6
                    strF = "BOOLALLOWREPORTTEMPLATEPDF"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 255
                    boolAdd = True
                    intU = -1

                Case 7
                    strF = "BOOLEDITFINALREPORT"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 255
                    boolAdd = True
                    intU = -1

                Case 8
                    strF = "BOOLFORCEFINALREPORTPDF"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 255
                    boolAdd = True
                    intU = 0


                    'BOOLALLOWRTEMPLATEPRINT
                    'BOOLALLOWFINALREPORTPRINT
                    'BOOLALLOWFINALREPORTWORD
                    'BOOLALLOWREPORTTEMPLATEWORD
                    'BOOLVIEWFINALREPORT
                    'BOOLALLOWREPORTTEMPLATEPDF
                    'BOOLEDITFINALREPORT
                    'BOOLFORCEFINALREPORTPDF



            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = True

            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = False
                    Exit For
                End If
            Next


            If boolCont Then 'field needs to be added
                boolAdd = True

                rs1.Close()
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'strSQL = "UPDATE " & strT & " SET " & strF & " = 'Administrator' WHERE ID_TBLPERMISSIONS = 1"
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & intU
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub ModifyRecords_DataTableRowTitlesSort_01(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 13

            strF = "CHARDATATABLENAME"
            strF1 = "ID_TBLDATATABLEROWTITLES"
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200

            str3 = ""
            Select Case Count2

                'order stuff in Report Template
                Case 1
                    str1 = "521" 'Edit Word Templates
                    str2 = "1"
                    strF = "INTORDER"
                Case 2
                    str1 = "522" 'View Word Templates
                    str2 = "2"
                    strF = "INTORDER"
                Case 3
                    str1 = "544" 'Allow Report Template Open in Word
                    str2 = "3"
                    strF = "INTORDER"
                Case 4
                    str1 = "548" 'Allow Report Template Open in PDF
                    str2 = "4"
                    strF = "INTORDER"
                Case 5
                    str1 = "538" 'Allow Report Template Print
                    str2 = "5"
                    strF = "INTORDER"


                    'order stuff in Final Report 
                Case 6
                    str1 = "185" 'Allow report generation
                    str2 = "1"
                    strF = "INTORDER"
                Case 7
                    str1 = "516" 'Force Watermarks
                    str2 = "2"
                    strF = "INTORDER"
                Case 8
                    str1 = "552" 'Force PDF
                    str2 = "3"
                    strF = "INTORDER"
                Case 9
                    str1 = "550" 'Edit Reports
                    str2 = "4"
                    strF = "INTORDER"
                Case 10
                    str1 = "546" 'View Reports
                    str2 = "5"
                    strF = "INTORDER"
                Case 11
                    str1 = "542" 'Allow open in word
                    str2 = "6"
                    strF = "INTORDER"
                Case 12
                    str1 = "206" 'Allow open in PDF
                    str2 = "7"
                    strF = "INTORDER"
                Case 13
                    str1 = "540" 'Allow print
                    str2 = "8"
                    strF = "INTORDER"

            End Select




            'rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            'If rs1.EOF And rs1.BOF Then
            'Else
            '    rs1.MoveFirst()
            'End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE " & strF1 & " = " & str1 & ";"



            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            '    rs1.Close()
            'End If

        Next
        'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
        '    rs1.Close()
        'End If
        'rs1 = Nothing


    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_PERMISSIONSREPORTTEMPLATEFINALREPORT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date = Now
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim int1 As Short
        Dim int2 As Int16
        Dim int3 As Int16
        Dim strF As String

        Dim boolNull As Boolean

        strT = "TBLDATATABLEROWTITLES"

        For Count1 = 1 To 16

            'ID_TBLDATATABLEROWTITLES	CHARDATATABLENAME	CHARROWNAME	INTORDER	CHARTABLEREF	CHARTABLEREFCOLUMNNAME	BOOLINCLUDE	UPSIZE_TS	CHARHOOK

            'NUMSIGFIGSAREARATIO
            'BOOLUSESIGFIGSAREARATIO
            'BOOLUSESPECRNDAREARATIO


            Select Case Count1

                Case 1
                    int1 = 538
                    str1 = "Allow Report Template Print"
                    int2 = 26
                    str2 = "BOOLALLOWRTEMPLATEPRINT"
                    str3 = "tblPermissionsReportTemplate"
                    boolNull = True
                    str4 = "TBLPERMISSIONS"

                Case 2
                    int1 = 539
                    str1 = "Allow Report Template Print?"
                    int2 = 26
                    str2 = "BOOLALLOWRTEMPLATEPRINT"
                    str3 = "TBLPERMISSIONS"
                    boolNull = False
                    str4 = "TBLPERMISSIONS"


                Case 3
                    int1 = 540
                    str1 = "Allow Report Print"
                    int2 = 26
                    str2 = "BOOLALLOWFINALREPORTPRINT"
                    str3 = "tblPermissionsFinalReport"
                    boolNull = True
                    str4 = "TBLPERMISSIONS"

                Case 4
                    int1 = 541
                    str1 = "Allow Report Print?"
                    int2 = 26
                    str2 = "BOOLALLOWFINALREPORTPRINT"
                    str3 = "TBLPERMISSIONS"
                    boolNull = False
                    str4 = "TBLPERMISSIONS"


                Case 5
                    int1 = 542
                    str1 = "Allow Report Open in Word"
                    int2 = 27
                    str2 = "BOOLALLOWFINALREPORTWORD"
                    str3 = "tblPermissionsFinalReport"
                    boolNull = True
                    str4 = "TBLPERMISSIONS"

                Case 6
                    int1 = 543
                    str1 = "Allow Report Open in Word?"
                    int2 = 27
                    str2 = "BOOLALLOWFINALREPORTWORD"
                    str3 = "TBLPERMISSIONS"
                    boolNull = False
                    str4 = "TBLPERMISSIONS"

                Case 7
                    int1 = 544
                    str1 = "Allow Report Template Open in Word"
                    int2 = 25
                    str2 = "BOOLALLOWREPORTTEMPLATEWORD"
                    str3 = "tblPermissionsReportTemplate"
                    boolNull = True
                    str4 = "TBLPERMISSIONS"

                Case 8
                    int1 = 545
                    str1 = "Allow Report Template Open in Word?"
                    int2 = 25
                    str2 = "BOOLALLOWREPORTTEMPLATEWORD"
                    str3 = "TBLPERMISSIONS"
                    boolNull = False
                    str4 = "TBLPERMISSIONS"


                Case 9
                    int1 = 546
                    str1 = "View Reports"
                    int2 = 29
                    str2 = "BOOLVIEWFINALREPORT"
                    str3 = "tblPermissionsFinalReport"
                    boolNull = True
                    str4 = "TBLPERMISSIONS"

                Case 10
                    int1 = 547
                    str1 = "View Reports?"
                    int2 = 30
                    str2 = "BOOLVIEWFINALREPORT"
                    str3 = "TBLPERMISSIONS"
                    boolNull = False
                    str4 = "TBLPERMISSIONS"


                Case 11
                    int1 = 548
                    str1 = "Allow Report Template Open in PDF"
                    int2 = 25
                    str2 = "BOOLALLOWREPORTTEMPLATEPDF"
                    str3 = "tblPermissionsReportTemplate"
                    boolNull = True
                    str4 = "TBLPERMISSIONS"

                Case 12
                    int1 = 549
                    str1 = "Allow Report Template Open in PDF?"
                    int2 = 25
                    str2 = "BOOLALLOWREPORTTEMPLATEPDF"
                    str3 = "TBLPERMISSIONS"
                    boolNull = False
                    str4 = "TBLPERMISSIONS"


                Case 13
                    int1 = 550
                    str1 = "Edit Reports"
                    int2 = 29
                    str2 = "BOOLEDITFINALREPORT"
                    str3 = "tblPermissionsFinalReport"
                    boolNull = True
                    str4 = "TBLPERMISSIONS"

                Case 14
                    int1 = 551
                    str1 = "Edit Reports?"
                    int2 = 30
                    str2 = "BOOLEDITFINALREPORT"
                    str3 = "TBLPERMISSIONS"
                    boolNull = False
                    str4 = "TBLPERMISSIONS"

                Case 15
                    int1 = 552
                    str1 = "Force Report as PDF"
                    int2 = 29
                    str2 = "BOOLFORCEFINALREPORTPDF"
                    str3 = "tblPermissionsFinalReport"
                    boolNull = True
                    str4 = "TBLPERMISSIONS"

                Case 16
                    int1 = 553
                    str1 = "Force Report as PDF?"
                    int2 = 30
                    str2 = "BOOLFORCEFINALREPORTPDF"
                    str3 = "TBLPERMISSIONS"
                    boolNull = False
                    str4 = "TBLPERMISSIONS"

            End Select

            Try

                'ReturnDate
                If boolNull Then
                    strSQL = "INSERT INTO " & strT & " VALUES(" & int1 & ", '" & str3 & "', '" & str1 & "', " & int2 & ", NULL, '" & str2 & "', -1, " & ReturnDate(dt) & ", NULL)"
                Else
                    strSQL = "INSERT INTO " & strT & " VALUES(" & int1 & ", '" & str3 & "', '" & str1 & "', " & int2 & ", '" & str4 & "', '" & str2 & "', -1, " & ReturnDate(dt) & ", NULL)"
                End If

                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = strM & ChrW(10) & ChrW(10)
                strM = strM & ex.Message
                boolCont = False
            End Try

        Next

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing

    End Sub

    Sub ModifyRecords_DataTableRowTitles_01(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 9

            strF = "CHARDATATABLENAME"
            strF1 = "ID_TBLDATATABLEROWTITLES"
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200

            str3 = ""
            Select Case Count2
                Case 1
                    str1 = "189"
                    str2 = "tblPermissions"
                Case 2
                    str1 = "521"
                    str2 = "tblPermissionsReportTemplate"
                Case 3
                    str1 = "522"
                    str2 = "tblPermissionsReportTemplate"
                Case 4
                    str1 = "206"
                    str2 = "tblPermissionsFinalReport"
                Case 5
                    str1 = "516"
                    str2 = "tblPermissionsFinalReport"

                Case 6
                    str1 = "185"
                    str2 = "tblPermissionsFinalReport"

                Case 7
                    str1 = "185"
                    str2 = "Allow Report Generation"
                    strF = "CHARROWNAME"
                    'Allow Word Report Generation

                Case 8
                    str1 = "206"
                    str2 = "Allow Report Open in PDF"
                    strF = "CHARROWNAME"
                    'Allow PDF Report Generation

                Case 9
                    str1 = "313"
                    str2 = "Allow editing on the Report Writer Administration - Allow Report Generation?"
                    strF = "CHARROWNAME"
                    'Allow editing on the Report Writer Administration - Allow Word Report Generation?


            End Select




            'rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            'If rs1.EOF And rs1.BOF Then
            'Else
            '    rs1.MoveFirst()
            'End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE " & strF1 & " = " & str1 & ";"



            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            '    rs1.Close()
            'End If

        Next
        'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
        '    rs1.Close()
        'End If
        'rs1 = Nothing


    End Sub

    Sub AddFields_TBLFINALREPORT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim boolText As Boolean

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "ID_TBLPERSONNEL"
                    numU = 0
                    strT = "TBLFINALREPORT"
                    numTy = 202
                    intText = 255
                    strU = "."
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                'no need to update records
                boolAdd = False

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLCONFIGHEADERLOOKUP_AnalRunDate(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64

        'ANALYTICALRUNSAMPLE.ASSAYDATETIME

        '        ID_TBLCONFIGHEADERLOOKUP 214
        '        ID_TBLCONFIGREPORTTABLES 5
        '       CHARCOLUMNLABEL	Assay Date
        '        INTORDER 15
        '        CHARWATSONTABLE ANALYTICALRUNSAMPLE
        '        CHARWATSONFIELD ASSAYDATETIME
        '        BOOLDEFAULT 0
        '        UPSIZE_TS 1 - Mar - 6



        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now

        maxID = 218

        'see if record already exists
        Dim rs1 As New ADODB.Recordset

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > maxID Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing
        Pause(1) 'need to give database time to catch up for next subroutine

        For Count1 = 1 To 1

            maxID = maxID + 1

            Select Case Count1

                Case 1
                    var1 = maxID
                    var2 = 5
                    var3 = "Analytical Run Date"
                    var4 = 16
                    var5 = "Analytical Run Date"
                    var6 = "RUNDATE"
                    var7 = 0

            End Select

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If

                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
                var1 = ex.Message
                var2 = var1
            End Try


        Next

end1:

        Pause(1) 'need to give database time to catch up for next subroutine

    End Sub

    Sub AddRecords_TBLMAXID_TBLFINALREPORT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 = 66 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 2

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLMAXID VALUES(65,'TBLFINALREPORT',1,#02-APR-16#)"
                Case 2
                    strSQL = "INSERT INTO TBLMAXID VALUES(66,'TBLFINALREPORTWORDDOCS',1,#02-APR-16#)"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddRecords_TBLTABLES_TBLFINALREPORT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTABLES"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 = 61 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 2

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTABLES VALUES(60,'TBLFINALREPORT')"
                Case 2
                    strSQL = "INSERT INTO TBLTABLES VALUES(61,'TBLFINALREPORTWORDDOCS')"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub CreateTable_TBLFINALREPORTWORDDOCS(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLFINALREPORTWORDDOCS"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'now add fields
                For Count1 = 1 To 6
                    If boolAccess Then
                        Select Case Count1
                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLFINALREPORT double"
                            Case 2
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES double"
                            Case 3
                                strSQL = "alter table " & strT & " ADD INTFINALREPORTVERSION int"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARREPORTTYPE text(100) NULL"
                            Case 5
                                strSQL = "alter table " & strT & " ADD CHARXML memo NULL"
                            Case 6
                                strSQL = "alter table " & strT & " ADD UPSIZE_TS date NULL"

                        End Select
                    Else
                        Select Case Count1
                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLFINALREPORT float"
                            Case 2
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES float"
                            Case 3
                                strSQL = "alter table " & strT & " ADD INTFINALREPORTVERSION real NULL"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARREPORTTYPE nvarchar2 NULL"
                            Case 5
                                strSQL = "alter table " & strT & " ADD CHARXML nvarchar2 NULL"
                            Case 6
                                strSQL = "alter table " & strT & " ADD UPSIZE_TS datetime NULL"

                        End Select

                    End If

                    '        If boolAccess Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " Single"
                    '        Else'If boolSQLServer Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " real"
                    '        End If
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                Next

            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)

    End Sub

    Sub CreateTable_TBLFINALREPORT(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLFINALREPORT"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'now add fields
                For Count1 = 1 To 12
                    If boolAccess Then
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES double"
                            Case 2
                                strSQL = "alter table " & strT & " ADD ID_TBLREPORTHISTORY double"
                            Case 3
                                strSQL = "alter table " & strT & " ADD ID_TBLREPORTS double"

                            Case 4
                                strSQL = "alter table " & strT & " ADD INTFINALREPORTVERSION int"
                            Case 5
                                strSQL = "alter table " & strT & " ADD CHARDESCRIPTION text(255) NULL"

                            Case 6
                                strSQL = "alter table " & strT & " ADD CHARCOMMENTS memo NULL"

                            Case 7
                                strSQL = "alter table " & strT & " ADD CHARREPORTTYPE text(100) NULL"

                            Case 8
                                strSQL = "alter table " & strT & " ADD BOOLLOCKED short NULL"

                            Case 9
                                strSQL = "alter table " & strT & " ADD ID_TBLPERSONNEL double"
                            Case 10
                                strSQL = "alter table " & strT & " ADD ID_TBLUSERACCOUNTS double"
                            Case 11
                                strSQL = "alter table " & strT & " ADD CHARUSERID text(255) NULL"

                            Case 12
                                strSQL = "alter table " & strT & " ADD UPSIZE_TS date NULL"

                        End Select
                    Else
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES float"
                            Case 2
                                strSQL = "alter table " & strT & " ADD ID_TBLREPORTHISTORY float"
                            Case 3
                                strSQL = "alter table " & strT & " ADD ID_TBLREPORTS float"

                            Case 4
                                strSQL = "alter table " & strT & " ADD INTFINALREPORTVERSION real NULL"
                            Case 5
                                strSQL = "alter table " & strT & " ADD CHARDESCRIPTION nvarchar2 NULL"

                            Case 6
                                strSQL = "alter table " & strT & " ADD CHARDESCRIPTION nvarchar2 NULL"


                            Case 7
                                strSQL = "alter table " & strT & " ADD CHARCOMMENTS nvarchar2 NULL"


                            Case 8
                                strSQL = "alter table " & strT & " ADD BOOLLOCKED smallint NULL"

                            Case 9
                                strSQL = "alter table " & strT & " ADD ID_TBLPERSONNEL float"
                            Case 10
                                strSQL = "alter table " & strT & " ADD ID_TBLUSERACCOUNTS float"
                            Case 11
                                strSQL = "alter table " & strT & " ADD CHARUSERID nvarchar2 NULL"

                            Case 12
                                strSQL = "alter table " & strT & " ADD UPSIZE_TS datetime NULL"

                        End Select

                    End If

                    '        If boolAccess Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " Single"
                    '        Else'If boolSQLServer Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " real"
                    '        End If
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                Next

            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)

    End Sub



    Sub AddFields_TBLWORDSTATEMENTSVERSIONS_IDS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim boolText As Boolean

        boolAdd = False
        For Count2 = 1 To 3
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "ID_TBLPERSONNEL"
                    numU = 0
                    strT = "TBLWORDSTATEMENTSVERSIONS"
                    numTy = 3
                    intText = 100
                    strU = "."
                    boolText = False

                Case 2
                    strF = "ID_TBLUSERACCOUNTS"
                    numU = 0
                    strT = "TBLWORDSTATEMENTSVERSIONS"
                    numTy = 3
                    intText = 100
                    strU = "."
                    boolText = False

                Case 3
                    strF = "CHARUSERID"
                    numU = 0
                    strT = "TBLWORDSTATEMENTSVERSIONS"
                    numTy = 202
                    intText = 255
                    strU = "."
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLCONFIGURATION_MDBLOCATION(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8, var9
        Dim intID As Int64

        strT = "TBLCONFIGURATION"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    intID = 32
                    var1 = "Global"
                    var2 = "Global Settings"
                    var3 = "Default archived study .mdb location"
                    var4 = "C:\LabIntegrity\StudyDoc\ArchivedMDBs\"
                    var5 = 18
                    var6 = 0
                    var7 = -1
                    var8 = 0
                    var9 = 0

            End Select

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If
                '''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddRecords_TBLCONFIGHEADERLOOKUP_AnalRunMatrix(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64

        'ANALYTICALRUNSAMPLE.ASSAYDATETIME

        '        ID_TBLCONFIGHEADERLOOKUP 214
        '        ID_TBLCONFIGREPORTTABLES 5
        '       CHARCOLUMNLABEL	Assay Date
        '        INTORDER 15
        '        CHARWATSONTABLE ANALYTICALRUNSAMPLE
        '        CHARWATSONFIELD ASSAYDATETIME
        '        BOOLDEFAULT 0
        '        UPSIZE_TS 1 - Mar - 6


        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now


        maxID = 215
        For Count1 = 1 To 3

            maxID = maxID + 1

            Select Case Count1

                Case 1
                    var1 = maxID
                    var2 = 1
                    var3 = "Matrix"
                    var4 = 10
                    var5 = "NA"
                    var6 = "NA"
                    var7 = 0

                Case 2
                    var1 = maxID
                    var2 = 1
                    var3 = "LLOQ"
                    var4 = 11
                    var5 = "NA"
                    var6 = "NA"
                    var7 = 0

                Case 3
                    var1 = maxID
                    var2 = 1
                    var3 = "ULOQ"
                    var4 = 12
                    var5 = "NA"
                    var6 = "NA"
                    var7 = 0

            End Select

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If

                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
                var1 = ex.Message
                var2 = var1
            End Try


        Next

        Pause(1) 'need to give database time to catch up for next subroutine

    End Sub

    Sub AddRecords_TBLCONFIGHEADERLOOKUP_RUNTYPE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64

        'ANALYTICALRUNSAMPLE.ASSAYDATETIME

        '        ID_TBLCONFIGHEADERLOOKUP 214
        '        ID_TBLCONFIGREPORTTABLES 5
        '       CHARCOLUMNLABEL	Assay Date
        '        INTORDER 15
        '        CHARWATSONTABLE ANALYTICALRUNSAMPLE
        '        CHARWATSONFIELD ASSAYDATETIME
        '        BOOLDEFAULT 0
        '        UPSIZE_TS 1 - Mar - 6


        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now


        maxID = 214
        For Count1 = 1 To 1

            maxID = maxID + 1

            Select Case Count1
                Case 1
                    var1 = maxID
                    var2 = 1
                    var3 = "Run Type"
                    var4 = 8
                    var5 = "NA"
                    var6 = "NA"
                    var7 = 0

            End Select

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If

                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
                var1 = ex.Message
                var2 = var1
            End Try


        Next

        Pause(1) 'need to give database time to catch up for next subroutine

    End Sub

    Sub AddRecords_TBLCONFIGHEADERLOOKUP_ASSAYDATETIME(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64

        'ANALYTICALRUNSAMPLE.ASSAYDATETIME

        '        ID_TBLCONFIGHEADERLOOKUP 214
        '        ID_TBLCONFIGREPORTTABLES 5
        '       CHARCOLUMNLABEL	Assay Date
        '        INTORDER 15
        '        CHARWATSONTABLE ANALYTICALRUNSAMPLE
        '        CHARWATSONFIELD ASSAYDATETIME
        '        BOOLDEFAULT 0
        '        UPSIZE_TS 1 - Mar - 6


        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now


        maxID = 213
        For Count1 = 1 To 1

            maxID = maxID + 1

            Select Case Count1
                Case 1
                    var1 = maxID
                    var2 = 5
                    var3 = "Assay Date"
                    var4 = 15
                    var5 = "ANALYTICALRUNSAMPLE"
                    var6 = "ASSAYDATETIME"
                    var7 = 0

            End Select

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If

                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
                var1 = ex.Message
                var2 = var1
            End Try


        Next

        Pause(1) 'need to give database time to catch up for next subroutine

    End Sub

    Sub AddFields_TBLASSIGNEDSAMPLES_INTANALYTEID(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim boolText As Boolean

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "INTANALYTEID"
                    numU = 0
                    strT = "TBLASSIGNEDSAMPLES"
                    numTy = 3
                    intText = 100
                    strU = "."
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLREPORTTABLEANALYTES_SETPRIMARYKEYS(ByVal frmUpdate As frmUpdateCheck, ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim strSQL As String
        Dim var1, var2
        Dim strM As String
        Dim strT As String
        Dim strF As String
        Dim strF1 As String
        Dim boolProb As Boolean
        Dim numU As Short
        Dim numTy As Short
        Dim intText As Short
        Dim boolText As Boolean
        Dim strU As String
        Dim str1 As String
        Dim str2 As String

        strT = "TBLREPORTTABLEANALYTES"
        strF = "ID_" & strT

        strF = "ID_TBLREPORTTABLEANALYTES"
        strF1 = "ID_TBLREPORTTABLEANALYTES1"
        numU = 0
        strT = "TBLREPORTTABLEANALYTES"
        numTy = 5
        intText = 100
        strU = "."
        boolText = False


        ' make new column
        strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
        cmd.CommandText = strSQL
        Try
            cmd.ExecuteNonQuery()
            var2 = "Hi"
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        Catch ex As Exception
            var1 = ex.Message.ToString
            var2 = var1
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
            'MsgBox(strM)

        End Try

        'update field
        strSQL = "UPDATE " & strT & " SET " & strT & "." & strF & " = " & strT & "." & strF1 & ";"
        cmd.CommandText = strSQL
        Try
            cmd.ExecuteNonQuery()
            var2 = "Hi"
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        Catch ex As Exception
            var1 = ex.Message.ToString
            var2 = var1
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
            'MsgBox(strM)

        End Try

        'now make column not null
        'ALTER TABLE MY_TABLE ALTER COLUMN STAGE INT NOT NULL
        strSQL = "ALTER TABLE " & strT & " ALTER COLUMN " & strF & " double NOT NULL;"
        cmd.CommandText = strSQL
        Try
            cmd.ExecuteNonQuery()
            var2 = "Hi"
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        Catch ex As Exception
            var1 = ex.Message.ToString
            var2 = var1
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
            'MsgBox(strM)

        End Try


        'NOW drop primary key
        strSQL = "ALTER TABLE " & strT & " DROP CONSTRAINT PK_" & strT & ";"
        cmd.CommandText = strSQL
        Try
            cmd.ExecuteNonQuery()
            var2 = "Hi"
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        Catch ex As Exception
            var1 = ex.Message.ToString
            var2 = var1
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
            'MsgBox(strM)

        End Try


        'now add new primary key

        'ALTER TABLE Persons
        'ADD CONSTRAINT pk_PersonID PRIMARY KEY (P_Id,LastName)

        str1 = frmUpdate.lbl1.Text
        str2 = str1 & ChrW(10) & "...This action will take a few moments..."
        frmUpdate.lbl1.Text = str2
        frmUpdate.lbl1.Refresh()

        strSQL = "alter table " & strT & " ADD CONSTRAINT PK_" & strF & " PRIMARY KEY (" & strF & ")"
        cmd.CommandText = strSQL
        Try
            cmd.ExecuteNonQuery()
            var2 = "Hi"
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        Catch ex As Exception
            var1 = ex.Message.ToString
            var2 = var1
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
            'MsgBox(strM)

        End Try

        'finally, delete strf1
        'ALTER TABLE Persons
        'DROP COLUMN DateOfBirth
        strSQL = "ALTER TABLE " & strT & " DROP COLUMN " & strF1
        cmd.CommandText = strSQL
        Try
            cmd.ExecuteNonQuery()
            var2 = "Hi"
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        Catch ex As Exception
            var1 = ex.Message.ToString
            var2 = var1
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
            'MsgBox(strM)

        End Try
        var1 = var1


    End Sub

    Sub ModifyRecords_TBLREPORTTABLEANALYTES_ID_TBLREPORTTABLEANALYTES1(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand, constr As String)

        'this will make id_ a primary key

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.Open(constr)
        Pause(1)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim int2 As Int64
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim boolText As Boolean


        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "ID_TBLREPORTTABLEANALYTES1"
                    numU = 0
                    strT = "TBLREPORTTABLEANALYTES"
                    numTy = 5
                    intText = 100
                    strU = "."
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont Then 'field exists and needs to have data added to it

                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next


                If boolAdd Then 'update records


                    Dim rsAA As New ADODB.Recordset

                    'must loop records
                    'return max records from strt

                    Dim CountAAA As Int64
                    'puts a lock on table

                    'strSQL = "SELECT " & strT & "." & strF & " FROM " & strT & ";"
                    strSQL = "SELECT " & strT & ".* FROM " & strT & ";"
                    Try
                        rsAA.Open(strSQL, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                        int2 = 0
                        For CountAAA = 1 To intRecs
                            int2 = int2 + 1
                            Try
                                rsAA.Fields(strF).Value = int2
                                rsAA.Update()
                                rsAA.UpdateBatch()
                                rsAA.MoveNext()
                            Catch ex As Exception

                                Pause(0.25)
                                Try
                                    If rsAA.State = ADODB.ObjectStateEnum.adStateOpen Then
                                        rsAA.Close()
                                    End If
                                Catch ex1 As Exception
                                    var1 = ex1.Message
                                End Try
                                'need to pause here to allow recordset to close
                                Pause(0.5)

                                'strF is set to intrecs in previous subroutine
                                strSQL = "SELECT " & strT & ".* FROM " & strT & " WHERE " & strF & " = " & intRecs & ";"
                                Try
                                    rsAA.Open(strSQL, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                                    rsAA.Fields(strF).Value = int2
                                    rsAA.Update()
                                    rsAA.UpdateBatch()
                                    rsAA.MoveNext()
                                Catch ex1 As Exception
                                    var1 = ex1.Message
                                End Try

                            End Try
                           
                        Next

                        '20160426 LEE:
                        'if intRecs > 7303, get a 'lock count exceeded' error

                        'need to pause here for two seconds to allow recordset to close
                        Pause(2)

                    Catch ex As Exception
                        var1 = ex.Message
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message & ChrW(10) & "int1 = " & int1
                        'MsgBox(ex.Message)

                    End Try

                    Try
                        If rsAA.State = ADODB.ObjectStateEnum.adStateOpen Then
                            rsAA.Close()
                        End If
                        rsAA = Nothing
                    Catch ex As Exception
                        var1 = ex.Message
                    End Try
                 

                    'add this value to tblmax
                    strSQL = "UPDATE TBLMAXID SET NUMMAXID = " & intRecs & " WHERE CHARTABLE = '" & strT & "';"

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
                        'MsgBox(strM)

                    End Try



                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing



        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLREPORTTABLEANALYTES_ID_TBLREPORTTABLEANALYTES1(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        'this will make id_ a primary key

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim boolText As Boolean

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "ID_TBLREPORTTABLEANALYTES1"
                    numU = 0
                    strT = "TBLREPORTTABLEANALYTES"
                    numTy = 5
                    intText = 100
                    strU = "."
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
                    'MsgBox(strM)
                End Try

                If boolAdd Then 'update records

                    'return max records from strt

                    Try

                        Dim rsAA As New ADODB.Recordset
                        rsAA.CursorLocation = CursorLocationEnum.adUseClient

                        strSQL = "SELECT COUNT(*) AS NUMA FROM " & strT & ";"

                        rsAA.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
                        rsAA.ActiveConnection = Nothing

                        'intRecs is global
                        intRecs = rsAA.Fields("NUMA").Value
                        rsAA.Close()

                        'need to pause here for two seconds to allow recordset to close
                        Pause(2)

                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        If rsAA.State = ADODB.ObjectStateEnum.adStateOpen Then
                            rsAA.Close()
                        End If
                        rsAA = Nothing

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
                        'MsgBox(strM)
                    End Try

                    'first make some value
                    strSQL = "UPDATE " & strT & " SET " & strF & " =  " & intRecs & ";"

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
                        'MsgBox(strM)

                    End Try



                    ''return max records from strt

                    'Try


                    '    rsAA.CursorLocation = CursorLocationEnum.adUseClient

                    '    strSQL = "SELECT COUNT(*) AS NUMA FROM " & strT & ";"

                    '    rsAA.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
                    '    rsAA.ActiveConnection = Nothing

                    '    'intRecs is global
                    '    intRecs = rsAA.Fields("NUMA").Value
                    '    rsAA.Close()

                    '    'need to pause here for two seconds to allow recordset to close
                    '    Pause(2)

                    '    boolProb = False
                    '    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    'Catch ex As Exception
                    '    boolProb = True
                    '    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
                    '    'MsgBox(strM)
                    'End Try

              



                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLMAXID_TBLREPORTTABLEANALYTES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLMAXID VALUES(64,'TBLREPORTTABLEANALYTES',1,#31-JAN-16#)"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddFields_TBLREPORTTABLEANALYTES_INTGROUP(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim boolText As Boolean

        boolAdd = False
        For Count2 = 1 To 3
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "INTGROUP"
                    numU = 0
                    strT = "TBLREPORTTABLEANALYTES"
                    numTy = 2
                    intText = 100
                    strU = "."
                    boolText = False

                Case 2
                    strF = "INTGROUP"
                    numU = 0
                    strT = "TBLANALREFSTANDARDS"
                    numTy = 2
                    intText = 100
                    strU = "."
                    boolText = False

                Case 3
                    strF = "INTGROUP"
                    numU = 0
                    strT = "TBLASSIGNEDSAMPLES"
                    numTy = 2
                    intText = 100
                    strU = "."
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub CreateTable_TBLLOGIN(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLLOGIN"
        boolCont = False

        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        Catch ex As Exception


            If boolAccess Then
                str1 = "CREATE TABLE " & strT & " "
                str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
            Else 'If boolSQLServer Then
                str1 = "CREATE TABLE " & strT & " "
                str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
            End If

            strSQL = str1 & str2

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                'strM = """" & strSQL & """ Table " & strT & " create successfully."
                strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                'MsgBox(strM)
                boolCont = True

                'now add fields
                Dim strID As String
                For Count1 = 1 To 11
                    strID = ""
                    If boolAccess Then
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLUSERACCOUNTS double"
                                strID = "ID_TBLUSERACCOUNTS"
                            Case 2
                                strSQL = "alter table " & strT & " ADD DTATTEMPT date"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARCOMPUTER text(255)"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARIPADDRESS text(255)"
                            Case 5
                                strSQL = "alter table " & strT & " ADD CHARATTUSERID text(255)"
                            Case 6
                                strSQL = "alter table " & strT & " ADD BOOLSUCCESSUID short"
                            Case 7
                                strSQL = "alter table " & strT & " ADD BOOLSUCCESSPSWD short"
                            Case 8
                                strSQL = "alter table " & strT & " ADD BOOLSUCCESSLOGIN short"
                            Case 9
                                strSQL = "alter table " & strT & " ADD CHARCOMMENTS text(255)"
                            Case 10
                                strSQL = "alter table " & strT & " ADD DTLOGOFF date"
                            Case 11
                                strSQL = "alter table " & strT & " ADD DTTIMESTAMP date"

                        End Select
                    Else
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLUSERACCOUNTS float"
                                strID = "ID_TBLUSERACCOUNTS"
                            Case 2
                                strSQL = "alter table " & strT & " ADD DTATTEMPT datetime"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARCOMPUTER nvarchar2"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARIPADDRESS nvarchar2"
                            Case 5
                                strSQL = "alter table " & strT & " ADD CHARATTUSERID nvarchar2"
                            Case 6
                                strSQL = "alter table " & strT & " ADD BOOLSUCCESSUID smallint"
                            Case 7
                                strSQL = "alter table " & strT & " ADD BOOLSUCCESSPSWD smallint"
                            Case 8
                                strSQL = "alter table " & strT & " ADD BOOLSUCCESSLOGIN smallint"
                            Case 9
                                strSQL = "alter table " & strT & " ADD CHARCOMMENTS nvarchar2"
                            Case 10
                                strSQL = "alter table " & strT & " ADD DTLOGOFF datetime"
                            Case 11
                                strSQL = "alter table " & strT & " ADD DTTIMESTAMP datetime"

                        End Select
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                        intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If
                    Catch ex1 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If
                    End Try

                    'create index
                    If Len(strID) = 0 Then
                    Else
                        strSQL = "CREATE INDEX idx_" & strID & " ON " & strT & " (" & strID & ")"
                        cmd.CommandText = strSQL
                        Try
                            cmd.ExecuteNonQuery()

                        Catch ex3 As Exception

                        End Try
                    End If

                Next

            Catch ex2 As Exception
                boolProb = True
                'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                boolCont = False
            End Try

            intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'MUST RE-ESTABLISH CON
            If con.State = ADODB.ObjectStateEnum.adStateOpen Then
                con.Close()
            End If

            con.open(constr)
            Pause(1)


        End Try


    End Sub

    Sub AddRecords_TBLMAXID_TBLLOGIN(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLMAXID VALUES(63,'TBLLOGIN',1,#23-JAN-16#)"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddRecords_TBLTABLES_TBLLOGIN(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTABLES"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 60 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTABLES VALUES(59,'TBLLOGIN')"
            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddFields_TBLDATA_CHARCAPTIONTRAILER(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARCAPTIONTRAILER"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 202
                    intText = 100
                    strU = "."

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_CHARCAPTIONTRAILER(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim int1 As Short
        Dim int2 As Int16
        Dim int3 As Int16
        Dim strF As String


        strT = "TBLDATATABLEROWTITLES"

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1.CursorLocation = CursorLocationEnum.adUseClient

        'check to see if this has been run
        str1 = "SELECT TBLDATATABLEROWTITLES.* "
        str2 = "FROM TBLDATATABLEROWTITLES "
        str3 = "WHERE(((TBLDATATABLEROWTITLES.CHARDATATABLENAME) = 'tblCompanyData')) "
        str4 = "ORDER BY TBLDATATABLEROWTITLES.INTORDER;"
        strSQL = str1 & str2 & str3 & str4

        Try
            rs1.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        rs1.ActiveConnection = Nothing

        'check to see if data needs to be modified
        strF = "CHARTABLEREFCOLUMNNAME = 'CHARCAPTIONTRAILER'"
        rs1.Filter = ""
        rs1.Filter = strF
        If rs1.RecordCount = 0 Then 'continue
        Else
            GoTo end1
        End If

        rs1.Filter = ""


        For Count1 = 1 To 1

            'ID_TBLDATATABLEROWTITLES	CHARDATATABLENAME	CHARROWNAME	INTORDER	CHARTABLEREF	CHARTABLEREFCOLUMNNAME	BOOLINCLUDE	UPSIZE_TS	CHARHOOK

            'NUMSIGFIGSAREARATIO
            'BOOLUSESIGFIGSAREARATIO
            'BOOLUSESPECRNDAREARATIO


            Select Case Count1

                Case 1
                    int1 = 537
                    str1 = "Appendix/Figure/Table Caption Trailer"
                    int2 = 43
                    str2 = "CHARCAPTIONTRAILER"

            End Select

            strSQL = "INSERT INTO " & strT & " VALUES(" & int1 & ", 'tblCompanyData', '" & str1 & "', " & int2 & ", 'tblData', '" & str2 & "', -1, #23-JAN-16#, NULL)"

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = strM & ChrW(10) & ChrW(10)
                strM = strM & ex.Message
                boolCont = False
            End Try

        Next

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing

    End Sub

    Sub AddFields_TBLDATA_NUMSIGFIGSAREARATIO(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 3
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "NUMSIGFIGSAREARATIO"
                    numU = 5
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100

                Case 2
                    strF = "BOOLUSESIGFIGSAREARATIO"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
                Case 3
                    strF = "BOOLUSESPECRNDAREARATIO"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100



            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_TBLCOMPANYDATA_01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim int1 As Short
        Dim int2 As Int16
        Dim int3 As Int16
        Dim strF As String


        strT = "TBLDATATABLEROWTITLES"

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1.CursorLocation = CursorLocationEnum.adUseClient

        'check to see if this has been run
        str1 = "SELECT TBLDATATABLEROWTITLES.* "
        str2 = "FROM TBLDATATABLEROWTITLES "
        str3 = "WHERE(((TBLDATATABLEROWTITLES.CHARDATATABLENAME) = 'tblCompanyData')) "
        str4 = "ORDER BY TBLDATATABLEROWTITLES.INTORDER;"
        strSQL = str1 & str2 & str3 & str4

        Try
            rs1.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        rs1.ActiveConnection = Nothing

        'check to see if data needs to be modified
        strF = "CHARTABLEREFCOLUMNNAME = 'NUMSIGFIGSAREARATIO'"
        rs1.Filter = ""
        rs1.Filter = strF
        If rs1.RecordCount = 0 Then 'continue
        Else
            GoTo end1
        End If

        rs1.Filter = ""


        For Count1 = 1 To 3

            'ID_TBLDATATABLEROWTITLES	CHARDATATABLENAME	CHARROWNAME	INTORDER	CHARTABLEREF	CHARTABLEREFCOLUMNNAME	BOOLINCLUDE	UPSIZE_TS	CHARHOOK

            'NUMSIGFIGSAREARATIO
            'BOOLUSESIGFIGSAREARATIO
            'BOOLUSESPECRNDAREARATIO


            Select Case Count1

                Case 1
                    int1 = 534
                    str1 = "Peak Area Ratio Sig Figs/Decimals"
                    int2 = 16
                    str2 = "NUMSIGFIGSAREARATIO"
                Case 2
                    int1 = 535
                    str1 = "Peak Area Ratio: Use Sig Figs, not Decimals"
                    int2 = 17
                    str2 = "BOOLUSESIGFIGSAREARATIO"
                Case 3
                    int1 = 536
                    str1 = "Peak Area Ratio: Use Conc Special Rounding"
                    int2 = 18
                    str2 = "BOOLUSESPECRNDAREARATIO"
            End Select

            strSQL = "INSERT INTO " & strT & " VALUES(" & int1 & ", 'tblCompanyData', '" & str1 & "', " & int2 & ", 'tblData', '" & str2 & "', -1, #01-JAN-16#, NULL)"

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = strM & ChrW(10) & ChrW(10)
                strM = strM & ex.Message
                boolCont = False
            End Try

        Next

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing

    End Sub

    Sub ModifyFields_TBLDATATABLEROWTITLES_TBLCOMPANYDATA_RENUMBER_01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim intF As Short
        Dim strF1 As String
        Dim strF2 As String

        boolAdd = False



        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1.CursorLocation = CursorLocationEnum.adUseClient

        str1 = "SELECT TBLDATATABLEROWTITLES.* "
        str2 = "FROM TBLDATATABLEROWTITLES "
        str3 = "WHERE(((TBLDATATABLEROWTITLES.CHARDATATABLENAME) = 'tblCompanyData')) "
        str4 = "ORDER BY TBLDATATABLEROWTITLES.INTORDER;"
        strSQL = str1 & str2 & str3 & str4

        Try
            rs1.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        rs1.ActiveConnection = Nothing

        'check to see if data needs to be modified
        strF = "CHARTABLEREFCOLUMNNAME = 'NUMSIGFIGSAREARATIO'"
        rs1.Filter = ""
        rs1.Filter = strF
        If rs1.RecordCount = 0 Then 'continue
        Else
            GoTo end1
        End If

        rs1.Filter = ""

        rs1.MoveLast()


        'need to add three items above intorder=15
        strT = "TBLDATATABLEROWTITLES"
        strF1 = "INTORDER"

        Do Until rs1.BOF
            int2 = rs1.Fields("INTORDER").Value

            If int2 = 15 Then
                Exit Do
            End If

            int3 = int2 + 3

            strF = "CHARDATATABLENAME = 'tblCompanyData' AND INTORDER = " & int2
            strSQL = "UPDATE " & strT & " SET INTORDER = " & int3 & " WHERE " & strF

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            rs1.MovePrevious()
        Loop

end1:

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing

    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_01(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 1

            strF1 = "CHARROWNAME"
            strF2 = "CHARTABLEREFCOLUMNNAME"
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    str1 = "Peak Areas: Use Conc Special Rounding"
                    str2 = "BOOLUSESPECRNDAREA"

            End Select


            strM = strF
            boolProb = False
            boolCont = False

            strSQL = "UPDATE " & strT & " SET " & strF1 & " = '" & str1 & "' WHERE " & strF2 & " = '" & str2 & "';"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try


        Next


    End Sub

    Sub AddFields_TBLDATA_ROUNDCONV(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        'Rounding Conventions

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim boolText As Boolean
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 6
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLROUNDFIVEEVEN"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False

                Case 2
                    strF = "BOOLROUNDFIVEAWAY"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False

                Case 3
                    strF = "BOOLCRITFULLPREC"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False

                Case 4
                    strF = "BOOLCRITROUNDED"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False

                Case 5
                    strF = "BOOLMEANFULLPREC"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False

                Case 6
                    strF = "BOOLMEANROUNDED"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                var1 = fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = strM & ChrW(10) & ex.Message
                    MsgBox(strM, vbInformation, "Problem...")
                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub


    Sub ModifyRecords_TBLDROPDOWNBOXCONTENT_01(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLDROPDOWNBOXCONTENT"
        For Count2 = 1 To 1

            strF = "CHARVALUE"
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    str1 = "High Performance Liquid Chromatograhy - Mass Spectrometry"
                    str2 = "High Performance Liquid Chromatography - Mass Spectrometry"

            End Select


            strM = strF
            boolProb = False
            boolCont = False

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE " & strF & " = '" & str1 & "';"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try


        Next


    End Sub

    Sub AddFields_tblUserAccounts_dtLogonTime(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String

        Dim dtNow As Date = Now

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "DTLOGONTIME"
                    numU = 0
                    strT = "TBLUSERACCOUNTS"

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(7, boolAccess, boolSQLSer, boolOra, 0, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    boolAdd = False
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = strM & ChrW(10) & ex.Message
                    MsgBox(strM)
                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = #" & dtNow & "# WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        strM = strM & ChrW(10) & ex.Message
                        strM = strM

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_TBLTABLES_TBLSECTIONTEMPLATES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTABLES"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 60 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 8

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTABLES VALUES(51,'TBLCUSTOMFIELDCODE')"
                Case 2
                    strSQL = "INSERT INTO TBLTABLES VALUES(52,'TBLCONFIGCOMPLIANCE')"
                Case 3
                    strSQL = "INSERT INTO TBLTABLES VALUES(53,'TBLDATASYSTEM')"
                Case 4
                    strSQL = "INSERT INTO TBLTABLES VALUES(54,'TBLREASONFORCHANGE')"
                Case 5
                    strSQL = "INSERT INTO TBLTABLES VALUES(55,'TBLMEANINGOFSIG')"
                Case 6
                    strSQL = "INSERT INTO TBLTABLES VALUES(56,'TBLSAVEEVENT')"
                Case 7
                    strSQL = "INSERT INTO TBLTABLES VALUES(57,'TBLAUDITTRAIL')"
                Case 8
                    strSQL = "INSERT INTO TBLTABLES VALUES(58,'TBLSECTIONTEMPLATES')"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddRecords_TBLMAXID_TBLSECTIONTEMPLATES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLMAXID VALUES(62,'TBLSECTIONTEMPLATES',1,#28-MAY-15#)"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub CreateTable_TBLSECTIONTEMPLATES(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLSECTIONTEMPLATES"
        boolCont = False

        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        Catch ex As Exception


            If boolAccess Then
                str1 = "CREATE TABLE " & strT & " "
                str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
            Else 'If boolSQLServer Then
                str1 = "CREATE TABLE " & strT & " "
                str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
            End If

            strSQL = str1 & str2

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                'strM = """" & strSQL & """ Table " & strT & " create successfully."
                strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                'MsgBox(strM)
                boolCont = True

                'now add fields
                Dim strID As String
                For Count1 = 1 To 5
                    strID = ""
                    If boolAccess Then
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD CHARMODULE text(100)"
                            Case 2
                                strSQL = "alter table " & strT & " ADD CHARCONTROL text(100)"
                            Case 3
                                strSQL = "alter table " & strT & " ADD NUMVALUE single"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARSTRING text(255)"
                            Case 5
                                strSQL = "alter table " & strT & " ADD INTINDEX short"

                        End Select
                    ElseIf boolSQLSer Then
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD CHARMODULE nvarchar2"
                            Case 2
                                strSQL = "alter table " & strT & " ADD CHARCONTROL nvarchar2"
                            Case 3
                                strSQL = "alter table " & strT & " ADD NUMVALUE real"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARSTRING nvarchar2"
                            Case 5
                                strSQL = "alter table " & strT & " ADD INTINDEX smallint"


                        End Select
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                        intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If
                    Catch ex1 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If
                    End Try

                    'create index
                    If Len(strID) = 0 Then
                    Else
                        strSQL = "CREATE INDEX idx_" & strID & " ON " & strT & " (" & strID & ")"
                        cmd.CommandText = strSQL
                        Try
                            cmd.ExecuteNonQuery()

                        Catch ex3 As Exception

                        End Try
                    End If

                Next

            Catch ex2 As Exception
                boolProb = True
                'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                boolCont = False
            End Try

            intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'MUST RE-ESTABLISH CON
            If con.State = ADODB.ObjectStateEnum.adStateOpen Then
                con.Close()
            End If

            con.open(constr)
            Pause(1)


        End Try


    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLPSL(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        'TABLE SPECIFIC LEGEND

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 533
                    str1 = "tblCompanyData"
                    str2 = "Enable Page-Specific Legends"
                    var2 = 39
                    str3 = "TBLDATA"
                    str4 = "BOOLPSL"
                    var3 = -1

            End Select

            Try

                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddFields_TBLDATA_BOOLPSL(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        'TABLE SPECIFIC LEGEND

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim boolText As Boolean
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLPSL"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False


            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLCONFIGURATION_ETMANAGEMENT(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8, var9
        Dim intID As Int64

        strT = "TBLCONFIGURATION"
        dt = Now
        For Count1 = 1 To 2
            Select Case Count1
                Case 1
                    intID = 30
                    var1 = "Global"
                    var2 = "Global Settings"
                    var3 = "Enable Word" & ChrW(8482) & " template management."
                    var4 = "FALSE"
                    var5 = 17
                    var6 = 0
                    var7 = 0
                    var8 = 0
                    var9 = -1

                Case 2
                    intID = 31
                    var1 = "Global"
                    var2 = "Global Settings"
                    var3 = "Enable Generated Report management."
                    var4 = "FALSE"
                    var5 = 17
                    var6 = 0
                    var7 = 0
                    var8 = 0
                    var9 = -1

            End Select

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If
                '''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddRecords_TBLMAXID_TBLWORDSTATEMENTSVERSION(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 60 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLMAXID VALUES(61,'TBLWORDSTATEMENTSVERSIONS'," & tMaxID & ",#03-MAY-15#)"


            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddRecords_TBLTABLES_TBLWORDSTATEMENTSVERSION(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTABLES"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 60 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTABLES VALUES(50,'TBLWORDSTATEMENTSVERSIONS')"


            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub CreateTable_TBLWORDSTATEMENTSVERSIONS(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLWORDSTATEMENTSVERSIONS"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'ID_TBLWORDSTATEMENTS
                'INTWORDVERSION


                'now add fields
                For Count1 = 1 To 4
                    If boolAccess Then
                        Select Case Count1
                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLWORDSTATEMENTS double"
                            Case 2
                                strSQL = "alter table " & strT & " ADD INTWORDVERSION double"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARDESCRIPTION memo NULL"
                            Case 4
                                strSQL = "alter table " & strT & " ADD UPSIZE_TS date null"
                        End Select
                    Else
                        Select Case Count1
                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLWORDSTATEMENTS float NULL"
                            Case 2
                                strSQL = "alter table " & strT & " ADD INTWORDVERSION float NULL"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARDESCRIPTION nvarchar2 NULL"
                            Case 4
                                strSQL = "alter table " & strT & " ADD UPSIZE_TS date NULL"
                        End Select

                    End If

                    '        If boolAccess Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " Single"
                    '        Else'If boolSQLServer Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " real"
                    '        End If
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                Next

                'now add data

                Dim id As Int64
                Dim id1 As Int64
                Dim dt As Date = Now

                str1 = "tblWordStatements"
                rs5.CursorLocation = CursorLocationEnum.adUseClient
                rs5.Open(str1, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
                Dim arrID
                ReDim arrID(rs5.RecordCount)
                id1 = 0
                Do Until rs5.EOF
                    id1 = id1 + 1
                    id = rs5.Fields("ID_TBLWORDSTATEMENTS").Value
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & id1 & "," & id & ",1,'Original Entry',#" & dt & "#);"
                    Else
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & id1 & "," & id & ",1,'Original Entry',#" & dt & "#);"
                    End If
                    Try
                        cmd.commandtext = strSQL
                        cmd.executenonquery()
                    Catch ex1 As Exception
                        boolProb = True
                        strM = "There was a problem executing " & strSQL & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        boolCont = False
                    End Try

                    rs5.MoveNext()
                    'strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                Loop
                tMaxID = id1
                rs5.Close()
                rs5 = Nothing


                'For Count1 = 1 To 1

                '    Select Case Count1
                '        Case 1
                '            str2 = "1"

                '    End Select

                '    Try
                '        
                '        If boolAccess Then
                '            str1 = "INSERT INTO " & strT & " VALUES (1,0,0,0,0,0,0,0);"
                '        ElseIf boolOra Then
                '            str1 = "INSERT INTO " & strT & " VALUES (1,0,0,0,0,0,0,0);"
                '        ElseIf boolSQLSer Then
                '        End If
                '        cmd.CommandText = str1
                '        cmd.ExecuteNonQuery()
                '        boolProb = False
                '        strM = str1 & " executed successfully."
                '        boolCont = True

                '    Catch ex4 As Exception
                '        boolProb = True
                '        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                '        boolCont = False
                '    End Try

                'Next
            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)

    End Sub

    Sub AddFields_TBLWORDDOCS_INTWORDVERSION(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "INTWORDVERSION"
                    numU = 1
                    strT = "TBLWORDDOCS"
                    numTy = 5
                    intText = 255
                    boolAdd = True


            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = True

            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = False
                    Exit For
                End If
            Next


            If boolCont Then 'field needs to be added
                boolAdd = True

                rs1.Close()
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = 1"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub


    Sub ModifyFields_TBLUSERACCOUNTS_BOOLACTIVE_01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim intF As Short
        Dim strF1 As String

        boolAdd = False



        rs1 = Nothing

        For Count2 = 1 To 2

            strF = "BOOLACTIVE"

            Select Case Count2

                Case 1
                    strT = "TBLUSERACCOUNTS"

                Case 2
                    strT = "TBLPERSONNEL"


            End Select

            boolAdd = True

            If boolAdd Then 'update records

                'UPDATE INTORDER
                strSQL = "UPDATE " & strT & " SET " & strF & " = -1 WHERE " & strF & " = 1"
                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                Try
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

            End If


        Next


    End Sub

    Sub ModifyFields_TBLDATATABLEROWTITLES_NUMBERING_01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim intF As Short
        Dim strF1 As String

        boolAdd = False



        rs1 = Nothing

        For Count2 = 1 To 28

            strT = "TBLDATATABLEROWTITLES"
            strF = "CHARROWNAME"
            strF1 = "TBLPERMISSIONS"

            Select Case Count2

                Case 1
                    str1 = "Choose Study & Report Tab"

                Case 2
                    str1 = "Add/Edit Top Level Data Tab"

                Case 3
                    str1 = "Review Analytical Runs Tab"

                Case 4
                    str1 = "Summary Table Configuration Tab"

                Case 5
                    str1 = "Choose/Edit Word Template Tab"

                Case 6
                    str1 = "Allow Word Report Generation"

                Case 7
                    str1 = "Edit Word Templates"

                Case 8
                    str1 = "View Word Templates"

                Case 9
                    str1 = "Allow PDF Report Generation"

                Case 10
                    str1 = "Force watermarks in Reports"

                Case 11
                    str1 = "Configure Report Tables Tab"

                Case 12
                    str1 = "Assign Samples Window"

                Case 13
                    str1 = "Advanded Table Configuration Window"

                Case 14
                    str1 = "Configure Column Headings Tab"

                Case 15
                    str1 = "Analytical Reference Standard Tab"

                Case 16
                    str1 = "Add/Edit Contributors Tab"

                Case 17
                    str1 = "Review Validated Method Tab"

                Case 18
                    str1 = "QA Event Table Tab"

                Case 19
                    str1 = "Sample Receipt Tab"

                Case 20
                    str1 = "Edit Appendices & Figures Tab"

                Case 21
                    str1 = "Report Writer Administration Tab"

                Case 22
                    str1 = "Sample/QC/Calibr Std Details Tab"

                Case 23
                    str1 = "Report Writer Audit Trail Tab"

                Case 24
                    str1 = "Administration: Dropdownbox Configuration Tab"

                Case 25
                    str1 = "Administration: Corporate Addresses Tab"

                Case 26
                    str1 = "Administration: Report Template Definitions Tab"

                Case 27
                    str1 = "Administration: Global Parameters Tab"

                Case 28
                    str1 = "Administration: Custom Field Codes Tab"


            End Select

            boolAdd = True

            If boolAdd Then 'update records

                'UPDATE INTORDER
                strSQL = "UPDATE " & strT & " SET INTORDER = " & Count2 & " WHERE " & strF & " = '" & str1 & "' AND CHARDATATABLENAME = '" & strF1 & "'"
                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                Try
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

            End If


        Next


    End Sub

    Sub ModifyFields_TBLDATATABLEROWTITLES_NUMBERING(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim intF As Short
        Dim strF1 As String

        Dim boolDoNumber As Boolean

        boolAdd = False



        rs1 = Nothing

        For Count2 = 1 To 22

            strT = "TBLDATATABLEROWTITLES"
            strF = "CHARROWNAME"
            strF1 = "TBLPERMISSIONS"
            boolDoNumber = True
            Select Case Count2
                Case 1
                    str1 = "Home Tab"
                    str2 = "Choose Study & Report Tab"
                Case 2
                    str1 = "Data Tab"
                    str2 = "Add/Edit Top Level Data Tab"
                Case 3
                    str1 = "Analytical Run Summary Tab"
                    str2 = "Review Analytical Runs Tab"
                Case 4
                    str1 = "Summary Table Tab"
                    str2 = "Summary Table Configuration Tab"
                Case 5
                    str1 = "Choose/Edit Word Template Tab"
                    str2 = "Choose/Edit Word Template Tab"
                Case 6
                    str1 = "Edit Word Templates"
                    str2 = "Edit Word Templates"
                Case 7
                    str1 = "View Word Templates"
                    str2 = "View Word Templates"
                Case 8
                    str1 = "Report Table Configuration Tab"
                    str2 = "Configure Report Tables Tab"
                Case 9
                    str1 = "Assign Samples Window"
                    str2 = "Assign Samples Window"
                Case 10
                    str1 = "Advanced Table Configuration Window"
                    str2 = "Advanced Table Configuration Window"
                Case 11
                    str1 = "Report Table Header Configuration Tab"
                    str2 = "Configure Column Headings Tab"
                Case 12
                    str1 = "Analytical Reference Standard Tab"
                    str2 = "Analytical Reference Standard Tab"
                Case 13
                    str1 = "Contributing Personnel Tab"
                    str2 = "Add/Edit Contributors Tab"
                Case 14
                    str1 = "Method Validation Data Tab"
                    str2 = "Review Validated Method Tab"
                Case 15
                    str1 = "QA Event Table Tab"
                    str2 = "QA Event Table Tab"
                Case 16
                    str1 = "Sample Receipt Tab"
                    str2 = "Sample Receipt Tab"
                Case 17
                    str1 = "Appendices and Figures Tab"
                    str2 = "Edit Appendices & Figures Tab"
                Case 18
                    str1 = "Administration Tab"
                    str2 = "Report Writer Administration Tab"
                Case 19
                    str1 = "Sample/QC/Calibr Std Details Tab"
                    str2 = "Sample/QC/Calibr Std Details Tab"
                Case 20
                    str1 = "Report Writer Audit Trail"
                    str2 = "Report Writer Audit Trail"
                Case 21
                    str1 = "Console: View Report Writer"
                    str2 = "Console: View Report Writer"
                    strF1 = "TBLPERMISSIONSADMIN"


                Case 22
                    str1 = "Administration Window"
                    str2 = "Console: View Administration"
                    boolDoNumber = True
                    strF1 = "TBLPERMISSIONSADMIN"

            End Select

            boolAdd = True

            If boolAdd Then 'update records

                If boolDoNumber Then
                    'UPDATE INTORDER
                    strSQL = "UPDATE " & strT & " SET INTORDER = " & Count2 & " WHERE " & strF & " = '" & str1 & "' AND CHARDATATABLENAME = '" & strF1 & "'"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try
                End If

                'UPDATE CHARROWNAME
                strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE " & strF & " = '" & str1 & "' AND CHARDATATABLENAME = '" & strF1 & "'"
                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                Try
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

            End If


        Next


    End Sub

    Sub AddFields_TBLPERMISSIONS_CHARPERMISSIONSNAME(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARPERMISSIONSNAME"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 202
                    intText = 255
                    boolAdd = True


            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = True

            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = False
                    Exit For
                End If
            Next


            If boolCont Then 'field needs to be added
                boolAdd = True

                rs1.Close()
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = 'Administrator' WHERE ID_TBLPERMISSIONS = 1"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub DeleteRecords_TBLPERMISSIONS_ID_TBLUSERACCOUNTS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim strF As String
        Dim maxID As Int64


        strT = "TBLPERMISSIONS"

        'DELETE FROM table_name
        '  WHERE some_column=some_value; 

        strSQL = "DELETE FROM " & strT & " WHERE ID_" & strT & " > 1"

        cmd.CommandText = strSQL
        Try
            cmd.ExecuteNonQuery()
            var2 = "Hi"
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        Catch ex As Exception
            var1 = ex.Message.ToString
            var2 = var1
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

        End Try


end1:


    End Sub

    Sub DropFields_TBLPERMISSIONS_ID_USERACCOUNTS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "ID_TBLUSERACCOUNTS"
                    numU = 1
                    strT = "TBLPERMISSIONS"
                    numTy = 3
                    intText = 100 'not needed
                    boolAdd = True


            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False

            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next


            If boolCont Then 'field needs to be DROPPED
                boolAdd = True

                rs1.Close()
                strSQL = "alter table " & strT & " DROP COLUMN " & strF ' & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddFields_TBLUSERACCOUNTS_ID_TBLPERMISSIONS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 3
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "ID_TBLPERMISSIONS"
                    numU = 1
                    strT = "TBLUSERACCOUNTS"
                    numTy = 3
                    intText = 100 'not needed
                    boolAdd = True
                Case 2
                    strF = "ID_TBLWATSONACCOUNT"
                    numU = 0
                    strT = "TBLUSERACCOUNTS"
                    numTy = 3
                    intText = 100 'not needed
                    boolAdd = True
                Case 3
                    strF = "ID_TBLWINDOWSAUTH"
                    numU = 0
                    strT = "TBLUSERACCOUNTS"
                    numTy = 3
                    intText = 100 'not needed
                    boolAdd = True

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False

            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next


            If boolCont = False Then 'field needs to be added
                boolAdd = True

                rs1.Close()
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub


    Sub AddFields_TBLPERMISSIONS_BOOLPERMISSIONS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim intF As Short

        boolAdd = False

        strT = "TBLPERMISSIONS"

        strSQL = "SELECT * FROM " & strT & " WHERE ID_" & strT & " < 2;"

        rs1.Open(strSQL, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        If rs1.EOF And rs1.BOF Then
        Else
            rs1.MoveFirst()
        End If

        'need to get field names in an array
        Dim arr1()
        ReDim arr1(rs1.Fields.Count)
        intF = 0
        For Each fld In rs1.Fields
            intF = intF + 1
            arr1(intF) = fld.Name
        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        For Count2 = 1 To 7
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLPERMISSIONSMANAGER"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100
                Case 2
                    strF = "BOOLEDITWORDTEMPLATE"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100
                Case 3
                    strF = "BOOLVIEWWORDTEMPLATE"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100

                Case 4
                    strF = "BOOLSAMPLEDETAILS"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100

                Case 5
                    strF = "BOOLRWAUDITTRAIL"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100

                Case 6
                    strF = "BOOLCONSOLEAUDITTRAIL"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100

                Case 7
                    strF = "BOOLCONSOLERW"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            For Count1 = 1 To intF
                str1 = arr1(Count1)
                If StrComp(strF, str1, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

        Next


    End Sub

    Sub AddRecords_TBLTAB1_PERMISSIONSMANAGER(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim strF As String

        strT = "TBLTAB1"

        'check to see if this has been run

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.ActiveConnection = Nothing
        strF = "ID_TBLTAB1 = 37"
        rs1.Filter = strF
        If rs1.RecordCount = 0 Then 'continue
        Else
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If

        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTAB1 VALUES(37,'Permissions Manager',5,'Admin',4,0,#18-FEB-15#)"
            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:


    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLPLACEHOLDER(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset
        Dim strF As String
        Dim numU As Int64

        strT = "TBLDATATABLEROWTITLES"

        'check to see if this has been run

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.ActiveConnection = Nothing


        'B = If checked, table placeholder only will be created

        numU = 517

        'NOTE: intOrder gets set in the last routine run:  ModifyFields_TBLDATATABLEROWTITLES_NUMBERING_01

        For Count1 = 1 To 15

            numU = numU + 1
            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLREPORTTABLE','Table placeholder only will be created (B)',NULL,'TBLREPORTTABLE','BOOLPLACEHOLDER',-1,#2/18/2015#,NULL)"

                Case 2
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONSADMIN','Administration: Permissions Manager Window',5,NULL,'BOOLPERMISSIONSMANAGER',-1,#2/19/2015#,NULL)"
                Case 3
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONSADMIN','Allow editing on the StudyDoc Administration - Permissions Manager tab?',NULL,'TBLPERMISSIONS','BOOLPERMISSIONSMANAGER',-1,#2/19/2015#,NULL)"


                Case 4
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONS','Edit Word Templates',11,NULL,'BOOLEDITWORDTEMPLATE',-1,#2/19/2015#,NULL)"
                Case 5
                    '20160630: This item isn't in table
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONS','Allow editing Word Report Templates?',NULL,'TBLPERMISSIONS','BOOLEDITWORDTEMPLATE',-1,#2/19/2015#,NULL)"


                Case 6
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONS','View Word Templates',11,NULL,'BOOLVIEWWORDTEMPLATE',-1,#2/19/2015#,NULL)"
                Case 7
                    '20160630: This item isn't in table
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONS','Allow viewing Word Report Templates?',NULL,'TBLPERMISSIONS','BOOLVIEWWORDTEMPLATE',-1,#2/19/2015#,NULL)"


                Case 8
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONS','Sample/QC/Calibr Std Details Tab',11,NULL,'BOOLSAMPLEDETAILS',-1,#2/19/2015#,NULL)"
                Case 9
                    '20160630: This item isn't in table
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONS','Allow viewing the Sample/QC/Calibr Std Details Tab?',NULL,'TBLPERMISSIONS','BOOLSAMPLEDETAILS',-1,#2/19/2015#,NULL)"


                Case 10
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONS','Report Writer Audit Trail Tab',11,NULL,'BOOLRWAUDITTRAIL',-1,#2/19/2015#,NULL)"
                Case 11
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONS','Allow viewing the Report Writer Audit Trail Tab?',NULL,'TBLPERMISSIONS','BOOLRWAUDITTRAIL',-1,#2/19/2015#,NULL)"


                Case 12
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONSADMIN','Console: View Report Writer',6,NULL,'BOOLCONSOLERW',-1,#2/19/2015#,NULL)"
                Case 13
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONSADMIN','Allow viewing the Report Writer module?',NULL,'TBLPERMISSIONS','BOOLCONSOLERW',-1,#2/19/2015#,NULL)"


                Case 14
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONSADMIN','Console: View Audit Trail',7,NULL,'BOOLCONSOLEAUDITTRAIL',-1,#2/19/2015#,NULL)"
                Case 15
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(" & numU & ",'TBLPERMISSIONSADMIN','Allow viewing the StudyDoc Audit Trail?',NULL,'TBLPERMISSIONS','BOOLCONSOLEAUDITTRAIL',-1,#2/19/2015#,NULL)"

            End Select



            '                Case 4
            'strF = "BOOLSAMPLEDETAILS"
            'numU = -1
            'strT = "TBLPERMISSIONS"
            'numTy = 2
            'intText = 100

            '    Case 5
            'strF = "BOOLRWAUDITTRAIL"
            'numU = -1
            'strT = "TBLPERMISSIONS"
            'numTy = 2
            'intText = 100

            '    Case 6
            'strF = "BOOLCONSOLEAUDITTRAIL"
            'numU = -1
            'strT = "TBLPERMISSIONS"
            'numTy = 2
            'intText = 100


            strF = "ID_TBLDATATABLEROWTITLES = " & numU
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then 'continue
                Try

                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    boolCont = False
                End Try
            End If

        Next

        rs1.Close()
        rs1 = Nothing

        'now do a modification
        strF = "CHARROWNAME"
        str2 = "Choose/Edit Word Template Tab"
        str1 = "Report Body Sections Tab"
        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE " & strF & " = '" & str1 & "';"

        Try
            cmd.CommandText = strSQL
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = str1 & " executed successfully."
            boolCont = True

        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
            boolCont = False
        End Try

end1:



    End Sub

    Sub AddFields_TBLREPORTTABLE_BOOLPLACEHOLDER(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLPLACEHOLDER"
                    numU = 0
                    strT = "TBLREPORTTABLE"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing
        'conA.CommitTrans()


    End Sub

    Sub ModifyRecords_TableOfContents_01(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLTAB1"
        For Count2 = 1 To 1

            strF = "CHARITEM"
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    str1 = "Choose Study & Template"
                    str2 = "Choose Study & Report"

            End Select

            'rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            'If rs1.EOF And rs1.BOF Then
            'Else
            '    rs1.MoveFirst()
            'End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE " & strF & " = '" & str1 & "' AND CHARFORM = 'StudyDoc Main' AND INTFORM = 1;"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            '    rs1.Close()
            'End If

        Next
        'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
        '    rs1.Close()
        'End If
        'rs1 = Nothing


    End Sub

    Sub AddRecords_TBLCONFIGREPORTTYPE_OTHER(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLCONFIGREPORTTYPE"

        'check to see if this has been run

        strSQL = "SELECT " & strT & ".* FROM " & strT & " WHERE ID_" & strT & " = 7"

        rs1.Open(strSQL, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        If rs1.RecordCount > 0 Then
            'already exists
            boolProb = False
            strM = "'" & strSQL & "' already exists."
            boolCont = False
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO " & strT & " VALUES(7,'Other',#06-NOV-14#,0)"
            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:


    End Sub

    Sub GuWuToStudyDoc_01(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        'GuWu, Table:TBLCONFIGURATION, Field: CHARCONFIGVALUE, ID:3, Entry: C:\GubbsIncApps\GuWu\Demo\LabMethodFigs\
        'GuWu, Table:TBLCONFIGURATION, Field: CHARCONFIGVALUE, ID:4, Entry: C:\GubbsIncApps\GuWu\Demo\Chromatograms\
        'GuWu, Table:TBLCONFIGURATION, Field: CHARCONFIGVALUE, ID:17, Entry: C:\GubbsIncApps\GuWu\Demo\
        'GuWu, Table:TBLCONFIGURATION, Field: CHARCONFIGTITLE, ID:27, Entry: Allow users to exclude data in GuWu (Watson overrides GuWu)
        'GuWu, Table:TBLCONFIGURATION, Field: CHARCONFIGTITLE, ID:28, Entry: Allow users to set QC and Calibr Std Acceptance Criteria (GuWu overrides Watson)
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:124, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:125, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:126, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:127, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:128, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:129, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:130, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:131, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:132, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:133, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:134, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:135, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:136, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARDATATABLENAME, ID:137, Entry: tblReportStatementsGuWu
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARROWNAME, ID:258, Entry: Enable GuWu Exclude Samples feature
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARROWNAME, ID:259, Entry: Enable GuWu Acceptance Crit. feature
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARTABLEREFCOLUMNNAME, ID:259, Entry: BOOLALLOWGUWUACCCRIT
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARROWNAME, ID:308, Entry: Allow editing on the GuWu Administration - User Account tab?
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARROWNAME, ID:314, Entry: Allow editing on the GuWu Administration - Hooks tab?
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARROWNAME, ID:316, Entry: Allow editing on the GuWu Administration Page tab?
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARROWNAME, ID:317, Entry: Allow editing on the GuWu Administration - Global Parameters tab?
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARROWNAME, ID:404, Entry: Use GuWu Acceptance Criteria
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARTABLEREFCOLUMNNAME, ID:404, Entry: BOOLUSEGUWUACCCRIT
        'GuWu, Table:TBLDATATABLEROWTITLES, Field: CHARROWNAME, ID:476, Entry: Allow editing on the GuWu Administration - Compliance Window
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:37, Entry: Returns the Watson Study ID corresponding to the GuWu Study.
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:38, Entry: Returns the Watson Project ID corresponding to the GuWu Study.
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:166, Entry: Where 'role' is a role configured in GuWu Returns a signature block that contains the persons name, degree (if configured), title, and company as a signature block
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:167, Entry: Where 'role' is a role configured in GuWu Returns a signature block that contains the persons name, degree (if configured) and title as a signature block
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:168, Entry: Where 'role' is a role configured in GuWu Returns a signature block that contains the persons name and degree (if configured) as a signature block
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:169, Entry: Where 'role' is a role configured in GuWu Returns a persons name and degree (if configured). If more than one, returns the names in a single line.
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:170, Entry: Where 'role' is a role configured in GuWu Returns a persons name and degree (if configured). If more than one, returns the names in a column
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:171, Entry: Where 'role' is a role configured in GuWu Returns a signature block that contains the persons name, degree (if configured) and title, as a signature block
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:172, Entry: Where 'role' is a role configured in GuWu Returns a signature block that contains the persons name, degree (if configured), title, and role as a signature block
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:176, Entry: A trigger to determine if more than one example of a Method Summary section needs to be prepared. The trigger is activated if the study has more than one different Laboratory Method Numbers configured in the Method Validation page of GuWu.
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:182, Entry: Inserts one or more statements describing which Analytes are described in which Appendice for which Watson Run ID. Information is obtained from the GuWu Appendix/Figure page.
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:185, Entry: Inserts a date formated in the Local Text Date format configuration shown on the GuWu Data page
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:186, Entry: Inserts a date/time with the date portion formated in the Local Text Date format configuration shown on the GuWu Data page and the time formatted as hh:mm:ss AM/PM
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:188, Entry: Inserts the tables configured in the GuWu Report Table Configuration page.
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:189, Entry: Inserts the Appendices configured in the GuWu Appendices and Figures page.
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:190, Entry: Inserts the Figures configured in the GuWu Appendices and Figures page.
        'GuWu, Table:TBLFIELDCODES, Field: CHARDESCRIPTION, ID:209, Entry: Inserts the Attachments (configured as Appendices) in the GuWu Appendices and Figures page.
        'GuWu, Table:TBLMETHODVALIDATIONDATA, Field: CHARARCHIVEPATH, ID:45, Entry: C:\GubbsInc\GuWu\ArchivedMDBs\MethodVal.MDB
        'GuWu, Table:TBLMETHODVALIDATIONDATA, Field: CHARARCHIVEPATH, ID:45, Entry: C:\GubbsInc\GuWu\ArchivedMDBs\MethodVal.MDB
        'GuWu, Table:TBLOUTSTANDINGITEMS, Field: CHARVALUE, ID:6041, Entry: GuWu Table Storage Temperature
        'GuWu, Table:TBLOUTSTANDINGITEMS, Field: CHARVALUE, ID:6042, Entry: GuWu Table Sample Condition
        'GuWu, Table:TBLOUTSTANDINGITEMS, Field: CHARVALUE, ID:6043, Entry: GuWu Sample Receipt Table
        'GuWu, Table:TBLOUTSTANDINGITEMS, Field: CHARVALUE, ID:6044, Entry: GuWu Sample Receipt Table
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:1, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:2, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:3, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:4, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:5, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:6, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:7, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:8, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:9, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:10, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:11, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:12, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:13, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:14, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:19, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:25, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:26, Entry: GuWu Main
        'GuWu, Table:TBLTAB1, Field: CHARFORM, ID:34, Entry: GuWu Main
        'Gubbs, Table:TBLUSERACCOUNTS, Field: CHARUSERID, ID:14, Entry: Gubbs
        'GuWu, Table:TBLWORDSTATEMENTS, Field: CHARWORDSTATEMENT, ID:376, Entry: C:\GubbsInc\GuWu\XML\WS_331_Statement_1.XML

        'need to update records with GuWu to StudyDoc


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim strG1 As String
        Dim strG2 As String

        boolAdd = False
        strT = "TBLTAB1"
        For Count2 = 1 To 11

            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strT = "TBLCONFIGURATION"
                    strF = "CHARCONFIGVALUE"
                    strG1 = "GuWu"
                    strG2 = "StudyDoc"
                    strSQL = "UPDATE " & strT & " " & strF & " = REPLACE(" & strF & ",'GuWu','StudyDoc') FROM " & strT & ";"
                Case 2
                    strT = "TBLCONFIGURATION"
                    strF = "CHARCONFIGVALUE"
                    strG1 = "GubbsInc"
                    strG2 = "LabIntegrity"
                    strSQL = "UPDATE " & strT & " " & strF & " = REPLACE(" & strF & ",'GubbsInc','LabIntegrity') FROM " & strT & ";"
                Case 3
                    strT = "TBLCONFIGURATION"
                    strF = "CHARCONFIGTITLE"
                    strG1 = "GubbsInc"
                    strG2 = "LabIntegrity"
                    strSQL = "UPDATE " & strT & " " & strF & " =  REPLACE(" & strF & ",'GubbsInc','LabIntegrity') FROM " & strT & ";"
                Case 4
                    strT = "TBLCONFIGURATION"
                    strF = "CHARCONFIGTITLE"
                    strG1 = "GuWu"
                    strG2 = "StudyDoc"
                    strSQL = "UPDATE " & strT & " " & strF & " =  REPLACE(" & strF & ",'GubbsInc','LabIntegrity') FROM " & strT & ";"
                Case 5
                    strT = "TBLDATATABLEROWTITLES"
                    strF = "CHARROWNAME"
                    strG1 = "GuWu"
                    strG2 = "StudyDoc"
                    strSQL = "UPDATE " & strT & " " & strF & " =  REPLACE(" & strF & ",'GuWu','StudyDoc') FROM " & strT & ";"
                Case 6
                    strT = "TBLFIELDCODES"
                    strF = "CHARDESCRIPTION"
                    strG1 = "GuWu"
                    strG2 = "StudyDoc"
                    strSQL = "UPDATE " & strT & " " & strF & " =  REPLACE(" & strF & ",'GuWu','StudyDoc') FROM " & strT & ";"
                Case 7
                    strT = "TBLMETHODVALIDATIONDATA"
                    strF = "CHARARCHIVEPATH"
                    strG1 = "GuWu"
                    strG2 = "StudyDoc"
                    strSQL = "UPDATE " & strT & " " & strF & " =  REPLACE(" & strF & ",'GuWu','StudyDoc') FROM " & strT & ";"
                Case 8
                    strT = "TBLMETHODVALIDATIONDATA"
                    strF = "CHARARCHIVEPATH"
                    strG1 = "GubbsInc"
                    strG2 = "LabIntegrity"
                    strSQL = "UPDATE " & strT & " " & strF & " =  REPLACE(" & strF & ",'GubbsInc','LabIntegrity') FROM " & strT & ";"
                Case 9
                    strT = "TBLOUTSTANDINGITEMS"
                    strF = "CHARVALUE"
                    strG1 = "GuWu"
                    strG2 = "StudyDoc"
                    strSQL = "UPDATE " & strT & " " & strF & " =  REPLACE(" & strF & ",'GuWu','StudyDoc') FROM " & strT & ";"
                Case 10
                    strT = "TBLTAB1"
                    strF = "CHARFORM"
                    strG1 = "GuWu"
                    strG2 = "StudyDoc"
                    strSQL = "UPDATE " & strT & " " & strF & " =  REPLACE(" & strF & ",'GuWu','StudyDoc') FROM " & strT & ";"
                Case 11
                    strT = "TBLWORDSTATEMENTS"
                    strF = "CHARWORDSTATEMENT"
                    strG1 = "GuWu"
                    strG2 = "StudyDoc"
                    strSQL = "UPDATE " & strT & " " & strF & " =  REPLACE(" & strF & ",'GuWu','StudyDoc') FROM " & strT & ";"
            End Select

            'rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            'If rs1.EOF And rs1.BOF Then
            'Else
            '    rs1.MoveFirst()
            'End If

            str1 = "SELECT " & strT & ".* FROM " & strT & " WHERE " & strF & " LIKE '%" & strG1 & "%'"
            '''''Console.WriteLine(str1)
            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If
            rs1.CursorLocation = CursorLocationEnum.adUseClient
            rs1.Open(str1, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
            rs1.ActiveConnection = Nothing
            int1 = rs1.RecordCount
            Do Until rs1.EOF
                str2 = rs1.Fields(strF).Value
                str3 = Replace(str2, strG1, strG2, 1, -1, CompareMethod.Text)
                'strSQL = "UPDATE " & strT & " SET " & strF & " = '" & Replace(str3, "'", "''", 1, -1, 1) & "' WHERE " & strF & " = '" & Replace(str2, "'", "''", 1, -1, CompareMethod.Text) & "'"
                '20190206 LEE
                strSQL = "UPDATE " & strT & " SET " & strF & " = '" & CleanText(str3) & "' WHERE " & strF & " = '" & CleanText(str2) & "'"
                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & vbCrLf & ex.Message
                    MsgBox(strM)
                    strM = strM
                End Try

                rs1.MoveNext()
            Loop

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

            'strM = strF
            'boolProb = False
            ''check to see if strF exists
            'boolCont = False
            ' ''debug.print ""
            ' ''debug.print "Start fields tblPKAUC..."

            ''strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE " & strF & " = '" & str1 & "' AND CHARFORM = 'StudyDoc Main' AND INTFORM = 1;"
            'cmd.CommandText = strSQL
            'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & vbCrLf & ex.Message
                MsgBox(strM)
                strM = strM
            End Try


        Next




    End Sub

    Sub ModifyRecords_TableOfContents(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLTAB1"
        For Count2 = 1 To 16

            strF = "CHARITEM"
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    str1 = "Home"
                    str2 = "Choose Study & Template"
                Case 2
                    str1 = "Data"
                    str2 = "Add/Edit Top Level Data"
                Case 3
                    str1 = "Analytical Run Summary"
                    str2 = "Review Analytical Runs"
                Case 4
                    str1 = "Summary Table"
                    str2 = "Summary Table Configuration"
                Case 5
                    str1 = "Report Template Configuration"
                    str2 = "Choose/Edit Word Template"
                Case 6
                    str1 = "Report Table Configuration"
                    str2 = "Configure Report Tables"
                Case 7
                    str1 = "Report Table Header Configuration"
                    str2 = "Configure Column Headings"
                Case 8
                    str1 = "Analytical Reference Standard"
                    str2 = "Analytical Reference Std"
                Case 9
                    str1 = "Contributing Personnel"
                    str2 = "Add/Edit Contributors"
                Case 10
                    str1 = "Method Validation Data"
                    str2 = "Review Validated Method"
                Case 11
                    str1 = "QA Event Table"
                    str2 = "QA Event Table"
                Case 12
                    str1 = "Sample Receipt"
                    str2 = "Sample Receipt Records"
                Case 13
                    str1 = "Appendices and Figures"
                    str2 = "Edit Appendices & Figures"
                Case 14
                    str1 = "Administration"
                    str2 = "Report Writer Administration"
                Case 15
                    str1 = "Sample/QC/Calibr Std Detail"
                    str2 = "Sample/QC/Calibr Std Detail"
                Case 16
                    str1 = "Audit Trail"
                    str2 = "Report Writer Audit Trail"
            End Select

            'rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            'If rs1.EOF And rs1.BOF Then
            'Else
            '    rs1.MoveFirst()
            'End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE " & strF & " = '" & str1 & "' AND CHARFORM = 'StudyDoc Main' AND INTFORM = 1;"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            '    rs1.Close()
            'End If

        Next
        'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
        '    rs1.Close()
        'End If
        'rs1 = Nothing


    End Sub

    Sub AddRecords_TBLFIELDCODES_LOCKSECTION(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        'for some reason, these records did not get added back in

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim str6 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim intL As Short
        Dim dt As Date

        Dim maxID As Int64

        strT = "TBLFIELDCODES"

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)

        maxID = GetMaxID(strT, 1, False)
        Dim maxIDO As Int64
        maxIDO = maxID

        boolAdd = False

        For Count2 = 1 To 1


            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'now add back desired records
            dt = Now
            For Count1 = 1 To 2

                Select Case Count1
                    Case 1
                        str1 = "[LOCKSECTION]"
                        str2 = "Renders the section between [LOCKSECTION] and [UNLOCKSECTION] read-only"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "NA"
                        str6 = "Report Items"
                    Case 2
                        str1 = "[UNLOCKSECTION]"
                        str2 = "Renders the section between [LOCKSECTION] and [UNLOCKSECTION] read-only"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "NA"
                        str6 = "Analytical Reference Standard Items"
                End Select

                boolCont = True
                strF = "CHARFIELDCODE = '" & str1 & "'"
                rs1.Filter = ""
                rs1.Filter = strF
                If rs1.RecordCount = 0 Then
                    boolCont = True
                Else
                    boolCont = False
                End If

                If boolCont Then

                    maxID = maxID + 1
                    var1 = maxID

                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "','" & str3 & "','" & str4 & "','" & str5 & "','" & str6 & "',#" & dt & "#, 0);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "','" & str3 & "','" & str4 & "','" & str5 & "','" & str6 & "',#" & dt & "#, 0);"
                    ElseIf boolSQLSer Then

                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        strM = Err.Description
                        strM = strM
                    End Try
                End If

            Next

        Next

        If maxID = maxIDO Then
        Else
            Call PutMaxID(strT, maxID)
        End If

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing

    End Sub

    Sub AddFields_TBLCONFIGURATION_GOTOWORD(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8, var9
        Dim intID As Int64

        strT = "TBLCONFIGURATION"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    intID = 29
                    var1 = "Global"
                    var2 = "Global Settings"
                    var3 = "Go directly to Word" & ChrW(8482) & " after report generation."
                    var4 = "FALSE"
                    var5 = 17
                    var6 = 0
                    var7 = 0
                    var8 = 0
                    var9 = -1

            End Select

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If
                '''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_CORRECT_CHARCHEMSTRUCTURE(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim int2 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim boolString As Boolean = False

        'NOTE:  There was a mistake in 'AddRecords_TBLDATATABLEROWTITLES_CHARCHEMSTRUCTURE'
        'boolInclued was set to 0, should have been -1


        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 4
            boolAdd = False
            str1 = ""
            str2 = ""

            strF1 = "ID_" & strT
            Select Case Count2

                ' Select Case Count1
                '    Case 1
                '        var1 = 260
                '        str1 = "tblCompanyAnalRefTable"
                '        str2 = "Chemical Structure"
                '        var2 = 5
                '        str3 = "tblCompanyAnalRefTable"
                '        str4 = "CHARCHEMSTRUCTURE"
                '        var3 = 0
                '    Case 2
                '        var1 = 261
                '        str1 = "tblCompanyAnalRefTable"
                '        str2 = "Molecular Formula"
                '        var2 = 6
                '        str3 = "tblCompanyAnalRefTable"
                '        str4 = "CHARMOLFORMULA"
                '        var3 = 0
                '    Case 3
                '        var1 = 262
                '        str1 = "tblCompanyAnalRefTable"
                '        str2 = "Molecular Weight (MW)"
                '        var2 = 7
                '        str3 = "tblCompanyAnalRefTable"
                '        str4 = "CHARMOLWT"
                '        var3 = 0
                '    Case 4
                '        var1 = 263
                '        str1 = "tblCompanyAnalRefTable"
                '        str2 = "Monoisotopic MW"
                '        var2 = 8
                '        str3 = "tblCompanyAnalRefTable"
                '        str4 = "CHARMONOISOWT"
                '        var3 = 0
                'End Select

                Case 1
                    strF = "BOOLINCLUDE"
                    int1 = 260
                    int2 = -1
                Case 2 'Peak Area Decimal Places
                    strF = "BOOLINCLUDE"
                    int1 = 261
                    int2 = -1
                Case 3 'Regression and R2 Decimal Places
                    strF = "BOOLINCLUDE"
                    int1 = 262
                    int2 = -1
                Case 4
                    strF = "BOOLINCLUDE"
                    int1 = 263
                    int2 = -1
            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = " & int2 & " WHERE " & strF1 & " = " & int1 & ";"

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_SIGFIGS(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim int2 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim boolString As Boolean = False

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 7
            boolAdd = False
            str1 = ""
            str2 = ""

            strF1 = "ID_" & strT
            Select Case Count2
                Case 1
                    strF2 = "Peak Area Sig Figs/Decimals"
                    strF = "CHARROWNAME"
                    int1 = 494
                    boolString = True
                Case 2 'Peak Area Decimal Places
                    strF = "BOOLINCLUDE"
                    int1 = 495
                    int2 = 0
                    boolString = False

                Case 3 'Regression and R2 Decimal Places
                    strF = "BOOLINCLUDE"
                    int1 = 499
                    int2 = 0
                    boolString = False

                Case 4
                    strF2 = "Regr Const Sig Figs/Decimals"
                    strF = "CHARROWNAME"
                    int1 = 212
                    boolString = True

                Case 5
                    strF2 = "Regr R2 Sig Figs/Decimals"
                    strF = "CHARROWNAME"
                    int1 = 213
                    boolString = True

                Case 6 'Data Decimal Places
                    strF = "BOOLINCLUDE"
                    int1 = 207
                    int2 = 0
                    boolString = False

                Case 7
                    strF2 = "Data Sig Figs/Decimals"
                    strF = "CHARROWNAME"
                    int1 = 199
                    boolString = True
            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            If boolString Then
                strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & int1 & ";"
            Else
                strSQL = "UPDATE " & strT & " SET " & strF & " = " & int2 & " WHERE " & strF1 & " = " & int1 & ";"
            End If
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLFORCEWATERMARK(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 2
            Select Case Count1
                Case 1
                    var1 = 516
                    str1 = "TBLPERMISSIONS"
                    str2 = "Force watermarks in reports"
                    var2 = 18
                    str3 = ""
                    str4 = "BOOLFORCEWATERMARK"
                    var3 = -1

                Case 2
                    var1 = 517
                    str1 = "TBLPERMISSIONS"
                    str2 = "Allow editing on the Report Writer Administration - Force watermarks in reports"
                    var2 = 24 '23
                    str3 = "TBLPERMISSIONS"
                    str4 = "BOOLFORCEWATERMARK"
                    var3 = -1

                    'Allow editing on the Report Writer Administration - Allow Word Report Generation?
            End Select

            Try


                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddFields_TBLPERMISSIONS_BOOLFORCEWATERMARK(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLFORCEWATERMARK"
                    numU = 0
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing
        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLIGNOREFC(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 515
                    str1 = "tblCompanyData"
                    str2 = "Ignore Table-Specific Field Code generation"
                    var2 = 38
                    str3 = "TBLDATA"
                    str4 = "BOOLIGNOREFC"
                    var3 = -1



            End Select

            Try

                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddFields_TBLDATA_BOOLIGNOREFC(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim boolText As Boolean
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLIGNOREFC"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False


            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub Fix_TBLREPORTTABLEHEADERCONFIG(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        'some time earlier when the 36,37,38 was added, study 44 got screwed up
        'when study 44 was used as a template, a bunch of bad stuff happened

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim int2 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim str6 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim intL As Short
        Dim dt As Date

        'do this only if version is < 2.2.46

        Dim strV As String
        Dim v1 As Short
        Dim v2 As Short
        Dim v3 As Short
        Dim intVerC As Int64
        Dim intVerN As Int64

        strV = CurVerDB

        int1 = InStr(1, strV, ".", CompareMethod.Text)
        int2 = InStr(int1 + 1, strV, ".", CompareMethod.Text)
        v1 = CInt(Mid(strV, 1, int1 - 1))
        v2 = CInt(Mid(strV, int1 + 1, int2 - int1 - 1))
        v3 = CInt(Mid(strV, int2 + 1, Len(strV) - int2))

        intVerN = 2002046
        str1 = Format(v1, "000") & Format(v2, "000") & Format(v3, "000")
        intVerC = CLng(str1)

        If intVerC >= intVerN Then
            GoTo end1
        End If


        str1 = "UPDATE TBLREPORTTABLEHEADERCONFIG "
        str2 = "INNER JOIN TBLCONFIGHEADERLOOKUP ON TBLREPORTTABLEHEADERCONFIG.ID_TBLCONFIGHEADERLOOKUP = TBLCONFIGHEADERLOOKUP.ID_TBLCONFIGHEADERLOOKUP "
        str3 = "SET TBLREPORTTABLEHEADERCONFIG.ID_TBLCONFIGREPORTTABLES = TBLCONFIGHEADERLOOKUP.ID_TBLCONFIGREPORTTABLES "
        str4 = "WHERE ((TBLCONFIGHEADERLOOKUP.ID_TBLCONFIGHEADERLOOKUP = TBLCONFIGHEADERLOOKUP.ID_TBLCONFIGHEADERLOOKUP));"

        strSQL = str1 & str2 & str3 & str4 '& str5 & str6 & str7

        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        'intCount = intCount + 1
        'sht.Range("Notes").Offset(intCount, 0).Value = strM
        'If boolProb Then
        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
        '    intRed = intRed + 1
        'Else
        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
        'End If

        'now update all 363738 boolInclude = -1
        str1 = "UPDATE TBLREPORTTABLEHEADERCONFIG "
        str2 = "SET BOOLINCLUDE = -1 "
        str3 = "WHERE (TBLREPORTTABLEHEADERCONFIG.ID_TBLCONFIGREPORTTABLES = 36 OR TBLREPORTTABLEHEADERCONFIG.ID_TBLCONFIGREPORTTABLES = 37 OR TBLREPORTTABLEHEADERCONFIG.ID_TBLCONFIGREPORTTABLES = 38);"
        strSQL = str1 & str2 & str3

        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        'intCount = intCount + 1
        'sht.Range("Notes").Offset(intCount, 0).Value = strM
        'If boolProb Then
        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
        '    intRed = intRed + 1
        'Else
        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
        'End If

end1:

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLBQL(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 514
                    str1 = "tblCompanyData"
                    str2 = "Use BQL/AQL vs BLQ/ALQ"
                    var2 = 37
                    str3 = "TBLDATA"
                    str4 = "BOOLBQL"
                    var3 = -1



            End Select

            Try

                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddFields_TBLDATA_BOOLBQL(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim boolText As Boolean
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLBQL"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False


            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLFIELDCODES_ANALYTE( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        'for some reason, these records did not get added back in

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim str6 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim intL As Short
        Dim dt As Date

        boolAdd = False
        strT = "TBLFIELDCODES" '
        For Count2 = 1 To 1


            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'now add back desired records
            dt = Now
            For Count1 = 1 To 6
                Select Case Count1
                    Case 1
                        var1 = 163
                        str1 = "[ANALYTE_IUPAC]"
                        str2 = "Returns the Analyte or Analytes (followed by the IUPAC name) that are the subject of the study. If more than one Analyte, then list items separated by a line return"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "NA"
                        str6 = "Report Items"
                    Case 2
                        var1 = 1
                        str1 = "[ANALREFTABLE]"
                        str2 = "Generates the Analytical Reference Standard Section tables."
                        str3 = "Analytical Reference Standard"
                        str4 = "NA"
                        str5 = "NA"
                        str6 = "Analytical Reference Standard Items"
                    Case 3
                        var1 = 71
                        str1 = "[ANALYTE]"
                        str2 = "Returns the Analyte or Analytes that are the subject of the study"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "NA"
                        str6 = "Study Items"

                    Case 4
                        var1 = 162
                        str1 = "[ABSTRACTANALYTEINFO]"
                        str2 = "Returns a description of calibration standard ranges for each Analyte in a study."
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "5.00 ng/mL to 3000 ng/mL for Analyte001 and 2.50 ng/mL to 2000 ng/mL for Analyte002"
                        str6 = "Report Items"
                    Case 5
                        var1 = 183
                        str1 = "[ABSTRACTANALYTEINFO1]"
                        str2 = "Returns a description of calibration standard ranges for each Analyte in a study. Differs from ABSTRACTANALYTEINFO in the order of describing information (compare Example column)"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "Cmpd1 from 1.00 ng/mL to 1000 ng/mL and Cmpd2 from 5.00 ng/mL to 5000 ng/mL"
                        str6 = "Report Items"
                    Case 6
                        var1 = 184
                        str1 = "[ABSTRACTANALYTEINFO2]"
                        str2 = "Returns a description of calibration standard ranges for each Analyte in a study. Differs from ABSTRACTANALYTEINFO by including extra information (compare Example column)"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "Cmpd1 in 25 L heparin buffered rat plasma samples over a concentration range of 1.00 ng/mL to 1000 ng/mL and Cmpd2 in 25 L heparin buffered rat plasma samples over a concentration range of 5.00 ng/mL to 5000 ng/mL"
                        str6 = "Report Items"

                End Select

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "','" & str3 & "','" & str4 & "','" & str5 & "','" & str6 & "',#" & dt & "#, 0);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "','" & str3 & "','" & str4 & "','" & str5 & "','" & str6 & "',#" & dt & "#, 0);"
                ElseIf boolSQLSer Then

                End If

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                Try
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = Err.Description
                    strM = strM
                End Try

            Next

        Next


    End Sub

    Sub AddFields_TBLDATA_BOOLQCNA(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim boolText As Boolean
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLQCNA"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False


            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub


    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLQCNA(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 513
                    str1 = "tblCompanyData"
                    str2 = "Enter NA for non-entry QC or Calibr Std levels"
                    var2 = 36
                    str3 = "TBLDATA"
                    str4 = "BOOLQCNA"
                    var3 = -1



            End Select

            Try

                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddRecords_TBLCONFIGHEADERLOOKUP_INCURREDSAMPLES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64

        'ID_TBLCONFIGHEADERLOOKUP	ID_TBLCONFIGREPORTTABLES	CHARCOLUMNLABEL	INTORDER	CHARWATSONTABLE	CHARWATSONFIELD	BOOLDEFAULT	UPSIZE_TS
        '205	38	Reported Conc. (ng/g)	14			-1	1/9/2011

        'Watson ID	Sample ID	Final Analysis Run ID	Final Original Conc. (ng/mL)	Repeat Run ID	Repeat Conc. (ng/mL)	%RE 1	Flag 2

        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now



        'Select Case Count2
        '    Case 1
        '        str1 = "Watson ID"
        '        str2 = "DESIGNSAMPLEID"
        '    Case 2
        '        str1 = "Sample ID"
        '        str2 = "SAMPLENAME"
        '    Case 3
        '        str1 = "Final Analysis" & ChrW(10) & "Run ID"
        '        str2 = "RUNID"
        '    Case 4
        '        str1 = "Final Original" & ChrW(10) & "Conc. (" & strConcUnits & ")"
        '        str2 = "CONCENTRATION"
        '    Case 5
        '        str1 = "Repeat" & ChrW(10) & "Run ID"
        '        str2 = "RUNID"
        '    Case 6
        '        str1 = "Repeat" & ChrW(10) & "Conc. (" & strConcUnits & ")"
        '        str2 = "CONCENTRATION"
        '    Case 7
        '        str1 = "%RE"
        '    Case 8
        '        str1 = "Flag"
        'End Select


        maxID = 205
        For Count1 = 1 To 8

            maxID = maxID + 1

            Select Case Count1
                Case 1
                    var1 = maxID
                    var2 = 30
                    var3 = "Watson ID"
                    var4 = Count1
                    var5 = "TBLISRUNIQUE"
                    var6 = "DESIGNSAMPLEID"
                    var7 = -1
                Case 2
                    var1 = maxID
                    var2 = 30
                    var3 = "Sample ID"
                    var4 = Count1
                    var5 = "TBLDESIGNSAMPLE"
                    var6 = "SAMPLENAME"
                    var7 = -1
                Case 3
                    var1 = maxID
                    var2 = 30
                    var3 = "Final Analysis" & ChrW(10) & "Run ID"
                    var4 = Count1
                    var5 = "TBLDESIGNSAMPLE"
                    var6 = "RUNID"
                    var7 = -1
                Case 4
                    var1 = maxID
                    var2 = 30
                    var3 = "Final Original" & ChrW(10) & "Conc. ([LLOQUnits])"
                    var4 = Count1
                    var5 = "TBLDESIGNSAMPLE"
                    var6 = "CONCENTRATION"
                    var7 = -1
                Case 5
                    var1 = maxID
                    var2 = 30
                    var3 = "Repeat" & ChrW(10) & "Run ID"
                    var4 = Count1
                    var5 = "TBLISR01"
                    var6 = "RUNID"
                    var7 = -1
                Case 6
                    var1 = maxID
                    var2 = 30
                    var3 = "Repeat" & ChrW(10) & "Conc. ([LLOQUnits])"
                    var4 = Count1
                    var5 = "TBLISR01"
                    var6 = "DESIGNSAMPLEID"
                    var7 = -1
                Case 7
                    var1 = maxID
                    var2 = 30
                    var3 = "%RE"
                    var4 = Count1
                    var5 = ""
                    var6 = ""
                    var7 = -1
                Case 8
                    var1 = maxID
                    var2 = 30
                    var3 = "Flag"
                    var4 = Count1
                    var5 = ""
                    var6 = ""
                    var7 = -1
            End Select



            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If

                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
                var1 = ex.Message
                var2 = var1
            End Try


        Next

        Pause(1) 'need to give database time to catch up for next subroutine

    End Sub

    Sub AddRecords_TBLREPORTTABLEHEADERCONFIG_INCURREDSAMPLES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8
        Dim maxID As Int64
        Dim omaxID As Int64

        Dim rs1 As New ADODB.Recordset
        Dim rs2 As New ADODB.Recordset
        Dim rs3 As New ADODB.Recordset
        Dim rsM As New ADODB.Recordset
        Dim idS As Int64

        'AAACKK!! This code is repeating itself!!!


        'get maxid for TBLREPORTTABLEHEADERCONFIG
        str1 = "SELECT * FROM TBLMAXID "
        str2 = "WHERE CHARTABLE = 'TBLREPORTTABLEHEADERCONFIG';"
        strSQL = str1 & str2

        rsM.CursorLocation = CursorLocationEnum.adUseClient
        rsM.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockOptimistic)
        rsM.ActiveConnection = Nothing

        maxID = rsM.Fields("NUMMAXID").Value
        omaxID = maxID

        'get current studies
        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open("TBLSTUDIES", con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs1.ActiveConnection = Nothing

        'ID_TBLREPORTTABLEHEADERCONFIG	ID_TBLSTUDIES	ID_TBLCONFIGREPORTTABLES	ID_TBLCONFIGHEADERLOOKUP	CHARUSERLABEL	INTORDER	BOOLINCLUDE	UPSIZE_TS
        '4741	65	38	205	Reported Conc. (ng/g)	14	-1	date


        str1 = "SELECT * FROM TBLCONFIGHEADERLOOKUP "
        str2 = "WHERE ID_TBLCONFIGREPORTTABLES = 30;"
        strSQL = str1 & str2

        rs2.CursorLocation = CursorLocationEnum.adUseClient
        rs2.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs2.ActiveConnection = Nothing

        rs3.CursorLocation = CursorLocationEnum.adUseClient

        'str1 = "SELECT * FROM TBLREPORTTABLEHEADERCONFIG "
        'str2 = "WHERE ID_TBLCONFIGREPORTTABLES = 30;"
        'strSQL = str1 & str2

        'rs3.CursorLocation = CursorLocationEnum.adUseClient
        'rs3.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        'rs3.ActiveConnection = Nothing

        strT = "TBLREPORTTABLEHEADERCONFIG"
        dt = Now

        Dim idCFL As Int64
        Dim strUL As String
        Dim boolGoCheck As Boolean = False
        Dim intNumA As Short

        Do Until rs1.EOF

            boolGoCheck = False

            idS = rs1.Fields("ID_TBLSTUDIES").Value
            maxID = maxID + 1

            rs2.MoveFirst()
            Count1 = 0

            '****check for goofy stuff
            str1 = "SELECT COUNT(*) AS NUMA FROM " & strT & " "
            str2 = "WHERE ID_TBLCONFIGREPORTTABLES = 30 AND ID_TBLCONFIGHEADERLOOKUP = 207 AND ID_TBLSTUDIES = " & idS & ";"
            strSQL = str1 & str2

            rs3.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
            rs3.ActiveConnection = Nothing

            intNumA = rs3.Fields("NUMA").Value
            If intNumA = 0 Then
                boolGoCheck = True
            ElseIf intNumA = 1 Then
                boolGoCheck = False
            Else
                'delete all records, then continue
                str1 = "DELETE FROM " & strT & " "
                str2 = "WHERE ID_TBLCONFIGREPORTTABLES = 30 AND ID_TBLSTUDIES = " & idS & ";"
                'DELETE FROM Persons
                'WHERE LastName='Tjessem' AND FirstName='Jakob'
                strSQL = str1 & str2
                Try
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception

                    var1 = ex.Message
                    var2 = var1

                End Try
                boolGoCheck = True
            End If

            'SELECT COUNT(*) AS NumberOfOrders FROM Orders
            rs3.Close()

            '****end check

            If boolGoCheck Then
            Else
                GoTo end1
            End If

            Do Until rs2.EOF

                Count1 = Count1 + 1

                idCFL = rs2.Fields("ID_TBLCONFIGHEADERLOOKUP").Value
                strUL = rs2.Fields("CHARCOLUMNLABEL").Value

                maxID = maxID + 1

                var1 = maxID
                var2 = idS
                var3 = 30
                var4 = idCFL
                var5 = strUL
                var6 = Count1
                var7 = -1

                Try

                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & ",#" & dt & "#);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & "," & var3 & "," & var4 & ",'" & var5 & "'," & var6 & "," & var7 & ",#" & dt & "#);"
                    ElseIf boolSQLSer Then

                    End If

                    '''''''''''console.writeline(strSQL)
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    boolCont = False
                    var1 = ex.Message
                    var2 = var1
                End Try

                rs2.MoveNext()

            Loop

end1:

            rs1.MoveNext()

        Loop

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        If rs2.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs2.Close()
        End If

        If rs3.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs3.Close()
        End If

        If omaxID = maxID Then
        Else
            rsM.Fields("NUMMAXID").Value = maxID + 1
            rsM.Update()
            rsM.ActiveConnection = con
            rsM.UpdateBatch(AffectEnum.adAffectAll)
            rsM.Close()
        End If

        rs1 = Nothing
        rs2 = Nothing
        rs3 = Nothing
        rsM = Nothing

    End Sub

    Sub AddFields_TBLREPORTTABLEANALYTES_NUMINCSAMPLECRIT01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "NUMINCSAMPLECRIT01"
                    numU = 20
                    strT = "TBLREPORTTABLEANALYTES"
                    numTy = 1
                    intText = 100
                
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub ModifyRecords_TBLREPORTTABLE_INCURREDSAMPLES( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        'ver(1, 2) = rsVer.Fields("int1Version").Value
        'ver(2, 2) = rsVer.Fields("int2Version").Value
        'ver(3, 2) = rsVer.Fields("int3Version").Value
        'ver(4, 2) = rsVer.Fields("int4Version").Value

        Dim boolGo As Boolean = False
        If ver(1, 1) <= 2 Then
            If ver(2, 1) <= 2 Then
                If ver(3, 1) <= 25 Then
                    boolGo = True
                End If
            End If
        End If

        If boolGo Then
        Else
            GoTo end1
        End If


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLREPORTTABLE"
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLREQUIRESSAMPLEASSIGNMENT"
                    strF1 = "ID_TBLCONFIGREPORTTABLES"
                    numU1 = 30
                    numU = 0

            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF1 & " = " & numU1 & ";"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

end1:

    End Sub

    Sub AddFields_TBLDATA_BOOLFOOTNOTEQCMEAN(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim boolText As Boolean
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLFOOTNOTEQCMEAN"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False

                Case 2
                    strF = "BOOLFLIPHEADER"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLFOOTNOTEQCMEAN(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 3
            Select Case Count1
                Case 1
                    var1 = 510
                    str1 = "tblCompanyData"
                    str2 = "Footnote QC Means that exceed acceptance criteria"
                    var2 = 34
                    str3 = "TBLDATA"
                    str4 = "BOOLFOOTNOTEQCMEAN"
                    var3 = -1

                Case 2
                    var1 = 511
                    str1 = "tblCompanyData"
                    str2 = "Header/footer in right/left margin on landscape page"
                    var2 = 35
                    str3 = "TBLDATA"
                    str4 = "BOOLFLIPHEADER"
                    var3 = -1

                Case 3
                    var1 = 512
                    str1 = "TBLREPORTTABLEANALYTES"
                    str2 = "Analyte Incurred Sample Reanalysis Acceptance Criteria"
                    var2 = 1
                    str3 = "TBLREPORTTABLEANALYTES"
                    str4 = "NUMINTSAMPLECRIT01"
                    var3 = -1

            End Select

            Try

                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddFields_TBLDATA_BOOLTABLEDTTIMESTAMP(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim boolText As Boolean
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLTABLEDTTIMESTAMP"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False


            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLTABLEDTTIMESTAMP(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 509
                    str1 = "tblCompanyData"
                    str2 = "Add a date/time stamp on tables"
                    var2 = 33
                    str3 = "TBLDATA"
                    str4 = "BOOLTABLEDTTIMESTAMP"
                    var3 = -1

            End Select

            Try
                

                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLNOMCONCPAREN(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 2
            Select Case Count1
                Case 1
                    var1 = 507
                    str1 = "tblCompanyData"
                    str2 = "Place Nominal Concentrations in parentheses"
                    var2 = 31
                    str3 = "TBLDATA"
                    str4 = "BOOLNOMCONCPAREN"
                    var3 = -1

                Case 2
                    var1 = 508
                    str1 = "tblCompanyData"
                    str2 = "Table-specific page numbering option"
                    var2 = 32
                    str3 = "TBLDATA"
                    str4 = "CHARSTPAGE"
                    var3 = -1

            End Select

            Try
                

                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddFields_TBLDATA_BOOLNOMCONCPAREN(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim boolText As Boolean
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLNOMCONCPAREN"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 0
                    boolText = False

                Case 2
                    strF = "CHARSTPAGE"
                    strU = "[None]"
                    strT = "TBLDATA"
                    numTy = 202
                    intText = 15
                    boolText = True

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    If boolText Then
                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    Else
                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub ModifyAddRecords_TBLDATEFORMATS_01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String

        Dim dt As Date

        dt = Now


        boolAdd = False
        For Count2 = 1 To 7
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2

                Case 1
                    strF = "INTORDER"
                    numU = 12
                    numU1 = 11
                Case 2
                    strF = "INTORDER"
                    numU = 13
                    numU1 = 12
                Case 3
                    strSQL = "INSERT INTO TBLDATEFORMATS VALUES (13,'1 Sep 2006','d MMM yyyy',14,#" & dt & "#);"
                Case 4
                    strSQL = "INSERT INTO TBLDATEFORMATS VALUES (14,'1 September 2006','d MMMM yyyy',15,#" & dt & "#);"

                Case 5
                    strSQL = "INSERT INTO TBLDATEFORMATS VALUES (15,'01 Sep 2006','dd MMM yyyy',16,#" & dt & "#);"
                Case 6
                    strSQL = "INSERT INTO TBLDATEFORMATS VALUES (16,'01 September 2006','dd MMMM yyyy',17,#" & dt & "#);"

                Case 7
                    strSQL = "INSERT INTO TBLDATEFORMATS VALUES (17,'01-September-2006','dd-MMMM-yyyy',11,#" & dt & "#);"

            End Select

            strF1 = "ID_TBLDATEFORMATS"
            strT = "TBLDATEFORMATS"

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            Select Case Count2

                Case 1, 2
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF1 & " = " & numU1
                Case 3, 4, 5

            End Select
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_CUSTOMFIELDCODES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 6
            Select Case Count1
                Case 1
                    var1 = 501
                    str1 = "TBLPERMISSIONS"
                    str2 = "Administration: Custom Field Codes Tab"
                    var2 = 23
                    str3 = ""
                    str4 = "BOOLCUSTOMFIELDCODES"
                    var3 = -1
                Case 2
                    var1 = 502
                    str1 = "TBLPERMISSIONS"
                    str2 = "Allow editing on the Report Writer Administration - Custom Field Code tab?"
                    var2 = 23
                    str3 = "TBLPERMISSIONS"
                    str4 = "BOOLCUSTOMFIELDCODES"
                    var3 = -1

                Case 3
                    var1 = 503
                    str1 = "TBLFIELDCODES"
                    str2 = "Field Code"
                    var2 = 1
                    str3 = "TBLFIELDCODES"
                    str4 = "CHARFIELDCODE"
                    var3 = -1
                Case 4
                    var1 = 504
                    str1 = "TBLFIELDCODES"
                    str2 = "Field Code Description"
                    var2 = 2
                    str3 = "TBLFIELDCODES"
                    str4 = "CHARDESCRIPTION"
                    var3 = -1
                Case 5
                    var1 = 505
                    str1 = "TBLFIELDCODES"
                    str2 = "Field Code Example"
                    var2 = 3
                    str3 = "TBLFIELDCODES"
                    str4 = "CHAREXAMPLE"
                    var3 = -1
                Case 6
                    var1 = 506
                    str1 = "TBLCUSTOMFIELDCODES"
                    str2 = "Custom Field Code Value"
                    var2 = 1
                    str3 = "TBLCUSTOMFIELDCODES"
                    str4 = "CHARVALUE"
                    var3 = -1
            End Select

            Try
                

                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub ModifyRecords_TBLPERMISSIONS_NULL(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim dtbl As System.Data.Datatable

        strT = "TBLPERMISSIONS"

        boolAdd = False

        For Count2 = 1 To 1

            rs1.CursorLocation = CursorLocationEnum.adUseClient
            rs1.Open(strT, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockOptimistic)
            rs1.ActiveConnection = Nothing

            For Each fld In rs1.Fields

                str1 = fld.Name
                If InStr(1, str1, "bool", CompareMethod.Text) > 0 Then
                    strSQL = "UPDATE " & strT & " SET " & str1 & " = 0 WHERE " & str1 & " IS NULL;"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try
                End If

            Next

            'strM = strF
            'boolProb = False
            ''check to see if strF exists
            'boolCont = False
            '''debug.print ""
            '''debug.print "Start fields tblPKAUC..."

            'strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strU & " AND " & strF & " IS NULL;"
            'cmd.CommandText = strSQL
            'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            'Try
            '    cmd.ExecuteNonQuery()
            '    boolProb = False
            '    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            'Catch ex As Exception
            '    boolProb = True
            '    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            'End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub AddRecords_TBLTEMPLATEATTRIBUTES_36(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs As New ADODB.Recordset
        Dim rs1 As New ADODB.Recordset
        Dim id As Int64
        Dim strF As String
        Dim strF1 As String
        Dim dtbl1 As System.Data.Datatable
        Dim dtbl2 As System.Data.Datatable
        Dim rows1() As DataRow
        Dim rows2() As DataRow
        Dim arr1(3, 1)
        Dim strDt As String

        'dtbl1 = tblTemplates
        'dtbl2 = tblTemplateAttributes

        'For Count1 = 0 To dtbl1.Rows.Count - 1
        '    id = dtbl1.Rows(Count1).Item("ID_TBLTEMPLATES")
        '    strF = "ID_TBLTEMPLATES = " & id & " AND ID_TBLTAB1 = 13"
        '    Erase rows2
        '    rows2 = dtbl2.Select(strF)
        '    If rows2.Length = 0 Then
        '        'add row
        '        Dim nrow As DataRow = dtbl2.NewRow
        '        nrow.BeginEdit()
        '        nrow("ID_TBLTEMPLATE") = id
        '        nrow("ID_TBLTAB1") = 13
        '        nrow("BOOLINCLUDE") = -1
        '        nrow.EndEdit()
        '        dtbl2.Rows.Add(nrow)

        '    End If

        'Next


        strT = "TBLTEMPLATEATTRIBUTES"
        dt = Now
        'strDt = Format(dt, "dd-MMM-yyyy")

        'first open tblTemplates
        If rs.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs.Close()
        End If
        rs.CursorLocation = CursorLocationEnum.adUseClient
        rs.Open("TBLTEMPLATES", con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs.ActiveConnection = Nothing


        ReDim arr1(3, rs.RecordCount)

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open("TBLTEMPLATEATTRIBUTES", con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs1.ActiveConnection = Nothing

        Dim int1 As Short

        int1 = 0
        Do Until rs.EOF
            id = rs.Fields("ID_TBLTEMPLATES").Value
            strF = "ID_TBLTEMPLATES = " & id & " AND ID_TBLTAB1 = 36"
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then
                int1 = int1 + 1
                arr1(1, int1) = id
                arr1(2, int1) = 36
                arr1(3, int1) = -1
            End If
            rs.MoveNext()
        Loop

        If rs.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs.Close()
        End If
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs = Nothing
        rs1 = Nothing

        For Count1 = 1 To int1
            var1 = arr1(1, Count1)
            var2 = arr1(2, Count1)
            var3 = arr1(3, Count1)

            strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",NULL," & var3 & ",#" & dt & "#);"
            Try
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
            Catch ex As Exception
                var1 = ex.Message
            End Try
        Next

        'For Count1 = 1 To 1
        '    Select Case Count1
        '        Case 1
        '            var1 = 493
        '            str1 = "tblCompanyData"
        '            str2 = "Format table anomolies with red bold font"
        '            var2 = 23
        '            str3 = "tblData"
        '            str4 = "BOOLREDBOLDFONT"
        '            var3 = -1

        '    End Select

        '    Try
        '        
        '        If boolAccess Then
        '            strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
        '        ElseIf boolOra Then
        '            strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
        '        ElseIf boolSQLSer Then
        '        End If
        '        '''''''''''console.writeline(strSQL)
        '        cmd.CommandText = strSQL
        '        cmd.ExecuteNonQuery()
        '        boolProb = False
        '        strM = str1 & " executed successfully."
        '        boolCont = True

        '    Catch ex As Exception
        '        boolProb = True
        '        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        '        boolCont = False
        '    End Try

        'Next


    End Sub

    Sub AddFields_TBLPERMISSIONS_CUSTOMFIELDCODES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLCUSTOMFIELDCODES"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing
        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLTAB1_CUSTOMFIELDCODES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTAB1"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 35 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTAB1 VALUES(36,'Custom Field Codes',5,'Admin',2,0,#14-MAR-11#)"
            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:


    End Sub

    Sub CreateTable_TBLCUSTOMFIELDCODE(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLCUSTOMFIELDCODES"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'now add fields
                For Count1 = 1 To 3
                    If boolAccess Then
                        Select Case Count1
                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES double"
                            Case 2
                                strSQL = "alter table " & strT & " ADD ID_TBLFIELDCODES double"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARVALUE text(255)"
                        End Select
                    Else
                        Select Case Count1
                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES float"
                            Case 2
                                strSQL = "alter table " & strT & " ADD ID_TBLFIELDCODES float"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARVALUE nvarchar2"
                        End Select

                    End If

                    '        If boolAccess Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " Single"
                    '        Else'If boolSQLServer Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " real"
                    '        End If
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                Next

                'now add data

                Dim id As Long

                'For Count1 = 1 To 1

                '    Select Case Count1
                '        Case 1
                '            str2 = "1"

                '    End Select

                '    Try
                '        
                '        If boolAccess Then
                '            str1 = "INSERT INTO " & strT & " VALUES (1,0,0,0,0,0,0,0);"
                '        ElseIf boolOra Then
                '            str1 = "INSERT INTO " & strT & " VALUES (1,0,0,0,0,0,0,0);"
                '        ElseIf boolSQLSer Then
                '        End If
                '        cmd.CommandText = str1
                '        cmd.ExecuteNonQuery()
                '        boolProb = False
                '        strM = str1 & " executed successfully."
                '        boolCont = True

                '    Catch ex4 As Exception
                '        boolProb = True
                '        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                '        boolCont = False
                '    End Try

                'Next
            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)

    End Sub

    Sub AddRecords_TBLMAXID_TBLCUSTOMFIELDCODES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 58 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing



        For Count1 = 1 To 2

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLMAXID VALUES(59,'TBLFIELDCODES',212,#14-MAR-10#)"
                Case 2
                    strSQL = "INSERT INTO TBLMAXID VALUES(60,'TBLCUSTOMFIELDCODES',1,#14-MAR-10#)"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddFields_TBLFIELDCODES_BOOLCUSTOM(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLCUSTOM"
                    numU = 0
                    strT = "TBLFIELDCODES"
                    numTy = 2
                    intText = 100
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLFIELDCODES_TOTALANALYTICALRUNS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7
        Dim rs1 As New ADODB.Recordset
        Dim strF As String
        Dim boolCont As Boolean

        strT = "TBLFIELDCODES"

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)

        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 211
                    var2 = "[TOTALANALYTICALRUNS]"
                    var3 = "Returns the total number of Analytical Runs performed in the study"
                    var4 = "Analytical Run "
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Analytical Run "

            End Select

            boolCont = True
            strF = "ID_TBLFIELDCODES = " & var1
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then
                boolCont = True
            Else
                boolCont = False
            End If

            If boolCont Then

                Try

                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolSQLSer Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    End If
                    '''''''''''console.writeline(strSQL)
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & strSQL & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    '''''''''console.writeline(strM)
                    'MsgBox(strM)
                    boolCont = False
                End Try

            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing


    End Sub

    Sub AlterColumn_TBLQATABLES_DTCOLUMN1(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String

        strT = "TBLQATABLES"

        boolAdd = False

        For Count2 = 1 To 8

            str1 = "DTCOLUMN" & Count2

            strSQL = ""
            If boolAccess Then
                strSQL = "alter table " & strT & " ALTER COLUMN " & str1 & " text(100)"
            End If
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                strM = ex.Message
                MsgBox(strM)
            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next

    End Sub

    Sub ModifyRecords_TBLTABLEPROPERTIES_BOOLSTATSBIAS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String


        boolAdd = False
        For Count2 = 1 To 5
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                'Case 1
                '    strF = "BOOLSTATSMEAN"
                'Case 2
                '    strF = "BO0OLSTATSSD"
                'Case 3
                '    strF = "BOOLSTATSCV"
                Case 1
                    strF = "BOOLSTATSBIAS"
                Case 2
                    strF = "BOOLSTATSDIFF"
                Case 3
                    strF = "BOOLSTATSDIFFCOL"
                Case 4
                    strF = "BOOLSTATSRE"
                Case 5
                    strF = "BOOLTHEORETICAL"

            End Select

            strF1 = "ID_TBLCONFIGREPORTTABLES"
            numU = 0
            numU1 = 2
            strT = "TBLTABLEPROPERTIES"

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF1 & " = " & numU1
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next

        'conA.CommitTrans()

    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_ORDERNUMREGRDEC(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim var1, var2, var3, var4, var5, var6
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 20
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARROWNAME"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = "Data: Use Sig Figs, not Decimals"
                    strF3 = CStr(208)
                    boolText = True
                Case 2
                    strF = "CHARROWNAME"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = "Data: Use Conc Special Rounding"
                    strF3 = CStr(211)
                    boolText = True

                Case 3
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(16)
                    strF3 = CStr(212)
                    boolText = False
                Case 4
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(17)
                    strF3 = CStr(213)
                    boolText = False

                Case 5
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(12)
                    strF3 = CStr(494)
                    boolText = False
                Case 6
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(13)
                    strF3 = CStr(495)
                    boolText = False
                Case 7
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(14)
                    strF3 = CStr(496)
                    boolText = False
                Case 8
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(15)
                    strF3 = CStr(497)
                    boolText = False
                Case 9
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(18)
                    strF3 = CStr(499)
                    boolText = False
                Case 10
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(19)
                    strF3 = CStr(498)
                    boolText = False

                Case 11
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(21)
                    strF3 = CStr(201)
                    boolText = False
                Case 12
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(22)
                    strF3 = CStr(202)
                    boolText = False
                Case 13
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(23)
                    strF3 = CStr(209)
                    boolText = False
                Case 14
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(24)
                    strF3 = CStr(255)
                    boolText = False
                Case 15
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(25)
                    strF3 = CStr(256)
                    boolText = False
                Case 16
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(26)
                    strF3 = CStr(258)
                    boolText = False
                Case 17
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(27)
                    strF3 = CStr(259)
                    boolText = False
                Case 18
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(28)
                    strF3 = CStr(473)
                    boolText = False
                Case 19
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(29)
                    strF3 = CStr(474)
                    boolText = False
                Case 20
                    strF = "INTORDER"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(30)
                    strF3 = CStr(493)
                    boolText = False

            End Select

            '20  201
            '21  202
            '22  209
            '23  255
            '24  256
            '25  258
            '26  259
            '27  473
            '28  474
            '29  493

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            If boolText Then
                strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strF3 & ";"
            Else
                strSQL = "UPDATE " & strT & " SET " & strF & " = " & strF2 & " WHERE " & strF1 & " = " & strF3 & ";"
            End If
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_NUMSIGFIGSAREA(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 7
            Select Case Count1
                Case 1
                    var1 = 494
                    str1 = "tblCompanyData"
                    str2 = "Peak Area Significant Figures"
                    var2 = 24
                    str3 = "tblData"
                    str4 = "NUMSIGFIGSAREA"
                    var3 = -1
                Case 2
                    var1 = 495
                    str1 = "tblCompanyData"
                    str2 = "Peak Area Decimal Places"
                    var2 = 25
                    str3 = "tblData"
                    str4 = "NUMDECIMALSAREA"
                    var3 = -1
                Case 3
                    var1 = 496
                    str1 = "tblCompanyData"
                    str2 = "Peak Areas: Use Sig Figs, not Decimals"
                    var2 = 26
                    str3 = "tblData"
                    str4 = "BOOLUSESIGFIGSAREA"
                    var3 = -1
                Case 4
                    var1 = 497
                    str1 = "tblCompanyData"
                    str2 = "Use Peak Area Special Rounding"
                    var2 = 27
                    str3 = "tblData"
                    str4 = "BOOLUSESPECRNDAREA"
                    var3 = -1

                Case 5
                    var1 = 499
                    str1 = "tblCompanyData"
                    str2 = "Regression and R2 Decimal Places"
                    var2 = 28
                    str3 = "tblData"
                    str4 = "NUMREGRDEC"
                    var3 = -1

                Case 6
                    var1 = 498
                    str1 = "tblCompanyData"
                    str2 = "Regression and R2: Use Sig Figs, not Decimals"
                    var2 = 29
                    str3 = "tblData"
                    str4 = "BOOLUSESIGFIGSREGR"
                    var3 = -1

                Case 7
                    var1 = 500
                    str1 = "tblCompanyData"
                    str2 = "Regression and R2: Use Sci. Notation"
                    var2 = 20
                    str3 = "tblData"
                    str4 = "BOOLUSEREGRSCINOT"
                    var3 = -1


            End Select

            Try

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddFields_TBLDATA_NUMSIGFIGSAREA(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 7
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "NUMSIGFIGSAREA"
                    numU = 3
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
                Case 2
                    strF = "NUMDECIMALSAREA"
                    numU = 3
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
                Case 3
                    strF = "BOOLUSESIGFIGSAREA"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
                Case 4
                    strF = "BOOLUSESPECRNDAREA"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100

                Case 5
                    strF = "NUMREGRDEC"
                    numU = 3
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
                Case 6
                    strF = "BOOLUSESIGFIGSREGR"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100

                Case 7
                    strF = "BOOLUSEREGRSCINOT"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_DTSTUDYSTARTDATE(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim var1, var2, var3, var4, var5, var6
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLINCLUDE"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(-1)
                    strF3 = CStr(264)
                Case 2
                    strF = "BOOLINCLUDE"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = CStr(-1)
                    strF3 = CStr(265)

            End Select

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = " & strF2 & " WHERE " & strF1 & " = " & strF3 & ";"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If


        Next

    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_ANOMALIES(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim var1, var2, var3, var4, var5, var6
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARROWNAME"
                    strF1 = "ID_TBLDATATABLEROWTITLES"
                    strF2 = "Format table anomalies with red bold font"
                    strF3 = CStr(493)

            End Select

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strF3 & ";"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next

    End Sub

    Sub AlterColumn_TBLMETHODVALIDATIONDATA_CHARPROCSTABILITY(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String

        strT = "TBLMETHODVALIDATIONDATA"

        boolAdd = False

        For Count2 = 1 To 5

            Select Case Count2

                Case 1
                    str1 = "CHARPROCSTABILITY"
                Case 2
                    str1 = "CHARREFRSTAB"
                Case 3
                    str1 = "CHARFTSTAB"
                Case 4
                    str1 = "CHARLTSTORSTAB"
                Case 5
                    str1 = "CHARDILINTEGR"

            End Select

            strSQL = ""
            If boolAccess Then
                strSQL = "alter table " & strT & " ALTER COLUMN " & str1 & " text(255)"
            End If
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next

    End Sub

    Sub ModifyRecords_TBLREPORTTABLE_333435(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String

        strT = "TBLREPORTTABLE"

        boolAdd = False

        strF = "CHARHEADINGTEXT"
        strF1 = "ID_TBLCONFIGREPORTTABLES"

        For Count2 = 1 To 3

            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200


            Select Case Count2
                Case 1
                    strF2 = "System Suitability Table v1"
                    strU = "33"
                Case 2
                    strF2 = "Selectivity in Individual Lots Table v1"
                    strU = "34"
                Case 3
                    strF2 = "Carryover in Individual Lots Table v1"
                    strU = "35"

            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strU & " AND " & strF & " IS NULL;"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_TBLTEMPLATEATTRIBUTES_13(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs As New ADODB.Recordset
        Dim rs1 As New ADODB.Recordset
        Dim id As Int64
        Dim strF As String
        Dim strF1 As String
        Dim dtbl1 As System.Data.Datatable
        Dim dtbl2 As System.Data.Datatable
        Dim rows1() As DataRow
        Dim rows2() As DataRow
        Dim arr1(3, 1)
        Dim strDt As String

        'dtbl1 = tblTemplates
        'dtbl2 = tblTemplateAttributes

        'For Count1 = 0 To dtbl1.Rows.Count - 1
        '    id = dtbl1.Rows(Count1).Item("ID_TBLTEMPLATES")
        '    strF = "ID_TBLTEMPLATES = " & id & " AND ID_TBLTAB1 = 13"
        '    Erase rows2
        '    rows2 = dtbl2.Select(strF)
        '    If rows2.Length = 0 Then
        '        'add row
        '        Dim nrow As DataRow = dtbl2.NewRow
        '        nrow.BeginEdit()
        '        nrow("ID_TBLTEMPLATE") = id
        '        nrow("ID_TBLTAB1") = 13
        '        nrow("BOOLINCLUDE") = -1
        '        nrow.EndEdit()
        '        dtbl2.Rows.Add(nrow)

        '    End If

        'Next


        strT = "TBLTEMPLATEATTRIBUTES"
        dt = Now
        'strDt = Format(dt, "dd-MMM-yyyy")

        'first open tblTemplates
        If rs.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs.Close()
        End If
        rs.CursorLocation = CursorLocationEnum.adUseClient
        rs.Open("TBLTEMPLATES", con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs.ActiveConnection = Nothing


        ReDim arr1(3, rs.RecordCount)

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open("TBLTEMPLATEATTRIBUTES", con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs1.ActiveConnection = Nothing

        Dim int1 As Short

        int1 = 0
        Do Until rs.EOF
            id = rs.Fields("ID_TBLTEMPLATES").Value
            strF = "ID_TBLTEMPLATES = " & id & " AND ID_TBLTAB1 = 13"
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then
                int1 = int1 + 1
                arr1(1, int1) = id
                arr1(2, int1) = 13
                arr1(3, int1) = -1
            End If
            rs.MoveNext()
        Loop

        If rs.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs.Close()
        End If
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs = Nothing
        rs1 = Nothing

        For Count1 = 1 To int1
            var1 = arr1(1, Count1)
            var2 = arr1(2, Count1)
            var3 = arr1(3, Count1)

            strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",NULL," & var3 & ",#" & dt & "#);"
            Try
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
            Catch ex As Exception
                var1 = ex.Message
            End Try
        Next

        'For Count1 = 1 To 1
        '    Select Case Count1
        '        Case 1
        '            var1 = 493
        '            str1 = "tblCompanyData"
        '            str2 = "Format table anomolies with red bold font"
        '            var2 = 23
        '            str3 = "tblData"
        '            str4 = "BOOLREDBOLDFONT"
        '            var3 = -1

        '    End Select

        '    Try
        '        
        '        If boolAccess Then
        '            strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
        '        ElseIf boolOra Then
        '            strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
        '        ElseIf boolSQLSer Then
        '        End If
        '        '''''''''''console.writeline(strSQL)
        '        cmd.CommandText = strSQL
        '        cmd.ExecuteNonQuery()
        '        boolProb = False
        '        strM = str1 & " executed successfully."
        '        boolCont = True

        '    Catch ex As Exception
        '        boolProb = True
        '        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        '        boolCont = False
        '    End Try

        'Next


    End Sub

    Sub ModifyRecords_TBLTAB1_BOOLINCLUDEINTEMPLATE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        'Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim boolDelete As Boolean


        boolAdd = False
        For Count2 = 1 To 5
            boolAdd = False
            boolDelete = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLINCLUDEINTEMPLATE"
                    strF1 = "ID_TBLTAB1"
                    strT = "TBLTAB1"
                    numU = 0
                    numU1 = 26
                Case 2
                    strF = "BOOLINCLUDEINTEMPLATE"
                    strF1 = "ID_TBLTAB1"
                    strT = "TBLTAB1"
                    numU = 0
                    numU1 = 34

                Case 3
                    strF = "BOOLINCLUDEINTEMPLATE"
                    strF1 = "ID_TBLTAB1"
                    strT = "TBLTAB1"
                    numU = -1
                    numU1 = 13

                Case 4
                    strF = "BOOLINCLUDEINTEMPLATE"
                    strF1 = "ID_TBLTAB1"
                    strT = "TBLTEMPLATEATTRIBUTES"
                    numU = 0
                    numU1 = 26
                    boolDelete = True
                Case 5
                    strF = "BOOLINCLUDEINTEMPLATE"
                    strF1 = "ID_TBLTAB1"
                    strT = "TBLTEMPLATEATTRIBUTES"
                    numU = 0
                    numU1 = 34
                    boolDelete = True


            End Select


            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            If boolDelete Then
                strSQL = "DELETE FROM " & strT & " WHERE " & strF1 & " = " & numU1 '"
            Else
                strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF1 & " = " & numU1 '"
            End If
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next



    End Sub

    Sub AddFields_TBLDATA_BOOLREDBOLDFONT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLREDBOLDFONT"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_BOOLREDBOLDFONT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 493
                    str1 = "tblCompanyData"
                    str2 = "Format table anomalies with red bold font"
                    var2 = 23
                    str3 = "tblData"
                    str4 = "BOOLREDBOLDFONT"
                    var3 = -1

            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub



    Sub ModifyRecords_TBLTABLEPROPERTIES_BOOLINCLANOVASUMSTATS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strF1 As String
        Dim strF2 As String

        boolAdd = False

        strT = "TBLTABLEPROPERTIES"

        For Count2 = 1 To 6
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLINTRARUNSUMSTATS"
                    numU = 13
                    strF1 = "BOOLINCLANOVASUMSTATS"
                Case 2
                    strF = "BOOLINTRARUNSUMSTATS"
                    numU = 14
                    strF1 = "BOOLINCLANOVASUMSTATS"
                Case 3
                    strF = "BOOLINTRARUNSUMSTATS"
                    numU = 15
                    strF1 = "BOOLINCLANOVASUMSTATS"


                Case 4
                    strF = "BOOLINCLANOVASUMSTATS"
                    numU = 13
                    strF1 = "BOOLINCLANOVASUMSTATS"
                Case 5
                    strF = "BOOLINCLANOVASUMSTATS"
                    numU = 14
                    strF1 = "BOOLINCLANOVASUMSTATS"
                Case 6
                    strF = "BOOLINCLANOVASUMSTATS"
                    numU = 15
                    strF1 = "BOOLINCLANOVASUMSTATS"

            End Select

            boolCont = False

            If boolCont = False Then 'field needs to be added

                boolAdd = True

                If boolAdd Then 'update records


                    Select Case Count2
                        Case 1, 2, 3
                            strSQL = "UPDATE " & strT & " SET " & strF & " = -1 WHERE " & strF1 & " = -1 AND ID_TBLCONFIGREPORTTABLES = " & numU & ";"
                        Case 4, 5, 6
                            strSQL = "UPDATE " & strT & " SET " & strF & " = 0 WHERE " & strF1 & " = -1 AND ID_TBLCONFIGREPORTTABLES = " & numU & ";"
                    End Select
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_BOOLINCLANOVASUMSTATS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strF1 As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARROWNAME"
                    numU = 389
                    strT = "TBLDATATABLEROWTITLES"
                    strF1 = "Include Inter-run Summary Stats"


            End Select

            boolCont = False

            If boolCont = False Then 'field needs to be added

                boolAdd = True

                If boolAdd Then 'update records

                    'delete all records from tblAudiTrail

                    If Count2 = 1 Then

                        strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF1 & "' WHERE ID_" & strT & " = 389;"
                        cmd.CommandText = strSQL
                        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                        Try
                            cmd.ExecuteNonQuery()
                            boolProb = False
                            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                        'intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If

                    End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_COMPLIANCE_02(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLDATATABLEROWTITLES"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 >= 492 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(492,'TBLTABLEPROPERTIES','Include Intra-run Summary Stats',NULL,'TBLTABLEPROPERTIES','BOOLINTRARUNSUMSTATS',-1,#1/15/2011#,NULL)"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:


    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_BOOLINTRARUNSTATS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 100
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2

                Case 1
                    strF = "BOOLINTRARUNSUMSTATS"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                Select Case Count2

                End Select

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_tblAssignedSamplesHelper_37(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim int1 As Short

        strT = "tblAssignedSamplesHelper"
        dt = Now
        int1 = 85
        For Count1 = 1 To 5
            Select Case Count1
                Case 1
                    var1 = int1 + Count1
                    var2 = "Control with IS"
                    var3 = 37
                    var4 = 1
                Case 2
                    var1 = int1 + Count1
                    var2 = "Control without IS"
                    var3 = 37
                    var4 = 1
                Case 3
                    var1 = int1 + Count1
                    var2 = "Fortified tissue - half tolerance"
                    var3 = 37
                    var4 = 1
                Case 4
                    var1 = int1 + Count1
                    var2 = "Fortified tissue - tolerance"
                    var3 = 37
                    var4 = 1
                Case 5
                    var1 = int1 + Count1
                    var2 = "Fortified tissue - twice tolerance"
                    var3 = 37
                    var4 = 1

            End Select

            Try
                
                If boolAccess Then
                    str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3," & var4 & ");"
                ElseIf boolOra Then
                    str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3," & var4 & ");"
                ElseIf boolSQLSer Then
                End If
                cmd.CommandText = str1
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddRecords_TBLCONFIGHEADERLOOKUP_363738(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7


        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now
        For Count1 = 1 To 38
            Select Case Count1
                Case 1
                    strSQL = "INSERT INTO " & strT & "  VALUES (168,36,'Watson Run ID',1,'SAMPLERESULTS','RUNID',-1,#09-Jan-11#);"
                Case 2
                    strSQL = "INSERT INTO " & strT & "  VALUES (169,36,'Sample Description',2,'ANARUNRAWANALYTEPEAK','SAMPLENAME',-1,#09-Jan-11#);"
                Case 3
                    strSQL = "INSERT INTO " & strT & "  VALUES (170,36,'Sequence ID',3,'ANALYTICALRUNSAMPLE','RUNSAMPLESEQUENCENUMBER',-1,#09-Jan-11#);"
                Case 4
                    strSQL = "INSERT INTO " & strT & "  VALUES (171,36,'Sample Type',4,'CONFIGSAMPLETYPES','SAMPLETYPEID',-1,#09-Jan-11#);"
                Case 5
                    strSQL = "INSERT INTO " & strT & "  VALUES (172,36,'Nominal Conc.',5,'ASSAYANALYTEKNOWN','CONCENTRATION',-1,#09-Jan-11#);"
                Case 6
                    strSQL = "INSERT INTO " & strT & "  VALUES (173,36,'RT (min)',6,'ANARUNRAWANALYTEPEAK','ANALYTEPEAKRETENTIONTIME',-1,#09-Jan-11#);"
                Case 7
                    strSQL = "INSERT INTO " & strT & "  VALUES (174,36,'Analyte Area',7,'ANARUNRAWANALYTEPEAK','ANALYTEAREA',-1,#09-Jan-11#);"
                Case 8
                    strSQL = "INSERT INTO " & strT & "  VALUES (175,36,'Int. Std. Area',8,'ANARUNRAWANALYTEPEAK','INTERNALSTANDARDAREA',-1,#09-Jan-11#);"
                Case 9
                    strSQL = "INSERT INTO " & strT & "  VALUES (176,36,'Peak Area Ratio',9,'','',-1,#09-Jan-11#);"
                Case 10
                    strSQL = "INSERT INTO " & strT & "  VALUES (177,36,'Calc. Conc.',10,'ANARUNANALYTERESULTS','CONCENTRATION',-1,#09-Jan-11#);"
                Case 11
                    strSQL = "INSERT INTO " & strT & "  VALUES (178,36,'%Rec',11,'','',-1,#09-Jan-11#);"
                Case 12
                    strSQL = "INSERT INTO " & strT & "  VALUES (179,37,'Watson Run ID',1,'SAMPLERESULTS','RUNID',-1,#09-Jan-11#);"
                Case 13
                    strSQL = "INSERT INTO " & strT & "  VALUES (180,37,'Sample Description',2,'ANARUNRAWANALYTEPEAK','SAMPLENAME',-1,#09-Jan-11#);"
                Case 14
                    strSQL = "INSERT INTO " & strT & "  VALUES (181,37,'Sequence ID',3,'ANALYTICALRUNSAMPLE','RUNSAMPLESEQUENCENUMBER',-1,#09-Jan-11#);"
                Case 15
                    strSQL = "INSERT INTO " & strT & "  VALUES (182,37,'Sample Type',4,'CONFIGSAMPLETYPES','SAMPLETYPEID',-1,#09-Jan-11#);"
                Case 16
                    strSQL = "INSERT INTO " & strT & "  VALUES (183,37,'Nominal Conc.',5,'ASSAYANALYTEKNOWN','CONCENTRATION',-1,#09-Jan-11#);"
                Case 17
                    strSQL = "INSERT INTO " & strT & "  VALUES (184,37,'RT (min)',6,'ANARUNRAWANALYTEPEAK','ANALYTEPEAKRETENTIONTIME',-1,#09-Jan-11#);"
                Case 18
                    strSQL = "INSERT INTO " & strT & "  VALUES (185,37,'Analyte Area',7,'ANARUNRAWANALYTEPEAK','ANALYTEAREA',-1,#09-Jan-11#);"
                Case 19
                    strSQL = "INSERT INTO " & strT & "  VALUES (186,37,'Int. Std. Area',8,'ANARUNRAWANALYTEPEAK','INTERNALSTANDARDAREA',-1,#09-Jan-11#);"
                Case 20
                    strSQL = "INSERT INTO " & strT & "  VALUES (187,37,'Peak Area Ratio',9,'','',-1,#09-Jan-11#);"
                Case 21
                    strSQL = "INSERT INTO " & strT & "  VALUES (188,37,'Calc. Conc.',10,'ANARUNANALYTERESULTS','CONCENTRATION',-1,#09-Jan-11#);"
                Case 22
                    strSQL = "INSERT INTO " & strT & "  VALUES (189,37,'%Rec',11,'','',-1,#09-Jan-11#);"
                Case 23
                    strSQL = "INSERT INTO " & strT & "  VALUES (190,37,'Average %Rec',12,'','',-1,#09-Jan-11#);"
                Case 24
                    strSQL = "INSERT INTO " & strT & "  VALUES (191,37,'%CV',13,'','',-1,#09-Jan-11#);"
                Case 25
                    strSQL = "INSERT INTO " & strT & "  VALUES (192,38,'Watson Run ID',1,'SAMPLERESULTS','RUNID',-1,#09-Jan-11#);"
                Case 26
                    strSQL = "INSERT INTO " & strT & "  VALUES (193,38,'Sample Description',2,'ANARUNRAWANALYTEPEAK','SAMPLENAME',-1,#09-Jan-11#);"
                Case 27
                    strSQL = "INSERT INTO " & strT & "  VALUES (194,38,'Sequence ID',3,'ANALYTICALRUNSAMPLE','RUNSAMPLESEQUENCENUMBER',-1,#09-Jan-11#);"
                Case 28
                    strSQL = "INSERT INTO " & strT & "  VALUES (195,38,'Sample Type',4,'CONFIGSAMPLETYPES','SAMPLETYPEID',-1,#09-Jan-11#);"
                Case 29
                    strSQL = "INSERT INTO " & strT & "  VALUES (196,38,'Nominal Conc.',5,'','',-1,#09-Jan-11#);"
                Case 30
                    strSQL = "INSERT INTO " & strT & "  VALUES (197,38,'RT (min)',6,'ANARUNRAWANALYTEPEAK','ANALYTEPEAKRETENTIONTIME',-1,#09-Jan-11#);"
                Case 31
                    strSQL = "INSERT INTO " & strT & "  VALUES (198,38,'Analyte Area',7,'ANARUNRAWANALYTEPEAK','ANALYTEAREA',-1,#09-Jan-11#);"
                Case 32
                    strSQL = "INSERT INTO " & strT & "  VALUES (199,38,'Int. Std. Area',8,'ANARUNRAWANALYTEPEAK','INTERNALSTANDARDAREA',-1,#09-Jan-11#);"
                Case 33
                    strSQL = "INSERT INTO " & strT & "  VALUES (200,38,'Peak Area Ratio',9,'','',-1,#09-Jan-11#);"
                Case 34
                    strSQL = "INSERT INTO " & strT & "  VALUES (201,38,'Calc. Conc.',10,'ANARUNANALYTERESULTS','CONCENTRATION',-1,#09-Jan-11#);"
                Case 35
                    strSQL = "INSERT INTO " & strT & "  VALUES (202,38,'Final Vol (mL)',11,'','',-1,#09-Jan-11#);"
                Case 36
                    strSQL = "INSERT INTO " & strT & "  VALUES (203,38,'Exact Sample Weight" & ChrW(160) & "(g)',12,'','',-1,#09-Jan-11#);"
                Case 37
                    strSQL = "INSERT INTO " & strT & "  VALUES (204,38,'Actual Conc. (ng/g)',13,'','',-1,#09-Jan-11#);"
                Case 38
                    strSQL = "INSERT INTO " & strT & "  VALUES (205,38,'Reported Conc. (ng/g)',14,'','',-1,#09-Jan-11#);"
            End Select

            Try
                
                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddRecords_tblConfigReportTables_363738(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7


        strT = "tblConfigReportTables"
        dt = Now
        For Count1 = 1 To 3
            Select Case Count1
                Case 1
                    var1 = 36
                    var2 = "Method Trial Back-Calculated Calibration Std Conc v1"
                    var3 = 29
                    var4 = -1
                    var5 = 0
                    var6 = -1
                    var7 = 0
                Case 2
                    var1 = 37
                    var2 = "Method Trial Control and Fortified QC Samples v1"
                    var3 = 30
                    var4 = -1
                    var5 = 0
                    var6 = -1
                    var7 = 0
                Case 3
                    var1 = 38
                    var2 = "Method Trial Incurred Blinded Samples v1"
                    var3 = 31
                    var4 = -1
                    var5 = 0
                    var6 = -1
                    var7 = 0
            End Select

            Try
                
                If boolAccess Then
                    str1 = "INSERT INTO " & strT & "  VALUES (" & var1 & ",3,'" & var2 & "'," & var3 & ",-1,0,-1,0,0," & var7 & "," & var6 & ",#" & dt & "#,3," & var5 & ",0,0," & var4 & ");"
                ElseIf boolOra Then
                    str1 = "INSERT INTO " & strT & "  VALUES (" & var1 & ",3,'" & var2 & "'," & var3 & ",-1,0,-1,0,0," & var7 & "," & var6 & ",#" & dt & "#,3," & var5 & ",0,0," & var4 & ");"
                ElseIf boolSQLSer Then
                End If
                cmd.CommandText = str1
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddFields_TBLAPPFIGS_BOOLINSERTWORDDOCS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLINSERTWORDDOCS"
                    numU = 0
                    strT = "TBLAPPFIGS"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False
            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'delete all records from tblAudiTrail

                    If Count2 = 1 Then

                        strSQL = "UPDATE " & strT & " SET " & strF & " = 0;"
                        cmd.CommandText = strSQL
                        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                        Try
                            cmd.ExecuteNonQuery()
                            boolProb = False
                            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                        'intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If

                    End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLREPORTS_BOOLREADONLYTABLES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLREADONLYTABLES"
                    numU = 0
                    strT = "TBLREPORTS"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False
            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'delete all records from tblAudiTrail

                    If Count2 = 1 Then

                        strSQL = "UPDATE " & strT & " SET " & strF & " = 0;"
                        cmd.CommandText = strSQL
                        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                        Try
                            cmd.ExecuteNonQuery()
                            boolProb = False
                            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                        'intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If

                    End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLFIELDCODES_TOCs(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7
        Dim rs1 As New ADODB.Recordset
        Dim strF As String
        Dim boolCont As Boolean

        strT = "TBLFIELDCODES"

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)

        dt = Now
        For Count1 = 1 To 8
            Select Case Count1
                Case 1
                    var1 = 204
                    var2 = "[TABLEOFCONTENTS_02]"
                    var3 = "Inserts a Word Table of Contents without a TofC Heading"
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Formatting Items"
                Case 2
                    var1 = 205
                    var2 = "[TABLEOFFIGURES_02]"
                    var3 = "Inserts a Word Table of Figures without a TofF Heading"
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Formatting Items"
                Case 3
                    var1 = 206
                    var2 = "[TABLEOFTABLES_02]"
                    var3 = "Inserts a Word Table of Tables without a TofT Heading"
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Formatting Items"
                Case 4
                    var1 = 207
                    var2 = "[TABLEOFAPPENDICES_02]"
                    var3 = "Inserts a Word Table of Appendices without a TofA Heading"
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Formatting Items"


                Case 5
                    var1 = 208
                    var2 = "[LASTATTACHMENT#]"
                    var3 = "Returns last Attachment number."
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Report Items"
                Case 6
                    var1 = 209
                    var2 = "[ATTACHMENTSECTION_01]"
                    var3 = "Inserts the Attachments (configured as Appendices) in the StudyDoc Appendices and Figures page."
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Report Items"
                Case 7
                    var1 = 210
                    var2 = "[TABLEOFATTACHMENTS_01]"
                    var3 = "Inserts a Word Table of Attachments."
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Formatting Item"
                Case 8
                    var1 = 210
                    var2 = "[TABLEOFATTACHMENTS_02]"
                    var3 = "Inserts a Word Table of Attachments without a TofA Heading."
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Formatting Item"


            End Select

            boolCont = True
            strF = "ID_TBLFIELDCODES = " & var1
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then
                boolCont = True
            Else
                boolCont = False
            End If

            If boolCont Then

                Try
                    
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolSQLSer Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    End If
                    '''''''''''console.writeline(strSQL)
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & strSQL & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    '''''''''console.writeline(strM)
                    'MsgBox(strM)
                    boolCont = False
                End Try

            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing


    End Sub

    Sub AddFields_TBLREPORTS_BOOLINSERTWORDDOCS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLINSERTWORDDOCS"
                    numU = 0
                    strT = "TBLREPORTS"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False
            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'delete all records from tblAudiTrail

                    If Count2 = 1 Then

                        strSQL = "UPDATE " & strT & " SET " & strF & " = 0;"
                        cmd.CommandText = strSQL
                        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                        Try
                            cmd.ExecuteNonQuery()
                            boolProb = False
                            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                        'intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If

                    End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLREPORTS_BOOLDISPLAYATTACHMENT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLDISPLAYATTACHMENTS"
                    numU = 0
                    strT = "TBLREPORTS"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False
            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'delete all records from tblAudiTrail

                    If Count2 = 1 Then

                        strSQL = "UPDATE " & strT & " SET " & strF & " = 0;"
                        cmd.CommandText = strSQL
                        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                        Try
                            cmd.ExecuteNonQuery()
                            boolProb = False
                            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                        'intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If

                    End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLFIELDCODES_SIGBLOCKS01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7
        Dim rs1 As New ADODB.Recordset
        Dim strF As String
        Dim boolCont As Boolean

        strT = "TBLFIELDCODES"

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)

        dt = Now
        For Count1 = 1 To 4
            Select Case Count1
                Case 1
                    var1 = 197
                    var2 = "[LASTTABLE#]"
                    var3 = "Returns last Table number."
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Report Items"
                Case 2
                    var1 = 198
                    var2 = "[LASTFIGURE#]"
                    var3 = "Returns last Figure number."
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Report Items"
                Case 3
                    var1 = 199
                    var2 = "[LASTAPPENDIX#]"
                    var3 = "Returns last Appendix number."
                    var4 = "NA"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Report Items"

                Case 4
                    var1 = 203
                    var2 = "[WATSONSTUDYTITLE]"
                    var3 = "Retrieves the Study Title as recorded in Watson"
                    var4 = "Home"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Report Items"

            End Select

            boolCont = True
            strF = "ID_TBLFIELDCODES = " & var1
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then
                boolCont = True
            Else
                boolCont = False
            End If

            If boolCont Then

                Try
                    
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolSQLSer Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    End If
                    '''''''''''console.writeline(strSQL)
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & strSQL & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    '''''''''console.writeline(strM)
                    'MsgBox(strM)
                    boolCont = False
                End Try

            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If

        rs1 = Nothing


    End Sub

    Sub AddFields_TBLSAVEEVENT_BOOLS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 10
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLREPORTWRITER"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 2
                    intText = 100
                Case 2
                    strF = "BOOLGUWUADMIN"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 2
                    intText = 100
                Case 3
                    strF = "BOOLREPORTWRITERADMIN"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 2
                    intText = 100
                Case 4
                    strF = "BOOLSTUDYDESIGN"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 2
                    intText = 100
                Case 5
                    strF = "INTNUMADDS"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 2
                    intText = 100
                Case 6
                    strF = "INTNUMDELETES"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 2
                    intText = 100
                Case 7
                    strF = "INTNUMMODIFIES"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 2
                    intText = 100

                Case 8
                    strF = "BOOLSTUDYDESIGNADMIN"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 2
                    intText = 100

                Case 9
                    strF = "CHARREASONFORCHANGE"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 202
                    intText = 200

                Case 10
                    strF = "CHARMEANINGOFSIG"
                    numU = 0
                    strT = "TBLSAVEEVENT"
                    numTy = 202
                    intText = 200


            End Select

            boolProb = False
            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'delete all records from tblAudiTrail

                    If Count2 = 1 Then

                        strSQL = "DELETE * FROM TBLAUDITTRAIL;"
                        cmd.CommandText = strSQL
                        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                        Try
                            cmd.ExecuteNonQuery()
                            boolProb = False
                            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                        'make tblMaxID = 1

                        strSQL = "UPDATE TBLMAXID SET NUMMAXID = 1 WHERE CHARTABLE = 'TBLSAVEENENT';"
                        cmd.CommandText = strSQL
                        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                        Try
                            cmd.ExecuteNonQuery()
                            boolProb = False
                            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                        'intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If

                    End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_CORPORATENICKNAMES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 11
            Select Case Count1
                Case 1
                    var1 = 481
                    str1 = "TBLCORPORATENICKNAMES"
                    str2 = "Corporate Nickname"
                    var2 = 22
                    str3 = "TBLCORPORATENICKNAMES"
                    str4 = "CHARNICKNAME"
                    var3 = -1
                Case 2
                    var1 = 482
                    str1 = "TBLCORPORATENICKNAMES"
                    str2 = "Active"
                    var2 = 23
                    str3 = "TBLCORPORATENICKNAMES"
                    str4 = "BOOLINCLUDE"
                    var3 = -1

                Case 3
                    var1 = 483
                    str1 = "TBLMEANINGOFSIG"
                    str2 = "Default"
                    var2 = 23
                    str3 = "TBLMEANINGOFSIG"
                    str4 = "BOOLDEFAULT"
                    var3 = -1

                Case 4
                    var1 = 484
                    str1 = "TBLREASONFORCHANGE"
                    str2 = "Default"
                    var2 = 23
                    str3 = "TBLREASONFORCHANGE"
                    str4 = "BOOLDEFAULT"
                    var3 = -1

                Case 5
                    var1 = 485
                    str1 = "TBLCONFIGCOMPLIANCE"
                    str2 = "Audit Trail Option On"
                    var2 = "0"
                    str3 = "TBLCONFIGCOMPLIANCE"
                    str4 = "BOOLAUDITTRAIL"
                    var3 = -1

                Case 6
                    var1 = 486
                    str1 = "TBLCONFIGCOMPLIANCE"
                    str2 = "Electronic Signature Option On"
                    var2 = "0"
                    str3 = "TBLCONFIGCOMPLIANCE"
                    str4 = "BOOLESIG"
                    var3 = -1

                Case 7
                    var1 = 487
                    str1 = "TBLCONFIGCOMPLIANCE"
                    str2 = "User ID Option - Only Logged On User"
                    var2 = "0"
                    str3 = "TBLCONFIGCOMPLIANCE"
                    str4 = "BOOLLOGGEDONUSER"
                    var3 = -1

                Case 8
                    var1 = 488
                    str1 = "TBLCONFIGCOMPLIANCE"
                    str2 = "Include Meaning of Signature checkbox"
                    var2 = "0"
                    str3 = "TBLCONFIGCOMPLIANCE"
                    str4 = "BOOLMEANINGOFSIG"
                    var3 = -1

                Case 9
                    var1 = 489
                    str1 = "TBLCONFIGCOMPLIANCE"
                    str2 = "Meaning of Signature - Restrict to dropdown choices checkbox"
                    var2 = "0"
                    str3 = "TBLCONFIGCOMPLIANCE"
                    str4 = "BOOLRESTRICTSIG"
                    var3 = -1

                Case 10
                    var1 = 490
                    str1 = "TBLCONFIGCOMPLIANCE"
                    str2 = "Include Reason for Change checkbox"
                    var2 = "0"
                    str3 = "TBLCONFIGCOMPLIANCE"
                    str4 = "BOOLREASONFORCHANGE"
                    var3 = -1

                Case 11
                    var1 = 491
                    str1 = "TBLCONFIGCOMPLIANCE"
                    str2 = "Reason for Change - Restrict to dropdown choices checkbox"
                    var2 = "0"
                    str3 = "TBLCONFIGCOMPLIANCE"
                    str4 = "BOOLRESTRICTREASON"
                    var3 = -1


            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddFields_RFC_MOS_DEFAULT(ByVal frmUpdate As frmUpdateCheck, ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs2 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        'need to wait. Errors if tbls created in same event

        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Pause(0.5)
            Select Case Count2
                Case 2
                    strF = "BOOLDEFAULT"
                    numU = 0
                    strT = "TBLREASONFORCHANGE"
                    numTy = 2
                    intText = 100
                Case 1
                    strF = "BOOLDEFAULT"
                    numU = 0
                    strT = "TBLMEANINGOFSIG"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False

            'rs2.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            'Pause(1)
            rs2.Open(strT, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
            'If rs2.EOF And rs2.BOF Then
            'Else
            '    rs2.MoveFirst()
            'End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs2.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs2.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                ''''''''console.writeline(strSQL)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = strM & ChrW(10) & ex.Message

                End Try

                'Modify records
                boolAdd = True
                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs2.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs2.Close()
            End If

        Next

        If rs2.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs2.Close()
        End If
        rs2 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub ModifyRecords_TBLPERMISSIONS_STUDYDESIGNNULLS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim idCR As Int64
        Dim idTS As Int64
        Dim strField As String
        Dim strVal As String
        Dim boolVal As Boolean
        Dim intVal As Short

        boolAdd = False
        strT = "TBLPERMISSIONS"

        For Count1 = 1 To 3

            boolVal = True
            strVal = ""
            intVal = 0
            Select Case Count1
                Case 1
                    strField = "BOOLSDPROJECTS"

                Case 2
                    strField = "BOOLSDSTUDIES"

                Case 3
                    strField = "BOOLSDASSAYS"

            End Select

            strSQL = "UPDATE " & strT & " SET " & strField & " = 0 WHERE " & strField & " IS NULL;"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next

        'conA.CommitTrans()


    End Sub

    Sub DeleteRecords_TBLPERMISSIONS(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        'There seems to be residual data from old data

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim rs2 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim str6 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim intL As Short
        Dim dt As Date

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open("TBLPERMISSIONS", con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.ActiveConnection = Nothing

        rs2.CursorLocation = CursorLocationEnum.adUseClient
        rs2.Open("TBLUSERACCOUNTS", con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs2.ActiveConnection = Nothing

        Dim idP As Int64
        Dim idUA As Int64

        rs1.MoveFirst()
        Do Until rs1.EOF
            idUA = rs1.Fields("ID_TBLUSERACCOUNTS").Value
            strF = "ID_TBLUSERACCOUNTS = " & idUA
            rs2.Filter = ""
            rs2.Filter = strF
            If rs2.RecordCount = 0 Then 'delete it from tblpermissions rs1

                str1 = "DELETE FROM TBLPERMISSIONS "
                str2 = "WHERE ID_TBLUSERACCOUNTS = " & idUA & ";"
                strSQL = str1 & str2 ' & str3

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                Try
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                End Try

                'intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If
            End If

            rs1.MoveNext()
        Loop

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        If rs2.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs2.Close()
        End If
        rs2 = Nothing

    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_CORRECTION02(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 16
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 176"
                Case 2
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 9 WHERE ID_TBLDATATABLEROWTITLES = 177"
                Case 3
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 10 WHERE ID_TBLDATATABLEROWTITLES = 178"
                Case 4
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 11 WHERE ID_TBLDATATABLEROWTITLES = 179"
                Case 5
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 12 WHERE ID_TBLDATATABLEROWTITLES = 180"
                Case 6
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 13 WHERE ID_TBLDATATABLEROWTITLES = 181"
                Case 7
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 14 WHERE ID_TBLDATATABLEROWTITLES = 182"
                Case 8
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 15 WHERE ID_TBLDATATABLEROWTITLES = 183"
                Case 9
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 16 WHERE ID_TBLDATATABLEROWTITLES = 184"
                Case 10
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 17 WHERE ID_TBLDATATABLEROWTITLES = 185"
                Case 11
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 18 WHERE ID_TBLDATATABLEROWTITLES = 206"
                Case 12
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 19 WHERE ID_TBLDATATABLEROWTITLES = 187"
                Case 13
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 20 WHERE ID_TBLDATATABLEROWTITLES = 188"
                Case 14
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 21 WHERE ID_TBLDATATABLEROWTITLES = 189"
                Case 15
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 22 WHERE ID_TBLDATATABLEROWTITLES = 190"
                Case 16
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET CHARROWNAME = 'Table Row Number' WHERE ID_TBLDATATABLEROWTITLES = 452"

            End Select

            'rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            'If rs1.EOF And rs1.BOF Then
            'Else
            '    rs1.MoveFirst()
            'End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            'strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strF3 & ";"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            '    rs1.Close()
            'End If

        Next


    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_COMPLIANCE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 6
            Select Case Count1
                Case 1
                    var1 = 475
                    str1 = "TBLPERMISSIONSADMIN"
                    str2 = "Administration: Compliance Window"
                    var2 = 5
                    str3 = ""
                    str4 = "BOOLCOMPLIANCEGLOBAL"
                    var3 = -1
                Case 2
                    var1 = 476
                    str1 = "TBLPERMISSIONSADMIN"
                    str2 = "Allow editing on the StudyDoc Administration - Compliance Window"
                    var2 = "NULL"
                    str3 = "TBLPERMISSIONS"
                    str4 = "BOOLCOMPLIANCEGLOBAL"
                    var3 = -1

                Case 3
                    var1 = 477
                    str1 = "TBLPERMISSIONS"
                    str2 = "Assign Samples Window"
                    var2 = 6
                    str3 = ""
                    str4 = "BOOLASSIGNSAMPLES"
                    var3 = -1
                Case 4
                    var1 = 478
                    str1 = "TBLPERMISSIONS"
                    str2 = "Allow editing on the Assign Samples Window"
                    var2 = "NULL"
                    str3 = "TBLPERMISSIONS"
                    str4 = "BOOLASSIGNSAMPLES"
                    var3 = -1

                Case 5
                    var1 = 479
                    str1 = "TBLPERMISSIONS"
                    str2 = "Advanded Table Configuration Window"
                    var2 = 7
                    str3 = ""
                    str4 = "BOOLADVANCEDTABLE"
                    var3 = -1
                Case 6
                    var1 = 480
                    str1 = "TBLPERMISSIONS"
                    str2 = "Allow editing on the Advanded Table Configuration Window"
                    var2 = "NULL"
                    str3 = "TBLPERMISSIONS"
                    str4 = "BOOLADVANCEDTABLE"
                    var3 = -1
            End Select

            Try
                

                If Len(str3) = 0 Then
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",NULL,'" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                Else
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                    ElseIf boolSQLSer Then
                    End If
                End If



                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_PERMISSIONS(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim idU As Int64
        Dim strT1 As String
        Dim boolText As Boolean

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 15
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolText = False

            strF1 = "ID_TBLDATATABLEROWTITLES"

            Select Case Count2
                Case 1
                    strF = "CHARROWNAME"
                    strF2 = "Allow editing on the Report Writer Administration - Global Parameters Tab?"
                    strF3 = "312"
                    boolText = True
                Case 2
                    strF = "CHARROWNAME"
                    strF2 = "Allow editing on the Report Writer Administration - Allow Word Report Generation?"
                    strF3 = "313"
                    boolText = True
                Case 3
                    strF = "CHARDATATABLENAME"
                    strF2 = "TBLPERMISSIONSADMIN"
                    strF3 = "308"
                    boolText = True
                Case 4
                    strF = "CHARDATATABLENAME"
                    strF2 = "TBLPERMISSIONSADMIN"
                    strF3 = "314"
                    boolText = True
                Case 5
                    strF = "CHARDATATABLENAME"
                    strF2 = "TBLPERMISSIONSADMIN"
                    strF3 = "316"
                    boolText = True
                Case 6
                    strF = "CHARDATATABLENAME"
                    strF2 = "TBLPERMISSIONSADMIN"
                    strF3 = "317"
                    boolText = True
                Case 7
                    strF = "CHARDATATABLENAME"
                    strF2 = "TBLPERMISSIONSSTUDYDESIGNER"
                    strF3 = "318"
                    boolText = True
                Case 8
                    strF = "CHARDATATABLENAME"
                    strF2 = "TBLPERMISSIONSSTUDYDESIGNER"
                    strF3 = "319"
                    boolText = True
                Case 9
                    strF = "CHARDATATABLENAME"
                    strF2 = "TBLPERMISSIONSSTUDYDESIGNER"
                    strF3 = "320"
                    boolText = True

                Case 10
                    strF = "CHARROWNAME"
                    strF2 = "Allow editing on the StudyDoc Administration - Global Parameters tab?"
                    strF3 = "317"
                    boolText = True

                Case 11
                    strF = "CHARROWNAME"
                    strF2 = "Allow editing on the PK/PD Study Designer - Projects tab?"
                    strF3 = "318"
                    boolText = True

                Case 12
                    strF = "CHARROWNAME"
                    strF2 = "Allow editing on the PK/PD Study Design - Studies tab?"
                    strF3 = "319"
                    boolText = True

                Case 13
                    strF = "CHARROWNAME"
                    strF2 = "Allow editing on the PK/PD Study Design - Assay Design tab?"
                    strF3 = "320"
                    boolText = True

                Case 14
                    strF = "CHARROWNAME"
                    strF2 = "Activate (A *) column"
                    strF3 = "467"
                    boolText = True

                Case 15
                    strF = "CHARROWNAME"
                    strF2 = "Activate (A *) column"
                    strF3 = "432"
                    boolText = True

            End Select


            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            If boolText Then
                strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strF3 & ";"
            Else
                strSQL = "UPDATE " & strT & " SET " & strF & " = " & strF2 & " WHERE " & strF1 & " = " & strF3 & ";"
            End If
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        rs1 = Nothing

    End Sub

    Sub CreateTable_TBLCONFIGCOMPLIANCE(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLCONFIGCOMPLIANCE"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'now add fields
                For Count1 = 1 To 7
                    If boolAccess Then
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD BOOLAUDITTRAIL short"
                            Case 2
                                strSQL = "alter table " & strT & " ADD BOOLESIG short"
                            Case 3
                                strSQL = "alter table " & strT & " ADD BOOLLOGGEDONUSER short"
                            Case 4
                                strSQL = "alter table " & strT & " ADD BOOLMEANINGOFSIG short"
                            Case 5
                                strSQL = "alter table " & strT & " ADD BOOLRESTRICTSIG short"
                            Case 6
                                strSQL = "alter table " & strT & " ADD BOOLREASONFORCHANGE short"
                            Case 7
                                strSQL = "alter table " & strT & " ADD BOOLRESTRICTREASON short"

                        End Select
                    Else
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD BOOLAUDITTRAIL smallint"
                            Case 2
                                strSQL = "alter table " & strT & " ADD BOOLESIG smallint"
                            Case 3
                                strSQL = "alter table " & strT & " ADD BOOLLOGGEDONUSER smallint"
                            Case 4
                                strSQL = "alter table " & strT & " ADD BOOLMEANINGOFSIG smallint"
                            Case 5
                                strSQL = "alter table " & strT & " ADD BOOLRESTRICTSIG smallint"
                            Case 6
                                strSQL = "alter table " & strT & " ADD BOOLREASONFORCHANGE smallint"
                            Case 7
                                strSQL = "alter table " & strT & " ADD BOOLRESTRICTREASON smallint"

                        End Select

                    End If

                    '        If boolAccess Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " Single"
                    '        Else'If boolSQLServer Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " real"
                    '        End If
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                Next

                'now add data

                Dim id As Long

                For Count1 = 1 To 1

                    Select Case Count1
                        Case 1
                            str2 = "1"

                    End Select

                    Try
                        
                        If boolAccess Then
                            str1 = "INSERT INTO " & strT & " VALUES (1,0,0,0,0,0,0,0);"
                        ElseIf boolOra Then
                            str1 = "INSERT INTO " & strT & " VALUES (1,0,0,0,0,0,0,0);"
                        ElseIf boolSQLSer Then
                        End If
                        cmd.CommandText = str1
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = str1 & " executed successfully."
                        boolCont = True

                    Catch ex4 As Exception
                        boolProb = True
                        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        boolCont = False
                    End Try

                Next
            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)

    End Sub

    Sub ModifyRecords_TBLMAXID_AUDITTRAIL(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim idU As Int64
        Dim strT1 As String


        'must sleep here about 2 seconds
        'Pause(2)

        boolAdd = False
        strT = "TBLMAXID"
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1

                    strF = "NUMMAXID"
                    strF1 = "CHARTABLE"
                    strT1 = "TBLREASONFORCHANGE"

                Case 2

                    strF = "NUMMAXID"
                    strF1 = "CHARTABLE"
                    strT1 = "TBLMEANINGOFSIG"

            End Select

            strID = "ID_" & strT1

            'Dim cn As ADODB.Connection

            str1 = "Select MAX(" & strID & ") "
            str2 = "FROM " & strT1 & ";"
            strSQL = str1 & str2

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            idU = 100 '????
            Try
                'idU = cmd.executescalar

                Dim count As Int64 = Convert.ToInt64(cmd.ExecuteScalar())
                idU = count

            Catch ex As Exception
                var1 = ex.Message

            End Try
            strF3 = CStr(idU)

            'If rs1.EOF And rs1.BOF Then
            '    idU = 1
            'Else
            '    rs1.MoveLast()
            '    idU = rs1.Fields(0).Value + 1
            'End If

            strF2 = CStr(idU)
            strF3 = strT1

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = " & strF2 & " WHERE " & strF1 & " = '" & strT1 & "';"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                var1 = ex.Message
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = strM & ChrW(10) & ex.Message
            End Try

            'MsgBox(strM)
            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        Try
            rs1.Close()
        Catch ex As Exception

        End Try

        rs1 = Nothing

    End Sub

    Sub AddFields_TBLPERMISSIONS_COMPLIANCE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 3
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLCOMPLIANCEGLOBAL"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100
                Case 2
                    strF = "BOOLASSIGNSAMPLES"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100
                Case 3
                    strF = "BOOLADVANCEDTABLE"
                    numU = -1
                    strT = "TBLPERMISSIONS"
                    numTy = 2
                    intText = 100

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'give permissions to all users at this point
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing
        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLTAB1_COMPLIANCE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTAB1"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 34 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTAB1 VALUES(35,'Compliance Settings',4,'Admin',4,0,#05-OCT-10#)"
            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:


    End Sub

    Sub AddRecords_tblAssignedSamplesHelper_DILN(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim int1 As Short

        strT = "tblAssignedSamplesHelper"
        dt = Now
        int1 = 77
        For Count1 = 1 To 8
            Select Case Count1
                Case 1
                    var1 = int1 + Count1
                    var2 = "QC Diln"
                    var3 = 11
                    var4 = 1
                Case 2
                    var1 = int1 + Count1
                    var2 = "QC Diln"
                    var3 = 18
                    var4 = 1
                Case 3
                    var1 = int1 + Count1
                    var2 = "QC Diln"
                    var3 = 19
                    var4 = 1
                Case 4
                    var1 = int1 + Count1
                    var2 = "QC Diln"
                    var3 = 21
                    var4 = 1
                Case 5
                    var1 = int1 + Count1
                    var2 = "QC Diln"
                    var3 = 29
                    var4 = 1
                Case 6
                    var1 = int1 + Count1
                    var2 = "QC Diln"
                    var3 = 4
                    var4 = 1
                Case 7
                    var1 = int1 + Count1
                    var2 = "QC Diln"
                    var3 = 31
                    var4 = 1
                Case 8
                    var1 = int1 + Count1
                    var2 = "QC Diln"
                    var3 = 32
                    var4 = 1

            End Select

            If Count1 = 6 Then 'skip
            Else
                Try
                    
                    If boolAccess Then
                        str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3," & var4 & ");"
                    ElseIf boolOra Then
                        str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3," & var4 & ");"
                    ElseIf boolSQLSer Then
                    End If
                    cmd.CommandText = str1
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    boolCont = False
                End Try
            End If


        Next


    End Sub

    Sub AddFields_TBLDATA_FORMATTHOUSAND(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "INTCOMMAFORMAT"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
                Case 2
                    strF = "BOOLBLUEHYPERLINK"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_FORMATTHOUSAND(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 2
            Select Case Count1
                Case 1
                    var1 = 473
                    str1 = "tblCompanyData"
                    str2 = "Format comma for number >= (enter 0 to ignore)"
                    var2 = 22
                    str3 = "tblData"
                    str4 = "INTCOMMAFORMAT"
                    var3 = -1
                Case 2
                    var1 = 474
                    str1 = "tblCompanyData"
                    str2 = "Make hyperlinks and TOC blue font color"
                    var2 = 23
                    str3 = "tblData"
                    str4 = "BOOLBLUEHYPERLINK"
                    var3 = -1

            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub ModifyRecords_TBLFIELDCODES_NUMBEROFSAMPLES(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLFIELDCODES"
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARDESCRIPTION"
                    strF1 = "ID_TBLFIELDCODES"
                    strF2 = "Returns the number of samples received in the study"
                    strF3 = "72"

            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strF3 & ";"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub AddRecords_TBLMAXID_TBLAUDITTRAIL(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLMAXID"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 54 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 4

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLMAXID VALUES(55,'TBLAUDITTRAIL',1,#04-AUG-10#)"
                Case 2
                    strSQL = "INSERT INTO TBLMAXID VALUES(56,'TBLSAVEEVENT',1,#04-AUG-10#)"
                Case 3
                    strSQL = "INSERT INTO TBLMAXID VALUES(57,'TBLMEANINGOFSIG',1,#04-AUG-10#)"
                Case 4
                    strSQL = "INSERT INTO TBLMAXID VALUES(58,'TBLREASONFORCHANGE',1,#04-AUG-10#)"

            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddRecords_TBLTAB1_AUDITTRAIL(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLTAB1"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 33 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 1

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLTAB1 VALUES(34,'Audit Trail',15,'StudyDoc Main',1,-1,#04-AUG-10#)"
            End Select

            Try

                'If boolAccess Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolOra Then
                '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                'ElseIf boolSQLSer Then
                'End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

end1:

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_COMPLIANCE_01(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim rs1 As New ADODB.Recordset

        strT = "TBLDATATABLEROWTITLES"

        'check to see if this has been run

        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        rs1.MoveLast()
        var1 = rs1.Fields(0).Value
        If var1 > 265 Then 'already been done
            rs1.Close()
            rs1 = Nothing
            GoTo end1
        End If
        rs1.Close()
        rs1 = Nothing

        For Count1 = 1 To 207

            Select Case Count1

                Case 1
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(266,'TBLAPPFIGS','Type',NULL,'TBLAPPFIGS','CHARTYPE',-1,#8/4/2010#,NULL)"
                Case 2
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(267,'TBLAPPFIGS','Analyte',NULL,'TBLAPPFIGS','CHARANALYTE',-1,#8/4/2010#,NULL)"
                Case 3
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(268,'TBLAPPFIGS','LM#',NULL,'TBLAPPFIGS','CHARLMNUMBER',-1,#8/4/2010#,NULL)"
                Case 4
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(269,'TBLAPPFIGS','Watson Run ID',NULL,'TBLAPPFIGS','NUMWATSONRUNNUMBER',-1,#8/4/2010#,NULL)"
                Case 5
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(270,'TBLAPPFIGS','Caption',NULL,'TBLAPPFIGS','CHARTITLE',-1,#8/4/2010#,NULL)"
                Case 6
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(271,'TBLAPPFIGS','Path (Optional)',NULL,'TBLAPPFIGS','CHARPATH',-1,#8/4/2010#,NULL)"
                Case 7
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(272,'TBLAPPFIGS','A* (Order)',NULL,'TBLAPPFIGS','INTORDER',-1,#8/4/2010#,NULL)"
                Case 8
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(273,'TBLAPPFIGS','Is Appendix?',NULL,'TBLAPPFIGS','BOOLAPPENDIX',-1,#8/4/2010#,NULL)"
                Case 9
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(274,'TBLAPPFIGS','Is Figure?',NULL,'TBLAPPFIGS','BOOLFIGURE',-1,#8/4/2010#,NULL)"
                Case 10
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(275,'TBLAPPFIGS','Include?',NULL,'TBLAPPFIGS','BOOLINCLUDEINREPORT',-1,#8/4/2010#,NULL)"
                Case 11
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(276,'TBLAPPFIGS','Page Orientation',NULL,'TBLAPPFIGS','CHARPAGEORIENTATION',-1,#8/4/2010#,NULL)"
                Case 12
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(277,'TBLAPPFIGS','Scale (%)',NULL,'TBLAPPFIGS','NUMSCALE',-1,#8/4/2010#,NULL)"
                Case 13
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(278,'TBLAPPFIGS','Crop Left inches (CL)',NULL,'TBLAPPFIGS','NUMCROPLEFT',-1,#8/4/2010#,NULL)"
                Case 14
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(279,'TBLAPPFIGS','Crop Right inches (CR)',NULL,'TBLAPPFIGS','NUMCROPRIGHT',-1,#8/4/2010#,NULL)"
                Case 15
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(280,'TBLAPPFIGS','Crop Top inches (CT)',NULL,'TBLAPPFIGS','NUMCROPTOP',-1,#8/4/2010#,NULL)"
                Case 16
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(281,'TBLAPPFIGS','Crop Bottom inches (CB)',NULL,'TBLAPPFIGS','NUMCROPBOTTOM',-1,#8/4/2010#,NULL)"
                Case 17
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(282,'TBLAPPFIGS','Field Code Identifier',NULL,'TBLAPPFIGS','CHARFCID',-1,#8/4/2010#,NULL)"
                Case 18
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(283,'TBLANALYTICALRUNSUMMARY','User Comments',NULL,'TBLANALYTICALRUNSUMMARY','CHARUSERCOMMENTS',-1,#8/4/2010#,NULL)"
                Case 19
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(284,'TBLANALYTICALRUNSUMMARY','Include in Run Summary Table? (A)',NULL,'TBLANALYTICALRUNSUMMARY','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 20
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(285,'TBLANALYTICALRUNSUMMARY','Include in Calibration Standard Table? (B)',NULL,'TBLANALYTICALRUNSUMMARY','BOOLINCLUDEREGR',-1,#8/4/2010#,NULL)"
                Case 21
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(286,'TBLCONTRIBUTINGPERSONNEL','Name',NULL,'TBLCONTRIBUTINGPERSONNEL','CHARCPNAME',-1,#8/4/2010#,NULL)"
                Case 22
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(287,'TBLCONTRIBUTINGPERSONNEL','Prefix',NULL,'TBLCONTRIBUTINGPERSONNEL','CHARCPPREFIX',-1,#8/4/2010#,NULL)"
                Case 23
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(288,'TBLCONTRIBUTINGPERSONNEL','Suffix',NULL,'TBLCONTRIBUTINGPERSONNEL','CHARCPSUFFIX',-1,#8/4/2010#,NULL)"
                Case 24
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(289,'TBLCONTRIBUTINGPERSONNEL','Degree',NULL,'TBLCONTRIBUTINGPERSONNEL','CHARCPDEGREE',-1,#8/4/2010#,NULL)"
                Case 25
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(290,'TBLCONTRIBUTINGPERSONNEL','Title',NULL,'TBLCONTRIBUTINGPERSONNEL','CHARCPTITLE',-1,#8/4/2010#,NULL)"
                Case 26
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(291,'TBLCONTRIBUTINGPERSONNEL','Role',NULL,'TBLCONTRIBUTINGPERSONNEL','CHARCPROLE',-1,#8/4/2010#,NULL)"
                Case 27
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(292,'TBLCONTRIBUTINGPERSONNEL','Order to display in Contributing Personnel Page',NULL,'TBLCONTRIBUTINGPERSONNEL','INTORDER',-1,#8/4/2010#,NULL)"
                Case 28
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(293,'TBLCONTRIBUTINGPERSONNEL','Include in Contributing Personnel Page? (A)',NULL,'TBLCONTRIBUTINGPERSONNEL','BOOLINCLUDESIGONTABLEPAGE',-1,#8/4/2010#,NULL)"
                Case 29
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(294,'TBLPERMISSIONS','Allow editing on the Home tab?',NULL,'TBLPERMISSIONS','BOOLHOME',-1,#8/4/2010#,NULL)"
                Case 30
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(295,'TBLPERMISSIONS','Allow editing on the Data tab?',NULL,'TBLPERMISSIONS','BOOLDATA',-1,#8/4/2010#,NULL)"
                Case 31
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(296,'TBLPERMISSIONS','Allow editing on the Analytical Run Summary tab?',NULL,'TBLPERMISSIONS','BOOLANALRUNSUMMARYTABLE',-1,#8/4/2010#,NULL)"
                Case 32
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(297,'TBLPERMISSIONS','Allow editing on the Summary tab?',NULL,'TBLPERMISSIONS','BOOLSUMMARYTABLE',-1,#8/4/2010#,NULL)"
                Case 33
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(298,'TBLPERMISSIONS','Allow editing on the Report Table Configuration tab?',NULL,'TBLPERMISSIONS','BOOLREPORTTABLECONFIGURATION',-1,#8/4/2010#,NULL)"
                Case 34
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(299,'TBLPERMISSIONS','Allow editing on the Report Table Header Configuration tab?',NULL,'TBLPERMISSIONS','BOOLREPORTTABLEHEADERCONFIG',-1,#8/4/2010#,NULL)"
                Case 35
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(300,'TBLPERMISSIONS','Allow editing on the Analytical Reference Standard tab?',NULL,'TBLPERMISSIONS','BOOLANALREFSTANDARD',-1,#8/4/2010#,NULL)"
                Case 36
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(301,'TBLPERMISSIONS','Allow editing on the Contributing Personnel tab?',NULL,'TBLPERMISSIONS','BOOLCONTRIBUTINGPERSONNEL',-1,#8/4/2010#,NULL)"
                Case 37
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(302,'TBLPERMISSIONS','Allow editing on the Report Template Configuration tab?',NULL,'TBLPERMISSIONS','BOOLREPORTBODYSECTIONS',-1,#8/4/2010#,NULL)"
                Case 38
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(303,'TBLPERMISSIONS','Allow editing on the Method Validation Data tab?',NULL,'TBLPERMISSIONS','BOOLMETHODVALIDATIONDATA',-1,#8/4/2010#,NULL)"
                Case 39
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(304,'TBLPERMISSIONS','Allow editing on the QA Event Table tab?',NULL,'TBLPERMISSIONS','BOOLQAEVENTTABLE',-1,#8/4/2010#,NULL)"
                Case 40
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(305,'TBLPERMISSIONS','Allow editing on the Sample Receipt tab?',NULL,'TBLPERMISSIONS','BOOLSAMPLERECEIPT',-1,#8/4/2010#,NULL)"
                Case 41
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(306,'TBLPERMISSIONS','Allow editing on the Appendices and Figures tab?',NULL,'TBLPERMISSIONS','BOOLAPPENDICES',-1,#8/4/2010#,NULL)"
                Case 42
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(307,'TBLPERMISSIONS','Allow editing on the Report Writer Administration tab?',NULL,'TBLPERMISSIONS','BOOLADMINISTRATION',-1,#8/4/2010#,NULL)"
                Case 43
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(308,'TBLPERMISSIONS','Allow editing on the StudyDoc Administration - User Account tab?',NULL,'TBLPERMISSIONS','BOOLUSERACCOUNTS',-1,#8/4/2010#,NULL)"
                Case 44
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(309,'TBLPERMISSIONS','Allow editing on the Report Writer Administration - Dropdown Box Configuration tab?',NULL,'TBLPERMISSIONS','BOOLDROPDOWNBOXCONFIGURATION',-1,#8/4/2010#,NULL)"
                Case 45
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(310,'TBLPERMISSIONS','Allow editing on the Report Writer Administration - Corporate Addresses tab?',NULL,'TBLPERMISSIONS','BOOLCORPORATEADDRESSES',-1,#8/4/2010#,NULL)"
                Case 46
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(311,'TBLPERMISSIONS','Allow editing on the Report Writer Administration - Study Template Definitions tab?',NULL,'TBLPERMISSIONS','BOOLREPORTTEMPLATEDEFINITIONS',-1,#8/4/2010#,NULL)"
                Case 47
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(312,'TBLPERMISSIONS','Allow editing on the Report Writer Administration - Study Template Definitions tab?',NULL,'TBLPERMISSIONS','BOOLGLOBALPARAMETERS',-1,#8/4/2010#,NULL)"
                Case 48
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(313,'TBLPERMISSIONS','Allow editing on the Report Writer Administration - Study Template Definitions tab?',NULL,'TBLPERMISSIONS','BOOLALLOWREPORTGENERATION',-1,#8/4/2010#,NULL)"
                Case 49
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(314,'TBLPERMISSIONS','Allow editing on the StudyDoc Administration - Hooks tab?',NULL,'TBLPERMISSIONS','BOOLHOOKS',-1,#8/4/2010#,NULL)"
                Case 50
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(315,'TBLPERMISSIONS','Allow user to create PDF report?',NULL,'TBLPERMISSIONS','BOOLALLOWPDFREPORT',-1,#8/4/2010#,NULL)"
                Case 51
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(316,'TBLPERMISSIONS','Allow editing on the StudyDoc Administration Page tab?',NULL,'TBLPERMISSIONS','BOOLADMINISTRATIONADMIN',-1,#8/4/2010#,NULL)"
                Case 52
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(317,'TBLPERMISSIONS','Allow editing on the StudyDoc Administration - Global Parameters tab tab?',NULL,'TBLPERMISSIONS','BOOLGLOBALPARAMETERSADMIN',-1,#8/4/2010#,NULL)"
                Case 53
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(318,'TBLPERMISSIONS','Allow editing on the PK/PD Study Designer - Projects tab tab?',NULL,'TBLPERMISSIONS','BOOLSDPROJECTS',-1,#8/4/2010#,NULL)"
                Case 54
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(319,'TBLPERMISSIONS','Allow editing on the PK/PD Study Design - Studies tab tab?',NULL,'TBLPERMISSIONS','BOOLSDSTUDIES',-1,#8/4/2010#,NULL)"
                Case 55
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(320,'TBLPERMISSIONS','Allow editing on the PK/PD Study Design - Assay Design tab tab?',NULL,'TBLPERMISSIONS','BOOLSDASSAYS',-1,#8/4/2010#,NULL)"
                Case 56
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(321,'TBLREPORTS','Report Number',NULL,'TBLREPORTS','CHARREPORTNUMBER',-1,#8/4/2010#,NULL)"
                Case 57
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(322,'TBLREPORTS','Draft Date',NULL,'TBLREPORTS','DTREPORTDRAFTISSUEDATE',-1,#8/4/2010#,NULL)"
                Case 58
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(323,'TBLREPORTS','Issue Date',NULL,'TBLREPORTS','DTREPORTFINALISSUEDATE',-1,#8/4/2010#,NULL)"
                Case 59
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(324,'TBLREPORTS','Use User Comments',NULL,'TBLREPORTS','INTUSERCOMMENTS',-1,#8/4/2010#,NULL)"
                Case 60
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(325,'TBLREPORTS','Study Type *',NULL,'TBLREPORTS','CHARREPORTTYPE',-1,#8/4/2010#,NULL)"
                Case 61
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(326,'TBLREPORTS','Report Title',NULL,'TBLREPORTS','CHARREPORTTITLE',-1,#8/4/2010#,NULL)"
                Case 62
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(327,'TBLREPORTS','Analytical Run Report Selection',NULL,'TBLREPORTS','BOOLEXCLUDEPSAE',-1,#8/4/2010#,NULL)"
                Case 63
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(328,'TBLREPORTTABLE','Order',NULL,'TBLREPORTTABLE','INTORDER',-1,#8/4/2010#,NULL)"
                Case 64
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(329,'TBLREPORTTABLE','Page Orientation',NULL,'TBLREPORTTABLE','CHARPAGEORIENTATION',-1,#8/4/2010#,NULL)"
                Case 65
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(330,'TBLREPORTTABLE','Include in Report?',NULL,'TBLREPORTTABLE','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 66
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(331,'TBLREPORTTABLE','Requires Sample Assignment? (A)',NULL,'TBLREPORTTABLE','BOOLREQUIRESSAMPLEASSIGNMENT',-1,#8/4/2010#,NULL)"
                Case 67
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(332,'TBLREPORTTABLE','Stability Period',NULL,'TBLREPORTTABLE','CHARSTABILITYPERIOD',-1,#8/4/2010#,NULL)"
                Case 68
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(333,'TBLREPORTTABLE','Table Title',NULL,'TBLREPORTTABLE','CHARHEADINGTEXT',-1,#8/4/2010#,NULL)"
                Case 69
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(334,'TBLREPORTTABLE','Field Code Identifier',NULL,'TBLREPORTTABLE','CHARFCID',-1,#8/4/2010#,NULL)"
                Case 70
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(335,'TBLREPORTTABLEHEADERCONFIG','User Label',NULL,'TBLREPORTTABLEHEADERCONFIG','CHARUSERLABEL',-1,#8/4/2010#,NULL)"
                Case 71
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(336,'TBLREPORTTABLEHEADERCONFIG','Order',NULL,'TBLREPORTTABLEHEADERCONFIG','INTORDER',-1,#8/4/2010#,NULL)"
                Case 72
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(337,'TBLREPORTTABLEHEADERCONFIG','Include',NULL,'TBLREPORTTABLEHEADERCONFIG','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 73
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(338,'TBLREPORTTABLEANALYTES','Include Analyte',NULL,'TBLREPORTTABLEANALYTES','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 74
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(339,'TBLTABLEPROPERTIES','Show Conc. Values that are < BQL',NULL,'TBLTABLEPROPERTIES','BOOLBQLSHOWCONC',-1,#8/4/2010#,NULL)"
                Case 75
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(340,'TBLTABLEPROPERTIES','Show Rejected Values',NULL,'TBLTABLEPROPERTIES','BOOLCSSHOWREJVALUES',-1,#8/4/2010#,NULL)"
                Case 76
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(341,'TBLTABLEPROPERTIES','Report Only Accepted Values',NULL,'TBLTABLEPROPERTIES','BOOLQCREPORTACCVALUES',-1,#8/4/2010#,NULL)"
                Case 77
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(342,'TBLTABLEPROPERTIES','Mean Statistics Option',NULL,'TBLTABLEPROPERTIES','BOOLSTATSMEAN',-1,#8/4/2010#,NULL)"
                Case 78
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(343,'TBLTABLEPROPERTIES','SD Statistics Option',NULL,'TBLTABLEPROPERTIES','BOOLSTATSSD',-1,#8/4/2010#,NULL)"
                Case 79
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(344,'TBLTABLEPROPERTIES','CV Statistics Option',NULL,'TBLTABLEPROPERTIES','BOOLSTATSCV',-1,#8/4/2010#,NULL)"
                Case 80
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(345,'TBLTABLEPROPERTIES','%Bias Statistics Option',NULL,'TBLTABLEPROPERTIES','BOOLSTATSBIAS',-1,#8/4/2010#,NULL)"
                Case 81
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(346,'TBLTABLEPROPERTIES','n Statistics Option',NULL,'TBLTABLEPROPERTIES','BOOLSTATSN',-1,#8/4/2010#,NULL)"
                Case 82
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(347,'TBLTABLEPROPERTIES','%Diff Statistics Option',NULL,'TBLTABLEPROPERTIES','BOOLSTATSDIFF',-1,#8/4/2010#,NULL)"
                Case 83
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(348,'TBLTABLEPROPERTIES','Include %Diff or %RE Column Option',NULL,'TBLTABLEPROPERTIES','BOOLSTATSDIFFCOL',-1,#8/4/2010#,NULL)"
                Case 84
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(349,'TBLTABLEPROPERTIES','Include Regression Constants in table Option',NULL,'TBLTABLEPROPERTIES','BOOLSTATSREGR',-1,#8/4/2010#,NULL)"
                Case 85
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(350,'TBLTABLEPROPERTIES','Level One Incurred Sample Acceptance Criteria (%)',NULL,'TBLTABLEPROPERTIES','NUMISCRIT1',-1,#8/4/2010#,NULL)"
                Case 86
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(351,'TBLTABLEPROPERTIES','% of BQL For Level One Evaluation',NULL,'TBLTABLEPROPERTIES','NUMISCRIT1LEVEL',-1,#8/4/2010#,NULL)"
                Case 87
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(352,'TBLTABLEPROPERTIES','Level Two Incurred Sample Acceptance Criteria (%)',NULL,'TBLTABLEPROPERTIES','NUMISCRIT2',-1,#8/4/2010#,NULL)"
                Case 88
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(353,'TBLTABLEPROPERTIES','%Theoretical Statistics Option',NULL,'TBLTABLEPROPERTIES','BOOLTHEORETICAL',-1,#8/4/2010#,NULL)"
                Case 89
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(354,'TBLTABLEPROPERTIES','Include ANOVA Section',NULL,'TBLTABLEPROPERTIES','BOOLINCLANOVA',-1,#8/4/2010#,NULL)"
                Case 90
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(355,'TBLTABLEPROPERTIES','Display BQL value in Legend',NULL,'TBLTABLEPROPERTIES','BOOLBQLLEGEND',-1,#8/4/2010#,NULL)"
                Case 91
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(356,'TBLTABLEPROPERTIES','Group Rules - Level 1 - Group Column',NULL,'TBLTABLEPROPERTIES','NUMSAMPLEG1',-1,#8/4/2010#,NULL)"
                Case 92
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(357,'TBLTABLEPROPERTIES','Group Rules - Level 2 - Group Column',NULL,'TBLTABLEPROPERTIES','NUMSAMPLEG2',-1,#8/4/2010#,NULL)"
                Case 93
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(358,'TBLTABLEPROPERTIES','Group Rules - Level 3 - Group Column',NULL,'TBLTABLEPROPERTIES','NUMSAMPLEG3',-1,#8/4/2010#,NULL)"
                Case 94
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(359,'TBLTABLEPROPERTIES','Group Rules - Level 4 - Group Column',NULL,'TBLTABLEPROPERTIES','NUMSAMPLEG4',-1,#8/4/2010#,NULL)"
                Case 95
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(360,'TBLTABLEPROPERTIES','Sort Rules - Level 1 - Sort Column',NULL,'TBLTABLEPROPERTIES','NUMSAMPLES1',-1,#8/4/2010#,NULL)"
                Case 96
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(361,'TBLTABLEPROPERTIES','Sort Rules - Level 2 - Sort Column',NULL,'TBLTABLEPROPERTIES','NUMSAMPLES2',-1,#8/4/2010#,NULL)"
                Case 97
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(362,'TBLTABLEPROPERTIES','Sort Rules - Level 3 - Sort Column',NULL,'TBLTABLEPROPERTIES','NUMSAMPLES3',-1,#8/4/2010#,NULL)"
                Case 98
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(363,'TBLTABLEPROPERTIES','Sort Rules - Level 4 - Sort Column',NULL,'TBLTABLEPROPERTIES','NUMSAMPLES4',-1,#8/4/2010#,NULL)"
                Case 99
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(364,'TBLTABLEPROPERTIES','Group Rules - Level 1 - ASC/DESC Column',NULL,'TBLTABLEPROPERTIES','CHARSAMPLEGAD1',-1,#8/4/2010#,NULL)"
                Case 100
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(365,'TBLTABLEPROPERTIES','Group Rules - Level 2 - ASC/DESC Column',NULL,'TBLTABLEPROPERTIES','CHARSAMPLEGAD2',-1,#8/4/2010#,NULL)"
                Case 101
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(366,'TBLTABLEPROPERTIES','Group Rules - Level 3 - ASC/DESC Column',NULL,'TBLTABLEPROPERTIES','CHARSAMPLEGAD3',-1,#8/4/2010#,NULL)"
                Case 102
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(367,'TBLTABLEPROPERTIES','Group Rules - Level 4 - ASC/DESC Column',NULL,'TBLTABLEPROPERTIES','CHARSAMPLEGAD4',-1,#8/4/2010#,NULL)"
                Case 103
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(368,'TBLTABLEPROPERTIES','Sort Rules - Level 1 - ASC/DESC Column',NULL,'TBLTABLEPROPERTIES','CHARSAMPLESAD1',-1,#8/4/2010#,NULL)"
                Case 104
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(369,'TBLTABLEPROPERTIES','Sort Rules - Level 2 - ASC/DESC Column',NULL,'TBLTABLEPROPERTIES','CHARSAMPLESAD2',-1,#8/4/2010#,NULL)"
                Case 105
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(370,'TBLTABLEPROPERTIES','Sort Rules - Level 3 - ASC/DESC Column',NULL,'TBLTABLEPROPERTIES','CHARSAMPLESAD3',-1,#8/4/2010#,NULL)"
                Case 106
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(371,'TBLTABLEPROPERTIES','Sort Rules - Level 4 - ASC/DESC Column',NULL,'TBLTABLEPROPERTIES','CHARSAMPLESAD4',-1,#8/4/2010#,NULL)"
                Case 107
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(372,'TBLTABLEPROPERTIES','Include PSAE Samples',NULL,'TBLTABLEPROPERTIES','BOOLINCLUDEPSAE',-1,#8/4/2010#,NULL)"
                Case 108
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(373,'TBLTABLEPROPERTIES','Use Concentration',NULL,'TBLTABLEPROPERTIES','BOOLRCCONC',-1,#8/4/2010#,NULL)"
                Case 109
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(374,'TBLTABLEPROPERTIES','Use Peak Area',NULL,'TBLTABLEPROPERTIES','BOOLRCPA',-1,#8/4/2010#,NULL)"
                Case 110
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(375,'TBLTABLEPROPERTIES','Use Peak Area Ratio (if applicable)',NULL,'TBLTABLEPROPERTIES','BOOLRCPARATIO',-1,#8/4/2010#,NULL)"
                Case 111
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(376,'TBLTABLEPROPERTIES','Include Int Std Table',NULL,'TBLTABLEPROPERTIES','BOOLINCLUDEISTBL',-1,#8/4/2010#,NULL)"
                Case 112
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(377,'TBLTABLEPROPERTIES','Calculations - Mean Accuracy Option',NULL,'TBLTABLEPROPERTIES','BOOLMEANACCURACY',-1,#8/4/2010#,NULL)"
                Case 113
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(378,'TBLTABLEPROPERTIES','Table Legend - No Legend',NULL,'TBLTABLEPROPERTIES','BOOLNONELEG',-1,#8/4/2010#,NULL)"
                Case 114
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(379,'TBLTABLEPROPERTIES','Table Legend - Positive Results',NULL,'TBLTABLEPROPERTIES','BOOLPOSLEG',-1,#8/4/2010#,NULL)"
                Case 115
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(380,'TBLTABLEPROPERTIES','Table Legend - Negative Results',NULL,'TBLTABLEPROPERTIES','BOOLNEGLEG',-1,#8/4/2010#,NULL)"
                Case 116
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(381,'TBLTABLEPROPERTIES','Table Legend - Custom Legend',NULL,'TBLTABLEPROPERTIES','BOOLCUSTOMLEG',-1,#8/4/2010#,NULL)"
                Case 117
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(382,'TBLTABLEPROPERTIES','Table Legend - Title',NULL,'TBLTABLEPROPERTIES','CHARTITLELEG',-1,#8/4/2010#,NULL)"
                Case 118
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(383,'TBLTABLEPROPERTIES','Table Legend - Numer.',NULL,'TBLTABLEPROPERTIES','CHARNUMLEG',-1,#8/4/2010#,NULL)"
                Case 119
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(384,'TBLTABLEPROPERTIES','Table Legend - Denom.',NULL,'TBLTABLEPROPERTIES','CHARDENLEG',-1,#8/4/2010#,NULL)"
                Case 120
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(385,'TBLTABLEPROPERTIES','Include Analysis Date',NULL,'TBLTABLEPROPERTIES','BOOLINCLUDEDATE',-1,#8/4/2010#,NULL)"
                Case 121
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(386,'TBLTABLEPROPERTIES','Calculations - Difference Option',NULL,'TBLTABLEPROPERTIES','BOOLDIFFERENCE',-1,#8/4/2010#,NULL)"
                Case 122
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(387,'TBLTABLEPROPERTIES','Calculations - Recovery Option',NULL,'TBLTABLEPROPERTIES','BOOLRECOVERY',-1,#8/4/2010#,NULL)"
                Case 123
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(388,'TBLTABLEPROPERTIES','Include Watson Labels',NULL,'TBLTABLEPROPERTIES','BOOLINCLUDEWATSONLABELS',-1,#8/4/2010#,NULL)"
                Case 124
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(389,'TBLTABLEPROPERTIES','Include Summary Stats Section',NULL,'TBLTABLEPROPERTIES','BOOLINCLANOVASUMSTATS',-1,#8/4/2010#,NULL)"
                Case 125
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(390,'TBLTABLEPROPERTIES','%RE Statistics Option',NULL,'TBLTABLEPROPERTIES','BOOLSTATSRE',-1,#8/4/2010#,NULL)"
                Case 126
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(391,'TBLTABLEPROPERTIES','Stability Conditions - Time period (e.g. 1, 5, 10, etc)',NULL,'TBLTABLEPROPERTIES','CHARTIMEPERIOD',-1,#8/4/2010#,NULL)"
                Case 127
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(392,'TBLTABLEPROPERTIES','Stability Conditions - Time frame (e.g. Hours, Days, etc.) ',NULL,'TBLTABLEPROPERTIES','CHARTIMEFRAME',-1,#8/4/2010#,NULL)"
                Case 128
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(393,'TBLTABLEPROPERTIES','Stability Conditions - Temperature (e.g. -70 deg C, Room Temp, Refrigerated, etc.):',NULL,'TBLTABLEPROPERTIES','CHARPERIODTEMP',-1,#8/4/2010#,NULL)"
                Case 129
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(394,'TBLTABLEPROPERTIES','Stability Conditions - Number of Cycles',NULL,'TBLTABLEPROPERTIES','INTNUMBEROFCYCLES',-1,#8/4/2010#,NULL)"
                Case 130
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(395,'TBLTABLEPROPERTIES','Stability Conditions - Convert Time to Text',NULL,'TBLTABLEPROPERTIES','BOOLCONVERTTIME',-1,#8/4/2010#,NULL)"
                Case 131
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(396,'TBLTABLEPROPERTIES','Stability Conditions - Convert 'deg C'',NULL,'TBLTABLEPROPERTIES','BOOLCONVERTTEMP',-1,#8/4/2010#,NULL)"
                Case 132
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(397,'TBLTABLEPROPERTIES','Int Std Conc (Optional: include units)',NULL,'TBLTABLEPROPERTIES','CHARISCONC',-1,#8/4/2010#,NULL)"
                Case 133
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(398,'TBLASSIGNEDSAMPLES','Assigned Samples Table - Term 1 column',NULL,'TBLASSIGNEDSAMPLES','CHARHELPER1',-1,#8/4/2010#,NULL)"
                Case 134
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(399,'TBLASSIGNEDSAMPLES','Assigned Samples Table - Term 2 column',NULL,'TBLASSIGNEDSAMPLES','CHARHELPER2',-1,#8/4/2010#,NULL)"
                Case 135
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(400,'TBLASSIGNEDSAMPLES','Assigned Samples Table - Nom. Conc. column',NULL,'TBLASSIGNEDSAMPLES','NOMCONC',-1,#8/4/2010#,NULL)"
                Case 136
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(401,'TBLASSIGNEDSAMPLES','Assigned Samples Table - Outlier column',NULL,'TBLASSIGNEDSAMPLES','BOOLOUTLIER',-1,#8/4/2010#,NULL)"
                Case 137
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(402,'TBLASSIGNEDSAMPLES','Assigned Samples Table - Incurred Sample column',NULL,'TBLASSIGNEDSAMPLES','BOOLINCURRED',-1,#8/4/2010#,NULL)"
                Case 138
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(403,'TBLASSIGNEDSAMPLES','Assigned Samples Table - Excl. Sample column',NULL,'TBLASSIGNEDSAMPLES','BOOLEXCLSAMPLE',-1,#8/4/2010#,NULL)"
                Case 139
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(404,'TBLASSIGNEDSAMPLES','Use StudyDoc Acceptance Criteria',NULL,'TBLASSIGNEDSAMPLES','BOOLUSEGUWUACCCRIT',-1,#8/4/2010#,NULL)"
                Case 140
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(405,'TBLASSIGNEDSAMPLES','Assigned Samples Table - Neg. Crit. column',NULL,'TBLASSIGNEDSAMPLES','NUMMINACCCRIT',-1,#8/4/2010#,NULL)"
                Case 141
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(406,'TBLASSIGNEDSAMPLES','Assigned Samples Table - Pos. Crit. column',NULL,'TBLASSIGNEDSAMPLES','NUMMAXACCCRIT',-1,#8/4/2010#,NULL)"
                Case 142
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(407,'TBLCORPORATEADDRESSES','Address Label column',NULL,'TBLCORPORATEADDRESSES','CHARADDRESS',-1,#8/4/2010#,NULL)"
                Case 143
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(408,'TBLCORPORATEADDRESSES','Address Value column',NULL,'TBLCORPORATEADDRESSES','CHARVALUE',-1,#8/4/2010#,NULL)"
                Case 144
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(409,'TBLCORPORATEADDRESSES','Include this label item in the Report Title (A *) column',NULL,'TBLCORPORATEADDRESSES','BOOLINCLUDEINTITLE',-1,#8/4/2010#,NULL)"
                Case 145
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(410,'TBLCORPORATENICKNAMES','Nickname column',NULL,'TBLCORPORATEADDRESSES','CHARNICKNAME',-1,#8/4/2010#,NULL)"
                Case 146
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(411,'TBLCORPORATENICKNAMES','Active column',NULL,'TBLCORPORATEADDRESSES','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 147
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(412,'TBLDROPDOWNBOXCONTENT','Value column',NULL,'TBLDROPDOWNBOXCONTENT','CHARVALUE',-1,#8/4/2010#,NULL)"
                Case 148
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(413,'TBLDROPDOWNBOXCONTENT','Adjective Form column',NULL,'TBLDROPDOWNBOXCONTENT','CHARADJECTIVE',-1,#8/4/2010#,NULL)"
                Case 149
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(414,'TBLDROPDOWNBOXCONTENT','Acronym column',NULL,'TBLDROPDOWNBOXCONTENT','CHARACRONYM',-1,#8/4/2010#,NULL)"
                Case 150
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(415,'TBLDROPDOWNBOXCONTENT','Display Order column',NULL,'TBLDROPDOWNBOXCONTENT','INTORDER',-1,#8/4/2010#,NULL)"
                Case 151
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(416,'TBLHOOKS','Hook column',NULL,'TBLHOOKS','CHARHOOK',-1,#8/4/2010#,NULL)"
                Case 152
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(417,'TBLHOOKS','User ID column',NULL,'TBLHOOKS','CHARUID',-1,#8/4/2010#,NULL)"
                Case 153
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(418,'TBLHOOKS','Password column',NULL,'TBLHOOKS','CHARPSWD',-1,#8/4/2010#,NULL)"
                Case 154
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(419,'TBLHOOKS','Connection String column',NULL,'TBLHOOKS','CHARCONNECTIONSTRING',-1,#8/4/2010#,NULL)"
                Case 155
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(420,'TBLHOOKS','Active column',NULL,'TBLHOOKS','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 156
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(421,'TBLHOOKS','Show column',NULL,'TBLHOOKS','BOOLSHOW',-1,#8/4/2010#,NULL)"
                Case 157
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(422,'TBLHOOKS','BOOLERROR column',NULL,'TBLHOOKS','BOOLERROR',-1,#8/4/2010#,NULL)"
                Case 158
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(423,'TBLINCLUDEROWS','Check to Include in Report (A*) column',NULL,'TBLINCLUDEROWS','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 159
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(424,'TBLMEANINGOFSIG','Meaning of Signature column',NULL,'TBLMEANINGOFSIG','CHARMEANINGOFSIG',-1,#8/4/2010#,NULL)"
                Case 160
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(425,'TBLMEANINGOFSIG','Include column',NULL,'TBLMEANINGOFSIG','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 161
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(426,'TBLMEANINGOFSIG','Order column',NULL,'TBLMEANINGOFSIG','INTORDER',-1,#8/4/2010#,NULL)"
                Case 162
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(427,'TBLPASSWORDHISTORY','Password',NULL,'TBLPASSWORDHISTORY','CHARPASSWORD',-1,#8/4/2010#,NULL)"
                Case 163
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(428,'TBLPERSONNEL','Last Name column',NULL,'TBLPERSONNEL','CHARLASTNAME',-1,#8/4/2010#,NULL)"
                Case 164
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(429,'TBLPERSONNEL','First Name column',NULL,'TBLPERSONNEL','CHARFIRSTNAME',-1,#8/4/2010#,NULL)"
                Case 165
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(430,'TBLPERSONNEL','Middle Name column',NULL,'TBLPERSONNEL','CHARMIDDLENAME',-1,#8/4/2010#,NULL)"
                Case 166
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(431,'TBLPERSONNEL','Comments column',NULL,'TBLPERSONNEL','CHARCOMMENTS',-1,#8/4/2010#,NULL)"
                Case 167
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(432,'TBLPERSONNEL','Deactivate/Activate (A *) column',NULL,'TBLPERSONNEL','BOOLACTIVE',-1,#8/4/2010#,NULL)"
                Case 168
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(433,'TBLPERSONNEL','eMail Address column',NULL,'TBLPERSONNEL','CHAREMAILADDRESS',-1,#8/4/2010#,NULL)"
                Case 169
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(434,'TBLQATABLES','Column 3',NULL,'TBLQATABLES','DTCOLUMN1',-1,#8/4/2010#,NULL)"
                Case 170
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(435,'TBLQATABLES','Column 4',NULL,'TBLQATABLES','DTCOLUMN2',-1,#8/4/2010#,NULL)"
                Case 171
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(436,'TBLQATABLES','Column 5',NULL,'TBLQATABLES','DTCOLUMN3',-1,#8/4/2010#,NULL)"
                Case 172
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(437,'TBLQATABLES','Column 6',NULL,'TBLQATABLES','DTCOLUMN4',-1,#8/4/2010#,NULL)"
                Case 173
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(438,'TBLQATABLES','Column 7',NULL,'TBLQATABLES','DTCOLUMN5',-1,#8/4/2010#,NULL)"
                Case 174
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(439,'TBLQATABLES','Column 8',NULL,'TBLQATABLES','DTCOLUMN6',-1,#8/4/2010#,NULL)"
                Case 175
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(440,'TBLQATABLES','Column 9',NULL,'TBLQATABLES','DTCOLUMN7',-1,#8/4/2010#,NULL)"
                Case 176
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(441,'TBLQATABLES','Column 10',NULL,'TBLQATABLES','DTCOLUMN8',-1,#8/4/2010#,NULL)"
                Case 177
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(442,'TBLQATABLES','Order column',NULL,'TBLQATABLES','INTORDER',-1,#8/4/2010#,NULL)"
                Case 178
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(443,'TBLREASONFORCHANGE','Reason for Change column',NULL,'TBLREASONFORCHANGE','CHARREASONFORCHANGE',-1,#8/4/2010#,NULL)"
                Case 179
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(444,'TBLREASONFORCHANGE','Include column',NULL,'TBLREASONFORCHANGE','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 180
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(445,'TBLREASONFORCHANGE','Order column',NULL,'TBLREASONFORCHANGE','INTORDER',-1,#8/4/2010#,NULL)"
                Case 181
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(446,'TBLREPORTSTATEMENTS','Assigned Report column',NULL,'TBLREPORTSTATEMENTS','CHARSTATEMENT',-1,#8/4/2010#,NULL)"
                Case 182
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(447,'TBLREPORTSTATEMENTS','Include',NULL,'TBLREPORTSTATEMENTS','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 183
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(448,'TBLSAMPLERECEIPT','Sample Count column',NULL,'TBLSAMPLERECEIPT','NUMSAMPLENUMBER',-1,#8/4/2010#,NULL)"
                Case 184
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(449,'TBLSAMPLERECEIPT','Date Received column',NULL,'TBLSAMPLERECEIPT','DTSHIPMENTRECEIVED',-1,#8/4/2010#,NULL)"
                Case 185
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(450,'TBLSAMPLERECEIPT','Storage Temperature column',NULL,'TBLSAMPLERECEIPT','CHARSTORAGETEMP',-1,#8/4/2010#,NULL)"
                Case 186
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(451,'TBLSAMPLERECEIPT','Sample Condition column',NULL,'TBLSAMPLERECEIPT','CHARCONDITION',-1,#8/4/2010#,NULL)"
                Case 187
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(452,'TBLSAMPLERECEIPT','Order',NULL,'TBLSAMPLERECEIPT','INTORDER',-1,#8/4/2010#,NULL)"
                Case 188
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(453,'TBLSAMPLERECEIPT','Total number to be used in report textbox',NULL,'TBLSAMPLERECEIPT','NUMTOTALSAMPLENUM',-1,#8/4/2010#,NULL)"
                Case 189
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(454,'TBLSAMPLERECEIPT','Use these sample counts(A *) column',NULL,'TBLSAMPLERECEIPT','BOOLUSE',-1,#8/4/2010#,NULL)"
                Case 190
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(455,'TBLSAMPLERECEIPT','Use Watson Sample Receipt Data checkbox',NULL,'TBLSAMPLERECEIPT','BOOLUSEWATSON',-1,#8/4/2010#,NULL)"
                Case 191
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(456,'TBLSAMPLERECEIPT','Enter sample number manually checkbox',NULL,'TBLSAMPLERECEIPT','BOOLUSEMANUAL',-1,#8/4/2010#,NULL)"
                Case 192
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(457,'TBLSAMPLERECEIPT','Source column',NULL,'TBLSAMPLERECEIPT','CHARSOURCE',-1,#8/4/2010#,NULL)"
                Case 193
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(458,'TBLSUMMARYDATA','Order column',NULL,'TBLSUMMARYDATA','INTORDER',-1,#8/4/2010#,NULL)"
                Case 194
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(459,'TBLSUMMARYDATA','Include in Report? (A*) column',NULL,'TBLSUMMARYDATA','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 195
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(460,'TBLTEMPLATES','Template Name column',NULL,'TBLTEMPLATES','CHARTEMPLATENAME',-1,#8/4/2010#,NULL)"
                Case 196
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(461,'TBLTEMPLATES','Study Name column',NULL,'TBLTEMPLATES','ID_TBLSTUDIES',-1,#8/4/2010#,NULL)"
                Case 197
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(462,'TBLTEMPLATES','Active column',NULL,'TBLTEMPLATES','BOOLACTIVE',-1,#8/4/2010#,NULL)"
                Case 198
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(463,'TBLTEMPLATEATTRIBUTES','Include column',NULL,'TBLTEMPLATEATTRIBUTES','BOOLINCLUDE',-1,#8/4/2010#,NULL)"
                Case 199
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(464,'TBLUSERACCOUNTS','User ID column',NULL,'TBLUSERACCOUNTS','CHARUSERID',-1,#8/4/2010#,NULL)"
                Case 200
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(465,'TBLUSERACCOUNTS','Change Pswd button',NULL,'TBLUSERACCOUNTS','CHARPASSWORD',-1,#8/4/2010#,NULL)"
                Case 201
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(466,'TBLUSERACCOUNTS','Comments column',NULL,'TBLUSERACCOUNTS','CHARCOMMENTS',-1,#8/4/2010#,NULL)"
                Case 202
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(467,'TBLUSERACCOUNTS','Deactivate/Activate (A *) column',NULL,'TBLUSERACCOUNTS','BOOLACTIVE',-1,#8/4/2010#,NULL)"
                Case 203
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(468,'TBLUSERACCOUNTS','User must change password at next login checkbox',NULL,'TBLUSERACCOUNTS','BOOLCHANGEPASSWORDATNEXTLOGON',-1,#8/4/2010#,NULL)"
                Case 204
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(469,'TBLUSERACCOUNTS','User cannot change password checkbox',NULL,'TBLUSERACCOUNTS','BOOLUSERCANNOTCHANGEPASSWORD',-1,#8/4/2010#,NULL)"
                Case 205
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(470,'TBLUSERACCOUNTS','Password never expires checkbox',NULL,'TBLUSERACCOUNTS','BOOLPASSWORDNEVEREXPIRES',-1,#8/4/2010#,NULL)"
                Case 206
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(471,'TBLUSERACCOUNTS','User ID is locked out checkbox',NULL,'TBLUSERACCOUNTS','BOOLACCOUNTISLOCKEDOUT',-1,#8/4/2010#,NULL)"
                Case 207
                    strSQL = "INSERT INTO TBLDATATABLEROWTITLES VALUES(472,'TBLWORDSTATEMENTS','CHARTITLE',NULL,'TBLWORDSTATEMENTS','CHARTITLE',-1,#8/4/2010#,NULL)"

            End Select

            Select Case Count1
                Case 193, 194 'ignore those two

                Case Else

                    Try

                        'If boolAccess Then
                        '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                        'ElseIf boolOra Then
                        '    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                        'ElseIf boolSQLSer Then
                        'End If
                        '''''''''''console.writeline(strSQL)
                        cmd.CommandText = strSQL
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = str1 & " executed successfully."
                        boolCont = True

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        boolCont = False
                    End Try

            End Select

        Next

end1:


    End Sub

    Sub AddFields_TBLSTUDIES_ID_TBLDATASYSTEM(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLSTUDIES"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 100
            strF1 = "ID_TBLDATASYSTEM"

            Select Case Count2
                Case 1
                    strF = "ID_TBLDATASYSTEM"
                    numU = 1
                    numTy = 5
                    boolDo = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                'enter value for null
                strSQL = "UPDATE TBLSTUDIES SET ID_TBLDATASYSTEM = 1 WHERE ID_TBLDATASYSTEM IS NULL"
                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub CreateTable_TBLDATASYSTEM(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLDATASYSTEM"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'now add fields
                For Count1 = 1 To 2
                    If boolAccess Then
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD CHARDATASYSTEM text(255)"
                            Case 2
                                strSQL = "alter table " & strT & " ADD CHARCOMMENTS text(255)"

                        End Select
                    Else
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD CHARDATASYSTEM nvarchar2"
                            Case 2
                                strSQL = "alter table " & strT & " ADD CHARCOMMENTS nvarchar2"

                        End Select
                    End If

                    '        If boolAccess Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " Single"
                    '        Else'If boolSQLServer Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " real"
                    '        End If
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                Next

                'now add data

                Dim id As Long

                For Count1 = 1 To 1

                    Select Case Count1
                        Case 1
                            str2 = "Thermo Watson"

                    End Select

                    Try
                        
                        If boolAccess Then
                            str1 = "INSERT INTO " & strT & " VALUES (" & Count1 & ",'" & str2 & "','None');"
                        ElseIf boolOra Then
                            str1 = "INSERT INTO " & strT & " VALUES (" & Count1 & ",'" & str2 & "','None');"
                        ElseIf boolSQLSer Then
                        End If
                        cmd.CommandText = str1
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = str1 & " executed successfully."
                        boolCont = True

                    Catch ex4 As Exception
                        boolProb = True
                        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        boolCont = False
                    End Try

                Next
            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)


    End Sub

    Sub CreateTable_TBLREASONFORCHANGE(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short
        Dim var1

        strT = "TBLREASONFORCHANGE"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()

                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    var1 = ex1.Message
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False
                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'now add fields
                For Count1 = 1 To 3
                    If boolAccess Then
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD CHARREASONFORCHANGE text(255)"
                            Case 2
                                strSQL = "alter table " & strT & " ADD INTORDER short"
                            Case 3
                                strSQL = "alter table " & strT & " ADD BOOLINCLUDE short"


                        End Select
                    Else
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD CHARREASONFORCHANGE nvarchar2"
                            Case 2
                                strSQL = "alter table " & strT & " ADD INTORDER smallint"
                            Case 3
                                strSQL = "alter table " & strT & " ADD BOOLINCLUDE smallint"

                        End Select
                    End If

                    '        If boolAccess Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " Single"
                    '        Else'If boolSQLServer Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " real"
                    '        End If
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                Next

                'now add data

                Dim id As Long

                For Count1 = 1 To 2

                    Select Case Count1
                        Case 1
                            str2 = "Original Entry"
                        Case 2
                            str2 = "Entry Error"

                    End Select

                    Try
                        
                        If boolAccess Then
                            str1 = "INSERT INTO " & strT & " VALUES (" & Count1 & ",'" & str2 & "'," & Count1 & ",-1);"
                        ElseIf boolOra Then
                            str1 = "INSERT INTO " & strT & " VALUES (" & Count1 & ",'" & str2 & "'," & Count1 & ",-1);"
                        ElseIf boolSQLSer Then
                        End If
                        cmd.CommandText = str1
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = str1 & " executed successfully."
                        boolCont = True

                    Catch ex4 As Exception
                        boolProb = True
                        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        boolCont = False
                    End Try

                Next
            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        Try
            rs5.Close()

        Catch ex As Exception

        End Try

        rs5 = Nothing

        'jeez
        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)


    End Sub

    Sub CreateTable_TBLMEANINGOFSIG(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLMEANINGOFSIG"
        boolCont = False
        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)

        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                Try
                    cmd.ExecuteNonQuery()
                    'rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    boolProb = False
                    'strM = """" & strSQL & """ Table " & strT & " create successfully."
                    strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    boolCont = True
                    'rs5.Close()
                Catch ex1 As Exception
                    boolProb = True
                    'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    MsgBox(strM)
                    boolCont = False

                End Try

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                'now add fields
                For Count1 = 1 To 3
                    If boolAccess Then
                        Select Case Count1


                            Case 1
                                strSQL = "alter table " & strT & " ADD CHARMEANINGOFSIG text(255)"
                            Case 2
                                strSQL = "alter table " & strT & " ADD INTORDER short"
                            Case 3
                                strSQL = "alter table " & strT & " ADD BOOLINCLUDE short"

                        End Select
                    Else
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD CHARMEANINGOFSIG nvarchar2"
                            Case 2
                                strSQL = "alter table " & strT & " ADD INTORDER smallint"
                            Case 3
                                strSQL = "alter table " & strT & " ADD BOOLINCLUDE smallint"

                        End Select
                    End If

                    '        If boolAccess Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " Single"
                    '        Else'If boolSQLServer Then
                    '            strSQL = "alter table " & strT & " ADD " & strF & " real"
                    '        End If
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                    Catch ex2 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try


                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                Next

                'now add data

                Dim id As Long

                For Count1 = 1 To 4

                    Select Case Count1

                        Case 1
                            str2 = "Review"
                        Case 2
                            str2 = "Approval"
                        Case 3
                            str2 = "Responsibility"
                        Case 4
                            str2 = "Authorship"

                    End Select

                    Try
                        
                        If boolAccess Then
                            str1 = "INSERT INTO " & strT & " VALUES (" & Count1 & ",'" & str2 & "'," & Count1 & ",-1);"
                        ElseIf boolOra Then
                            str1 = "INSERT INTO " & strT & " VALUES (" & Count1 & ",'" & str2 & "'," & Count1 & ",-1);"
                        ElseIf boolSQLSer Then
                        End If
                        cmd.CommandText = str1
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = str1 & " executed successfully."
                        boolCont = True

                    Catch ex4 As Exception
                        boolProb = True
                        strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        boolCont = False
                    End Try

                Next
            Catch ex3 As Exception

                boolProb = False
                strM = "Table " & strT & " already exists. No need to create."
                boolCont = True
                rs5.Close()
                rs5 = Nothing

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

            End Try

        End Try

        Try
            rs5.Close()

        Catch ex As Exception

        End Try

        rs5 = Nothing

        'MUST RE-ESTABLISH CON
        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con.open(constr)
        Pause(1)

    End Sub

    Sub CreateTable_TBLSAVEEVENT(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLSAVEEVENT"
        boolCont = False

        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            rs5.Close()
            rs5 = Nothing
        Catch ex As Exception

            Try

                If boolAccess Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                Else 'If boolSQLServer Then
                    str1 = "CREATE TABLE " & strT & " "
                    str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
                End If

                strSQL = str1 & str2

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                cmd.ExecuteNonQuery()

                boolProb = False
                'strM = """" & strSQL & """ Table " & strT & " create successfully."
                strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                'MsgBox(strM)
                boolCont = True

                intCount = intCount + 1
                'sht.Range("Notes").Offset(intCount, 0).Value = strM
                'If boolProb Then
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                '    intRed = intRed + 1
                'Else
                '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                'End If

                Dim strID As String

                For Count1 = 1 To 6

                    strID = ""
                    If boolAccess Then
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD DTSAVEDATE date"
                            Case 2
                                strSQL = "alter table " & strT & " ADD CHARUSERNAME text(255)"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARUSERID text(255)"
                            Case 4
                                strSQL = "alter table " & strT & " ADD ID_TBLREASONFORCHANGE double"
                                strID = "ID_TBLREASONFORCHANGE"
                            Case 5
                                strSQL = "alter table " & strT & " ADD ID_TBLCHARMEANINGOFSIG double"
                                strID = "ID_TBLCHARMEANINGOFSIG"
                            Case 6
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES double"
                                strID = "ID_TBLSTUDIES"

                        End Select
                    Else
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD DTSAVEDATE datetime"
                            Case 2
                                strSQL = "alter table " & strT & " ADD CHARUSERNAME nvarchar2"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARUSERID nvarchar2"
                            Case 4
                                strSQL = "alter table " & strT & " ADD ID_TBLREASONFORCHANGE float"
                                strID = "ID_TBLREASONFORCHANGE"
                            Case 5
                                strSQL = "alter table " & strT & " ADD ID_TBLCHARMEANINGOFSIG float"
                                strID = "ID_TBLCHARMEANINGOFSIG"
                            Case 6
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES float"
                                strID = "ID_TBLSTUDIES"

                        End Select
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()

                        intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If


                    Catch ex1 As Exception

                        boolProb = True
                        'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        boolCont = False

                        intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If

                    End Try

                    'create indices
                    If Len(strID) = 0 Then
                    Else
                        strSQL = "CREATE INDEX idx_" & strID & " ON " & strT & " (" & strID & ")"
                        cmd.CommandText = strSQL
                        Try
                            cmd.ExecuteNonQuery()

                        Catch ex3 As Exception

                            str1 = "a"

                        End Try
                    End If

                Next


            Catch ex2 As Exception

            End Try

            'MUST RE-ESTABLISH CON
            If con.State = ADODB.ObjectStateEnum.adStateOpen Then
                con.Close()
            End If

            con.open(constr)
            Pause(1)

        End Try


    End Sub

    Sub CreateTable_TBLAUDITTRAIL(ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd, ByVal constr)

        Dim rs5 As New ADODB.Recordset
        Dim strT As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim Count1 As Short

        strT = "TBLAUDITTRAIL"
        boolCont = False

        Try
            rs5.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        Catch ex As Exception


            If boolAccess Then
                str1 = "CREATE TABLE " & strT & " "
                str2 = "(ID_" & strT & " double CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
            Else 'If boolSQLServer Then
                str1 = "CREATE TABLE " & strT & " "
                str2 = "(ID_" & strT & " float CONSTRAINT PK_id_" & strT & " PRIMARY KEY);"
            End If

            strSQL = str1 & str2

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                'strM = """" & strSQL & """ Table " & strT & " create successfully."
                strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                'MsgBox(strM)
                boolCont = True

                'now add fields
                Dim strID As String
                For Count1 = 1 To 28
                    strID = ""
                    If boolAccess Then
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLSAVEEVENT double"
                                strID = "ID_TBLSAVEEVENT"
                            Case 2
                                strSQL = "alter table " & strT & " ADD CHAROLDVALUE memo"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARNEWVALUE memo"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARTABLE text(50)"
                            Case 5
                                strSQL = "alter table " & strT & " ADD CHARCOLUMN text(50)"
                            Case 6
                                strSQL = "alter table " & strT & " ADD CHARACTION text(25)"
                            Case 7
                                strSQL = "alter table " & strT & " ADD ID_SOURCETABLE double"
                            Case 8
                                strSQL = "alter table " & strT & " ADD CHARLINK1 text(255)"
                            Case 9
                                strSQL = "alter table " & strT & " ADD CHARLINK2 text(255)"
                            Case 10
                                strSQL = "alter table " & strT & " ADD CHARACTUALITEM text(255)"

                            Case 11
                                strSQL = "alter table " & strT & " ADD DTSAVEDATE date"
                            Case 12
                                strSQL = "alter table " & strT & " ADD CHARUSERNAME text(255)"
                            Case 13
                                strSQL = "alter table " & strT & " ADD CHARUSERID text(255)"
                            Case 14
                                strSQL = "alter table " & strT & " ADD CHARTBLREASONFORCHANGE text(255)"
                            Case 15
                                strSQL = "alter table " & strT & " ADD CHARTBLCHARMEANINGOFSIG text(255)"
                            Case 16
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES double"
                                strID = "ID_TBLSTUDIES"
                            Case 17
                                strSQL = "alter table " & strT & " ADD CHARWORKSTATION text(255)"
                            Case 18
                                strSQL = "alter table " & strT & " ADD CHARTABLEDESCRIPTION text(255)"
                            Case 19
                                strSQL = "alter table " & strT & " ADD CHARLINK1VALUE text(255)"
                            Case 20
                                strSQL = "alter table " & strT & " ADD CHARLINK2VALUE text(255)"
                            Case 21
                                strSQL = "alter table " & strT & " ADD CHARSTANDARDTIMEZONE text(50)"
                            Case 22
                                strSQL = "alter table " & strT & " ADD CHARDAYLIGHTSAVINGZONE text(50)"
                            Case 23
                                strSQL = "alter table " & strT & " ADD CHARDAYLIGHTSAVINGTIME text(50)"
                            Case 24
                                strSQL = "alter table " & strT & " ADD CHARCOORUNIVTIME text(50)"
                            Case 25
                                strSQL = "alter table " & strT & " ADD CHARUTCOFFSET text(50)"
                            Case 26
                                strSQL = "alter table " & strT & " ADD CHARWATSONSTUDYNAME text(255)"
                            Case 27
                                strSQL = "alter table " & strT & " ADD DTCOORUNIVTIME date"
                            Case 28
                                strSQL = "alter table " & strT & " ADD CHARAUDITTYPE text(50)"
                        End Select
                    Else
                        Select Case Count1

                            Case 1
                                strSQL = "alter table " & strT & " ADD ID_TBLSAVEEVENT float"
                                strID = "ID_TBLSAVEEVENT"
                            Case 2
                                strSQL = "alter table " & strT & " ADD CHAROLDVALUE nvarchar2"
                            Case 3
                                strSQL = "alter table " & strT & " ADD CHARNEWVALUE nvarchar2"
                            Case 4
                                strSQL = "alter table " & strT & " ADD CHARTABLE nvarchar2"
                            Case 5
                                strSQL = "alter table " & strT & " ADD CHARCOLUMN nvarchar2"
                            Case 6
                                strSQL = "alter table " & strT & " ADD CHARACTION nvarchar2"
                            Case 7
                                strSQL = "alter table " & strT & " ADD ID_SOURCETABLE float"
                            Case 8
                                strSQL = "alter table " & strT & " ADD CHARLINK1 nvarchar2"
                            Case 9
                                strSQL = "alter table " & strT & " ADD CHARLINK2 nvarchar2"
                            Case 10
                                strSQL = "alter table " & strT & " ADD CHARACTUALITEM nvarchar2"

                            Case 11
                                strSQL = "alter table " & strT & " ADD DTSAVEDATE datetime"
                            Case 12
                                strSQL = "alter table " & strT & " ADD CHARUSERNAME nvarchar2"
                            Case 13
                                strSQL = "alter table " & strT & " ADD CHARUSERID nvarchar2"
                            Case 14
                                strSQL = "alter table " & strT & " ADD CHARTBLREASONFORCHANGE nvarchar2"
                            Case 15
                                strSQL = "alter table " & strT & " ADD CHARTBLCHARMEANINGOFSIG nvarchar2"
                            Case 16
                                strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES float"
                                strID = "ID_TBLSTUDIES"
                            Case 17
                                strSQL = "alter table " & strT & " ADD CHARWORKSTATION nvarchar2"
                            Case 18
                                strSQL = "alter table " & strT & " ADD CHARTABLEDESCRIPTION nvarchar2"
                            Case 19
                                strSQL = "alter table " & strT & " ADD CHARLINK1VALUE nvarchar2"
                            Case 20
                                strSQL = "alter table " & strT & " ADD CHARLINK2VALUE nvarchar2"
                            Case 21
                                strSQL = "alter table " & strT & " ADD CHARSTANDARDTIMEZONE nvarchar2"
                            Case 22
                                strSQL = "alter table " & strT & " ADD CHARDAYLIGHTSAVINGZONE nvarchar2"
                            Case 23
                                strSQL = "alter table " & strT & " ADD CHARDAYLIGHTSAVINGTIME nvarchar2"
                            Case 24
                                strSQL = "alter table " & strT & " ADD CHARCOORUNIVTIME nvarchar2"
                            Case 25
                                strSQL = "alter table " & strT & " ADD CHARUTCOFFSET nvarchar2"
                            Case 26
                                strSQL = "alter table " & strT & " ADD CHARWATSONSTUDYNAME nvarchar2"
                            Case 27
                                strSQL = "alter table " & strT & " ADD DTCOORUNIVTIME datetime"
                            Case 28
                                strSQL = "alter table " & strT & " ADD CHARAUDITTYPE nvarchar2"
                        End Select
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = strSQL 'strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                        intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If
                    Catch ex1 As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                        intCount = intCount + 1
                        'sht.Range("Notes").Offset(intCount, 0).Value = strM
                        'If boolProb Then
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                        '    intRed = intRed + 1
                        'Else
                        '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                        'End If
                    End Try

                    'create index
                    If Len(strID) = 0 Then
                    Else
                        strSQL = "CREATE INDEX idx_" & strID & " ON " & strT & " (" & strID & ")"
                        cmd.CommandText = strSQL
                        Try
                            cmd.ExecuteNonQuery()

                        Catch ex3 As Exception

                        End Try
                    End If

                Next

            Catch ex2 As Exception
                boolProb = True
                'strM = """" & strSQL & """ There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                boolCont = False
            End Try

            intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'MUST RE-ESTABLISH CON
            If con.State = ADODB.ObjectStateEnum.adStateOpen Then
                con.Close()
            End If

            con.open(constr)
            Pause(1)


        End Try


    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_CORRECTION( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLDATATABLEROWTITLES"
        For Count2 = 1 To 21
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 1 WHERE ID_TBLDATATABLEROWTITLES = 41"
                Case 2
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 2 WHERE ID_TBLDATATABLEROWTITLES = 42"
                Case 3
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 3 WHERE ID_TBLDATATABLEROWTITLES = 49"
                Case 4
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 4 WHERE ID_TBLDATATABLEROWTITLES = 140"
                Case 5
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 5 WHERE ID_TBLDATATABLEROWTITLES = 264"
                Case 6
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 6 WHERE ID_TBLDATATABLEROWTITLES = 265"
                Case 7
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 7 WHERE ID_TBLDATATABLEROWTITLES = 51"
                Case 8
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
                Case 9
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 9 WHERE ID_TBLDATATABLEROWTITLES = 207"
                Case 10
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 10 WHERE ID_TBLDATATABLEROWTITLES = 208"
                Case 11
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 11 WHERE ID_TBLDATATABLEROWTITLES = 211"
                Case 12
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 12 WHERE ID_TBLDATATABLEROWTITLES = 212"
                Case 13
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 13 WHERE ID_TBLDATATABLEROWTITLES = 213"
                Case 14
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 14 WHERE ID_TBLDATATABLEROWTITLES = 201"
                Case 15
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 15 WHERE ID_TBLDATATABLEROWTITLES = 202"
                Case 16
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 16 WHERE ID_TBLDATATABLEROWTITLES = 209"
                Case 17
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 17 WHERE ID_TBLDATATABLEROWTITLES = 210"
                Case 18
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 18 WHERE ID_TBLDATATABLEROWTITLES = 255"
                Case 19
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 19 WHERE ID_TBLDATATABLEROWTITLES = 256"
                Case 20
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 20 WHERE ID_TBLDATATABLEROWTITLES = 258"
                Case 21
                    strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 21 WHERE ID_TBLDATATABLEROWTITLES = 259"

            End Select

            'rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            'If rs1.EOF And rs1.BOF Then
            'Else
            '    rs1.MoveFirst()
            'End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            'strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strF3 & ";"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            '    rs1.Close()
            'End If

        Next


    End Sub

    Sub ModifyRecords_TBLTAB1_REPORTTEMPLATE_A( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLTAB1"
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARITEM"
                    strF1 = "ID_TBLTAB1"
                    strF2 = "Report Template Configuration"
                    strF3 = "9"

            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strF3 & ";"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddFields_TBLOUTSTANDINGITEMS_CHARFIELDCODE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLOUTSTANDINGITEMS"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 100
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2
                Case 1
                    strF = "CHARFIELDCODE"
                    numU = 0
                    numTy = 202
                    boolDo = False
                
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                Select Case Count2

                End Select

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try


            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub ModifyRecords_TBLTABLEPROPERTIES_MISCELLANEOUS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim idCR As Int64
        Dim idTS As Int64
        Dim strField As String
        Dim strVal As String
        Dim boolVal As Boolean
        Dim intVal As Short

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"

        idTS = 44
        For Count2 = 1 To 6

            Select Case Count2
                Case 1
                    idCR = 18
                Case 2
                    idCR = 19
                Case 3
                    idCR = 21
                Case 4
                    idCR = 22
                Case 5
                    idCR = 23
                Case 6
                    idCR = 29
            End Select

            For Count1 = 1 To 4

                boolVal = True
                strVal = ""
                intVal = 0
                Select Case Count1
                    Case 1
                        strField = "CHARTIMEPERIOD"
                        Select Case Count2
                            Case 1
                                strVal = "Twenty-four"
                            Case 2
                                strVal = ""
                                boolVal = False
                            Case 3
                                strVal = "Seven"
                            Case 4
                                strVal = "72"
                            Case 5
                                strVal = "72"
                            Case 6
                                strVal = "Thirty-two"
                        End Select
                    Case 2
                        strField = "CHARTIMEFRAME"
                        Select Case Count2
                            Case 1
                                strVal = "Hours"
                            Case 2
                                boolVal = False
                                strVal = ""
                            Case 3
                                strVal = "Days"
                            Case 4
                                strVal = "Hours"
                            Case 5
                                strVal = "Hours"
                            Case 6
                                strVal = "Days"

                        End Select
                    Case 3
                        strField = "CHARPERIODTEMP"
                        Select Case Count2
                            Case 1
                                strVal = "70 " & ChrW(176) & "C"
                            Case 2
                                strVal = ""
                                boolVal = False
                            Case 3
                                strVal = "Refrigerated"
                            Case 4
                                strVal = "Room Temperature"
                            Case 5
                                strVal = "Room Temperature"
                            Case 6
                                strVal = "70 " & ChrW(176) & "C"

                        End Select
                    Case 4
                        strField = "INTNUMBEROFCYCLES"
                        Select Case Count2
                            Case 1
                                strVal = ""
                            Case 2
                                intVal = 3
                                boolVal = False
                            Case 3
                                strVal = ""
                            Case 4
                                boolVal = False
                            Case 5
                                boolVal = False
                            Case 6
                                boolVal = False

                        End Select
                End Select

                Dim boolDo As Boolean
                boolDo = False
                If boolVal Then
                    If Len(strVal) = 0 Then
                    Else
                        boolDo = True
                        strSQL = "UPDATE " & strT & " SET " & strField & " = '" & strVal & "' WHERE " & strField & " IS NULL AND ID_TBLCONFIGREPORTTABLES = " & idCR & " AND ID_TBLSTUDIES = 44"
                    End If
                Else
                    If intVal = 0 Then
                    Else
                        boolDo = True
                        strSQL = "UPDATE " & strT & " SET " & strField & " = " & intVal & " WHERE " & strField & " IS NULL AND ID_TBLCONFIGREPORTTABLES = " & idCR & " AND ID_TBLSTUDIES = 44"
                    End If
                End If

                If boolDo Then

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If
             
            Next

        Next

        'conA.CommitTrans()


    End Sub


    Sub AddRecords_tblAssignedSamplesHelper_35(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim int1 As Short

        strT = "tblAssignedSamplesHelper"
        dt = Now
        int1 = 74
        For Count1 = 1 To 3
            Select Case Count1
                Case 1
                    var1 = int1 + Count1
                    var2 = "LLOQ"
                    var3 = 35
                    var4 = 1
                Case 2
                    var1 = int1 + Count1
                    var2 = "ULOQ"
                    var3 = 35
                    var4 = 1
                Case 3
                    var1 = int1 + Count1
                    var2 = "Blank"
                    var3 = 35
                    var4 = 1

            End Select

            Try
                
                If boolAccess Then
                    str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3," & var4 & ");"
                ElseIf boolOra Then
                    str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3," & var4 & ");"
                ElseIf boolSQLSer Then
                End If
                cmd.CommandText = str1
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddRecords_tblAssignedSamplesHelper_34(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4
        Dim int1 As Short

        strT = "tblAssignedSamplesHelper"
        dt = Now
        int1 = 61
        For Count1 = 1 To 13
            Select Case Count1
                Case 1
                    var1 = int1 + Count1
                    var2 = "Blank With IS"
                    var3 = 34
                    var4 = 2
                Case 2
                    var1 = int1 + Count1
                    var2 = "Blank WithOut IS"
                    var3 = 34
                    var4 = 2
                Case 3
                    var1 = int1 + Count1
                    var2 = "LLOQ"
                    var3 = 34
                    var4 = 2
                Case 4
                    var1 = int1 + Count1
                    var2 = "Lot 1"
                    var3 = 34
                    var4 = 1
                Case 5
                    var1 = int1 + Count1
                    var2 = "Lot 2"
                    var3 = 34
                    var4 = 1
                Case 6
                    var1 = int1 + Count1
                    var2 = "Lot 3"
                    var3 = 34
                    var4 = 1
                Case 7
                    var1 = int1 + Count1
                    var2 = "Lot 4"
                    var3 = 34
                    var4 = 1
                Case 8
                    var1 = int1 + Count1
                    var2 = "Lot 5"
                    var3 = 34
                    var4 = 1
                Case 9
                    var1 = int1 + Count1
                    var2 = "Lot 6"
                    var3 = 34
                    var4 = 1
                Case 10
                    var1 = int1 + Count1
                    var2 = "Lot 7"
                    var3 = 34
                    var4 = 1
                Case 11
                    var1 = int1 + Count1
                    var2 = "Lot 8"
                    var3 = 34
                    var4 = 1
                Case 12
                    var1 = int1 + Count1
                    var2 = "Lot 9"
                    var3 = 34
                    var4 = 1
                Case 13
                    var1 = int1 + Count1
                    var2 = "Lot 10"
                    var3 = 34
                    var4 = 1

            End Select

            Try
                
                If boolAccess Then
                    str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3," & var4 & ");"
                ElseIf boolOra Then
                    str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3," & var4 & ");"
                ElseIf boolSQLSer Then
                End If
                cmd.CommandText = str1
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddRecords_tblConfigReportTables_333435(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7


        strT = "tblConfigReportTables"
        dt = Now
        For Count1 = 1 To 3
            Select Case Count1
                Case 1
                    var1 = 33
                    var2 = "System Suitability Table v1"
                    var3 = 26
                    var4 = -1
                    var5 = 0
                    var6 = 0
                    var7 = -1
                Case 2
                    var1 = 34
                    var2 = "Selectivity in Individual Lots Table v1"
                    var3 = 27
                    var4 = 0
                    var5 = 0
                    var6 = 0
                    var7 = -1
                Case 3
                    var1 = 35
                    var2 = "Carryover in Individual Lots Table v1"
                    var3 = 28
                    var4 = -1
                    var5 = 0
                    var6 = 0
                    var7 = -1
            End Select

            Try
                
                If boolAccess Then
                    str1 = "INSERT INTO " & strT & "  VALUES (" & var1 & ",2,'" & var2 & "'," & var3 & ",0,-1,-1,0,0," & var7 & "," & var6 & ",#" & dt & "#,3," & var5 & ",0,0," & var4 & ");"
                ElseIf boolOra Then
                    str1 = "INSERT INTO " & strT & "  VALUES (" & var1 & ",2,'" & var2 & "'," & var3 & ",0,-1,-1,0,0," & var7 & "," & var6 & ",#" & dt & "#,3," & var5 & ",0,0," & var4 & ");"
                ElseIf boolSQLSer Then
                End If
                cmd.CommandText = str1
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub DeleteRecords_TBLFIELDCODES_ANALYTE( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim str6 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim intL As Short
        Dim dt As Date

        boolAdd = False
        strT = "TBLFIELDCODES" '
        For Count2 = 1 To 1

            Select Case Count2
                Case 1
                    'strSQL = "DELETE * FROM " & strT & " WHERE CHARFIELDCODE LIKE '[ANALYTE_%';"
                    str1 = "DELETE(" & strT & ".CHARFIELDCODE) "
                    str2 = "FROM(" & strT & ") "
                    'str3 = "WHERE (((" & strT & ".CHARFIELDCODE) Like '%ANALYTE_%'));"
                    str3 = "WHERE (((" & strT & ".CHARFIELDCODE) Like '%ANALYTE[_]%'));"
                    strSQL = str1 & str2 & str3
            End Select

            'strSQL = "DELETE * FROM " & strT & " WHERE ID_TBLCONFIGBODYSECTIONS < 341;"

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            'now add back desired records
            dt = Now
            For Count1 = 1 To 6
                Select Case Count1
                    Case 1
                        var1 = 163
                        str1 = "[ANALYTE_IUPAC]"
                        str2 = "Returns the Analyte or Analytes (followed by the IUPAC name) that are the subject of the study. If more than one Analyte, then list items separated by a line return"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "NA"
                        str6 = "Report Items"
                    Case 2
                        var1 = 1
                        str1 = "[ANALREFTABLE]"
                        str2 = "Generates the Analytical Reference Standard Section tables."
                        str3 = "Analytical Reference Standard"
                        str4 = "NA"
                        str5 = "NA"
                        str6 = "Analytical Reference Standard Items"
                    Case 3
                        var1 = 71
                        str1 = "[ANALYTE]"
                        str2 = "Returns the Analyte or Analytes that are the subject of the study"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "NA"
                        str6 = "Study Items"

                    Case 4
                        var1 = 162
                        str1 = "[ABSTRACTANALYTEINFO]"
                        str2 = "Returns a description of calibration standard ranges for each Analyte in a study."
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "5.00 ng/mL to 3000 ng/mL for Analyte001 and 2.50 ng/mL to 2000 ng/mL for Analyte002"
                        str6 = "Report Items"
                    Case 5
                        var1 = 183
                        str1 = "[ABSTRACTANALYTEINFO1]"
                        str2 = "Returns a description of calibration standard ranges for each Analyte in a study. Differs from ABSTRACTANALYTEINFO in the order of describing information (compare Example column)"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "Cmpd1 from 1.00 ng/mL to 1000 ng/mL and Cmpd2 from 5.00 ng/mL to 5000 ng/mL"
                        str6 = "Report Items"
                    Case 6
                        var1 = 184
                        str1 = "[ABSTRACTANALYTEINFO2]"
                        str2 = "Returns a description of calibration standard ranges for each Analyte in a study. Differs from ABSTRACTANALYTEINFO by including extra information (compare Example column)"
                        str3 = "NA"
                        str4 = "NA"
                        str5 = "Cmpd1 in 25 L heparin buffered rat plasma samples over a concentration range of 1.00 ng/mL to 1000 ng/mL and Cmpd2 in 25 L heparin buffered rat plasma samples over a concentration range of 5.00 ng/mL to 5000 ng/mL"
                        str6 = "Report Items"

                End Select

                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "','" & str3 & "','" & str4 & "','" & str5 & "','" & str6 & "',#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "','" & str3 & "','" & str4 & "','" & str5 & "','" & str6 & "',#" & dt & "#);"
                ElseIf boolSQLSer Then

                End If

                cmd.CommandText = strSQL
                cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                Try
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                End Try

            Next

        Next


    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_TIMEPERIOD(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 7

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 100
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2
                Case 1
                    strF = "CHARTIMEPERIOD"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 202
                    boolDo = False
                Case 2
                    strF = "CHARTIMEFRAME"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 202
                    boolDo = False
                Case 3
                    strF = "CHARPERIODTEMP"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 202
                    boolDo = False
                Case 4
                    strF = "INTNUMBEROFCYCLES"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                Case 5
                    strF = "BOOLCONVERTTIME"
                    numU = -1
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True
                Case 6
                    strF = "BOOLCONVERTTEMP"
                    numU = -1
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True
                Case 7
                    strF = "CHARISCONC"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 202
                    boolDo = False
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                'boolAdd = True

                rs1.Close()

                Select Case Count2

                End Select

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    For Count3 = 1 To 1

                        Select Case Count3
                            Case 1
                                strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                            Case 2
                                strSQL = "UPDATE " & strT & " SET " & strF & " = -1 " & strWhere1
                        End Select

                        cmd.CommandText = strSQL
                        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                        Try
                            cmd.ExecuteNonQuery()
                            boolProb = False
                            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                    Next

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLAPPFIGS_CHARFCID(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARFCID"
                    numU = 0
                    strT = "TBLAPPFIGS"
                    numTy = 202
                    intText = 100
                Case 2
                    strF = "CHARFCID"
                    numU = 0
                    strT = "TBLREPORTTABLE"
                    numTy = 202
                    intText = 100

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    'cmd.CommandText = strSQL
                    'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    'Try
                    '    cmd.ExecuteNonQuery()
                    '    boolProb = False
                    '    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    'Catch ex As Exception
                    '    boolProb = True
                    '    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    'End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub ModifyRecords_TBLCONFIGAPPFIGS_MISCELLANEOUS( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLCONFIGAPPFIGS"
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARTITLE"
                    strF1 = "ID_TBLCONFIGAPPFIGS"
                    strF2 = "Miscellaneous Appendices/Figs"
                    strF3 = CStr(5)

            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " = " & strF3 & ";"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_TBLTABLEPROPERTIES_BOOLSTATSRE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2
                Case 1
                    strF = "BOOLSTATSRE"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True

                rs1.Close()

                Select Case Count2

                End Select

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = True
                If boolAdd Then 'update records

                    For Count3 = 1 To 2

                        Select Case Count3
                            Case 1
                                strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                            Case 2
                                strSQL = "UPDATE " & strT & " SET " & strF & " = -1 " & strWhere1
                        End Select

                        If boolDo Or Count3 = 1 Then
                            cmd.CommandText = strSQL
                            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                            Try
                                cmd.ExecuteNonQuery()
                                boolProb = False
                                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                            Catch ex As Exception
                                boolProb = True
                                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                            End Try

                            'intCount = intCount + 1
                            'sht.Range("Notes").Offset(intCount, 0).Value = strM
                            'If boolProb Then
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                            '    intRed = intRed + 1
                            'Else
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                            'End If
                        End If

                    Next

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_STUDYSTARTDATE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 2
            Select Case Count1
                Case 1
                    var1 = 264
                    str1 = "tblCompanyData"
                    str2 = "Study Start Date"
                    var2 = 5
                    str3 = "tblData"
                    str4 = "DTSTUDYSTARTDATE"
                    var3 = 0
                Case 2
                    var1 = 265
                    str1 = "tblCompanyData"
                    str2 = "Study End Date"
                    var2 = 6
                    str3 = "tblData"
                    str4 = "DTSTUDYENDDATE"
                    var3 = 0

            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_STUDYSTARTDATE( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String

        boolAdd = False

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 7 WHERE ID_TBLDATATABLEROWTITLES = 51"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 9 WHERE ID_TBLDATATABLEROWTITLES = 207"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 10 WHERE ID_TBLDATATABLEROWTITLES = 208"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 11 WHERE ID_TBLDATATABLEROWTITLES = 211"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 11 WHERE ID_TBLDATATABLEROWTITLES = 201"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 12 WHERE ID_TBLDATATABLEROWTITLES = 202"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 12 WHERE ID_TBLDATATABLEROWTITLES = 212"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 13 WHERE ID_TBLDATATABLEROWTITLES = 213"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 14 WHERE ID_TBLDATATABLEROWTITLES = 209"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 15 WHERE ID_TBLDATATABLEROWTITLES = 210"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 16 WHERE ID_TBLDATATABLEROWTITLES = 255"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 17 WHERE ID_TBLDATATABLEROWTITLES = 256"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 18 WHERE ID_TBLDATATABLEROWTITLES = 258"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 19 WHERE ID_TBLDATATABLEROWTITLES = 259"
        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 199"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try


        'DON'T DO THIS!  IT RUNS EVERY TIME AND SCREWS UP INORDER NUMBERING
        'For Count2 = 17 To 5 Step -1
        '    boolAdd = False
        '    str1 = ""
        '    str2 = ""
        '    int1 = 200

        '    strF = "(CHARDATATABLENAME = 'tblCompanyData' AND INTORDER = " & Count2 & ")"
        '    strF1 = "INTORDER"
        '    numU = -1
        '    numU1 = 3
        '    strT = "TBLDATATABLEROWTITLES"
        '    strF2 = "[None]"


        '    'rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        '    'If rs1.EOF And rs1.BOF Then
        '    'Else
        '    '    rs1.MoveFirst()
        '    'End If

        '    strM = strF
        '    boolProb = False
        '    'check to see if strF exists
        '    boolCont = False
        '    ''debug.print ""
        '    ''debug.print "Start fields tblPKAUC..."

        '    strSQL = "UPDATE " & strT & " SET " & strF1 & " = " & Count2 + 2 & " WHERE " & strF
        '    cmd.CommandText = strSQL
        '    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        '    Try
        '        cmd.ExecuteNonQuery()
        '        boolProb = False
        '        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        '    Catch ex As Exception
        '        boolProb = True
        '        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        '    End Try

        '    'intCount = intCount + 1
        '    'sht.Range("Notes").Offset(intCount, 0).Value = strM
        '    'If boolProb Then
        '    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
        '    '    intRed = intRed + 1
        '    'Else
        '    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
        '    'End If

        '    'If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
        '    '    rs1.Close()
        '    'End If

        'Next


    End Sub

    Sub AddFields_TBLDATA_STUDYSTARTDATE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "DTSTUDYSTARTDATE"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 7
                    intText = 100
                Case 2
                    strF = "DTSTUDYENDDATE"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 7
                    intText = 100
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    'cmd.CommandText = strSQL
                    'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    'Try
                    '    cmd.ExecuteNonQuery()
                    '    boolProb = False
                    '    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    'Catch ex As Exception
                    '    boolProb = True
                    '    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    'End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub DeleteRecords_TBLREPORTSTATEMENTS( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim intL As Short

        boolAdd = False
        strT = "TBLREPORTSTATEMENTS" '
        For Count2 = 1 To 3

            Select Case Count2
                Case 1
                    strSQL = "DELETE * FROM " & strT & " WHERE ID_TBLCONFIGBODYSECTIONS = 1;"
                Case 2
                    'strSQL = "DELETE * FROM " & strT & " WHERE (ID_TBLCONFIGBODYSECTIONS > 2 AND ID_TBLCONFIGBODYSECTIONS < 134;"
                    strSQL = "DELETE *, ID_TBLCONFIGBODYSECTIONS, ID_TBLCONFIGBODYSECTIONS FROM(TBLREPORTSTATEMENTS) WHERE (((ID_TBLCONFIGBODYSECTIONS) > 2) AND ((ID_TBLCONFIGBODYSECTIONS) < 134));"

                Case 3
                    'strSQL = "DELETE * FROM " & strT & " WHERE (ID_TBLCONFIGBODYSECTIONS > 141 AND ID_TBLCONFIGBODYSECTIONS < 341;"
                    strSQL = "DELETE *, ID_TBLCONFIGBODYSECTIONS, ID_TBLCONFIGBODYSECTIONS FROM(TBLREPORTSTATEMENTS) WHERE (((ID_TBLCONFIGBODYSECTIONS) > 141) AND ((ID_TBLCONFIGBODYSECTIONS) < 341));"

            End Select

            'strSQL = "DELETE * FROM " & strT & " WHERE ID_TBLCONFIGBODYSECTIONS < 341;"

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next


    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_CHARCHEMSTRUCTURE( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 5 WHERE ID_TBLDATATABLEROWTITLES = 260"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 6 WHERE ID_TBLDATATABLEROWTITLES = 261"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 7 WHERE ID_TBLDATATABLEROWTITLES = 262"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 8 WHERE ID_TBLDATATABLEROWTITLES = 263"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 9 WHERE ID_TBLDATATABLEROWTITLES = 2"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 10 WHERE ID_TBLDATATABLEROWTITLES = 3"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 11 WHERE ID_TBLDATATABLEROWTITLES = 4"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 12 WHERE ID_TBLDATATABLEROWTITLES = 5"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 13 WHERE ID_TBLDATATABLEROWTITLES = 6"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 14 WHERE ID_TBLDATATABLEROWTITLES = 7"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 15 WHERE ID_TBLDATATABLEROWTITLES = 8"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 16 WHERE ID_TBLDATATABLEROWTITLES = 9"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 17 WHERE ID_TBLDATATABLEROWTITLES = 10"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 18 WHERE ID_TBLDATATABLEROWTITLES = 195"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 19 WHERE ID_TBLDATATABLEROWTITLES = 198"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 20 WHERE ID_TBLDATATABLEROWTITLES = 11"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 21 WHERE ID_TBLDATATABLEROWTITLES = 12"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 22 WHERE ID_TBLDATATABLEROWTITLES = 191"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 23 WHERE ID_TBLDATATABLEROWTITLES = 196"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 24 WHERE ID_TBLDATATABLEROWTITLES = 197"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        strSQL = "UPDATE TBLDATATABLEROWTITLES SET INTORDER = 25 WHERE ID_TBLDATATABLEROWTITLES = 205"
        cmd.CommandText = strSQL
        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        Try
            cmd.ExecuteNonQuery()
            boolProb = False
            strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf
        Catch ex As Exception
            boolProb = True
            strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
        End Try

        'boolAdd = False
        'For Count2 = 21 To 5 Step -1
        '    boolAdd = False
        '    str1 = ""
        '    str2 = ""
        '    int1 = 200

        '    strF = "(CHARDATATABLENAME = 'tblCompanyAnalRefTable' AND INTORDER = " & Count2 & ")"
        '    strF1 = "INTORDER"
        '    numU = -1
        '    numU1 = 3
        '    strT = "TBLDATATABLEROWTITLES"
        '    strF2 = "[None]"


        '    rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
        '    If rs1.EOF And rs1.BOF Then
        '    Else
        '        rs1.MoveFirst()
        '    End If

        '    strM = strF
        '    boolProb = False
        '    'check to see if strF exists
        '    boolCont = False
        '    ''debug.print ""
        '    ''debug.print "Start fields tblPKAUC..."

        '    strSQL = "UPDATE " & strT & " SET " & strF1 & " = " & Count2 + 4 & " WHERE " & strF
        '    cmd.CommandText = strSQL
        '    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
        '    Try
        '        cmd.ExecuteNonQuery()
        '        boolProb = False
        '        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

        '    Catch ex As Exception
        '        boolProb = True
        '        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

        '    End Try

        '    'intCount = intCount + 1
        '    'sht.Range("Notes").Offset(intCount, 0).Value = strM
        '    'If boolProb Then
        '    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
        '    '    intRed = intRed + 1
        '    'Else
        '    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
        '    'End If

        '    If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
        '        rs1.Close()
        '    End If

        'Next


    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_CHARCHEMSTRUCTURE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 4
            Select Case Count1
                Case 1
                    var1 = 260
                    str1 = "tblCompanyAnalRefTable"
                    str2 = "Chemical Structure"
                    var2 = 5
                    str3 = "tblCompanyAnalRefTable"
                    str4 = "CHARCHEMSTRUCTURE"
                    var3 = 0
                Case 2
                    var1 = 261
                    str1 = "tblCompanyAnalRefTable"
                    str2 = "Molecular Formula"
                    var2 = 6
                    str3 = "tblCompanyAnalRefTable"
                    str4 = "CHARMOLFORMULA"
                    var3 = 0
                Case 3
                    var1 = 262
                    str1 = "tblCompanyAnalRefTable"
                    str2 = "Molecular Weight (MW)"
                    var2 = 7
                    str3 = "tblCompanyAnalRefTable"
                    str4 = "CHARMOLWT"
                    var3 = 0
                Case 4
                    var1 = 263
                    str1 = "tblCompanyAnalRefTable"
                    str2 = "Monoisotopic MW"
                    var2 = 8
                    str3 = "tblCompanyAnalRefTable"
                    str4 = "CHARMONOISOWT"
                    var3 = 0
            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddFields_TBLANALREFSTANDARDS_CHARCHEMSTRUCTURE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String
        Dim numTy As Short
        Dim intText As Short

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String

        'strF = "CHARFTSTORCOND"
        'numU = 0
        'strT = "TBLMETHODVALIDATIONDATA"
        'numTy = 202
        'intText = 200
        'strU = ""

        boolAdd = False
        For Count2 = 1 To 4
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            numU = 0
            Select Case Count2
                Case 1
                    strF = "CHARCHEMSTRUCTURE"
                    strT = "TBLANALREFSTANDARDS"
                    numTy = 202
                    intText = 100
                Case 2
                    strF = "CHARMOLFORMULA"
                    strT = "TBLANALREFSTANDARDS"
                    numTy = 202
                    intText = 100
                Case 3
                    strF = "CHARMOLWT"
                    strT = "TBLANALREFSTANDARDS"
                    numTy = 202
                    intText = 100
                Case 4
                    strF = "CHARMONOISOWT"
                    strT = "TBLANALREFSTANDARDS"
                    numTy = 202
                    intText = 100

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)

                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = False
                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = 0 WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    strSQL = "UPDATE " & strT & " SET " & strF & " = -1 WHERE (ID_TBLCONFIGREPORTTABLES = 11 OR ID_TBLCONFIGREPORTTABLES = 13 OR ID_TBLCONFIGREPORTTABLES = 14 OR ID_TBLCONFIGREPORTTABLES = 15)"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_boolInclAnovaSummaryStats(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLINCLANOVASUMSTATS"
                    numU = -1
                    strT = "tblTABLEPROPERTIES"

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = 0 WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    strSQL = "UPDATE " & strT & " SET " & strF & " = -1 WHERE (ID_TBLCONFIGREPORTTABLES = 11 OR ID_TBLCONFIGREPORTTABLES = 13 OR ID_TBLCONFIGREPORTTABLES = 14 OR ID_TBLCONFIGREPORTTABLES = 15)"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_EXCLUDESAMPLES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 2
            Select Case Count1
                Case 1
                    var1 = 258
                    str1 = "tblCompanyData"
                    str2 = "Enable GuWu Exclude Samples feature"
                    var2 = 16
                    str3 = "tblData"
                    str4 = "BOOLALLOWEXCLSAMPLES"
                    var3 = -1

                Case 2
                    var1 = 259
                    str1 = "tblCompanyData"
                    str2 = "Enable GuWu Acceptance Crit. feature"
                    var2 = 17
                    str3 = "tblData"
                    str4 = "BOOLALLOWGUWUACCCRIT"
                    var3 = -1

            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddFields_TBLDATA_EXCLUDESAMPLES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLALLOWEXCLSAMPLES"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
                Case 2
                    strF = "BOOLALLOWGUWUACCCRIT"
                    numU = -1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLCONFIGURATION_EXCLUDESAMPLES( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8, var9
        Dim intID As Int64

        strT = "TBLCONFIGURATION"
        dt = Now
        For Count1 = 1 To 2
            Select Case Count1
                Case 1
                    intID = 27
                    var1 = "Global"
                    var2 = "Global Settings"
                    var3 = "Allow users to exclude data in GuWu (Watson overrides GuWu)"
                    var4 = "TRUE"
                    var5 = 15
                    var6 = 0
                    var7 = 0
                    var8 = 0
                    var9 = -1

                Case 2
                    intID = 28
                    var1 = "Global"
                    var2 = "Global Settings"
                    var3 = "Allow users to set QC and Calibr Std Acceptance Criteria (GuWu overrides Watson)"
                    var4 = "TRUE"
                    var5 = 16
                    var6 = 0
                    var7 = 0
                    var8 = 0
                    var9 = -1

            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If
                '''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddFields_TBLASSIGNEDSAMPLES_BOOLACCCRIT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim boolUpdate As Boolean

        boolAdd = False
        strT = "TBLASSIGNEDSAMPLES"
        For Count2 = 1 To 3
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10
            boolUpdate = False

            Select Case Count2
                Case 1
                    strF = "BOOLUSEGUWUACCCRIT"
                    numU = 0
                    strT = "TBLASSIGNEDSAMPLES"
                    numTy = 2
                    boolUpdate = True
                Case 2
                    strF = "NUMMINACCCRIT"
                    numU = 0
                    strT = "TBLASSIGNEDSAMPLES"
                    numTy = 1
                Case 3
                    strF = "NUMMAXACCCRIT"
                    numU = 0
                    strT = "TBLASSIGNEDSAMPLES"
                    numTy = 1

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next


            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                If boolAccess Then
                    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)
                ElseIf boolSQLSer Then

                ElseIf boolOra Then

                End If

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                'boolAdd = True
                If boolUpdate Then 'update records

                    If boolString Then
                        If boolAccess Then
                            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                        ElseIf boolSQLSer Then
                        ElseIf boolOra Then
                        End If
                    Else
                        If boolAccess Then
                            strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                        ElseIf boolSQLSer Then
                        ElseIf boolOra Then
                        End If
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLASSIGNEDSAMPLES_BOOLEXCLSAMPLE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLEXCLSAMPLE"
                    numU = 0
                    strT = "TBLASSIGNEDSAMPLES"

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddRecords_TBLFIELDCODES_FREEZETHAWSTORAGECOND(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7
        Dim rs1 As New ADODB.Recordset
        Dim strF As String
        Dim boolCont As Boolean

        strT = "TBLFIELDCODES"

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)

        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 196
                    var2 = "[FREEZETHAWSTORAGECOND]"
                    var3 = "Returns the Freeze/Thaw Storage Conditions recorded in the Method Validation Data tab"
                    var4 = "Method Validation Data"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Study Items"

            End Select

            boolCont = True
            strF = "ID_TBLFIELDCODES = " & var1
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then
                boolCont = True
            Else
                boolCont = False
            End If

            If boolCont Then

                Try
                    
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolSQLSer Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    End If
                    '''''''''''console.writeline(strSQL)
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & strSQL & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    '''''''''console.writeline(strM)
                    'MsgBox(strM)
                    boolCont = False
                End Try

            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_CHARFTSTORCOND(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 257
                    str1 = "tblMethodValidationData"
                    str2 = "Freeze/Thaw Storage Conditions"
                    var2 = 29
                    str3 = "tblMethodValidationData"
                    str4 = "CHARFTSTORCOND"
                    var3 = -1
            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub ModifyRecords_TBLDATATABLEROWTITLES_CHARFTSTORCOND_CHANGEORDER( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String

        boolAdd = False
        For Count2 = 36 To 29 Step -1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200

            strF = "(CHARDATATABLENAME = 'tblMethodValidationData' AND INTORDER = " & Count2 & ")"
            strF1 = "INTORDER"
            numU = -1
            numU1 = 3
            strT = "TBLDATATABLEROWTITLES"
            strF2 = "[None]"


            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF1 & " = " & Count2 + 1 & " WHERE " & strF
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub AddFields_TBLMETHODVALIDATIONDATA_CHARFTSTORCOND( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARFTSTORCOND"
                    numU = 0
                    strT = "TBLMETHODVALIDATIONDATA"
                    numTy = 202
                    intText = 200
                    strU = ""

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = False

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_BOOLINCLUDEWATSONLABELS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2
                Case 1
                    strF = "BOOLINCLUDEWATSONLABELS"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True

                rs1.Close()

                Select Case Count2

                End Select

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = True
                If boolAdd Then 'update records

                    For Count3 = 1 To 2

                        Select Case Count3
                            Case 1
                                strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                            Case 2
                                strSQL = "UPDATE " & strT & " SET " & strF & " = -1 " & strWhere1
                        End Select

                        If boolDo Or Count3 = 1 Then
                            cmd.CommandText = strSQL
                            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                            Try
                                cmd.ExecuteNonQuery()
                                boolProb = False
                                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                            Catch ex As Exception
                                boolProb = True
                                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                            End Try

                            'intCount = intCount + 1
                            'sht.Range("Notes").Offset(intCount, 0).Value = strM
                            'If boolProb Then
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                            '    intRed = intRed + 1
                            'Else
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                            'End If
                        End If

                    Next

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLANALYTICALRUNSUMMARY_BOOLINCLUDEREGR( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLINCLUDEREGR"
                    numU = -1
                    strT = "TBLANALYTICALRUNSUMMARY"
                    numTy = 2
                    intText = 100
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = True

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub


    Sub AddFields_TBLDATA_QAEVENTSBORDER( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLQAEVENTBORDER"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = True

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_TBLFIELDCODES_ANTICOAGULANTMETHOD(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7
        Dim rs1 As New ADODB.Recordset
        Dim strF As String
        Dim boolCont As Boolean

        strT = "TBLFIELDCODES"

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)

        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 195
                    var2 = "[ANTICOAGULANTMETHOD]"
                    var3 = "Returns the anticoagulant/preservative described in the Method Validation section"
                    var4 = "Method Validation"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Report Items"

            End Select

            boolCont = True
            strF = "ID_TBLFIELDCODES = " & var1
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then
                boolCont = True
            Else
                boolCont = False
            End If

            If boolCont Then

                Try
                    
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolSQLSer Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    End If
                    '''''''''''console.writeline(strSQL)
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & strSQL & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    '''''''''console.writeline(strM)
                    'MsgBox(strM)
                    boolCont = False
                End Try

            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_RECOVERY(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 2

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2

                'EXAMPLE:
                'Case 1
                '    strF = "BOOLRCCONC"
                '    numU = 0
                '    strT = "tblTABLEPROPERTIES"
                '    numTy = 2
                '    strWhere1 = "WHERE (" & strF1 & " = 17 OR " & strF1 & " = 31 OR " & strF1 & " = 32);"
                '    boolDo = True
                'Case 2
                '    strF = "BOOLRCPA"
                '    numU = 0
                '    strT = "tblTABLEPROPERTIES"
                '    numTy = 2
                '    strWhere1 = "WHERE (" & strF1 & " = 13 OR " & strF1 & " = 14 OR " & strF1 & " = 15);"
                '    boolDo = True
                Case 1
                    strF = "BOOLDIFFERENCE"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                Case 2
                    strF = "BOOLRECOVERY"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    strWhere1 = "WHERE (" & strF1 & " = 13 OR " & strF1 & " = 14 OR " & strF1 & " = 15);"
                    boolDo = True
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True

                rs1.Close()

                Select Case Count2

                End Select

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = True
                If boolAdd Then 'update records

                    For Count3 = 1 To 2

                        Select Case Count3
                            Case 1
                                strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                            Case 2
                                strSQL = "UPDATE " & strT & " SET " & strF & " = -1 " & strWhere1
                        End Select

                        If boolDo Or Count3 = 1 Then
                            cmd.CommandText = strSQL
                            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                            Try
                                cmd.ExecuteNonQuery()
                                boolProb = False
                                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                            Catch ex As Exception
                                boolProb = True
                                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                            End Try

                            'intCount = intCount + 1
                            'sht.Range("Notes").Offset(intCount, 0).Value = strM
                            'If boolProb Then
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                            '    intRed = intRed + 1
                            'Else
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                            'End If
                        End If

                    Next

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_BOOLINCLUDEDATE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2
                Case 1
                    strF = "BOOLINCLUDEDATE"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True

                rs1.Close()

                Select Case Count2

                End Select

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = True
                If boolAdd Then 'update records

                    For Count3 = 1 To 2

                        Select Case Count3
                            Case 1
                                strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                            Case 2
                                strSQL = "UPDATE " & strT & " SET " & strF & " = -1 " & strWhere1
                        End Select

                        If boolDo Or Count3 = 1 Then
                            cmd.CommandText = strSQL
                            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                            Try
                                cmd.ExecuteNonQuery()
                                boolProb = False
                                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                            Catch ex As Exception
                                boolProb = True
                                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                            End Try

                            'intCount = intCount + 1
                            'sht.Range("Notes").Offset(intCount, 0).Value = strM
                            'If boolProb Then
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                            '    intRed = intRed + 1
                            'Else
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                            'End If
                        End If

                    Next

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing
        'conA.CommitTrans()

    End Sub

    Sub ModifyRecords_TBLTABLEPROPERTIES_CorrectBOOLPOSLEG(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 1

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2
                Case 1
                    strF = "BOOLPOSLEG"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    strWhere1 = "WHERE (BOOLPOSLEG = 0 AND BOOLNEGLEG = 0);"
                    boolDo = True

            End Select

            boolProb = False

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            boolCont = False

            If boolCont = False Then 'field needs to be added

                boolAdd = True

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = -1 " & strWhere1

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()

    End Sub

    Sub DeleteRecords_TBLREPORTHEADERS( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLREPORTHEADERS"
        For Count2 = 1 To 1

            strSQL = "DELETE * FROM " & strT

            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

        Next


    End Sub

    Sub AddFileds_TBLTABLEPROPERTIES_LEGENDS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU2 As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim strWhere3 As String
        Dim strWhere4 As String
        Dim intEnd As Short
        Dim boolDo As Boolean
        Dim strText1 As String
        Dim strLegNum As String
        Dim strLegDen As String

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 7

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2
                Case 1
                    strF = "BOOLNONELEG"
                    numU = -1
                    numU2 = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    strWhere1 = "WHERE (" & strF1 & " = 13 OR " & strF1 & " = 14 OR " & strF1 & " = 15 OR " & strF1 & " = 22 OR " & strF1 & " = 23)"
                    boolDo = True
                    boolAdd = True
                Case 2
                    strF = "BOOLPOSLEG"
                    numU = 0
                    numU2 = -1
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    strWhere1 = "WHERE (" & strF1 & " = 13 OR " & strF1 & " = 14 OR " & strF1 & " = 15 OR " & strF1 & " = 22 OR " & strF1 & " = 23)"
                    boolDo = True
                    boolAdd = True
                Case 3
                    strF = "BOOLNEGLEG"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True
                Case 4
                    strF = "BOOLCUSTOMLEG"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
                    boolAdd = True
                Case 5
                    strF = "CHARTITLELEG"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 202
                    boolDo = False
                    lenChar = 250
                    boolAdd = True
                    boolString = True
                Case 6
                    strF = "CHARNUMLEG"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 202
                    boolDo = False
                    lenChar = 250
                    boolAdd = True
                    boolString = True
                Case 7
                    strF = "CHARDENLEG"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 202
                    boolDo = False
                    lenChar = 250
                    boolAdd = True
                    boolString = True
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added

                rs1.Close()

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                Dim boolRealDo As Boolean = True

                If boolAdd Then 'update records

                    For Count3 = 1 To 2

                        Select Case Count2
                            Case 1, 2, 3, 4
                                Select Case Count3
                                    Case 1
                                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                                    Case 2
                                        strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU2 & " " & strWhere1 & ";"
                                End Select
                            Case 5, 6, 7

                                Exit For

                        End Select


                        If (boolDo Or Count3 = 1) Then
                            cmd.CommandText = strSQL
                            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                            Try
                                cmd.ExecuteNonQuery()
                                boolProb = False
                                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                            Catch ex As Exception
                                boolProb = True
                                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                            End Try

                            'intCount = intCount + 1
                            'sht.Range("Notes").Offset(intCount, 0).Value = strM
                            'If boolProb Then
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                            '    intRed = intRed + 1
                            'Else
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                            'End If
                        End If

                    Next

                    If boolString And Count3 = 1 Then

                        For Count3 = 1 To 5

                            Select Case Count3
                                Case 1
                                    Select Case Count2
                                        Case 5
                                            strText1 = "Combined Recovery = "
                                        Case 6
                                            strText1 = "(Mean Peak Area of Extracted QC) * 100"
                                        Case 7
                                            strText1 = "(Mean Peak Area of Solution QC)"
                                    End Select
                                    strWhere1 = "WHERE " & strF1 & " = 13"

                                Case 2
                                    Select Case Count2
                                        Case 5
                                            strText1 = "True Recovery = "
                                        Case 6
                                            strText1 = "(Mean Peak Area of Extracted QC) * 100"
                                        Case 7
                                            strText1 = "(Mean Peak Area of Post Extraction Spiking Solution QC)"
                                    End Select
                                    strWhere1 = "WHERE " & strF1 & " = 14"
                                Case 3
                                    Select Case Count2
                                        Case 5
                                            strText1 = "Suppression/Enhancement = "
                                        Case 6
                                            strText1 = "(Mean Peak Area of Post Extraction Spiking Solution QC) * 100"
                                        Case 7
                                            strText1 = "(Mean Peak Area of Solution QC)"
                                    End Select
                                    strWhere1 = "WHERE " & strF1 & " = 15"
                                Case 4
                                    Select Case Count2
                                        Case 5
                                            strText1 = "%Difference = "
                                        Case 6
                                            strText1 = "(Mean Old - Mean New) x 100"
                                        Case 7
                                            strText1 = "(Mean New)"
                                    End Select
                                    strWhere1 = "WHERE " & strF1 & " = 22"
                                Case 5
                                    Select Case Count2
                                        Case 5
                                            strText1 = "%Difference = "
                                        Case 6
                                            strText1 = "(Mean Old - Mean New) x 100"
                                        Case 7
                                            strText1 = "(Mean New)"
                                    End Select
                                    strWhere1 = "WHERE " & strF1 & " = 23"
                            End Select

                            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strText1 & "' " & strWhere1 & ";"

                            cmd.CommandText = strSQL
                            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                            Try
                                cmd.ExecuteNonQuery()
                                boolProb = False
                                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                            Catch ex As Exception
                                boolProb = True
                                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                            End Try

                            'intCount = intCount + 1
                            'sht.Range("Notes").Offset(intCount, 0).Value = strM
                            'If boolProb Then
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                            '    intRed = intRed + 1
                            'Else
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                            'End If

                        Next

                    End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing
        'conA.CommitTrans()

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_BOOLRC(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim Count3 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short
        Dim strF1 As String
        Dim strWhere1 As String
        Dim strWhere2 As String
        Dim intEnd As Short
        Dim boolDo As Boolean

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        intEnd = 5

        For Count2 = 1 To intEnd
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10
            strF1 = "ID_TBLCONFIGREPORTTABLES"

            Select Case Count2
                Case 1
                    strF = "BOOLRCCONC"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    strWhere1 = "WHERE (" & strF1 & " = 17 OR " & strF1 & " = 31 OR " & strF1 & " = 32);"
                    boolDo = True
                Case 2
                    strF = "BOOLRCPA"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                    strWhere1 = "WHERE (" & strF1 & " = 13 OR " & strF1 & " = 14 OR " & strF1 & " = 15);"
                    boolDo = True
                Case 3
                    strF = "BOOLRCPARATIO"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    strWhere1 = "WHERE (" & strF1 & " = 22 OR " & strF1 & " = 23);"
                    boolDo = True
                Case 4
                    strF = "BOOLINCLUDEISTBL"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    strWhere1 = "WHERE (" & strF1 & " = 13 OR " & strF1 & " = 14 OR " & strF1 & " = 15);"
                    boolDo = True
                Case 5
                    strF = "BOOLMEANACCURACY"
                    numU = 0
                    strT = "TBLTABLEPROPERTIES"
                    numTy = 2
                    boolDo = False
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True

                rs1.Close()

                Select Case Count2

                End Select

                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = True
                If boolAdd Then 'update records

                    For Count3 = 1 To 2

                        Select Case Count3
                            Case 1
                                strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & ";"
                            Case 2
                                strSQL = "UPDATE " & strT & " SET " & strF & " = -1 " & strWhere1
                        End Select

                        If boolDo Or Count3 = 1 Then
                            cmd.CommandText = strSQL
                            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                            Try
                                cmd.ExecuteNonQuery()
                                boolProb = False
                                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                            Catch ex As Exception
                                boolProb = True
                                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                            End Try

                            'intCount = intCount + 1
                            'sht.Range("Notes").Offset(intCount, 0).Value = strM
                            'If boolProb Then
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                            '    intRed = intRed + 1
                            'Else
                            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                            'End If
                        End If

                    Next

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing
        'conA.CommitTrans()

    End Sub

    Sub ModifyRecords_TBLCONFIGURATION_DEFAULT1( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String

        boolAdd = False
        strT = "TBLCONFIGURATION"
        For Count2 = 1 To 3
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARCONFIGTITLE"
                    strF2 = "Default # of Decimals for Conc Data"
                    strF3 = "Default Number of Decimals"
                Case 2
                    strF = "CHARCONFIGTITLE"
                    strF2 = "Default Significant Figures for Conc Data"
                    strF3 = "Default Significant Figures"
                Case 3
                    strF = "CHARCONFIGTITLE"
                    strF2 = "Default Use Significant Figures, not Decimals for Conc Data"
                    strF3 = "Default Use Significant Figures, not Decimals"
            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF & " = '" & strF3 & "';"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub AddFields_TBLCONFIGURATION_INTQCPERCDECPLACES( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7, var8, var9
        Dim intID As Int64

        strT = "TBLCONFIGURATION"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1

                    intID = 26
                    var1 = "Global"
                    var2 = "Global Settings"
                    var3 = "Default # of Decimals for QC Stats"
                    var4 = "1"
                    var5 = 14
                    var6 = -1
                    var7 = 0
                    var8 = 0
                    var9 = 0

            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & intID & ",'" & var1 & "','" & var2 & "','" & var3 & "','" & var4 & "'," & var5 & "," & var6 & "," & var7 & "," & var8 & "," & var9 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If
                '''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub ModifyRecords_TBLDATA_CHARUNITS( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String
        Dim strF2 As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARUNITS"
                    strF1 = "CHARUNITS"
                    numU = -1
                    numU1 = 3
                    strT = "TBLDATA"
                    strF2 = "[None]"
            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strF2 & "' WHERE " & strF1 & " IS NULL"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub


    Sub AddFields_TBLDATA_INTQCPERCDECPLACES( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "INTQCPERCDECPLACES"
                    numU = 1
                    strT = "TBLDATA"
                    numTy = 2
                    intText = 100
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = True

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_INTQCPERCDECPLACES( ByVal boolAccess, ByVal boolSQLSer, ByVal boolOra, ByVal con, ByVal cmd)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 256
                    str1 = "tblCompanyData"
                    str2 = "QC Stats % Decimal Places"
                    var2 = 15
                    str3 = "tblData"
                    str4 = "INTQCPERCDECPLACES"
                    var3 = -1


            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next

    End Sub

    Sub AddRecords_TBLFIELDCODES_BIASDIFF(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7
        Dim rs1 As New ADODB.Recordset
        Dim strF As String
        Dim boolCont As Boolean

        strT = "TBLFIELDCODES"

        rs1.CursorLocation = CursorLocationEnum.adUseClient
        rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)

        dt = Now
        For Count1 = 1 To 2
            Select Case Count1
                Case 1
                    var1 = 193
                    var2 = "[BIASORDIFFQC]"
                    var3 = "Returns ''Bias'' or ''Diff'' depending on the stats value chosen in the Advanced Table Configuration window for the ''Summary of Interpolated QC Std Conc'' table."
                    var4 = "Report Table Configuration"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Report Items"
                Case 2
                    var1 = 194
                    var2 = "[BIASORDIFFCALIBR]"
                    var3 = "Returns ''Bias'' or ''Diff'' depending on the stats value chosen in the Advanced Table Configuration window for the ''Summary of Back-Calculated Calibration Std Conc'' table."
                    var4 = "Report Table Configuration"
                    var5 = "NA"
                    var6 = "NA"
                    var7 = "Report Items"
            End Select

            boolCont = True
            strF = "ID_TBLFIELDCODES = " & var1
            rs1.Filter = ""
            rs1.Filter = strF
            If rs1.RecordCount = 0 Then
                boolCont = True
            Else
                boolCont = False
            End If

            If boolCont Then

                Try
                    
                    If boolAccess Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolOra Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    ElseIf boolSQLSer Then
                        strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & var2 & "','" & var3 & "','" & var4 & "','" & var5 & "','" & var6 & "','" & var7 & "',#" & dt & "#);"
                    End If
                    '''''''''''console.writeline(strSQL)
                    cmd.CommandText = strSQL
                    cmd.ExecuteNonQuery()
                    boolProb = False
                    strM = str1 & " executed successfully."
                    boolCont = True

                Catch ex As Exception
                    boolProb = True
                    strM = "There was a problem executing " & strSQL & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                    '''''''''console.writeline(strM)
                    'MsgBox(strM)
                    boolCont = False
                End Try

            End If

        Next

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub CheckTblReportsNameNull(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String

        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARHEADINGTEXT"
                    str2 = "Ad Hoc QC Stability Table"
                    strT = "TBLREPORTTABLE"
                    intText = 31
                Case 2
                    strF = "CHARHEADINGTEXT"
                    str2 = "Ad Hoc QC Stability Comparison Table"
                    strT = "TBLREPORTTABLE"
                    intText = 32
            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE CHARHEADINGTEXT IS NULL AND ID_TBLCONFIGREPORTTABLES = " & intText
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub ModifyRecords_TBLTAB1_REPORTTEMPLATE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String


        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARITEM"
                    strF1 = "CHARFORM"
                    str1 = "Report Template Definitions"
                    str2 = "Study Template Definitions"
                    strT = "TBLTAB1"

            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & str2 & "' WHERE " & strF & " = '" & str1 & "' AND CHARFORM = 'Admin'"
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub ModifyRecords_TBLTABLEPROPERTIES_BOOLCSREPORTACCVALUES(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim numU1 As Short
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String


        boolAdd = False
        For Count2 = 1 To 2
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLCSREPORTACCVALUES"
                    strF1 = "ID_TBLCONFIGREPORTTABLES"
                    numU = -1
                    numU1 = 3
                    strT = "TBLTABLEPROPERTIES"

                Case 2
                    strF = "BOOLSTATSNR"
                    strF1 = "ID_TBLCONFIGREPORTTABLES"
                    numU = -1
                    numU1 = 3
                    strT = "TBLTABLEPROPERTIES"

            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF1 & " = " & numU1
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_UPDATENULLS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        For Count2 = 1 To 18
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10

            Select Case Count2
                Case 1
                    strF = "NUMSAMPLEG1"
                    numU = 103 'Subject
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 2
                    strF = "NUMSAMPLEG2"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 3
                    strF = "NUMSAMPLEG3"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 4
                    strF = "NUMSAMPLEG4"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 5
                    strF = "NUMSAMPLES1"
                    numU = 103 'Subject
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 6
                    strF = "NUMSAMPLES2"
                    numU = 102 'Group
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 7
                    strF = "NUMSAMPLES3"
                    numU = 106 'Treatment
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 8
                    strF = "NUMSAMPLES4"
                    numU = 101 'Gender
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2


                Case 9
                    strF = "CHARSAMPLEGAD1"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 10
                    strF = "CHARSAMPLEGAD2"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 11
                    strF = "CHARSAMPLEGAD3"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 12
                    strF = "CHARSAMPLEGAD4"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 13
                    strF = "CHARSAMPLESAD1"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 14
                    strF = "CHARSAMPLESAD2"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 15
                    strF = "CHARSAMPLESAD3"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 16
                    strF = "CHARSAMPLESAD4"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10

                Case 17
                    strF = "BOOLBQLLEGEND"
                    numU = 0 'Gender
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2

                Case 18
                    strF = "BOOLINCLUDEPSAE"
                    numU = 0 'Gender
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2

            End Select

            boolCont = False
            If boolCont = False Then 'UPDATE FIELDS
                boolAdd = True
                If boolAdd Then 'update records

                    If boolString Then
                        If boolAccess Then
                            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                        ElseIf boolSQLSer Then
                        ElseIf boolOra Then
                        End If
                    Else
                        If boolAccess Then
                            strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                        ElseIf boolSQLSer Then
                        ElseIf boolOra Then
                        End If
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()

    End Sub

    Sub AddFields_tblTABLEPROPERTIES_BOOLINCLUDEPSAE(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim strF1 As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLINCLUDEPSAE"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'for Summary of Analytical Runs, make default -1
                    numU = -1
                    strF1 = "ID_TBLCONFIGREPORTTABLES"
                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF1 & " = 1"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddFields_TBLTABLEPROPERTIES_SORT(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim strU As String
        Dim boolString As Boolean
        Dim numTy As Short
        Dim lenChar As Short

        boolAdd = False
        strT = "TBLTABLEPROPERTIES"
        For Count2 = 1 To 16
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            boolString = False
            lenChar = 10

            Select Case Count2
                Case 1
                    strF = "NUMSAMPLEG1"
                    numU = 103 'Subject
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 2
                    strF = "NUMSAMPLEG2"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 3
                    strF = "NUMSAMPLEG3"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 4
                    strF = "NUMSAMPLEG4"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 5
                    strF = "NUMSAMPLES1"
                    numU = 103 'Subject
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 6
                    strF = "NUMSAMPLES2"
                    numU = 102 'Group
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 7
                    strF = "NUMSAMPLES3"
                    numU = 106 'Treatment
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2
                Case 8
                    strF = "NUMSAMPLES4"
                    numU = 101 'Gender
                    strT = "tblTABLEPROPERTIES"
                    numTy = 2


                Case 9
                    strF = "CHARSAMPLEGAD1"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 10
                    strF = "CHARSAMPLEGAD2"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 11
                    strF = "CHARSAMPLEGAD3"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 12
                    strF = "CHARSAMPLEGAD4"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 13
                    strF = "CHARSAMPLESAD1"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 14
                    strF = "CHARSAMPLESAD2"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 15
                    strF = "CHARSAMPLESAD3"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10
                Case 16
                    strF = "CHARSAMPLESAD4"
                    strU = "ASC"
                    strT = "tblTABLEPROPERTIES"
                    boolString = True
                    numTy = 202
                    lenChar = 10

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                If boolAccess Then
                    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, lenChar, numU)
                ElseIf boolSQLSer Then

                ElseIf boolOra Then

                End If

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                boolAdd = True
                If boolAdd Then 'update records

                    If boolString Then
                        If boolAccess Then
                            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF & " IS NULL"
                        ElseIf boolSQLSer Then
                        ElseIf boolOra Then
                        End If
                    Else
                        If boolAccess Then
                            strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                        ElseIf boolSQLSer Then
                        ElseIf boolOra Then
                        End If
                    End If

                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_TBLCONFIGHEADERLOOKUP_MATRIX(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4, var5, var6, var7



        strT = "TBLCONFIGHEADERLOOKUP"
        dt = Now
        For Count1 = 1 To 3
            Select Case Count1
                Case 1
                    var1 = 165
                    var2 = 5
                    var3 = "Matrix"
                    var4 = 14
                    var5 = "CONFIGSAMPLETYPES"
                    var6 = "SAMPLETYPEID"
                    var7 = 0

                Case 2
                    var1 = 166
                    var2 = 6
                    var3 = "Matrix"
                    var4 = 10
                    var5 = "CONFIGSAMPLETYPES"
                    var6 = "SAMPLETYPEID"
                    var7 = 0

                Case 3
                    var1 = 167
                    var2 = 7
                    var3 = "Matrix"
                    var4 = 12
                    var5 = "CONFIGSAMPLETYPES"
                    var6 = "SAMPLETYPEID"
                    var7 = 0

            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & "," & var2 & ",'" & var3 & "'," & var4 & ",'" & var5 & "','" & var6 & "'," & var7 & ",#" & dt & "#);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub ModifyRecords_TBLTAB_QCCALIBR(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short
        Dim strU As String
        Dim strF1 As String


        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARITEM"
                    strF1 = "ID_TBLTAB1"
                    strU = "Sample/QC/Calibr Std Details"
                    numU = 26
                    strT = "TBLTAB1"

            End Select

            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."

            strSQL = "UPDATE " & strT & " SET " & strF & " = '" & strU & "' WHERE " & strF1 & " = " & numU
            cmd.CommandText = strSQL
            cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
            Try
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

            End Try

            'intCount = intCount + 1
            'sht.Range("Notes").Offset(intCount, 0).Value = strM
            'If boolProb Then
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
            '    intRed = intRed + 1
            'Else
            '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
            'End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()

        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing


    End Sub

    Sub AddRecords_TBLDATATABLEROWTITLES_CHARUNITS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3, var4

        strT = "TBLDATATABLEROWTITLES"
        dt = Now
        For Count1 = 1 To 1
            Select Case Count1
                Case 1
                    var1 = 255
                    str1 = "tblCompanyData"
                    str2 = "Alternate Calibr/QC Std Units"
                    var2 = 14
                    str3 = "tblData"
                    str4 = "CHARUNITS"
                    var3 = -1
            End Select

            Try
                
                If boolAccess Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolOra Then
                    strSQL = "INSERT INTO " & strT & "  VALUES (" & var1 & ",'" & str1 & "','" & str2 & "'," & var2 & ",'" & str3 & "','" & str4 & "'," & var3 & ",#" & dt & "#,NULL);"
                ElseIf boolSQLSer Then
                End If
                '''''''''''console.writeline(strSQL)
                cmd.CommandText = strSQL
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddFields_TBLDATA_CHARUNITS(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim numTy As Short
        Dim intText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "CHARUNITS"
                    numU = 0
                    strT = "TBLDATA"
                    numTy = 202
                    intText = 100
            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(numTy, boolAccess, boolSQLSer, boolOra, intText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    'strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    'cmd.CommandText = strSQL
                    'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    'Try
                    '    cmd.ExecuteNonQuery()
                    '    boolProb = False
                    '    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    'Catch ex As Exception
                    '    boolProb = True
                    '    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    'End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddFields_BOOLBQLLEGEND(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)


        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLBQLLEGEND"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddFields_INTEGNUM(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim rs2 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String
        Dim strF As String
        Dim strS As String
        Dim intRows As Short
        Dim boolHit As Boolean

        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim intTy As Short
        Dim lenText As Short

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "INTEGNUM"
                    numU = 1 'default numeric value
                    strT = "TBLREPORTTABLE"
                    intTy = 2 'small integer
                    lenText = 0 'used for length of varchar

            End Select

            boolProb = False
            rs1.CursorLocation = CursorLocationEnum.adUseClient
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            rs1.ActiveConnection = Nothing
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next

            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(intTy, boolAccess, boolSQLSer, boolOra, lenText, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'put a pause in here???

                    'this is special for INTEGNUM
                    rs2.CursorLocation = CursorLocationEnum.adUseClient
                    rs2.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                    rs2.ActiveConnection = Nothing

                    boolHit = False
                    For Count1 = 1 To 2

                        Select Case Count1
                            Case 1
                                str1 = "31"
                            Case 2
                                str1 = "32"
                        End Select

                        strF = "ID_TBLCONFIGREPORTTABLES = " & str1
                        strS = "ID_" & strT
                        rs2.Filter = strF
                        rs2.Sort = strS
                        intRows = rs2.RecordCount
                        If intRows > 0 Then
                            boolHit = True
                        End If

                        For Count3 = 0 To intRows - 1
                            rs2.Fields("INTEGNUM").Value = Count3 + 1
                            rs2.Update()
                            rs2.MoveNext()
                        Next

                        Try
                            If boolHit Then
                                rs2.ActiveConnection = con
                                rs2.UpdateBatch(AffectEnum.adAffectAllChapters)
                                rs2.ActiveConnection = Nothing
                            End If

                            boolProb = False
                            strM = "Successfully updated " & strF & " records in " & strT & "." '& vbCrLf

                        Catch ex As Exception
                            boolProb = True
                            strM = "There was a problem updating " & strF & " records in " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                        End Try

                    Next

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

            If rs2.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs2.Close()
            End If

        Next Count2

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddRecords_tblAssignedSamplesHelper_3132(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3
        Dim int1 As Short

        strT = "tblAssignedSamplesHelper"
        dt = Now
        int1 = 53
        For Count1 = 1 To 8
            Select Case Count1
                Case 1
                    var1 = int1 + Count1
                    var2 = "QC LLOQ"
                    var3 = 31
                Case 2
                    var1 = int1 + Count1
                    var2 = "QC Low"
                    var3 = 31
                Case 3
                    var1 = int1 + Count1
                    var2 = "QC Mid"
                    var3 = 31
                Case 4
                    var1 = int1 + Count1
                    var2 = "QC High"
                    var3 = 31
                Case 5
                    var1 = int1 + Count1
                    var2 = "QC LLOQ"
                    var3 = 32
                Case 6
                    var1 = int1 + Count1
                    var2 = "QC Low"
                    var3 = 32
                Case 7
                    var1 = int1 + Count1
                    var2 = "QC Mid"
                    var3 = 32
                Case 8
                    var1 = int1 + Count1
                    var2 = "QC High"
                    var3 = 32

            End Select

            Try
                
                If boolAccess Then
                    str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3,1);"
                ElseIf boolOra Then
                    str1 = "INSERT INTO " & strT & " VALUES (" & var1 & ",'" & var2 & "'," & var3 & ",3,1);"
                ElseIf boolSQLSer Then
                End If
                cmd.CommandText = str1
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub


    Sub AddRecords_tblConfigReportTables_3132(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim str1 As String
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String
        Dim dt As Date
        Dim Count1 As Short
        Dim var1, var2, var3


        strT = "tblConfigReportTables"
        dt = Now
        For Count1 = 1 To 2
            Select Case Count1
                Case 1
                    var1 = 31
                    var2 = "Ad Hoc QC Stability Table"
                    var3 = 24
                Case 2
                    var1 = 32
                    var2 = "Ad Hoc QC Stability Comparison Table"
                    var3 = 25
            End Select

            Try
                
                If boolAccess Then
                    str1 = "INSERT INTO " & strT & "  VALUES (" & var1 & ",2,'" & var2 & "'," & var3 & ",0,-1,-1,0,0,0,-1,#" & dt & "#,3,-1,0,0,-1);"
                ElseIf boolOra Then
                    str1 = "INSERT INTO " & strT & "  VALUES (" & var1 & ",2,'" & var2 & "'," & var3 & ",0,-1,-1,0,0,0,-1,#" & dt & "#,3,-1,0,0,-1);"
                ElseIf boolSQLSer Then
                End If
                cmd.CommandText = str1
                cmd.ExecuteNonQuery()
                boolProb = False
                strM = str1 & " executed successfully."
                boolCont = True

            Catch ex As Exception
                boolProb = True
                strM = "There was a problem executing " & str1 & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf
                boolCont = False
            End Try

        Next


    End Sub

    Sub AddFields_boolInclAnova(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLINCLANOVA"
                    numU = -1
                    strT = "tblTABLEPROPERTIES"

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub AddFields_boolTheoretical(ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal con As ADODB.Connection, ByVal cmd As OleDb.OleDbCommand)

        Dim fld As ADODB.Field
        Dim rs1 As New ADODB.Recordset
        Dim var1, var2, var3, var4, var5, var6
        Dim fldprop As ADODB.Properties
        Dim Count1 As Short
        Dim int1 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strID As String
        Dim strTy As String
        Dim varType
        Dim varSize
        Dim boolSpecial As Boolean
        Dim boolHasISStudies As Boolean = False
        Dim strSQL As String
        Dim strFN As String


        Dim pgV As Int16
        Dim pgMax As Int16
        Dim intCt As Short

        Dim boolAdd As Boolean
        Dim Count2 As Short
        Dim strF As String
        Dim numU As Single
        Dim boolProb As Boolean
        Dim strM As String
        Dim strT As String

        boolAdd = False
        For Count2 = 1 To 1
            boolAdd = False
            str1 = ""
            str2 = ""
            int1 = 200
            Select Case Count2
                Case 1
                    strF = "BOOLTHEORETICAL"
                    numU = 0
                    strT = "tblTABLEPROPERTIES"

            End Select

            boolProb = False
            rs1.Open(strT, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            If rs1.EOF And rs1.BOF Then
            Else
                rs1.MoveFirst()
            End If

            strM = strF
            boolProb = False
            'check to see if strF exists
            boolCont = False
            ''debug.print ""
            ''debug.print "Start fields tblPKAUC..."
            For Each fld In rs1.Fields
                ''debug.print fld.Name
                If StrComp(strF, fld.Name, vbTextCompare) = 0 Then
                    boolCont = True
                    Exit For
                End If
            Next



            If boolCont = False Then 'field needs to be added
                boolAdd = True
                'Err.Clear()
                'On Error GoTo 0
                rs1.Close()
                'On Error Resume Next
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'If boolAccess Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " single NULL"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolSQLSer Then 'if boolsqlServer Then
                '    'strSQL = "alter table " & strT & " ADD " & strF & " real NULL DEFAULT ((" & numU & "))"
                '    strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                'ElseIf boolOra Then
                'End If
                ''debug.print strSQL

                'cmd.CommandText = strSQL
                'cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                'cmd.Execute()

                cmd.CommandText = strSQL
                Try
                    cmd.ExecuteNonQuery()
                    var2 = "Hi"
                    boolProb = False
                    strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                Catch ex As Exception
                    var1 = ex.Message.ToString
                    var2 = var1
                    boolProb = True
                    strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                End Try

                If boolAdd Then 'update records

                    strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL"
                    cmd.CommandText = strSQL
                    cmd.CommandType = ADODB.CommandTypeEnum.adCmdText
                    Try
                        cmd.ExecuteNonQuery()
                        boolProb = False
                        strM = """" & strSQL & """ successfully executed on " & strT & "." '& vbCrLf

                    Catch ex As Exception
                        boolProb = True
                        strM = "There was a problem executing """ & strSQL & """ on " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." '& vbCrLf

                    End Try

                    'intCount = intCount + 1
                    'sht.Range("Notes").Offset(intCount, 0).Value = strM
                    'If boolProb Then
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 3 'red
                    '    intRed = intRed + 1
                    'Else
                    '    sht.Range("Notes").Offset(intCount, 0).Font.ColorIndex = 0 'automatic
                    'End If

                End If

            Else 'ignore
                boolProb = False
                strM = "Field " & strF & " already exists in " & strT & " . No need to update." '& vbCrLf
            End If

            If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
                rs1.Close()
            End If

        Next

        'conA.CommitTrans()
        If rs1.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs1.Close()
        End If
        rs1 = Nothing

    End Sub

    Sub UpdateCheck(ByVal boolAccess As Boolean, ByVal boolOra As Boolean, ByVal boolSQLSer As Boolean)

        Dim var1, var2, var3, var4

        var1 = My.Application.Info.Version.Major
        var2 = My.Application.Info.Version.Minor
        var3 = My.Application.Info.Version.Build
        var4 = My.Application.Info.Version.MinorRevision

        CurVer = var1 & "." & var2 & "." & var3 ' & "." & var4
        CurVerNew = var1 & "." & var2 & "." & var3 & "." & var4
        ver(1, 1) = var1
        ver(2, 1) = var2
        ver(3, 1) = var3
        ver(4, 1) = var4

        strUpdateMsg = "StudyDoc database updated successfully."

        cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

        boolNeedsUD = Not (CheckVersion(boolAccess, boolOra, boolSQLSer))

        If boolUpdateDB Then 'continue
        Else
            GoTo end1
        End If

        If boolNeedsUD Then 'continue

        Else
            GoTo end1
        End If

        'Call CheckTables(boolAccess, boolOra, boolSQLSer)

        'boolUpdateCheckBad = False

        'GoTo end1

        'boolBad = False
        'If boolNeedsUD Then
        '    If boolBad Then

        '    Else
        '        strUpdateMsg = "StudyDoc database updated successfully."
        '        boolBad = False
        '    End If

        'Else
        '    boolBad = False

        'End If

        'boolUpdateCheckBad = boolBad

end1:

        Try
            If conA.State = ADODB.ObjectStateEnum.adStateOpen Then
                conA.Close()
            End If

        Catch ex As Exception

        End Try
        conA = Nothing

        Try
            If conB.State = ADODB.ObjectStateEnum.adStateOpen Then
                conB.Close()
            End If

        Catch ex As Exception

        End Try
        conB = Nothing

        Try
            If rsVer.State = ADODB.ObjectStateEnum.adStateOpen Then
                rsVer.Close()
            End If

        Catch ex As Exception

        End Try
        rsVer = Nothing

        cmd = Nothing

        If boolQuitUpdate Then
            End
        End If


    End Sub

    Function CheckVersion(ByVal boolAccess As Boolean, ByVal boolOra As Boolean, ByVal boolSQLSer As Boolean) As Boolean

        CheckVersion = False
        'false if version is incorrect

        Dim boolTblVersion As Boolean = False
        Dim Count1 As Short
        Dim int1 As Short
        Dim int2 As Short
        Dim l1 As Short
        Dim boolVerNewer As Boolean = False
        Dim boolVerOlder As Boolean = False
        Dim strM As String
        Dim varUpgrade
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim boolProb As Boolean = True
        Dim boolCont As Boolean = True
        Dim appdt ' As Date
        Dim var1, var2
        Dim boolDt As Boolean = False
        Dim constr As String
        Dim boolBrandNew As Boolean = False
        Dim strT As String
        Dim strF As String
        Dim numU As Single



        var1 = My.Application.Info.Description
        'var1 = "a"

        If boolAccess Then
            'Try
            '    appdt = "#" & Format(CDate(var1), "dd-MMM-yyyy") & "#"
            'Catch ex As Exception
            '    appdt = "NULL"
            'End Try
            constr = constrIni
        ElseIf boolSQLSer Then
            'add provider to constr
            constr = constrIni ' "Provider=SQLOLEDB;" & constrIni
        ElseIf boolOra Then
            Try
                appdt = Format(CDate(var1), "dd-MMM-yyyy")
            Catch ex As Exception
                appdt = ""
            End Try
            constr = constrIniGuWuODBC
        End If

        appdt = ReturnDate(CDate(var1))

        strM = ""

        Try
            conA.Open(constr)
        Catch ex As Exception
            strM = "Problem opening conA." & ChrW(10) & ChrW(10) & ex.Message
            strM = strM & ChrW(10) & ChrW(10) & "StudyDoc will close."
            MsgBox(strM, vbInformation, "Problem...")
            End

        End Try

        '20161217 LEE: Check here for any corrections to be made
        Call DatabaseUpdatePreConnection(conA)

        cmd.ActiveConnection = conA

        boolUpdateDB = True

        'first look for TBLVERSION from Destination
        Try
            str1 = "SELECT TBLVERSION.* FROM TBLVERSION ORDER BY ID_TBLVERSION;"
            rsVer.CursorLocation = ADODB.CursorLocationEnum.adUseClient
            'rsVer.Open(str1, conA, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockBatchOptimistic)
            '20190204 LEE: Why is this openstatic? Should be OpenDynamic
            rsVer.Open(str1, conA, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            rsVer.ActiveConnection = Nothing
            boolTblVersion = True
        Catch ex As Exception
            var1 = ex.Message
            boolTblVersion = False
        End Try

        If boolTblVersion Then 'continue
            'check for CurVer in db
            'goto last entry
            rsVer.MoveLast()

            ver(1, 2) = rsVer.Fields("int1Version").Value
            ver(2, 2) = rsVer.Fields("int2Version").Value
            ver(3, 2) = rsVer.Fields("int3Version").Value
            Try
                ver(4, 2) = rsVer.Fields("int4Version").Value
            Catch ex As Exception
                'create field int4Version
                strT = "TBLVERSION"
                strF = "INT4VERSION"
                numU = 0
                strSQL = "alter table " & strT & " ADD " & strF & " " & Return_strTy(2, boolAccess, boolSQLSer, boolOra, 0, numU)
                cmd.CommandText = strSQL
                cmd.Execute()
                boolProb = False
                strM = "COLUMN " & strF & " create successfully."
                boolCont = True

                'enter values
                strSQL = "UPDATE " & strT & " SET " & strF & " = " & numU & " WHERE " & strF & " IS NULL;"
                cmd.CommandText = strSQL
                cmd.Execute()
                boolProb = False
                strM = "COLUMN " & strF & " updated successfully."
                boolCont = True

                'must re-open rsVer
                If rsVer.State = ADODB.ObjectStateEnum.adStateOpen Then
                    rsVer.Close()
                End If
                str1 = "SELECT * FROM TBLVERSION ORDER BY ID_TBLVERSION;"
                rsVer.CursorLocation = ADODB.CursorLocationEnum.adUseClient
                'rsVer.Open(str1, conA, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockBatchOptimistic)
                rsVer.Open(str1, conA, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
                rsVer.ActiveConnection = Nothing
                boolTblVersion = True

                ver(4, 2) = 0
            End Try

            CurVerDB = ver(1, 2) & "." & ver(2, 2) & "." & ver(3, 2)
            CurVerDB_New = ver(1, 2) & "." & ver(2, 2) & "." & ver(3, 2) & "." & ver(4, 2)

            Dim strVer1 As String
            Dim strVer2 As String

            strVer1 = Format(ver(1, 1), "0000") & Format(ver(2, 1), "0000") & Format(ver(3, 1), "0000") & Format(ver(4, 1), "0000")
            strVer2 = Format(ver(1, 2), "0000") & Format(ver(2, 2), "0000") & Format(ver(3, 2), "0000") & Format(ver(4, 2), "0000")

            'need strVerold for Access backup file name
            '20190201 LEE: Need strVerNew for install logs
            strVerNew = Format(ver(1, 1), "00") & Format(ver(2, 1), "00") & Format(ver(3, 1), "00") & Format(ver(4, 1), "00")
            strVerOld = Format(ver(1, 2), "00") & Format(ver(2, 2), "00") & Format(ver(3, 2), "00") & Format(ver(4, 2), "00")

            Dim intVer1 As Int64
            Dim intVer2 As Int64

            intVer1 = CLng(strVer1)
            intVer2 = CLng(strVer2)

            'rsver.close

            If intVer1 = intVer2 Then
                boolNeedsUD = False
                boolUpdateCheckBad = False
                CheckVersion = True
                GoTo end1
            ElseIf intVer1 < intVer2 Then
                boolVerOlder = True
                boolVerNewer = False
            Else
                boolVerOlder = False
                boolVerNewer = True
            End If


            'If ver(1, 1) = ver(1, 2) Then
            '    If ver(2, 1) = ver(2, 2) Then
            '        If ver(3, 1) = ver(3, 2) Then
            '        Else
            '            If ver(3, 1) < ver(3, 2) Then
            '                boolVerOlder = True
            '                boolVerNewer = False
            '            Else
            '                boolVerOlder = False
            '                boolVerNewer = True
            '            End If

            '        End If
            '    Else
            '        If ver(2, 1) < ver(2, 2) Then
            '            boolVerOlder = True
            '            boolVerNewer = False
            '        Else
            '            boolVerOlder = False
            '            boolVerNewer = True
            '        End If

            '    End If
            'Else
            '    If ver(1, 1) < ver(1, 2) Then
            '        boolVerOlder = True
            '        boolVerNewer = False
            '    Else
            '        boolVerOlder = False
            '        boolVerNewer = True
            '    End If
            'End If

        Else

            ''create TBLVERSION

            'strT = "TBLVERSION"
            'str1 = "CREATE TABLE " & strT & " "
            'If boolAccess Then
            '    str2 = "(ID_TBLVERSION int CONSTRAINT PK_TBLVERSION PRIMARY KEY, INT1VERSION short, INT2VERSION short, INT3VERSION short, DTDATE date);"
            'ElseIf boolSQLSer Then

            'ElseIf boolOra Then
            '    str2 = "(ID_TBLVERSION NUMBER DEFAULT ( 0 ) CONSTRAINT PK_TBLVERSION PRIMARY KEY, INT1VERSION NUMBER DEFAULT ( 0 ), INT2VERSION NUMBER DEFAULT ( 0 ), INT3VERSION NUMBER DEFAULT ( 0 ), DTDATE DATE);"
            'ElseIf boolSQLSer Then
            'End If
            'strSQL = str1 & str2

            'cmd.CommandText = strSQL

            'Try
            '    cmd.Execute()

            '    'If boolAccess Then
            '    '    str1 = "INSERT INTO " & strT & " VALUES (1," & ver(1, 1) & "," & ver(2, 1) & "," & ver(3, 1) & "," & appdt & ");"
            '    'ElseIf boolOra Then
            '    '    str1 = "INSERT INTO " & strT & " VALUES (1," & ver(1, 1) & "," & ver(2, 1) & "," & ver(3, 1) & ",'" & appdt & "');"
            '    'ElseIf boolSQLSer Then
            '    'End If
            '    str1 = "INSERT INTO " & strT & " VALUES (1," & ver(1, 1) & "," & ver(2, 1) & "," & ver(3, 1) & "," & appdt & ");"
            '    cmd.CommandText = str1
            '    cmd.Execute()
            '    boolProb = False
            '    strM = "Table " & strT & " create successfully."
            '    boolCont = True

            'Catch ex As Exception
            '    boolProb = True
            '    strM = "There was a problem creating table " & strT & ". Please contact your LABIntegrity StudyDoc technical representative." & ChrW(10) & ex.Message
            '    boolCont = False
            'End Try

            'If boolProb Then
            '    MsgBox(strM, MsgBoxStyle.Exclamation, "boolProb: Problem creating table " & strT & "...")
            '    GoTo end1
            'End If

            ''reopen rs
            'Try
            '    str1 = "SELECT * FROM TBLVERSION ORDER BY ID_TBLVERSION;"
            '    rsVer.Open(str1, conA, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockBatchOptimistic)
            '    rsVer.ActiveConnection = Nothing
            '    boolTblVersion = True
            'Catch ex As Exception
            '    strM = "Problem opening table " & strT & "."
            '    MsgBox(strM, MsgBoxStyle.Exclamation, "Problem creating table " & strT & "..." & ChrW(10) & ex.Message)
            '    GoTo end1
            'End Try

            boolBrandNew = True

        End If

        If (boolVerOlder = False And boolVerNewer = False) And boolBrandNew = False Then 'continue
            boolNeedsUD = False

        Else

            Dim frm As New frmUpdateCheck

            If boolBrandNew Then
                strM = "The StudyDoc database has not been configured." & ChrW(10) & ChrW(10)
                strM = strM & "StudyDoc will now create and populate tables in the database."
                MsgBox(strM, MsgBoxStyle.Exclamation, "StudyDoc database will be configured...")
                boolUpdateDB = True
                boolNeedsUD = True

            Else

                If boolVerOlder Then
                    strM = "This version of StudyDoc (" & CurVerNew & ") is older than the version" & ChrW(10) & "currently configured in the StudyDoc Access database (" & CurVerDB_New & ")." & ChrW(10) & ChrW(10)
                    strM = strM & "This installed instance of StudyDoc must be upgraded to version " & CurVerDB_New & " before it can be used." & ChrW(10) & ChrW(10)
                    strM = strM & "Please contact your StudyDoc Administrator."
                    'MsgBox(strM, MsgBoxStyle.Exclamation, "StudyDoc must be upgraded...")
                    boolUpdateDB = False
                    frm.cmdNo.Text = "E&xit"
                    frm.cmdYes.Visible = False
                Else
                    strM = "This version of StudyDoc (" & CurVerNew & ") is newer than the version" & ChrW(10) & "currently configured in the StudyDoc database (" & CurVerDB_New & ")." & ChrW(10) & ChrW(10)
                    strM = strM & "The table structure and/or records of the StudyDoc database" & ChrW(10) & "must be updated before this version of StudyDoc can be used." & ChrW(10) & ChrW(10)
                    strM = strM & "Do you wish to update the database?" & ChrW(10) & ChrW(10)
                    strM = strM & "If you choose 'Yes', then once this action has been completed, all other installed instances of StudyDoc that interact with this database must be upgraded to version " & CurVerNew & "." & ChrW(10) & ChrW(10)
                    strM = strM & "If you choose 'No', StudyDoc will close."
                    'varUpgrade = MsgBox(strM, MsgBoxStyle.YesNo, "StudyDoc database must be updated...")
                    'If varUpgrade = 6 Then 'Yes upgrade
                    '    boolUpdateDB = True
                    'Else
                    '    boolUpdateDB = False
                    'End If
                End If


                boolNeedsUD = True
            End If

            frm.lbl1.Text = strM
            frm.boolAccess = boolAccess
            frm.boolOra = boolOra
            frm.boolSQLSer = boolSQLSer
            frm.boolBrandNew = boolBrandNew

            If boolNeedsUD Then 'continue
                CheckVersion = False
                boolUpdateCheckBad = False
            Else
                boolUpdateCheckBad = False
                CheckVersion = True
                'GoTo end1
            End If

            frm.ShowDialog()

            frm.Dispose()

        End If

        If boolNeedsUD Then 'continue
            CheckVersion = False
            boolUpdateCheckBad = False
        Else
            boolUpdateCheckBad = False
            CheckVersion = True
            GoTo end1
        End If

end1:

        '20190205 LEE:
        'Note: Don't need to close rsVer
        'It gets closed at the end of UpdateCheck


    End Function

    Function Return_strTy(ByVal intType As Short, ByVal boolAccess As Boolean, ByVal boolSQLSer As Boolean, ByVal boolOra As Boolean, ByVal lenText As Short, ByVal numNumDefault As Single) As String

        '20160530 LEE:
        'ignore passed variables, use global variables

        'ADO data types:
        'http://www.w3schools.com/asp/ado_datatypes.asp

        If boolGuWuAccess Then
            Select Case intType
                Case Is = 3 'adInteger;3;ID_TBLADDRESSLABELS
                    Return_strTy = "int NULL" ';"
                Case Is = 202 'adVarWChar;202;CHARLABEL
                    Return_strTy = "text(" & lenText & ") NULL" ';"
                Case Is = 7 'adDate;7;UPSIZE_TS
                    Return_strTy = "date NULL" ';"
                Case Is = 2 'adSmallInt;2;BOOLISREPLICATE
                    Return_strTy = "short NULL" ';"
                Case Is = 5 'adDouble;5;NUMWATSONRUNNUMBER
                    Return_strTy = "double NULL" ';"
                Case Is = 203 'adLongVarWChar;203;CHARFIELDCODE
                    Return_strTy = "memo NULL" ';"
                Case Is = 1 'I made this up for single
                    Return_strTy = "single NULL"
                Case Is = 11 'boolean add just in case 20181214
                    Return_strTy = "yesno NULL"
            End Select
        ElseIf boolGuWuSQLServer Then
            Select Case intType
                Case Is = 3 'adInteger;3;ID_TBLADDRESSLABELS
                    Return_strTy = "int NULL" ';"
                Case Is = 202 'adVarWChar;202;CHARLABEL
                    Return_strTy = "NVarChar (" & lenText & ") NULL" ';"
                Case Is = 7 'adDate;7;UPSIZE_TS
                    Return_strTy = "datetime NULL" ';"
                Case Is = 2 'adSmallInt;2;BOOLISREPLICATE
                    Return_strTy = "smallint NULL" ';"
                Case Is = 5 'adDouble;5;NUMWATSONRUNNUMBER
                    Return_strTy = "float NULL" ';"
                Case Is = 203 'adLongVarWChar;203;CHARFIELDCODE
                    'Return_strTy = "text NULL" ';"
                    '20181214 LEE:
                    'update field type to current SQL Server
                    Return_strTy = "nvarchar(max) NULL" ';"
                Case Is = 1 'I made this up for single
                    Return_strTy = "real NULL"
                Case Is = 11 'boolean,  add just in case 20181214
                    Return_strTy = "bit NULL"

            End Select
        ElseIf boolGuWuOracle Then
            Select Case intType
                Case Is = 3 'adInteger;3;ID_TBLADDRESSLABELS
                    Return_strTy = "NUMBER DEFAULT(" & numNumDefault & ")" ';

                Case Is = 202 'adVarWChar;202;CHARLABEL
                    Return_strTy = "NVARCHAR2(" & lenText & ")" ';"
                Case Is = 7 'adDate;7;UPSIZE_TS
                    Return_strTy = "DATE" ';"
                Case Is = 2 'adSmallInt;2;BOOLISREPLICATE
                    'Return_strTy = "NUMBER DEFAULT(" & numNumDefault & ")" ';"
                    Return_strTy = "NUMBER" ';"
                Case Is = 5 'adDouble;5;NUMWATSONRUNNUMBER
                    'Return_strTy = "NUMBER DEFAULT(" & numNumDefault & ") ';"
                    Return_strTy = "NUMBER" ';"
                Case Is = 203 'adLongVarWChar;203;CHARFIELDCODE
                    Return_strTy = "NVARCHAR2(" & lenText & ")" ';"
                Case Is = 1 'I made this up for single
                    Return_strTy = "NUMBER DEFAULT(" & numNumDefault & ")" ';"
                Case Is = 11 'boolean,  add just in case 20181214
                    Return_strTy = "NUMBER DEFAULT(0)" ';"
            End Select
        End If

    End Function

End Module

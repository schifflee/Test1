Option Compare Text

Imports Word = Microsoft.Office.Interop.Word
Imports System
Imports System.IO
Imports System.Text
Imports System.IO.FileSystemInfo
Imports System.Collections.Generic

Module modConserved

    'small change
    Public idU As Int64



    Public Sub buttonBorderRadius(ByRef buttonObj As Object, ByVal borderRadiusINT As Integer)

        '20190221 LEE: Give buttons a curved corner look
        'https://stackoverflow.com/questions/21121968/how-do-i-create-button-with-rounded-corners-edges-on-winform-c

        Dim p As New Drawing2D.GraphicsPath()
        p.StartFigure()
        'TOP LEFT CORNER
        p.AddArc(New Rectangle(0, 0, borderRadiusINT, borderRadiusINT), 180, 90)
        p.AddLine(40, 0, buttonObj.Width - borderRadiusINT, 0)
        'TOP RIGHT CORNER
        p.AddArc(New Rectangle(buttonObj.Width - borderRadiusINT, 0, borderRadiusINT, borderRadiusINT), -90, 90)
        p.AddLine(buttonObj.Width, 40, buttonObj.Width, buttonObj.Height - borderRadiusINT)
        'BOTTOM RIGHT CORNER
        p.AddArc(New Rectangle(buttonObj.Width - borderRadiusINT, buttonObj.Height - borderRadiusINT, borderRadiusINT, borderRadiusINT), 0, 90)
        p.AddLine(buttonObj.Width - borderRadiusINT, buttonObj.Height, borderRadiusINT, buttonObj.Height)
        'BOTTOM LEFT CORNER
        p.AddArc(New Rectangle(0, buttonObj.Height - borderRadiusINT, borderRadiusINT, borderRadiusINT), 90, 90)
        p.CloseFigure()
        buttonObj.Region = New Region(p)

    End Sub



    Sub WriteInstall(strA As String)
        '20190131 LEE
        Dim str1 As String
        intInstall = intInstall + 1
        Try
            strInstall(intInstall) = strA
        Catch ex As Exception
            str1 = str1
        End Try


    End Sub

    Sub WriteInstallDir()

        Dim str1 As String
        Dim str2 As String

        '20190131 LEE:
        If intInstall = 0 Then
        Else

            ReDim Preserve strInstall(intInstall)
            'record Installation Scripts
            Dim IDir As String
            IDir = "C:\LabIntegrity\StudyDoc\Logs"
            If IO.Directory.Exists(IDir) Then
            Else
                'make directory
                IO.Directory.CreateDirectory(IDir)
            End If

            'make .loginstall file
            Dim dtNow As Date = Now
            Dim strNow As String = Format(dtNow, "yyyyMMdd_HHmmss")
            str1 = "Install_" & strNV_DB_New & "_" & strNow
            str1 = "Install_" & strVerNew & "_" & strNow
            str2 = IDir & "\" & str1 & ".loginstall"
            Try
                IO.File.WriteAllLines(str2, strInstall)
            Catch ex As Exception
                str1 = str1
            End Try

        End If

    End Sub

    Sub SetStudyCount()

        '20190130 LEE
        Dim str1 As String = "Watson Studies Configured in StudyDoc"
        Dim str2 As String
        Try
            Dim int1 As Int32 = frmH.dgvwStudy.Rows.Count
            If int1 = 1 Then
                str2 = str1 & " - " & int1 & " study"
            Else
                str2 = str1 & " - " & int1 & " studies"
            End If

        Catch ex As Exception
            str2 = str1
        End Try

        frmH.lblcbxStudies.Text = str2

        'Me.lblcbxStudies.Text = "Watson Studies Configured in StudyDoc"

    End Sub

    Function CreatedgvwStudiesDatasource(boolFromHome As Boolean) As DataTable

        Dim dgv As DataGridView
        Dim dv As System.Data.DataView
        Dim Count1 As Int32
        Dim Count2 As Int32
        Dim Count3 As Int32
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strSQL As String
        Dim boolRO As Boolean
        'Dim rs As New ADODB.Recordset
        Dim int1 As Short
        Dim int2 As Short
        Dim intCol As Short
        Dim var1, var2, var3, var4
        Dim strF As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strS As String
        Dim dv1 As System.Data.DataView

        'account for Final/Open studies
        'optStudyDocStudies - all studies
        'optStudyDocOpen - studies with tblReportTables.DTREPORTFINALISSUEDATE IS NULL
        'optStudyDocClose - studies with tblReportTables.DTREPORTFINALISSUEDATE IS NOT NULL

        Try
            dv1 = New DataView(tblwSTUDY.Clone, "", "STUDYNAME", DataViewRowState.CurrentRows)
            var1 = dv1.Count 'debug, should be 0 because clone doesn't bring over data
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        Dim tbl2 As System.Data.DataTable
        Try
            tbl2 = dv1.ToTable
        Catch ex As Exception
            var1 = ex.Message
            var1 = tbl2.Rows.Count
        End Try

        var1 = tbl2.Rows.Count

        If frmH.rbArchive.Checked Then
            Try

                tbl2 = tblwSTUDY.Copy
                var1 = tbl2.Rows.Count

                'need to add studytype (CHARREPORTTYPE) here
                var1 = tblwSTUDY.Rows(0).Item("STUDYID")
                'get id_tblStudies from tblstudies
                strF = "INT_WATSONSTUDYID = " & var1
                Dim rows2() As DataRow = tblStudies.Select(strF)
                var3 = rows2(0).Item("ID_TBLSTUDIES")
                strF1 = "ID_TBLSTUDIES = " & var3
                Dim rows1() As DataRow = tblReports.Select(strF1, "", DataViewRowState.CurrentRows)

                var1 = rows1(0).Item("CHARREPORTTYPE")
                tbl2.Rows(0).BeginEdit()
                tbl2.Rows(0).Item("CHARREPORTTYPE") = rows1(0).Item("CHARREPORTTYPE")
                tbl2.Rows(0).EndEdit()

            Catch ex As Exception
                var1 = ex.Message
                var1 = var1
            End Try
        Else
            Try

                'Alternate code in case LINQ is too slow or is buggy
                'int1 = 0 'debug

                '20190130 LEE
                strF = "ID_TBLSTUDIES > 0"
                If boolFromHome Then
                    If frmH.optStudyDocStudies.Checked Then
                        strF = "ID_TBLSTUDIES > 0"
                    ElseIf frmH.optStudyDocOpen.Checked Then
                        strF = "DTREPORTFINALISSUEDATE IS NULL"
                    ElseIf frmH.optStudyDocClosed.Checked Then
                        strF = "DTREPORTFINALISSUEDATE IS NOT NULL"
                    End If
                End If

                Dim rows1() As DataRow = tblReports.Select(strF, "", DataViewRowState.CurrentRows)
                For Count1 = 0 To rows1.Length - 1

                    ''debug
                    'For Count2 = 0 To tblReports.Columns.Count - 1
                    '    str1 = tblReports.Columns(Count2).ColumnName
                    '    var1 = rows1(0).Item(str1)
                    '    var1 = var1
                    'Next

                    var1 = rows1(Count1).Item("ID_TBLSTUDIES")
                    strF1 = "ID_TBLSTUDIES = " & var1
                    Dim rows2() As DataRow = tblStudies.Select(strF1)
                    For Count2 = 0 To rows2.Length - 1
                        var2 = rows2(Count2).Item("INT_WATSONSTUDYID")
                        strF2 = "STUDYID = " & var2
                        Dim rows3() As DataRow = tblwSTUDY.Select(strF2)
                        For Count3 = 0 To rows3.Length - 1
                            int1 = int1 + 1 'debug

                            Dim dr1 As DataRow = tbl2.NewRow

                            dr1.BeginEdit()
                            dr1("PROJECTIDTEXT") = rows3(0).Item("PROJECTIDTEXT")
                            dr1("STUDYNAME") = rows3(0).Item("STUDYNAME")
                            dr1("STUDYNUMBER") = rows3(0).Item("STUDYNUMBER")
                            dr1("SPECIES") = rows3(0).Item("SPECIES")
                            dr1("STUDYTITLE") = rows3(0).Item("STUDYTITLE")
                            dr1("PROJECTID") = rows3(0).Item("PROJECTID")
                            dr1("STUDYID") = rows3(0).Item("STUDYID")
                            dr1("SPECIESID") = rows3(0).Item("SPECIESID")

                            Try
                                dr1("CHARREPORTTYPE") = rows1(Count1).Item("CHARREPORTTYPE")
                            Catch ex As Exception
                                var1 = var1
                            End Try
                            dr1.EndEdit()

                            tbl2.Rows.Add(dr1)

                        Next
                    Next
                Next

                'need to sort tbl2
                Dim dv3 As DataView
                Try
                    dv3 = New DataView(tbl2, "", "STUDYNAME", DataViewRowState.CurrentRows)
                    tbl2 = dv3.ToTable
                Catch ex As Exception

                End Try

            Catch ex As Exception
                var1 = ex.Message
                var1 = var1
            End Try

        End If

        CreatedgvwStudiesDatasource = tbl2

    End Function

    Sub IncrNextTableNumber(wd As Microsoft.Office.Interop.Word.Application)

        If gboolTableSection Then
            ctTableN = ctTableN + 1
        Else

            ctTableN = 0

            'redo arrts
            Call FillTS(wd)

            Dim intUB As Int16 = UBound(arrTS)

            If intUB = 0 Then
                ctTableN = ctTableN + 1
            Else
                'need to check position of any existing tables

                Dim int1 As Int32
                Dim int2 As Int32
                Dim int3 As Int32
                Dim Count1 As Int16

                int2 = wd.Selection.Start

                int1 = 0

                For Count1 = 1 To intUB

                    int3 = arrTS(Count1)
                    If int2 < int3 Then
                        Exit For
                    Else

                    End If

                    ctTableN = Count1

                Next Count1

                ctTableN = ctTableN + 1

            End If

        End If


    End Sub

    Sub FillTS(wd As Microsoft.Office.Interop.Word.Application)

        Dim var1, var2, var3

        Dim rng1 As Word.Range
        Dim c As Word.Range

        Dim pos1 As Int32
        Dim pos2 As Int32

        ReDim arrTS(1000)

        Dim int1 As Int32

        Dim intOrig As Int64

        Dim rngOrig As Word.Range = wd.Selection.Range

        With wd

            .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)

            rng1 = .ActiveDocument.Range '.Content

            pos1 = rng1.Start
            pos2 = rng1.End

            var1 = 0

            int1 = 0

            var2 = 0
            With .Selection.Find

                .ClearFormatting()
                .Replacement.ClearFormatting()
                .Style = "Caption"
                .Text = ""
                .Forward = True
                .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue  ' 1            'wdFindContinue=1
                .MatchCase = False
                .MatchWholeWord = False
                .MatchWildcards = False
                .MatchSoundsLike = False
                .MatchAllWordForms = False
                '.Execute

                Do While .Execute

                    If .Found Then

                        int1 = int1 + 1
                        wd.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine)
                        var1 = wd.Selection.Start
                        If int1 > UBound(arrTS) Then
                            ReDim Preserve arrTS(UBound(arrTS) + 1000)
                        End If
                        arrTS(int1) = CLng(var1)
                        If var1 = var2 Or var1 < var2 Then
                            Exit Do
                        End If
                    Else
                        Exit Do
                    End If

                    If int1 > 1000 Then
                        var1 = var1
                    End If

                    var2 = var1

                Loop

                .ClearFormatting()
                .Replacement.ClearFormatting()

            End With

            .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)

            'go back to original position
            rngOrig.Select()


        End With

        ReDim Preserve arrTS(int1)

        If int1 = 0 Then
            gboolTSDone = True
        End If


    End Sub

    Sub SaveAnalyteGroups()

        Dim dgv As DataGridView = frmH.dgvAnalyteGroups
        Dim dv As DataView = dgv.DataSource
        Dim dtbl As System.Data.DataTable = TBLSTUDYDOCANALYTES
        Dim dtbl1 As System.Data.DataTable = tblAnalytesHome
        Dim strF As String

        'must change values in dtbl

        Dim intRow As Int16
        Dim intO1 As Int16
        Dim intO2 As Int16

        Dim var1, var2, var3
        Dim intRows As Int16
        Dim Count1 As Int16
        Dim Count2 As Int16

        intRows = dgv.Rows.Count

        For Count1 = 0 To intRows - 1

            intO1 = dgv("INTGROUP", Count1).Value
            intO2 = dgv("INTORDER", Count1).Value
            var1 = dgv("CHARUSERANALYTE", Count1).Value
            var2 = dgv("CHARUSERIS", Count1).Value

            strF = "INTGROUP = " & intO1 & " AND ID_TBLSTUDIES = " & id_tblStudies
            Dim rows() As DataRow = dtbl.Select(strF)
            rows(0).BeginEdit()
            rows(0).Item("INTORDER") = intO2
            rows(0).Item("CHARUSERANALYTE") = var1
            rows(0).Item("CHARUSERIS") = var2
            rows(0).EndEdit()

            'strF = "INTORDER = " & intO2
            strF = "INTGROUP = " & intO1
            Dim rows1() As DataRow = dtbl1.Select(strF)
            rows1(0).BeginEdit()
            rows1(0).Item("INTORDER") = intO2
            rows1(0).Item("CHARUSERANALYTE") = var1
            rows1(0).Item("CHARUSERIS") = var2
            rows1(0).EndEdit()

        Next Count1

        dtbl1.AcceptChanges()

    End Sub

    Sub SetDocGlobal(doc As Word.Document)

        Dim var1 As String

        SpellSetting = True
        GrammarSetting = True

        Try

            With doc.Options
                SpellSetting = .CheckSpellingAsYouType
                GrammarSetting = .CheckGrammarAsYouType
            End With
        Catch ex As Exception
            var1 = var1
        End Try

    End Sub

    Sub SpellingOff(doc As Word.Document, boolSetOrig As Boolean)

        'SpellSetting As Boolean, GrammarSetting As Boolean are set globally

        Dim var1

        Try
            '20180701 LEE:
            'In case Word 2010 doesn't support, do this in Try-Catch
            If boolSetOrig Then
                With doc.Options
                    .CheckSpellingAsYouType = SpellSetting
                    .CheckGrammarAsYouType = GrammarSetting
                End With
            Else
                With doc.Options
                    .CheckSpellingAsYouType = False
                    .CheckGrammarAsYouType = False
                End With
            End If
        
        Catch ex As Exception
            var1 = var1
        End Try

    End Sub

    Sub AdjustReassayOriginalValue()


        '20180226 LEE:
        'dvDuplicates
        'LI-00016 Study POP01 Furosemide Human Plasma has several original and repeat samples marked incorrectly in SAMPLERESULTSCONFLICT.ORIGINALVALUE (Y and N are switched).
        'This is obvious because the Reassay RunID (e.g. 3) is before the Original RunID (e.g. 7)
        'There must be some problem with the query because actaul Reassay Watson table provided by LI-00016 shows the correct assignment.
        'need to check here to ensure correct assignment

        '20180606 LEE:
        'This logic is not working. LI-00017 study 01045005_04Jun2018 has data in which no records in tblReassayReport is the correct value
        'Will try go back to old logic:  evaluate sevaral different queries


        Dim Count1 As Int32
        Dim Count2 As Int32
        Dim Count3 As Int32
        Dim Count4 As Int32
        Dim Count5 As Int32
        Dim Count6 As Int32
        Dim Count2A As Short
        Dim intUSubj As Int32
        Dim strSubj As String
        Dim intL As Int32
        Dim strF As String
        Dim strF2 As String
        Dim intDSId As Int64
        Dim var1, var2, var3, var4
        Dim intDo As Int16
        Dim strS As String
        Dim strAnalyteID As String
        Dim strAnalyteDescription As String
        Dim strMatrix As String


        Dim rowsUG() As DataRow

        Try
            Dim dv11 As New DataView(tblAnalytesHome, "IsIntStd = 'No'", "INTORDER ASC, OriginalAnalyteDescription ASC", DataViewRowState.CurrentRows)
            Dim tbl11 As DataTable = dv11.ToTable("a", True, "AnalyteID", "OriginalAnalyteDescription", "Matrix", "ConcUnits", "IsIntStd")

            strF = "IsIntStd = 'No'"
            strS = "INTORDER ASC" ', IsIntStd ASC, OriginalAnalyteDescription ASC"
            Dim rows11() As DataRow = tbl11.Select()
            Dim intRowsAnal As Short = rows11.Length



            For Count2A = 0 To intRowsAnal - 1

                Try
                    strAnalyteID = rows11(Count2A).Item("AnalyteID")
                    strAnalyteDescription = rows11(Count2A).Item("OriginalAnalyteDescription")
                    strMatrix = rows11(Count2A).Item("Matrix")
                Catch ex As Exception
                    var1 = var1 'debug
                End Try


                strF = "SAMPLETYPEID = '" & strMatrix & "' AND ANALYTEID = " & strAnalyteID ' makeRunMatrixFilter(intDo, strAnalyteID, strMatrix) & " AND ORIGINALVALUE = 'Y'"
                'Console.WriteLine(strF)
                'strSdvRepeatTableRowsSort = "DESIGNSUBJECTTAG ASC, WEEK ASC, ENDDAY ASC, ENDHOUR ASC, ENDMINUTE ASC, ENDSECOND ASC, SAMPLERESULTS_RUNID ASC"
                'strS = "DESIGNSUBJECTTAG ASC, RUNID ASC, ENDDAY ASC, ENDHOUR ASC, ENDMINUTE ASC"
                strS = "DESIGNSUBJECTTAG ASC, WEEK ASC, ENDDAY ASC, ENDHOUR ASC, ENDMINUTE ASC, ENDSECOND, RUNID ASC"
                Dim dv1 As System.Data.DataView = New DataView(tblReassayReport, strF, strS, DataViewRowState.CurrentRows)
                'Dim tblUGrps As System.Data.DataTable = dv1.ToTable("a", True, "DESIGNSUBJECTTAG", "ENDDAY", "ENDHOUR", "ENDMINUTE", "RUNID", "DESIGNSAMPLEID")
                ' Dim tblUGrps As System.Data.DataTable = dv1.ToTable("a", True, "DESIGNSUBJECTTAG", "ENDDAY", "ENDHOUR", "ENDMINUTE", "RUNID", "DESIGNSAMPLEID", "STARTDAY", "STARTHOUR", "STARTMINUTE")
                Dim tblUGrps As System.Data.DataTable = dv1.ToTable("a", True, "DESIGNSUBJECTTAG", "WEEK", "ENDDAY", "ENDHOUR", "ENDMINUTE", "ENDSECOND", "RUNID", "DESIGNSAMPLEID", "STARTDAY", "STARTHOUR", "STARTMINUTE", "STARTSECOND")
                Dim intUGrps As Short
                intUGrps = tblUGrps.Rows.Count

                'determine number of blank rows to skip
                Dim tblUSubj As System.Data.DataTable = dv1.ToTable("a", True, "DESIGNSUBJECTTAG")
                'Nope. Need to keep Design Subject separate
                'Dim tblUSubj As System.Data.DataTable = dv1.ToTable("a", True, "DESIGNSUBJECTTAG", "DESIGNSAMPLEID")
                intUSubj = tblUSubj.Rows.Count

                For Count4 = 1 To intUSubj

                    strSubj = tblUSubj.Rows(Count4 - 1).Item("DESIGNSUBJECTTAG")

                    strF = "DESIGNSUBJECTTAG = '" & strSubj & "'"
                    rowsUG = tblUGrps.Select(strF, strS)
                    intL = rowsUG.Length
                    intL = intL 'debug

                    For Count6 = 1 To intL

                        intDSId = rowsUG(Count6 - 1).Item("DESIGNSAMPLEID")

                        strF2 = "DESIGNSAMPLEID = " & intDSId & " AND ANALYTEID = " & strAnalyteID & " AND SAMPLETYPEID = '" & strMatrix & "'"
                        'Dim rowsDups() As DataRow = tblReassayReport.Select(strF)
                        Dim rowsDups() As DataRow = tblReassayReport.Select(strF2, "RUNID ASC")
                        'first entry ORIGINALVALUE should be "Y"
                        var1 = rowsDups(0).Item("ORIGINALVALUE")
                        If StrComp(var1, "Y", CompareMethod.Text) = 0 Then
                        Else
                            'need to reassign ORIGINALVALUE
                            For Count3 = 0 To rowsDups.Length - 1
                                rowsDups(Count3).BeginEdit()
                                If Count3 = 0 Then
                                    rowsDups(Count3).Item("ORIGINALVALUE") = "Y"
                                Else
                                    rowsDups(Count3).Item("ORIGINALVALUE") = "N"
                                End If
                                rowsDups(Count3).EndEdit()
                            Next

                            'must do the same in tblRepeatAllRunSamples
                            Dim rowsRARS() As DataRow = tblRepeatAllRunSamples.Select(strF2, "ANARUNANALYTERESULTS_RUNID")
                            For Count3 = 0 To rowsRARS.Length - 1
                                rowsDups(Count3).BeginEdit()
                                If Count3 = 0 Then
                                    rowsRARS(Count3).Item("ORIGINALVALUE") = "Y"
                                Else
                                    rowsRARS(Count3).Item("ORIGINALVALUE") = "N"
                                End If
                                rowsRARS(Count3).EndEdit()
                            Next

                        End If

                    Next Count6

                Next Count4

            Next
        Catch ex As Exception
            var1 = var1 'debug
        End Try


    End Sub

    Sub ApplyChapterNumber(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal strTable As String)

        Try
            With wd.CaptionLabels(strTable)
                .IncludeChapterNumber = True
                .ChapterStyleLevel = 1
                .Separator = Microsoft.Office.Interop.Word.WdSeparatorType.wdSeparatorHyphen
            End With
        Catch ex As Exception

        End Try


    End Sub

    Sub InsertTableCrossRef(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal strTName As String, intNum As Short)
        Dim str1 As String

        str1 = CStr(ReturnLabelPosition(strTName, intNum))

        With wd
            .Selection.InsertCrossReference(ReferenceType:="Table", ReferenceKind:=Microsoft.Office.Interop.Word.WdReferenceKind.wdOnlyLabelAndNumber, ReferenceItem:=str1, InsertAsHyperlink:=True, IncludePosition:=False) ', SeparateNumbers:=False, SeparatorString:=" ")

        End With

    End Sub

    Sub CreateReturnLabelPosition()

        Dim Count1 As Short
        Dim str1 As String

        If dtblReturnLabelPosition.Columns.Contains("charTitle") Then

        Else
            For Count1 = 1 To 2

                Select Case Count1
                    Case 1
                        str1 = "charTitle"
                    Case 2
                        str1 = "intNum"
                End Select

                Dim col1 As New DataColumn
                col1.ColumnName = str1
                dtblReturnLabelPosition.Columns.Add(col1)

            Next
        End If


    End Sub

    Sub FillReturnLabelPosition(wd As Microsoft.Office.Interop.Word.Application)

        'clear table
        Try
            dtblReturnLabelPosition.Clear()
            dtblReturnLabelPosition.AcceptChanges()
        Catch ex As Exception

        End Try

        Dim doc As Microsoft.Office.Interop.Word.Document
        doc = wd.ActiveDocument

        Dim arrC = doc.GetCrossReferenceItems("Table")
        'returns an 1-based array of table references

        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim str6 As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim intCt As Short
        Dim intI As Int16 = UBound(arrC)
        Dim arrC1
        Dim intA As Int16

        Dim intT As Integer
        Dim intSR As Integer
        Dim intD As Integer

        Dim var1, var2, var3, var4, var5

        Dim boolTab As Boolean = True
        If StrComp(gstrCAPTIONFOLLOW, "Tab", CompareMethod.Text) = 0 Then
            boolTab = True
        Else
            boolTab = False
        End If

        Dim boolDash As Boolean = False
        Dim intDash As Short = Len(lcharCaptionTrailer)
        'lcharCaptionTrailer
        If InStr(1, lcharCaptionTrailer, "-", CompareMethod.Text) > 0 Then
            boolDash = True
        Else
            boolDash = False
        End If

        '20170713 LEE:
        'Note: If caption type is "Include Section Number", captured string dash is represented as 'record separator' (chrw(30))
        'e.g.: 'Table 10-4	Analytical Batch 9 Quality Control Evaluation Data for BCX7343 in Rat K3EDTA Plasma'
        'is recorded as 'Table 104	Analytical Batch 9 Quality Control Evaluation Data for BCX7343 in Rat K3EDTA Plasma'
        '    there is actually a chrw(30) in between 10 and 4
        'this must be accounted for in Function ReturnLabelPosition located in modConserved


        intCt = 0

        For Count1 = 1 To intI

            str1 = arrC(Count1)
            'find 'Table-space-XXX-(tab or return)

            intT = 0
            If boolTab Then
                intT = InStr(1, str1, ChrW(9), vbTextCompare) 'tab
            Else 'soft return
                'str1 should have soft return, but is actually just a space in this string
                'strC has the soft retrun
                'but there is already a space after Table
                'so must look for 2nd space, then replace it with soft return chrw(11)
                'but must account for funny captiontrailer, like " -"
                'find number of spaces in lcharCaptionTrailer
                Dim intCPS As Short = 0
                For Count2 = 1 To Len(lcharCaptionTrailer)
                    var1 = Mid(lcharCaptionTrailer, Count2, 1)
                    If StrComp(var1.ToString, " ", CompareMethod.Text) = 0 Then
                        intCPS = intCPS + 1
                    End If
                Next

                Dim intLastSpace As Short = 2 + intCPS
                Dim arrS(Len(str1))
                Dim intS As Int16 = 0
                For Count2 = 1 To Len(str1)
                    var1 = Mid(str1, Count2, 1)
                    var2 = AscW(var1)
                    If var2 = 32 Then
                        intS = intS + 1
                        arrS(intS) = Count2
                        If intS >= intLastSpace Then
                            Exit For
                        End If
                    End If
                Next
                intT = arrS(intLastSpace)

                str2 = Mid(str1, 1, intT - 1)
                str3 = Mid(str1, intT + 1, Len(str1))
                str4 = str2 & ChrW(11) & str3
                str1 = str4

            End If



            If intT = 0 Then
                str6 = str1
            Else

                'if delimiter is dash, go two back
                'If boolDash Then
                '    str3 = Mid(str1, 1, intT - 1 - intDash)
                'Else
                '    str3 = Mid(str1, 1, intT - 1)
                'End If
                str3 = Mid(str1, 1, intT - 1 - intDash)

                'replace any hyphens with record separator
                'str4 = Replace(str3, "-", "", 1, -1, vbTextCompare)
                str4 = Replace(str3, "-", ChrW(30), 1, -1, vbTextCompare)
                'replace space with nbs
                str5 = Replace(str4, " ", ChrW(160), 1, -1, CompareMethod.Text)

                'replace str3 with str4
                str6 = Replace(str1, str3, str5, 1, -1, vbTextCompare)

            End If

            Dim nr As DataRow = dtblReturnLabelPosition.NewRow
            nr.BeginEdit()
            nr("charTitle") = str6
            nr("intNum") = Count1
            nr.EndEdit()
            dtblReturnLabelPosition.Rows.Add(nr)

        Next

    End Sub

    Function ReturnLabelPosition(strC As String, intNum As Short) As Int16

        ReturnLabelPosition = intNum

        Dim var1
        Dim strF As String
        strF = "charTitle = '" & strC & "'"
        Dim rows() As DataRow = dtblReturnLabelPosition.Select(strF)
        If rows.Length = 0 Then
            var1 = var1 'debug
        Else
            ReturnLabelPosition = rows(0).Item("intNum")
        End If


    End Function

    Sub CallMsgBox(intV As Integer, wd As Microsoft.Office.Interop.Word.Application)

        Exit Sub

        wd.Visible = True

        MsgBox("Here: " & intV)


    End Sub

    Sub InsertPageBreak(wd As Microsoft.Office.Interop.Word.Application)

        If boolTableSectionStart Then
            boolTableSectionStart = False
        Else
            '20180523 LEE
            wd.Selection.TypeParagraph()

            wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)

            ''20180523 LEE
            'wd.Selection.TypeParagraph()
        End If

    End Sub

    Sub InsertPageBreakAppFig(wd As Microsoft.Office.Interop.Word.Application)

        If boolAppFigSectionStart Then
            boolAppFigSectionStart = False
        Else
            wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
            'If boolIWD Then
            'Else
            '    wd.Selection.InsertBreak(Type:=Microsoft.Office.Interop.Word.WdBreakType.wdSectionBreakNextPage)
            'End If
        End If            

    End Sub

    Sub ReorderAnalytes()

        'Legend
        'Dim arrAnalytes(16, 51) '1=AnalyteDescription, 2=AnalyteID, 3=AnalyteIndex
        '4=BQL, 5=AQL, 6=Conc Units, 7=AcceptedRuns, 8=IsReplicate, 9=IsIntStd
        '10=UseIntStd, 11=IntStd, 12=MasterAssayID, 13=IsCoadminCmpd,14=OriginalAnalyteDescription,15=intGroup,16=MATRIX, 17=intOrder, 18=CALIBRSET

        Dim dtbl As System.Data.DataTable = tblAnalytesHome
        Dim strF As String
        Dim strS As String

        'first do analytes
        strF = "IsIntStd = 'No'"
        strS = "INTORDER ASC"
        Dim rows() As DataRow = dtbl.Select(strF, strs)

        Dim Count1 As Short
        Dim Count2 As Short
        Dim intCt As Short = 0
        Dim var1, var2, var3

        For Count1 = 0 To rows.Length - 1
            var2 = rows(Count1).Item("INTORDER") 'debug
            var3 = rows(Count1).Item("ANALYTEDESCRIPTION") 'debug
            For Count2 = 0 To intUBAA - 1
                var1 = rows(Count1).Item(Count2)
                If Count2 = 15 Then
                    var1 = var1 'debug
                End If
                arrAnalytes(Count2 + 1, Count1 + 1) = var1
            Next
        Next

        'now do tblAnalyteGroups

        'Legend

        '    tblAnalyteGroupsTemp = dv1a.ToTable("a", True, "ANALYTEDESCRIPTION", "ANALYTEID", "INTSTD", "INTGROUP", "ANALYTEDESCRIPTION_C", "MATRIX", "INTCALSET", "CALIBRSET")
        ''now add a column
        'If tblAnalyteGroupsTemp.Columns.Contains("INTORDER") Then
        var3 = var3

        Try
            For Count1 = 0 To rows.Length - 1
                var3 = rows(Count1).Item("AnalyteDescription") 'debug
                var1 = rows(Count1).Item("intGroup")
                var2 = NZ(rows(Count1).Item("intOrder"), 0)
                strF = "INTGROUP = " & var1
                Dim rowsA() As DataRow = tblAnalyteGroups.Select(strF)
                If rowsA.Length = 0 Then
                Else
                    rowsA(0).BeginEdit()
                    rowsA(0).Item("INTORDER") = var2
                    rowsA(0).EndEdit()
                End If

                'now must make changes to tblStudyDocAnalytes which mimics tblAnalytesHome
                strF = "INTGROUP = " & var1 & " AND ID_TBLSTUDIES = " & id_tblStudies
                Dim rowsSDA() As DataRow = TBLSTUDYDOCANALYTES.Select(strF)
                If rowsSDA.Length = 0 Then
                Else
                    rowsSDA(0).BeginEdit()
                    rowsSDA(0).Item("INTORDER") = var2
                    rowsSDA(0).EndEdit()
                End If
            Next
        Catch ex As Exception
            var1 = var1
        End Try
   


        Try
            'now must re-order tblAnalyteGroup
            strF = "INTGROUP > -1"
            strS = "INTORDER ASC"
            Dim rowsB() As DataRow = tblAnalyteGroups.Select(strF, strS)

            Dim dtbl2 As DataTable = rowsB.CopyToDataTable
            tblAnalyteGroups = dtbl2
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        'now must reset tblanalyteids and tblmatrices
        strF = "INTGROUP > -2"
        strS = "INTORDER ASC"
        Dim dvAnalyteGroups As New DataView(tblAnalyteGroups, strF, strS, DataViewRowState.CurrentRows)
        tblAnalyteIDs = dvAnalyteGroups.ToTable("tblAnalyteIDs", True, "ANALYTEID", "ANALYTEDESCRIPTION")

        'enter data for Table Matrices
        tblMatrices = dvAnalyteGroups.ToTable("tblMatrices", True, "MATRIX")





    End Sub

    Sub ChooseReportWindow()

        '20170309 LEE: Some clients (LI-00028 and LI-00001) are reporting an error (see JIRA SD-369) when attempting to create a report when the Configure Report Tables tab is not chosen
        'This error cannot be reproduced in the StudyDoc development environment
        'To resolve, will force Configure Report Tables window to be active if Prepare Report is selected

        boolChooseReportWindow = True

        frmH.lbxTab1.SelectedIndex = 5



    End Sub

    Sub GetINTWINAUTH()

        Dim strF As String = "CHARCONFIGCATEGORY = 'Global LDAP'"
        Dim rows() As DataRow = tblConfiguration.Select(strF)
        Dim var1

        If rows.Length = 0 Then
            INTWINAUTH = 1
        Else
            var1 = NZ(rows(0).Item("CHARCONFIGVALUE"), 1)
            If IsNumeric(var1) Then
                INTWINAUTH = var1
            End If
        End If

    End Sub

    Sub ResetStudyRecord()

        'set txt to -10
        frmH.txtcbxMDBSelIndex.Text = -10

    End Sub

    Sub GetWatsonStudyRoles(ByRef cn As ADODB.Connection)


        Dim rs As New ADODB.Recordset
        Dim str1 As String = ""
        Dim str2 As String = ""
        Dim str3 As String = ""
        Dim str4 As String = ""
        Dim strSQL As String = ""
        Dim Count1 As Short
        Dim int1 As Int64
        Dim var1

        str1 = "SELECT " & strSchema & ".SECUSERSTUDYROLES.USERID, " & strSchema & ".SECUSERSTUDYROLES.STUDYID, " & strSchema & ".SECUSERSTUDYROLES.ROLEID, " & strSchema & ".SECROLEDESC.ROLEDESC "
        str2 = "FROM (" & strSchema & ".SECUSERSTUDYROLES INNER JOIN " & strSchema & ".SECAUTHORIZEDROLES ON (" & strSchema & ".SECUSERSTUDYROLES.ROLEID = " & strSchema & ".SECAUTHORIZEDROLES.ROLEID) AND (" & strSchema & ".SECUSERSTUDYROLES.USERID = " & strSchema & ".SECAUTHORIZEDROLES.USERID)) INNER JOIN " & strSchema & ".SECROLEDESC ON " & strSchema & ".SECAUTHORIZEDROLES.ROLEID = " & strSchema & ".SECROLEDESC.ROLEID;"


        strSQL = str1 & str2

        'Console.WriteLine("tblWatsonStudyRoles: " & strSQL)

        If rs.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs.Close()
        End If

        rs.CursorLocation = CursorLocationEnum.adUseClient
        rs.Open(strSQL, cn, ADODB.CursorTypeEnum.adOpenStatic, ADODB.LockTypeEnum.adLockReadOnly)
        rs.ActiveConnection = Nothing

        int1 = rs.RecordCount 'debug

        Try
            tblWatsonStudyRoles.Clear()
            tblWatsonStudyRoles.AcceptChanges()
            tblWatsonStudyRoles.BeginLoadData()
            daDoPr.Fill(tblWatsonStudyRoles, rs)
            tblWatsonStudyRoles.EndLoadData()
            rs.Close()
        Catch ex As Exception
            var1 = ex.Message
        End Try

        int1 = tblWatsonStudyRoles.Rows.Count 'debug
        int1 = int1


end1:

        rs = Nothing


    End Sub

    Sub GetWatsonUsers(ByRef cn As ADODB.Connection)


        Dim rs As New ADODB.Recordset
        Dim str1 As String = ""
        Dim str2 As String = ""
        Dim str3 As String = ""
        Dim str4 As String = ""
        Dim strSQL As String = ""
        Dim Count1 As Short
        Dim int1 As Int64
        Dim var1

        strSQL = str1 & str2 & str3 & str4


        str1 = "SELECT " & strSchema & ".SECUSERACCOUNTS.* FROM " & strSchema & ".SECUSERACCOUNTS;"
        strSQL = str1

        If rs.State = ADODB.ObjectStateEnum.adStateOpen Then
            rs.Close()
        End If
     
        rs.CursorLocation = CursorLocationEnum.adUseClient
        rs.Open(strSQL, cn, ADODB.CursorTypeEnum.adOpenStatic, ADODB.LockTypeEnum.adLockReadOnly)
        rs.ActiveConnection = Nothing

        int1 = rs.RecordCount 'debug

        Try
            tblWatsonUsers.Clear()
            tblWatsonUsers.AcceptChanges()
            tblWatsonUsers.BeginLoadData()
            daDoPr.Fill(tblWatsonUsers, rs)
            tblWatsonUsers.EndLoadData()
            rs.Close()
        Catch ex As Exception
            var1 = ex.Message
        End Try



        int1 = tblWatsonUsers.Rows.Count 'debug
        int1 = int1




end1:

        rs = Nothing


    End Sub

    Sub SetPanAction()

        Call frmH.SetPanPos()

        'Dim a, b, c

        'a = frmH.tab1.Top + frmH.tab1.Height
        'b = frmH.panActions.Top
        'c = a - b
        'frmH.panActions.Height = c

        'frmH.panActions.Refresh()

    End Sub


    Sub SetCellPaddingZero(tbl As Word.Table)

        With tbl
            .TopPadding = 0 'InchesToPoints(0)
            .BottomPadding = 0 ' InchesToPoints(0)
            .LeftPadding = 2.88 ' 0 'InchesToPoints(0)
            .RightPadding = 2.88 ' 0 'InchesToPoints(0.08)
            .Spacing = 0
        End With

    End Sub

    Sub SetCellPadding(tbl As Word.Table)

        With tbl
            .TopPadding = 0 'InchesToPoints(0)
            .BottomPadding = 0 ' InchesToPoints(0)
            .LeftPadding = 0 'InchesToPoints(0)
            .RightPadding = 5.76 ' 3.6 ' 5.76 'InchesToPoints(0.08)
            .Spacing = 0
        End With

    End Sub


    Sub DoCells(wCells As Microsoft.Office.Interop.Word.Cells)

        'This code will not allow the cell range to wordwrap. 
        'This is usefull for columns with dates that sometimes wrap improperly

        'unfortunately, this is slow and there doesn't seem to be a way to apply to a column rather than each cell
        'even though Word macrorecorder does it, that code transfered here will apply to only the first cell of the column

        Dim cell As Microsoft.Office.Interop.Word.Cell
        Dim var1 '

        For Each cell In wCells
            cell.WordWrap = False
        Next

    End Sub

    Sub SetComboCell(dgv As DataGridView, strCol As String)

        Dim Count1 As Short
        Dim var1

        'now do comboboxcell

        For Count1 = 0 To dgv.Rows.Count - 1
            Dim cbx As New DataGridViewComboBoxCell
            cbx.Items.Add("P")
            cbx.Items.Add("L")
            'cbx.DisplayStyleForCurrentCellOnly = True
            cbx.DisplayStyle = DataGridViewComboBoxDisplayStyle.DropDownButton
            Try
                dgv(strCol, Count1) = cbx
            Catch ex As Exception
                var1 = ex.Message
                var1 = var1
            End Try
        Next

    End Sub

    Sub SaveAutoAssignSamples()

        Dim var1

        Call FillAuditTrailTemp(tblAutoAssignSamples)

        If boolGuWuOracle Then
            'Try
            '    ta_TBLAUTOASSIGNSAMPLES.Update(tblAutoAssignSamples)
            'Catch ex As DBConcurrencyException
            '    'ds2005.TBLTABLEPROPERTIES.Merge('ds2005.TBLTABLEPROPERTIES, True)
            'End Try
        ElseIf boolGuWuAccess Then
            Try
                ta_TBLAUTOASSIGNSAMPLESAcc.Update(tblAutoAssignSamples)
            Catch ex As DBConcurrencyException
                var1 = ex.Message
                'ds2005Acc.TBLTABLEPROPERTIES.Merge('ds2005Acc.TBLTABLEPROPERTIES, True)
            End Try
        ElseIf boolGuWuSQLServer Then
            Try
                ta_TBLAUTOASSIGNSAMPLESSQLServer.Update(tblAutoAssignSamples)
            Catch ex As DBConcurrencyException
                var1 = ex.Message
                'ds2005Acc.TBLTABLEPROPERTIES.Merge('ds2005Acc.TBLTABLEPROPERTIES, True)
            End Try
        End If

    End Sub

    Sub DatabaseCorrections()

        Dim tbl As DataTable
        Dim strF As String
        Dim STRS As String
        Dim rows() As DataRow
        Dim Count1 As Int16
        Dim Count2 As Int16
        Dim Count3 As Int16
        Dim Count4 As Int16
        Dim int1 As Int32
        Dim int2 As Int32
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim str6 As String
        Dim var1, var2, var3, var4
        Dim boolSave As Boolean
        Dim dtNow As Date = Now
        Dim intMaxID As Int32

        Dim id1 As Int32
        Dim id2 As Int32

        Dim boolHit As Boolean = False

        Try

            'deprecate some data

            boolSave = False

            tbl = tblConfiguration

            strF = "CHARCONFIGGROUP = 'Global' AND CHARCONFIGCATEGORY = 'Global Settings' AND CHARCONFIGTITLE LIKE 'Go directly to Word" & ChrW(8482) & " after report generation.*'"
            rows = tblConfiguration.Select(strF)
            If rows.Length = 0 Then
            Else
                boolSave = True
                rows(0).BeginEdit()
                rows(0).Item("CHARCONFIGGROUP") = "DEPRECATED"
                rows(0).Item("CHARCONFIGCATEGORY") = "DEPRECATED"
                rows(0).EndEdit()

            End If

            'strF = "ID_TBLCONFIGURATION = 16" 'No more pdf driver
            'rows = tblConfiguration.Select(strF)
            'If rows.Length = 0 Then
            'Else
            '    boolSave = True
            '    rows(0).BeginEdit()
            '    rows(0).Item("CHARCONFIGGROUP") = "DEPRECATED"
            '    rows(0).Item("CHARCONFIGCATEGORY") = "DEPRECATED"
            '    rows(0).EndEdit()

            'End If

            '20170308 LEE: Add entry for Global LDAP
            strF = "CHARCONFIGCATEGORY = 'Global LDAP'"
            rows = tblConfiguration.Select(strF)
            If rows.Length = 0 Then

                boolSave = True

                'add record
                Dim nr As DataRow = tblConfiguration.NewRow
                nr.BeginEdit()

                nr("ID_TBLCONFIGURATION") = 33
                nr("CHARCONFIGGROUP") = "Global"
                nr("CHARCONFIGCATEGORY") = "Global LDAP"
                nr("CHARCONFIGTITLE") = "Global Windows Authentication Type"
                nr("CHARCONFIGVALUE") = 1
                nr("INTORDER") = 1
                nr("BOOLISNUMERIC") = 1
                nr("BOOLISDIRECTORY") = 0
                nr("BOOLISFILE") = 0
                nr("BOOLISBOOLEAN") = 0
                nr("UPSIZE_TS") = dtNow

                nr.EndEdit()

                tblConfiguration.Rows.Add(nr)

            End If

            '20170403 LEE: Add entry for Report Generation Advanced Prompt
            strF = "ID_TBLCONFIGURATION = 34"
            rows = tblConfiguration.Select(strF)
            If rows.Length = 0 Then

                boolSave = True

                'add record
                Dim nr As DataRow = tblConfiguration.NewRow
                nr.BeginEdit()

                nr("ID_TBLCONFIGURATION") = 34
                nr("CHARCONFIGGROUP") = "Global"
                nr("CHARCONFIGCATEGORY") = "Global Settings"
                nr("CHARCONFIGTITLE") = "Report Generation Advanced Prompt"
                nr("CHARCONFIGVALUE") = "FALSE"
                nr("INTORDER") = 17
                nr("BOOLISNUMERIC") = 0
                nr("BOOLISDIRECTORY") = 0
                nr("BOOLISFILE") = 0
                nr("BOOLISBOOLEAN") = -1
                nr("UPSIZE_TS") = dtNow

                nr.EndEdit()

                tblConfiguration.Rows.Add(nr)

            End If

            '20170417 LEE:  Add entry for ChromReporter Path
            strF = "ID_TBLCONFIGURATION = 35"
            rows = tblConfiguration.Select(strF)
            If rows.Length = 0 Then

                boolSave = True

                'add record
                Dim nr As DataRow = tblConfiguration.NewRow
                nr.BeginEdit()

                nr("ID_TBLCONFIGURATION") = 35
                nr("CHARCONFIGGROUP") = "Global"
                nr("CHARCONFIGCATEGORY") = "Global Settings"
                nr("CHARCONFIGTITLE") = "ChromReporter Path"
                'nr("CHARCONFIGVALUE") = ""
                nr("INTORDER") = 19
                nr("BOOLISNUMERIC") = 0
                nr("BOOLISDIRECTORY") = 0
                nr("BOOLISFILE") = -1
                nr("BOOLISBOOLEAN") = 0
                nr("UPSIZE_TS") = dtNow

                nr.EndEdit()

                tblConfiguration.Rows.Add(nr)

            End If


            If boolSave Then
                If boolGuWuOracle Then

                    Try
                        ta_tblConfiguration.Update(tblConfiguration)
                    Catch ex As DBConcurrencyException
                        'ds2005.TBLUSERACCOUNTS.Merge('ds2005.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuAccess Then

                    Try
                        ta_tblConfigurationAcc.Update(tblConfiguration)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuSQLServer Then

                    Try
                        ta_tblConfigurationSQLServer.Update(tblConfiguration)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                        var1 = var1
                    End Try

                End If
            End If


            'add QC-Mid-1,2,3 to tblAssignedSamplesHelper
            boolSave = False
            tbl = tblAssignedSamplesHelper

            'find maxid
            intMaxID = tblAssignedSamplesHelper.Rows(tblAssignedSamplesHelper.Rows.Count - 1).Item("ID_TBLASSIGNEDSAMPLESHELPER")

            '11:
            '18:
            '19:
            '21:
            '29:
            '4:
            '31:
            '32:

            'ID_TBLASSIGNEDSAMPLESHELPER()
            'CHARHELPER()
            'ID_TBLCONFIGREPORTTABLES()
            'NUMCOMPANY()
            'NUMHELPERNUMBER()


            For Count1 = 1 To 8

                Select Case Count1
                    Case 1
                        int1 = 11
                    Case 2
                        int1 = 18
                    Case 3
                        int1 = 19
                    Case 4
                        int1 = 21
                    Case 5
                        int1 = 29
                    Case 6
                        int1 = 4
                    Case 7
                        int1 = 31
                    Case 8
                        int1 = 32
                End Select

                For Count2 = 1 To 5

                    str1 = "QC Mid-" & Count2
                    Erase rows
                    rows = tbl.Select("CHARHELPER = '" & str1 & "' AND ID_TBLCONFIGREPORTTABLES = " & int1)

                    If rows.Length = 0 Then

                        intMaxID = intMaxID + 1
                        Dim nr As DataRow = tblAssignedSamplesHelper.NewRow
                        nr.BeginEdit()
                        nr("ID_TBLASSIGNEDSAMPLESHELPER") = intMaxID
                        nr("CHARHELPER") = "QC Mid-" & Count2
                        nr("ID_TBLCONFIGREPORTTABLES") = int1
                        nr("NUMCOMPANY") = 3
                        nr("NUMHELPERNUMBER") = 1
                        nr.EndEdit()
                        tblAssignedSamplesHelper.Rows.Add(nr)

                        boolSave = True

                    End If

                Next

            Next
            'tblAssignedSamplesHelper.AcceptChanges()

            '20190214 LEE:
            'Must add helper1 stuff to diln_12 because adhocstability_31 is now used for Diln table
            int1 = 12
            For Count1 = 1 To 9
                Select Case Count1
                    Case 1
                        str1 = "QC Low"
                    Case 2
                        str1 = "QC Mid"
                    Case 3
                        str1 = "QC Mid-1"
                    Case 4
                        str1 = "QC Mid-2"
                    Case 5
                        str1 = "QC Mid-3"
                    Case 6
                        str1 = "QC Mid-4"
                    Case 7
                        str1 = "QC Mid-5"
                    Case 8
                        str1 = "QC High"
                    Case 9
                        str1 = "QC Diln"
                End Select

                Erase rows
                rows = tbl.Select("CHARHELPER = '" & str1 & "' AND ID_TBLCONFIGREPORTTABLES = " & int1 & " AND NUMHELPERNUMBER = 1")

                If rows.Length = 0 Then

                    intMaxID = intMaxID + 1
                    Dim nr As DataRow = tblAssignedSamplesHelper.NewRow
                    nr.BeginEdit()
                    nr("ID_TBLASSIGNEDSAMPLESHELPER") = intMaxID
                    nr("CHARHELPER") = str1
                    nr("ID_TBLCONFIGREPORTTABLES") = int1
                    nr("NUMCOMPANY") = 3
                    nr("NUMHELPERNUMBER") = 1
                    nr.EndEdit()
                    tblAssignedSamplesHelper.Rows.Add(nr)

                    boolSave = True

                End If

            Next Count1

            If boolSave Then
                If boolGuWuOracle Then

                    Try
                        ta_tblAssignedSamplesHelper.Update(tblAssignedSamplesHelper)
                    Catch ex As DBConcurrencyException
                        'ds2005.TBLUSERACCOUNTS.Merge('ds2005.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuAccess Then

                    Try
                        ta_tblAssignedSamplesHelperAcc.Update(tblAssignedSamplesHelper)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuSQLServer Then

                    Try
                        ta_tblAssignedSamplesHelperSQLServer.Update(tblAssignedSamplesHelper)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                End If
            End If


            ''debug
            'For Count1 = 0 To tbl.Rows.Count - 1
            '    str1 = tbl.Rows(Count1).Item("CHARHELPER")
            '    ''Console.WriteLine(str1)
            'Next

end1:

        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        'ensure aaAdmin has ID_TBLPERMISSIONS = 1

        Try
            strF = "ID_TBLUSERACCOUNTS = 1"
            rows = tblUserAccounts.Select(strF)
            var1 = NZ(rows(0).Item("ID_TBLPERMISSIONS"), -1)
            If var1 = 1 Then
            Else
                rows(0).BeginEdit()
                rows(0).Item("ID_TBLPERMISSIONS") = 1
                rows(0).EndEdit()

                If boolGuWuOracle Then

                    Try
                        ta_tblUserAccounts.Update(tblUserAccounts)
                    Catch ex As DBConcurrencyException
                        'ds2005.TBLUSERACCOUNTS.Merge('ds2005.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuAccess Then

                    Try
                        ta_tblUserAccountsAcc.Update(tblUserAccounts)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuSQLServer Then

                    Try
                        ta_tblUserAccountsSQLServer.Update(tblUserAccounts)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                End If

            End If

        Catch ex As Exception

        End Try

        'some TBLDATATABLEROWTITLES corrections
        boolSave = False
        Dim boolTRCN As Boolean = False
        Dim boolOrder As Boolean = False
        Dim boolChangeAll As Boolean = False '20190213 LEE:
        For Count1 = 1 To 28

            boolTRCN = False
            boolOrder = False
            boolChangeAll = False

            Select Case Count1
                Case 1
                    var1 = 331
                    var2 = "Requires Sample Assignment? (A)"
                    var3 = "Requires Sample Assignment? (SA)"

                Case 2
                    var1 = 554
                    var2 = "Use SigFigs/Decimals for Recovery/MatrixFactor values"
                    var3 = "Use SigFigs for Recovery/MatrixFactor values"

                Case 3
                    '20170106 LEE
                    var1 = 513
                    var3 = "Enter NA for non-entry QC or Calibr Std levels"
                    var2 = "Enter NA for non-entry QC or Calibr Std values"

                Case 4
                    '201700529 LEE
                    var1 = 514
                    var2 = "Use BQL/AQL vs BLQ/ALQ"
                    var3 = "Use BQL/AQL vs BLQ/ALQ vs LLOQ/ULOQ"

                Case 5
                    '201700529 LEE
                    var1 = 514
                    var2 = "BOOLBQL"
                    var3 = "CHARBQL"
                    boolTRCN = True

                Case 6
                    var1 = 554
                    var3 = 23
                    boolOrder = True


                Case 7
                    var1 = 201
                    var3 = 26
                    boolOrder = True
                Case 8
                    var1 = 202
                    var3 = 27
                    boolOrder = True
                Case 9
                    var1 = 203
                    var3 = 28
                    boolOrder = True
                Case 10
                    var1 = 255
                    var3 = 25
                    boolOrder = True
                Case 11
                    var1 = 256
                    var3 = 24
                    boolOrder = True

                Case 12
                    var1 = 554
                    var2 = "Use SigFigs for Recovery/MatrixFactor values"
                    var3 = "Use SigFigs for Recovery values"


                    '20181110 LEE
                    'reorder tblMethodValidationData orders
                Case 13
                    var1 = 52
                    var3 = 28
                    boolOrder = True

                Case 14
                    var1 = 53
                    var3 = 29
                    boolOrder = True

                Case 15
                    var1 = 203
                    var3 = 27
                    boolOrder = True

                Case 16
                    var1 = 257
                    var3 = 30
                    boolOrder = True

                Case 17
                    var1 = 248
                    var3 = 38
                    boolOrder = True

                Case 18
                    var1 = 249
                    var3 = 39
                    boolOrder = True

                Case 19
                    var1 = 250
                    var3 = 40
                    boolOrder = True

                Case 20
                    var1 = 251
                    var3 = 41
                    boolOrder = True


                    '20181110 LEE:
                    'Rename some tblMethodValidation Entries
                Case 21
                    var1 = 54
                    var2 = "Stability under Storage Conditions"
                    var3 = "Bench-top Stability"

                Case 22
                    var1 = 247
                    var2 = "Refrigerated Stability in Matrix"
                    var3 = "Reinjection Stability"


                    '20181111 LEE:
                    'Rename some tblSummaryData entries
                Case 23
                    var1 = 109
                    var2 = "Stability under Storage Conditions"
                    var3 = "Bench-top Stability"

                Case 24
                    var1 = 228
                    var2 = "Refrigerated Stability in Matrix"
                    var3 = "Reinjection Stability"


                Case 25 '20190212 LEE: correction
                    var1 = 235
                    var2 = "Analytical Method Type"
                    var3 = "Assay Technique"

                Case 26 '20190212 LEE: correction
                    var2 = "Validation Study Title"
                    var3 = "Validation Report Title"
                    boolChangeAll = True


                    '20190220 LEE:
                Case 27 '20190212 LEE: correction
                    var2 = "Validation Study Title"
                    var3 = "Validation Report Title"
                    boolChangeAll = True
                Case 28 '20190212 LEE: correction
                    var2 = "Long-term Storage Stability in Matrix"
                    var3 = "Long-term Storage Stability"
                    boolChangeAll = True

            End Select
            If boolTRCN Then
                strF = "ID_TBLDATATABLEROWTITLES = " & var1 & " AND CHARTABLEREFCOLUMNNAME = '" & var2 & "'"
            ElseIf boolOrder Then
                strF = "ID_TBLDATATABLEROWTITLES = " & var1
            ElseIf boolChangeAll Then
                strF = "CHARROWNAME = '" & var2 & "'"
            Else
                strF = "ID_TBLDATATABLEROWTITLES = " & var1 & " AND CHARROWNAME = '" & var2 & "'"
            End If

            Try
                Erase rows
                rows = tblDataTableRowTitles.Select(strF)
                If rows.Length > 0 Then
                    boolSave = True

                    'strF = "ID_TBLDATATABLEROWTITLES = " & var1'20190213 LEE: Why?
                    Dim rowsA() As DataRow = tblDataTableRowTitles.Select(strF)

                    rowsA(0).BeginEdit()
                    If boolTRCN Then
                        rowsA(0).Item("CHARTABLEREFCOLUMNNAME") = var3
                    ElseIf boolOrder Then
                        rowsA(0).Item("INTORDER") = var3
                    ElseIf boolChangeAll Then '20190213 LEE:
                        For Count2 = 0 To rowsA.Length - 1
                            rowsA(Count2).Item("CHARROWNAME") = var3
                        Next
                    Else
                        rowsA(0).Item("CHARROWNAME") = var3
                    End If

                    rowsA(0).EndEdit()
                End If
            Catch ex As Exception
                var3 = ex.Message
            End Try

        Next

        If boolSave Then
            If boolGuWuOracle Then

                Try
                    ta_tblDataTableRowTitles.Update(tblDataTableRowTitles)
                Catch ex As DBConcurrencyException
                    'ds2005.TBLUSERACCOUNTS.Merge('ds2005.TBLUSERACCOUNTS, True)
                End Try

            ElseIf boolGuWuAccess Then

                Try
                    ta_tblDataTableRowTitlesAcc.Update(tblDataTableRowTitles)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                End Try

            ElseIf boolGuWuSQLServer Then

                Try
                    ta_tblDataTableRowTitlesSQLServer.Update(tblDataTableRowTitles)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                End Try

            End If
        End If

        'add rows
        'companion to modUpdateCheck.AddFields_xxxxx
        boolSave = False
        For Count1 = 1 To 26
            Select Case Count1
                Case 1
                    int1 = 599
                    str1 = "Allow StdDev calculation if n = 2"
                    int2 = 45
                    str2 = "BOOLSD2"
                    str3 = "tblCompanyData"
                    var1 = "tblData"

                Case 2 'v3.55.2
                    int1 = 600
                    str1 = "If %Accuracy Column is displayed, then report average in Statistics section"
                    int2 = 46
                    str2 = "BOOLDIFFCOLSTATS"
                    str3 = "tblCompanyData"
                    var1 = "tblData"

                Case 3 'v3.55.3
                    int1 = 601
                    str1 = "Group QC Levels By"
                    int2 = 47
                    str2 = "INTQCLEVELGROUP"
                    str3 = "TBLTABLEPROPERTIES"
                    var1 = "TBLTABLEPROPERTIES"

                Case 4 'v3.59.0
                    int1 = 602
                    str1 = "Initial Analysis Date"
                    int2 = 10
                    str2 = "FIRSTANALYSISDATE"
                    str3 = "tblWatsonData"
                    var1 = DBNull.Value

                Case 5
                    int1 = 603
                    str1 = "Last Analysis Date"
                    int2 = 11
                    str2 = "LASTANALYSISDATE"
                    str3 = "tblWatsonData"
                    var1 = DBNull.Value

                Case 6
                    int1 = 604
                    str1 = "Chromatogram Source File"
                    int2 = 12
                    str2 = "CHARRDB"
                    str3 = "TBLAPPFIGS"
                    var1 = "TBLAPPFIGS"

                Case 7
                    int1 = 605
                    str1 = "Allow Lock/Unlock Final Report"
                    int2 = 9
                    str2 = "BOOLLOCKFINALREPORT"
                    str3 = "tblPermissionsFinalReport"
                    var1 = DBNull.Value

                Case 8
                    int1 = 606
                    str1 = "Character following table/figure/appendix caption"
                    int2 = 47
                    str2 = "CHARCAPTIONFOLLOW"
                    str3 = "tblCompanyData"
                    var1 = "tblData"

                Case 9
                    int1 = 607
                    str1 = "Use %RSD label instead of %CV"
                    int2 = 48
                    str2 = "BOOLUSERSD"
                    str3 = "tblCompanyData"
                    var1 = "tblData"

                Case 10
                    int1 = 608
                    str1 = "Add chapter number to table caption label"
                    int2 = 49
                    str2 = "BOOLTABLELABELSECTION"
                    str3 = "tblCompanyData"
                    var1 = "tblData"

                Case 11
                    int1 = 609
                    str1 = "Table font size (0 to use Normal style font size)"
                    int2 = 28
                    str2 = "NUMTABLEFONTSIZE"
                    str3 = "tblCompanyData"
                    var1 = "tblData"


                Case 12 '20190108 LEE:
                    int1 = 610
                    str1 = "Include Calibr Range in table title if multi-calibr range"
                    int2 = 50
                    str2 = "BOOLCALIBRTABLETITLE"
                    str3 = "tblCompanyData"
                    var1 = "tblData"


                Case 13 '20190109 LEE:  'first do tblSummary Data
                    int1 = 611
                    str1 = "Whole Blood Stability"
                    int2 = 35
                    str2 = ""
                    str3 = "tblSummaryData"
                    var1 = ""
                Case 14
                    int1 = 612
                    str1 = "Stock Solution Stability"
                    int2 = 35
                    str2 = ""
                    str3 = "tblSummaryData"
                    var1 = ""
                Case 15
                    int1 = 613
                    str1 = "Spiking Solution Stability"
                    int2 = 35
                    str2 = ""
                    str3 = "tblSummaryData"
                    var1 = ""
                Case 16
                    int1 = 614
                    str1 = "Autosampler Stability"
                    int2 = 35
                    str2 = ""
                    str3 = "tblSummaryData"
                    var1 = ""
                Case 17
                    int1 = 615
                    str1 = "Batch Reinjection Stability"
                    int2 = 34
                    str2 = ""
                    str3 = "tblSummaryData"
                    var1 = ""

                Case 18 '20190109 LEE: 'first do tblMethodValidationData Data
                    int1 = 616
                    str1 = "Whole Blood Stability"
                    int2 = 38
                    str2 = "CHARBLOOD"
                    str3 = "tblMethodValidationData"
                    var1 = str3
                Case 19
                    int1 = 617
                    str1 = "Stock Solution Stability"
                    int2 = 38
                    str2 = "CHARSTOCKSOLUTION"
                    str3 = "tblMethodValidationData"
                    var1 = str3
                Case 20
                    int1 = 618
                    str1 = "Spiking Solution Stability"
                    int2 = 38
                    str2 = "CHARSPIKING"
                    str3 = "tblMethodValidationData"
                    var1 = str3
                Case 21
                    int1 = 619
                    str1 = "Autosampler Stability"
                    int2 = 38
                    str2 = "CHARAUTOSAMPLER"
                    str3 = "tblMethodValidationData"
                    var1 = str3
                Case 22
                    int1 = 620
                    str1 = "Batch Reinjection Stability"
                    int2 = 37
                    str2 = "CHARBATCHREINJECTION"
                    str3 = "tblMethodValidationData"
                    var1 = str3


                Case 23 '20190305 LEE: Add additional autoassignsamples entries
                    int1 = 621
                    str1 = "Auto Assign Samples Label: New or Third Measurement"
                    int2 = 1
                    str2 = "CHARNEW2"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 24 '20190305 LEE: Add additional autoassignsamples entries
                    int1 = 622
                    str1 = "Auto Assign Samples Label: New or Fourth Measurement"
                    int2 = 1
                    str2 = "CHARNEW3"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 25
                    int1 = 623
                    str1 = "Auto Assign Samples Label: Run Identifier 3 (Optional)"
                    int2 = 1
                    str2 = "CHARRUNIDENTIFIER3"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3
                Case 26
                    int1 = 624
                    str1 = "Auto Assign Samples Label: Run Identifier 4 (Optional)"
                    int2 = 1
                    str2 = "CHARRUNIDENTIFIER4"
                    str3 = "TBLAUTOASSIGNSAMPLES"
                    str4 = str3

            End Select

            'check to see if data needs to be modified
            'strF = "CHARTABLEREFCOLUMNNAME = '" & str2 & "' AND CHARDATATABLENAME = '" & str3 & "'"
            '20190109 LEE: ?? Just filter for int1
            strF = "ID_TBLDATATABLEROWTITLES = " & int1
            Try
                Erase rows
                rows = tblDataTableRowTitles.Select(strF)
                If rows.Length = 0 Then
                    'add row
                    'strSQL = "INSERT INTO " & strT & " VALUES(" & int1 & ", '" & str3 & "', '" & str1 & "', " & int2 & ", '" & str4 & "', '" & str2 & "', -1, " & ReturnDate(dt) & ", NULL)"
                    ''ID_TBLDATATABLEROWTITLES	CHARDATATABLENAME	CHARROWNAME	INTORDER	CHARTABLEREF	CHARTABLEREFCOLUMNNAME	BOOLINCLUDE	UPSIZE_TS	CHARHOOK
                    Dim nr As DataRow = tblDataTableRowTitles.NewRow
                    nr.BeginEdit()
                    nr.Item("ID_TBLDATATABLEROWTITLES") = int1
                    nr.Item("CHARDATATABLENAME") = str3
                    nr.Item("CHARROWNAME") = str1
                    nr.Item("INTORDER") = int2
                    nr.Item("CHARTABLEREF") = var1
                    nr.Item("CHARTABLEREFCOLUMNNAME") = str2
                    nr.Item("BOOLINCLUDE") = -1
                    nr.Item("UPSIZE_TS") = dtNow
                    nr.EndEdit()

                    tblDataTableRowTitles.Rows.Add(nr)

                    boolSave = True

                End If
            Catch ex As Exception
                var3 = ex.Message
            End Try

        Next

        '20190215 LEE: Need to remove items
        For Count1 = 1 To 1

            Select Case Count1
                Case 1
                    str1 = "Freeze/Thaw Storage Conditions"
                    str2 = ""
            End Select

            strF = "CHARROWNAME = '" & str1 & "'"

            Try
                Erase rows
                rows = tblDataTableRowTitles.Select(strF)
                If rows.Length = 0 Then
                Else
                    boolSave = True
                    For Count2 = rows.Length - 1 To 0 Step -1
                        rows(Count2).Delete()
                    Next
                End If
            Catch ex As Exception

            End Try

        Next Count1

        ''20190215 LEE: Need to modify
        For Count1 = 1 To 1

            Select Case Count1
                Case 1
                    str1 = "Freeze/Thaw Stability in Matrix"
                    str2 = "Freeze/Thaw Stability"
                Case 2
                    str1 = ""
            End Select

            strF = "CHARROWNAME = '" & str1 & "'"

            Try
                Erase rows
                rows = tblDataTableRowTitles.Select(strF)
                If rows.Length = 0 Then
                Else
                    boolSave = True
                    For Count2 = rows.Length - 1 To 0 Step -1
                        rows(Count2).Item("CHARROWNAME") = str2
                    Next
                End If
            Catch ex As Exception

            End Try

        Next Count1


        If boolSave Then
            If boolGuWuOracle Then

                Try
                    ta_tblDataTableRowTitles.Update(tblDataTableRowTitles)
                Catch ex As DBConcurrencyException
                    'ds2005.TBLUSERACCOUNTS.Merge('ds2005.TBLUSERACCOUNTS, True)
                End Try

            ElseIf boolGuWuAccess Then

                Try
                    ta_tblDataTableRowTitlesAcc.Update(tblDataTableRowTitles)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                End Try

            ElseIf boolGuWuSQLServer Then

                Try
                    ta_tblDataTableRowTitlesSQLServer.Update(tblDataTableRowTitles)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                End Try

            End If
        End If


        '20170110 LEE: add Watson Run ID choices to every table that has it
        'tblReportTableHeaderConfig is a GetDataBy query
        'must set it to normal, then set back
        'ID_TBLCONFIGHEADERLOOKUP	ID_TBLCONFIGREPORTTABLES	CHARCOLUMNLABEL	INTORDER	CHARWATSONTABLE	CHARWATSONFIELD	BOOLDEFAULT	UPSIZE_TS

        tblReportTableHeaderConfig.Clear()
        tblReportTableHeaderConfig.AcceptChanges()
        tblReportTableHeaderConfig.BeginLoadData()
        If boolGuWuOracle Then
            ta_tblReportTableHeaderConfig.ClearBeforeFill = True
            ta_tblReportTableHeaderConfig.Fill(tblReportTableHeaderConfig)
        ElseIf boolGuWuAccess Then
            ta_tblReportTableHeaderConfigAcc.ClearBeforeFill = True
            ta_tblReportTableHeaderConfigAcc.Fill(tblReportTableHeaderConfig)
        ElseIf boolGuWuSQLServer Then
            ta_tblReportTableHeaderConfigSQLServer.ClearBeforeFill = True
            ta_tblReportTableHeaderConfigSQLServer.Fill(tblReportTableHeaderConfig)
        End If
        tblReportTableHeaderConfig.EndLoadData()
        Try
            int1 = tblReportTableHeaderConfig.Rows.Count 'DEBUG
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try


        boolSave = False

        Erase rows
        Dim boolGo As Boolean
        Dim strF1 As String
        Dim id As Int32

        '20190221 LEE: Need to set four items in TBLCONFIGHEADERLOOKUP and TBLREPORTTABLEHEADERCONFIG
        Dim arrID()
        ReDim arrID(4)
        'first do TBLCONFIGHEADERLOOKUP
        id = 2
        boolHit = False
        For Count1 = 1 To 4
            Select Case Count1
                Case 1
                    str1 = "Intercept"
                Case 2
                    str1 = "R-Squared"
                Case 3
                    str1 = "Slope"
                Case 4
                    str1 = "Weighting"
            End Select

            strF1 = "ID_TBLCONFIGREPORTTABLES = " & id & " AND CHARCOLUMNLABEL = '" & str1 & "' AND BOOLDEFAULT = -1"
            rows = tblConfigHeaderLookup.Select(strF1)
            If rows.Length = 0 Then
            Else
                arrID(Count1) = rows(0).Item("ID_TBLCONFIGHEADERLOOKUP")
                rows(0).BeginEdit()
                rows(0).Item("BOOLDEFAULT") = 0
                rows(0).EndEdit()
                boolSave = True
                boolHit = True
            End If
        Next

        'now do TBLREPORTTABLEHEADERCONFIG
        id = 2
        If boolHit Then
            For Count1 = 1 To 4
                Select Case Count1
                    Case 1
                        str1 = "Intercept"
                    Case 2
                        str1 = "R-Squared"
                    Case 3
                        str1 = "Slope"
                    Case 4
                        str1 = "Weighting"
                End Select

                strF1 = "ID_TBLCONFIGREPORTTABLES = " & id & " AND ID_TBLCONFIGHEADERLOOKUP = " & arrID(Count1) & " AND BOOLINCLUDE = -1"
                Try
                    rows = tblReportTableHeaderConfig.Select(strF1)
                    If rows.Length = 0 Then
                    Else
                        For Count2 = 0 To rows.Length - 1
                            rows(Count2).BeginEdit()
                            rows(Count2).Item("BOOLINCLUDE") = 0
                            rows(Count2).EndEdit()
                            boolSave = True
                        Next

                    End If
                Catch ex As Exception
                    var1 = var1
                End Try

            Next
        End If
     



        id = 248

        'get id1 from tblReportTableHeaderConfig
        Try
            Dim rowsA() As DataRow = tblReportTableHeaderConfig.Select("ID_TBLREPORTTABLEHEADERCONFIG > 0", "ID_TBLREPORTTABLEHEADERCONFIG ASC")
            id1 = rowsA(rowsA.Length - 1).Item("ID_TBLREPORTTABLEHEADERCONFIG")

            'get distinct
            Dim dvRTHC As DataView = New DataView(tblReportTableHeaderConfig)
            'Dim tblA As DataTable = dvRTHC.ToTable("tblA", True, "ID_TBLSTUDIES", "ID_TBLCONFIGREPORTTABLES")
            Dim tblA As DataTable = dvRTHC.ToTable("tblA", True, "ID_TBLSTUDIES")
            int1 = tblA.Rows.Count 'debug

            For Count1 = 1 To 50

                boolGo = False

                Select Case Count1

                    Case 3, 4, 7, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 29, 30, 31, 32, 33, 34
                        boolGo = True
                End Select

                If boolGo Then
                    id = id + 1
                    'first check to see if record exists
                    strF = "ID_TBLCONFIGHEADERLOOKUP = " & id
                    rows = tblConfigHeaderLookup.Select(strF)
                    If rows.Length = 0 Then
                        'add record
                        Dim nr As DataRow = tblConfigHeaderLookup.NewRow
                        nr.BeginEdit()
                        nr.Item("ID_TBLCONFIGHEADERLOOKUP") = id
                        nr.Item("ID_TBLCONFIGREPORTTABLES") = Count1
                        nr.Item("CHARCOLUMNLABEL") = "Watson Run ID"
                        nr.Item("INTORDER") = 1
                        nr.Item("CHARWATSONTABLE") = "NA"
                        nr.Item("CHARWATSONFIELD") = "NA"
                        nr.Item("BOOLDEFAULT") = -1
                        nr.Item("UPSIZE_TS") = dtNow
                        nr.EndEdit()

                        tblConfigHeaderLookup.Rows.Add(nr)

                        boolSave = True

                        'now add to tblReportTableHeaderConfig
                        'ID_TBLREPORTTABLEHEADERCONFIG	ID_TBLSTUDIES	ID_TBLCONFIGREPORTTABLES	ID_TBLCONFIGHEADERLOOKUP	CHARUSERLABEL	INTORDER	BOOLINCLUDE	UPSIZE_TS

                        For Count2 = 0 To tblA.Rows.Count - 1
                            'add record
                            id1 = id1 + 1
                            Dim nr1 As DataRow = tblReportTableHeaderConfig.NewRow
                            nr1.BeginEdit()
                            nr1.Item("ID_TBLREPORTTABLEHEADERCONFIG") = id1
                            nr1.Item("ID_TBLSTUDIES") = tblA.Rows(Count2).Item("ID_TBLSTUDIES")
                            nr1.Item("ID_TBLCONFIGREPORTTABLES") = Count1
                            nr1.Item("ID_TBLCONFIGHEADERLOOKUP") = id
                            nr1.Item("CHARUSERLABEL") = "Watson Run ID"
                            nr1.Item("INTORDER") = 1
                            nr1.Item("BOOLINCLUDE") = -1
                            nr1.Item("UPSIZE_TS") = dtNow
                            nr1.EndEdit()

                            boolSave = True

                            tblReportTableHeaderConfig.Rows.Add(nr1)
                        Next


                    End If
                End If

            Next


            '20170405 LEE:
            'now add items for Sample Concentrations Sort
            'and other tables

            For Count1 = 1 To 12

                Select Case Count1
                    Case 1
                        int1 = 269
                        str1 = "    (Subject Number)"
                        str2 = "DESIGNSUBJECT"
                        str3 = "DESIGNSUBJECTID"
                        int2 = 20
                        id = 5
                    Case 2
                        int1 = 270
                        str1 = "    (Group Number)"
                        str2 = "DESIGNSUBJECTGROUP"
                        str3 = "SUBJECTGROUPID"
                        int2 = 21
                        id = 5
                    Case 3
                        int1 = 271
                        str1 = "Dose Amount"
                        str2 = "DESIGNSUBJECTTREATMENT"
                        str3 = "DOSEAMOUNT"
                        int2 = 22
                        id = 5

                    Case 4
                        int1 = 272
                        str1 = "Sample Count"
                        str2 = "NA"
                        str3 = "NA"
                        int2 = 23
                        id = 5 'Sample Conc
                    Case 5
                        int1 = 273
                        str1 = "Sample Count"
                        str2 = "NA"
                        str3 = "NA"
                        int2 = 20 'ISR
                        id = 30


                    Case 6
                        '20171108 LEE: Added for Alturas
                        int1 = 274
                        str1 = "Instrument ID"
                        str2 = "ANALYTICALRUN" ' "NA"
                        str3 = "INSTGROUPNAME" '"NA"
                        int2 = 13
                        id = 1


                    Case 7
                        int1 = 275
                        str1 = "Custom ID"
                        str2 = "DESIGNSAMPLE" ' "NA"
                        str3 = "USERSAMPLEID" '"NA"
                        int2 = 14
                        id = 5

                    Case 8
                        int1 = 276
                        str1 = "Custom ID"
                        str2 = "DESIGNSAMPLE" ' "NA"
                        str3 = "USERSAMPLEID" '"NA"
                        int2 = 14
                        id = 6

                    Case 9
                        int1 = 277
                        str1 = "Custom ID"
                        str2 = "DESIGNSAMPLE" ' "NA"
                        str3 = "USERSAMPLEID" '"NA"
                        int2 = 14
                        id = 7

                    Case 10
                        int1 = 278
                        str1 = "Custom ID"
                        str2 = "NA"
                        str3 = "NA"
                        int2 = 14
                        id = 30

                    Case 11
                        int1 = 279
                        str1 = "Sample Name"
                        str2 = "NA"
                        str3 = "NA"
                        int2 = 2
                        id = 32

                        '20180419 LEE: look further down in 'do bulk Analysis Date' for next id2

                End Select

                strF = "ID_TBLCONFIGHEADERLOOKUP = " & int1
                Erase rows
                rows = tblConfigHeaderLookup.Select(strF)
                If rows.Length = 0 Then

                    Dim nr As DataRow = tblConfigHeaderLookup.NewRow
                    nr.BeginEdit()
                    nr.Item("ID_TBLCONFIGHEADERLOOKUP") = int1
                    nr.Item("ID_TBLCONFIGREPORTTABLES") = id
                    nr.Item("CHARCOLUMNLABEL") = str1
                    nr.Item("INTORDER") = int2
                    nr.Item("CHARWATSONTABLE") = str2
                    nr.Item("CHARWATSONFIELD") = str3
                    nr.Item("BOOLDEFAULT") = 0
                    nr.Item("UPSIZE_TS") = dtNow
                    nr.EndEdit()

                    tblConfigHeaderLookup.Rows.Add(nr)

                    boolSave = True

                End If

            Next

            'now add some new values to tblReportTableHeaderConfig
            'don't do 1 and 2 from above
            For Count1 = 3 To 11

                Select Case Count1

                    'Case 1
                    '    id = 5 'sample analysis
                    '    id2 = 271

                    'Case 2
                    '    id = 5 'sample analysis
                    '    id2 = 272

                    'Case 3
                    '    id = 5 'sample analysis
                    '    id2 = 272

                    'Case 4
                    '    id = 30 'ISR
                    '    id2 = 273


                    'Case 1
                    '    id = 5 'sample analysis
                    '    id2 = 269

                    'Case 2
                    '    id = 5 'sample analysis
                    '    id2 = 270

                    Case 3
                        id = 5 'sample analysis
                        id2 = 271
                        str1 = "Dose"
                    Case 4
                        id = 5 'sample analysis
                        id2 = 272
                        str1 = "Sample Count"

                    Case 5
                        id = 30 'sample analysis
                        id2 = 273
                        str1 = "Sample Count"

                    Case 6
                        '20171108 LEE: Added for Alturas
                        id = 1
                        id2 = 274
                        str1 = "Instrument ID"


                    Case 7
                        id = 5
                        id2 = 275
                        str1 = "Custom ID"

                    Case 8
                        id = 6
                        id2 = 276
                        str1 = "Custom ID"

                    Case 9
                        id = 7
                        id2 = 277
                        str1 = "Custom ID"

                    Case 10
                        id = 30
                        id2 = 278
                        str1 = "Custom ID"

                    Case 11
                        id = 32
                        'id2 = 278
                        '20180419 LEE:
                        id2 = 279
                        str1 = "Sample Name"


                        '20180419 LEE: look further down in 'do bulk Analysis Date' for next id2

                End Select

                strF = "ID_TBLCONFIGREPORTTABLES = " & id & " AND ID_TBLCONFIGHEADERLOOKUP = " & id2
                rows = tblReportTableHeaderConfig.Select(strF)

                If rows.Length = 0 Then
                    'add rows
                    For Count2 = 0 To tblA.Rows.Count - 1
                        'add record
                        id1 = id1 + 1
                        Dim nr1 As DataRow = tblReportTableHeaderConfig.NewRow
                        nr1.BeginEdit()
                        nr1.Item("ID_TBLREPORTTABLEHEADERCONFIG") = id1
                        nr1.Item("ID_TBLSTUDIES") = tblA.Rows(Count2).Item("ID_TBLSTUDIES")
                        nr1.Item("ID_TBLCONFIGREPORTTABLES") = id
                        nr1.Item("ID_TBLCONFIGHEADERLOOKUP") = id2
                        nr1.Item("CHARUSERLABEL") = str1
                        nr1.Item("INTORDER") = 20
                        nr1.Item("BOOLINCLUDE") = 0
                        nr1.Item("UPSIZE_TS") = dtNow
                        nr1.EndEdit()

                        boolSave = True

                        tblReportTableHeaderConfig.Rows.Add(nr1)
                    Next

                End If

            Next Count1

            'do bulk Analysis Date
            Dim intNextID As Int16 = 279 'do not change this!

            '20180808 LEE:
            'Bulk addition is because users want to be able to configure the text of 'Analysis Date'

            For Count1 = 1 To 38

                Select Case Count1

                    Case 2, 3, 4, 11, 12, 13, 17, 18, 19, 21, 22, 29, 31, 32, 33, 34, 35, 36, 37, 38


                        intNextID = intNextID + 1

                        int1 = intNextID
                        str1 = "Analysis Date"
                        str2 = "NA"
                        str3 = "NA"
                        int2 = 2
                        id = Count1

                        strF = "ID_TBLCONFIGHEADERLOOKUP = " & int1
                        Erase rows
                        rows = tblConfigHeaderLookup.Select(strF)
                        If rows.Length = 0 Then

                            Dim nr As DataRow = tblConfigHeaderLookup.NewRow
                            nr.BeginEdit()
                            nr.Item("ID_TBLCONFIGHEADERLOOKUP") = int1
                            nr.Item("ID_TBLCONFIGREPORTTABLES") = id
                            nr.Item("CHARCOLUMNLABEL") = str1
                            nr.Item("INTORDER") = int2
                            nr.Item("CHARWATSONTABLE") = str2
                            nr.Item("CHARWATSONFIELD") = str3
                            nr.Item("BOOLDEFAULT") = -1
                            nr.Item("UPSIZE_TS") = dtNow
                            nr.EndEdit()

                            tblConfigHeaderLookup.Rows.Add(nr)

                            boolSave = True

                        End If

                End Select

            Next Count1

            intNextID = 279 'do not change this!

            For Count1 = 1 To 38

                Select Case Count1

                    Case 2, 3, 4, 11, 12, 13, 17, 18, 19, 21, 22, 29, 31, 32, 33, 34, 35, 36, 37, 38

                        intNextID = intNextID + 1

                        int1 = intNextID
                        id = Count1
                        id2 = int1
                        str1 = "Analysis Date"

                        strF = "ID_TBLCONFIGREPORTTABLES = " & id & " AND ID_TBLCONFIGHEADERLOOKUP = " & id2
                        rows = tblReportTableHeaderConfig.Select(strF)

                        If rows.Length = 0 Then
                            'add rows
                            For Count2 = 0 To tblA.Rows.Count - 1
                                'add record
                                id1 = id1 + 1
                                Dim nr1 As DataRow = tblReportTableHeaderConfig.NewRow
                                nr1.BeginEdit()
                                nr1.Item("ID_TBLREPORTTABLEHEADERCONFIG") = id1
                                nr1.Item("ID_TBLSTUDIES") = tblA.Rows(Count2).Item("ID_TBLSTUDIES")
                                nr1.Item("ID_TBLCONFIGREPORTTABLES") = id
                                nr1.Item("ID_TBLCONFIGHEADERLOOKUP") = id2
                                nr1.Item("CHARUSERLABEL") = str1
                                nr1.Item("INTORDER") = 20
                                nr1.Item("BOOLINCLUDE") = -1
                                nr1.Item("UPSIZE_TS") = dtNow
                                nr1.EndEdit()

                                boolSave = True

                                tblReportTableHeaderConfig.Rows.Add(nr1)
                            Next

                        End If

                End Select

            Next Count1


            '****

            '20180420 LEE: Forgot tables 14 and 15
            Dim intNextIDO As Short = intNextID

            '20180808 LEE:
            'Why am I adding Analysis Date to all these tables?
            'Analysis date is in Run ID column

            For Count1 = 1 To 38

                Select Case Count1
                    Case 14, 15

                        intNextID = intNextID + 1

                        int1 = intNextID
                        str1 = "Analysis Date"
                        str2 = "NA"
                        str3 = "NA"
                        int2 = 2
                        id = Count1

                        strF = "ID_TBLCONFIGHEADERLOOKUP = " & int1
                        Erase rows
                        rows = tblConfigHeaderLookup.Select(strF)
                        If rows.Length = 0 Then

                            Dim nr As DataRow = tblConfigHeaderLookup.NewRow
                            nr.BeginEdit()
                            nr.Item("ID_TBLCONFIGHEADERLOOKUP") = int1
                            nr.Item("ID_TBLCONFIGREPORTTABLES") = id
                            nr.Item("CHARCOLUMNLABEL") = str1
                            nr.Item("INTORDER") = int2
                            nr.Item("CHARWATSONTABLE") = str2
                            nr.Item("CHARWATSONFIELD") = str3
                            nr.Item("BOOLDEFAULT") = -1
                            nr.Item("UPSIZE_TS") = dtNow
                            nr.EndEdit()

                            tblConfigHeaderLookup.Rows.Add(nr)

                            boolSave = True

                        End If

                End Select

            Next Count1

            intNextID = intNextIDO
            For Count1 = 1 To 38

                Select Case Count1
                    Case 14, 15

                        intNextID = intNextID + 1

                        int1 = intNextID
                        id = Count1
                        id2 = int1
                        str1 = "Analysis Date"

                        strF = "ID_TBLCONFIGREPORTTABLES = " & id & " AND ID_TBLCONFIGHEADERLOOKUP = " & id2
                        rows = tblReportTableHeaderConfig.Select(strF)

                        If rows.Length = 0 Then
                            'add rows
                            For Count2 = 0 To tblA.Rows.Count - 1
                                'add record
                                id1 = id1 + 1
                                Dim nr1 As DataRow = tblReportTableHeaderConfig.NewRow
                                nr1.BeginEdit()
                                nr1.Item("ID_TBLREPORTTABLEHEADERCONFIG") = id1
                                nr1.Item("ID_TBLSTUDIES") = tblA.Rows(Count2).Item("ID_TBLSTUDIES")
                                nr1.Item("ID_TBLCONFIGREPORTTABLES") = id
                                nr1.Item("ID_TBLCONFIGHEADERLOOKUP") = id2
                                nr1.Item("CHARUSERLABEL") = str1
                                nr1.Item("INTORDER") = 20
                                nr1.Item("BOOLINCLUDE") = -1
                                nr1.Item("UPSIZE_TS") = dtNow
                                nr1.EndEdit()

                                boolSave = True

                                tblReportTableHeaderConfig.Rows.Add(nr1)
                            Next

                        End If

                End Select

            Next Count1

            '****

            '20180808 LEE:
            'Back in 2017, there was a problem with Dose
            'Now tblReportTableHeaderConfig has a boat load of Dose
            Dim rowsD() As DataRow

            For Count1 = 1 To 38

                id1 = 271

                For Count4 = 0 To tblA.Rows.Count - 1

                    id2 = tblA.Rows(Count4).Item("ID_TBLSTUDIES")

                    strF = "ID_TBLCONFIGREPORTTABLES = " & Count1 & " AND ID_TBLCONFIGHEADERLOOKUP = " & id1 & " AND ID_TBLSTUDIES = " & id2
                    rowsD = tblReportTableHeaderConfig.Select(strF)
                    'delete all but last row
                    For Count2 = rowsD.Length - 2 To 0 Step -1
                        boolSave = True
                        rowsD(Count2).Delete()
                    Next Count2

                Next Count4

            Next Count1

            '*****

            '20180622 LEE: Add some more choices

            'first do tblConfigHeaderLookup

            intNextIDO = 301
            int1 = intNextIDO
            Dim intD As Short = 0

            For Count1 = 1 To 11

                int1 = int1 + 1
                intD = 0

                Select Case Count1
                    Case 1
                        str1 = "Year"
                        str2 = "DESIGNSUBJECTTREATMENT"
                        str3 = "YEAR"
                        int2 = 20
                        id = 5 'Sample Conc
                    Case 2
                        str1 = "Month"
                        str2 = "DESIGNSUBJECTTREATMENT"
                        str3 = "MONTH"
                        int2 = 21
                        id = 5 'Sample Conc
                    Case 3
                        str1 = "Week"
                        str2 = "DESIGNSUBJECTTREATMENT"
                        str3 = "WEEK"
                        int2 = 22
                        id = 5 'Sample Conc

                    Case 4
                        str1 = "Visit Text"
                        str2 = "DESIGNSUBJECTTREATMENT"
                        str3 = "VISITTEXT"
                        int2 = 23
                        id = 5 'Sample Conc

                    Case 5
                        str1 = "Year"
                        str2 = "DESIGNSUBJECTTREATMENT"
                        str3 = "YEAR"
                        int2 = 20
                        id = 6 'Reassay
                    Case 6
                        str1 = "Month"
                        str2 = "DESIGNSUBJECTTREATMENT"
                        str3 = "MONTH"
                        int2 = 21
                        id = 6 'Reassay
                    Case 7
                        str1 = "Week"
                        str2 = "DESIGNSUBJECTTREATMENT"
                        str3 = "WEEK"
                        int2 = 22
                        id = 6 'Reassay

                    Case 8
                        str1 = "Visit Text"
                        str2 = "DESIGNSUBJECTTREATMENT"
                        str3 = "VISITTEXT"
                        int2 = 23
                        id = 6 'Reassay


                    Case 9
                        str1 = "Time Text"
                        str2 = "DESIGNEVENTSAMPLETIME"
                        str3 = "TIMETEXT"
                        int2 = 24
                        id = 6 'Reassay
                    Case 10
                        str1 = "Group"
                        str2 = "DESIGNSUBJECTGROUP"
                        str3 = "SUBJECTGROUPNAME"
                        int2 = 25
                        id = 6 'Reassay

                    Case 11 '20190306 LEE: Need to add 'Label' entry in AdHocStabilityComparison
                        str1 = "Label"
                        str2 = "NA"
                        str3 = "NA"
                        int2 = 1
                        id = 32 'AdHocStabilityComparison
                        intD = -1

                        '20180419 LEE: look further down in 'do bulk Analysis Date' for next id2

                End Select

                strF = "ID_TBLCONFIGHEADERLOOKUP = " & int1
                Erase rows
                rows = tblConfigHeaderLookup.Select(strF)
                If rows.Length = 0 Then

                    Dim nr As DataRow = tblConfigHeaderLookup.NewRow
                    nr.BeginEdit()
                    nr.Item("ID_TBLCONFIGHEADERLOOKUP") = int1
                    nr.Item("ID_TBLCONFIGREPORTTABLES") = id
                    nr.Item("CHARCOLUMNLABEL") = str1
                    nr.Item("INTORDER") = int2
                    nr.Item("CHARWATSONTABLE") = str2
                    nr.Item("CHARWATSONFIELD") = str3
                    nr.Item("BOOLDEFAULT") = intD
                    nr.Item("UPSIZE_TS") = dtNow
                    nr.EndEdit()

                    tblConfigHeaderLookup.Rows.Add(nr)

                    boolSave = True

                End If

            Next

            '20190306 LEE:
            'for _32, need to change Watson Run ID to intOrder = 2
            Try
                strF = "ID_TBLCONFIGREPORTTABLES = 32 AND CHARCOLUMNLABEL = 'Watson Run ID'"
                rows = tblConfigHeaderLookup.Select(strF)
                If rows.Length = 0 Then
                Else
                    var1 = rows(0).Item("ID_TBLCONFIGHEADERLOOKUP")
                    strF1 = "ID_TBLCONFIGHEADERLOOKUP = " & var1 & " AND ID_TBLCONFIGREPORTTABLES = 32 AND INTORDER = 1"
                    Dim rows11() As DataRow = tblReportTableHeaderConfig.Select(strF1)
                    If rows11.Length = 0 Then
                    Else
                        boolSave = True
                        For Count1 = 0 To rows11.Length - 1
                            rows11(Count1).BeginEdit()
                            rows11(Count1).Item("INTORDER") = 2
                            rows11(Count1).EndEdit()
                        Next
                    End If

                End If
            Catch ex As Exception
                var1 = var1
            End Try
     

            'now do tblReportTableHeaderConfig
            id2 = intNextIDO

            '20190306 LEE: Hmm. Need to get maxid
            id1 = GetMaxID("TBLREPORTTABLEHEADERCONFIG", 1, False) - 1

            For Count1 = 1 To 11

                id2 = id2 + 1
                intD = 0
                int2 = 20

                Select Case Count1

                    'add some choices in Samples table 5
                    Case 1
                        id = 5
                        'id2 = 280
                        str1 = "Year"

                    Case 2
                        id = 5
                        'id2 = 281
                        str1 = "Month"

                    Case 3
                        id = 5
                        'id2 = 282
                        str1 = "Week"

                    Case 4
                        id = 5
                        'id2 = 283
                        str1 = "Visit Text"


                        'add some choices to Reassay table 6
                    Case 5
                        id = 6
                        'id2 = 284
                        str1 = "Year"

                    Case 6
                        id = 6
                        'id2 = 285
                        str1 = "Month"

                    Case 7
                        id = 6
                        'id2 = 286
                        str1 = "Week"

                    Case 8
                        id = 6
                        'id2 = 287
                        str1 = "Visit Text"

                    Case 9
                        id = 6
                        'id2 = 285
                        str1 = "Time Text"

                    Case 10
                        id = 6
                        'id2 = 286
                        str1 = "Group"

                    Case 11 '20190306 LEE: Need to add 'Label' entry in AdHocStabilityComparison
                        id = 32 'AdHocStabilityComparison
                        'id2 = 286
                        str1 = "Label"
                        intD = -1
                        int2 = 1

                        '20180419 LEE: look further down in 'do bulk Analysis Date' for next id2

                End Select

                strF = "ID_TBLCONFIGREPORTTABLES = " & id & " AND ID_TBLCONFIGHEADERLOOKUP = " & id2
                rows = tblReportTableHeaderConfig.Select(strF)

                Try
                    If rows.Length = 0 Then
                        'add rows
                        For Count2 = 0 To tblA.Rows.Count - 1
                            'add record
                            id1 = id1 + 1
                            Dim nr1 As DataRow = tblReportTableHeaderConfig.NewRow
                            nr1.BeginEdit()
                            nr1.Item("ID_TBLREPORTTABLEHEADERCONFIG") = id1
                            nr1.Item("ID_TBLSTUDIES") = tblA.Rows(Count2).Item("ID_TBLSTUDIES")
                            nr1.Item("ID_TBLCONFIGREPORTTABLES") = id
                            nr1.Item("ID_TBLCONFIGHEADERLOOKUP") = id2
                            nr1.Item("CHARUSERLABEL") = str1
                            nr1.Item("INTORDER") = int2
                            nr1.Item("BOOLINCLUDE") = intD
                            nr1.Item("UPSIZE_TS") = dtNow
                            nr1.EndEdit()

                            boolSave = True

                            tblReportTableHeaderConfig.Rows.Add(nr1)
                        Next

                    End If
                Catch ex As Exception
                    var1 = ex.Message
                    var1 = var1
                End Try


            Next Count1

            If boolSave Then

                Call PutMaxID("TBLREPORTTABLEHEADERCONFIG", id1)

                If boolGuWuOracle Then

                    Try
                        ta_tblConfigHeaderLookup.Update(tblConfigHeaderLookup)
                    Catch ex As DBConcurrencyException
                        'ds2005.TBLUSERACCOUNTS.Merge('ds2005.TBLUSERACCOUNTS, True)
                    End Try

                    Try
                        ta_tblReportTableHeaderConfig.Update(tblReportTableHeaderConfig)
                    Catch ex As DBConcurrencyException
                        'ds2005.TBLUSERACCOUNTS.Merge('ds2005.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuAccess Then

                    Try
                        ta_tblConfigHeaderLookupAcc.Update(tblConfigHeaderLookup)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                    Try
                        ta_tblReportTableHeaderConfigAcc.Update(tblReportTableHeaderConfig)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuSQLServer Then

                    Try
                        ta_tblConfigHeaderLookupSQLServer.Update(tblConfigHeaderLookup)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                    Try
                        ta_tblReportTableHeaderConfigSQLServer.Update(tblReportTableHeaderConfig)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                End If
            End If

            'put back
            tblReportTableHeaderConfig.Clear()
            tblReportTableHeaderConfig.AcceptChanges()
            If boolGuWuOracle Then
                'tblReportTableHeaderConfig = ta_tblReportTableHeaderConfig.GetDataBy_ID_TBLSTUDIES(id_tblStudies)
            ElseIf boolGuWuAccess Then
                tblReportTableHeaderConfig = ta_tblReportTableHeaderConfigAcc.GetDataBy_ID_TBLSTUDIES(id_tblStudies)
            ElseIf boolGuWuSQLServer Then
                tblReportTableHeaderConfig = ta_tblReportTableHeaderConfigSQLServer.GetDataBy_ID_TBLSTUDIES(id_tblStudies)
            End If
            int1 = tblReportTableHeaderConfig.Rows.Count 'DEBUG

        Catch ex As Exception

            var1 = ex.Message

        End Try


        'update tblTab1
        '20170404 LEE: tblTab1.CustomFieldCode should be boolincludeintemplate = -1
        boolSave = False
        strF = "ID_TBLTAB1 = 36"
        Dim rows3() As DataRow = tblTab1.Select(strF)
        var1 = NZ(rows3(0).Item("BOOLINCLUDEINTEMPLATE"), 0)

        If var1 = 0 Then
            rows3(0).BeginEdit()
            rows3(0).Item("BOOLINCLUDEINTEMPLATE") = -1
            rows3(0).EndEdit()
            boolSave = True
        End If

        If boolSave Then
            If boolGuWuOracle Then

                Try
                    ta_tblTab1.Update(tblTab1)
                Catch ex As DBConcurrencyException
                    'ds2005.tblTemplateAttributes.Merge('ds2005.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            ElseIf boolGuWuAccess Then

                Try
                    ta_tblTab1Acc.Update(tblTab1)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            ElseIf boolGuWuSQLServer Then

                Try
                    ta_tblTab1SQLServer.Update(tblTab1)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            End If
        End If


        'tblTemplate
        '20170404 LEE: Field Codes should be added to tblTemplateAttributes
        'first do default
        boolSave = False
        strF = "ID_TBLTEMPLATES = -1 AND ID_TBLTAB1 = 36"
        Dim rows1() As DataRow = tblTemplateAttributes.Select(strF)
        If rows1.Length = 0 Then
            Dim nr As DataRow = tblTemplateAttributes.NewRow
            nr.BeginEdit()
            nr.Item("ID_TBLTEMPLATES") = -1
            nr.Item("ID_TBLTAB1") = 36
            nr.Item("BOOLINCLUDE") = -1
            nr.EndEdit()
            tblTemplateAttributes.Rows.Add(nr)
            boolSave = True
        End If

        For Count1 = 0 To tblTemplates.Rows.Count - 1

            var1 = tblTemplates.Rows(Count1).Item("ID_TBLTEMPLATES")
            strF = "ID_TBLTEMPLATES = " & var1 & " AND ID_TBLTAB1 = 36"
            Dim rows2() As DataRow = tblTemplateAttributes.Select(strF)
            If rows2.Length = 0 Then
                Dim nr As DataRow = tblTemplateAttributes.NewRow
                nr.BeginEdit()
                nr.Item("ID_TBLTEMPLATES") = var1
                nr.Item("ID_TBLTAB1") = 36
                nr.Item("BOOLINCLUDE") = -1
                nr.EndEdit()
                tblTemplateAttributes.Rows.Add(nr)
                boolSave = True
            End If
        Next

        If boolSave Then
            If boolGuWuOracle Then

                Try
                    ta_tblTemplateAttributes.Update(tblTemplateAttributes)
                Catch ex As DBConcurrencyException
                    'ds2005.tblTemplateAttributes.Merge('ds2005.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            ElseIf boolGuWuAccess Then

                Try
                    ta_tblTemplateAttributesAcc.Update(tblTemplateAttributes)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            ElseIf boolGuWuSQLServer Then

                Try
                    ta_tblTemplateAttributesSQLServer.Update(tblTemplateAttributes)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            End If
        End If

        'tblFieldCodes
        '20190213 LEE: added comments
        'deleting some unneeded field codes here
        id2 = id
        boolSave = False
        Dim boolDoAll As Boolean

        For Count1 = 1 To 56

            boolDoAll = False
            Select Case Count1
                Case Is = 1
                    id2 = 68
                Case Is = 2
                    id2 = 69
                Case Is = 3
                    id2 = 70
                Case Is = 4
                    id2 = 77
                Case Is = 5
                    id2 = 114
                Case Is = 6
                    id2 = 115
                Case Is = 7
                    id2 = 116
                Case Is = 8
                    id2 = 117
                Case Is = 9
                    id2 = 118
                Case Is = 10
                    id2 = 119
                Case Is = 11
                    id2 = 120
                Case Is = 12
                    id2 = 121
                Case Is = 13
                    id2 = 131
                Case Is = 14
                    id2 = 133
                Case Is = 15
                    id2 = 135
                Case Is = 16
                    id2 = 137
                Case Is = 17
                    id2 = 139
                Case Is = 18
                    id2 = 141
                Case Is = 19
                    id2 = 143
                Case Is = 20
                    id2 = 158
                Case Is = 21
                    id2 = 159
                Case Is = 22 '[REGRESSIONTABLENUMBERSECTION]
                    id2 = 81
                Case Is = 23 '[CALSTDTABLENUMBERSECTION]
                    id2 = 82
                Case Is = 24 '[SAMPLETABLENUMBERSECTION]
                    id2 = 88
                Case Is = 25 '[QCTABLENUMBERSECTION]
                    id2 = 85

                Case Is = 26 '[REGRESSION]
                    id2 = 26
                Case Is = 27 '[WEIGHTING]
                    id2 = 27

                Case Is = 28 '[QCMEANACCURACYMIN]
                    id2 = 33
                Case Is = 29 '[QCMEANACCURACYMAX]
                    id2 = 34
                Case Is = 30 '[QCPRECISIONMIN]
                    id2 = 35
                Case Is = 31 '[QCPRECISIONMAX]
                    id2 = 36

                Case Is = 32 '[INTEGRATIONTYPE]
                    id2 = 43


                Case Is = 33 'roleSigBlock
                    id2 = 166
                Case Is = 34 'roleSigBlock
                    id2 = 167
                Case Is = 35 'roleSigBlock
                    id2 = 168
                Case Is = 36 'roleSigBlock
                    id2 = 169
                Case Is = 37 'roleSigBlock
                    id2 = 170
                Case Is = 38 'roleSigBlock
                    id2 = 171
                Case Is = 39 'roleSigBlock
                    id2 = 172

                Case Is = 40 '[NUMCOADREPLICATES]
                    id2 = 16

                    '20190203 LEE:
                Case Is = 41 '
                    boolDoAll = True
                    str1 = "[METHODREFRIGERATEDSTABILITYINMATRIX]"
                Case Is = 42 '
                    boolDoAll = True
                    str1 = "[METHODSTABILITYUNDERSTORAGECONDITIONS]"
                Case Is = 43
                    boolDoAll = True
                    str1 = "[ANTICOAGULANTMETHOD]"

                    '20190215 LEE:
                Case Is = 44
                    boolDoAll = True
                    str1 = "[FREEZETHAWSTORAGECOND]"
                Case Is = 45
                    boolDoAll = True
                    str1 = "[METHODDEMONSTRATEDFREEZE/THAWCYCLES]"
                Case Is = 46
                    boolDoAll = True
                    str1 = "[METHODFREEZETHAW]"
                Case Is = 47
                    boolDoAll = True
                    str1 = "[METHODMAXIMUMNUMBEROFFREEZE/THAWCYCLES]"
                Case Is = 48
                    boolDoAll = True
                    str1 = "[METHODPROTOCOLNUMBER]"
                Case Is = 49
                    boolDoAll = True
                    str1 = "[METHODMETHODVALIDATIONTITLE]"
                Case Is = 50
                    boolDoAll = True
                    str1 = "[METHODSPONSORMETHODVALIDATIONSTUDYNUMBER]"
                Case Is = 51
                    boolDoAll = True
                    str1 = "[CHARREPORTNUMBER]"

                    '20190222 LEE:
                Case Is = 52
                    boolDoAll = True
                    str1 = "[MAXRUNSIZE]" 'deprecated. Use CHARMAXRUNSIZE

                    '20190228 LEE:
                Case Is = 53
                    boolDoAll = True
                    str1 = "[REPLICATEDILUTIONQC]" 'deprecated. Use DILUTIONREPLICATESforAnalyte_
                Case Is = 54
                    boolDoAll = True
                    str1 = "[NUMDILFACTOR]" 'deprecated. Use DILUTIONFACTORforAnalyte_
                Case Is = 55
                    boolDoAll = True
                    str1 = "[NUMDILVALUE]" 'deprecated. Use DILUTIONVALUEforAnalyte_
                Case Is = 56
                    boolDoAll = True
                    str1 = "[NUMLINDILREPLICATES]" 'deprecated. Use DILUTIONREPLICATESforAnalyte_

            End Select

            If boolDoAll Then
                strF = "CHARFIELDCODE = '" & str1 & "'"
            Else
                strF = "ID_TBLFIELDCODES = " & id2
            End If

            Dim rows2() As DataRow = tblFieldCodes.Select(strF)
            If rows2.Length = 0 Then
            Else
                For Count2 = rows2.Length - 1 To 0
                    boolSave = True
                    rows2(Count2).BeginEdit()
                    rows2(Count2).Delete()
                    rows2(Count2).EndEdit()
                Next

            End If

        Next

        'update some values
        For Count1 = 1 To 1

            Select Case Count1
                Case 1
                    id1 = 164
                    str1 = "Returns a list of calibration standard concentrations for each analyte"
                    str2 = "5, 10, 30, 75, 200, 750, 1250, and 2000 ng/mL"

            End Select

            strF = "ID_TBLFIELDCODES = " & id1
            Dim rows2() As DataRow = tblFieldCodes.Select(strF)
            If rows2.Length = 0 Then
            Else
                Try
                    rows2(0).BeginEdit()
                    rows2(0).Item("CHARDESCRIPTION") = str1
                    rows2(0).Item("CHAREXAMPLE") = str2
                    rows2(0).EndEdit()
                Catch ex As Exception
                    var1 = var1
                End Try
                boolSave = True
             
            End If

        Next

        '20190212 LEE
        'update some more values
        For Count1 = 1 To 4

            Select Case Count1
                Case 1
                    str1 = "Method Validation - Assay Technique"
                    str2 = "[CHARANALMETHODTYPE]"
                    str3 = "HPLC-MS/MS"
                Case 2
                    str1 = "Method Validation - Validation Study Number"
                    str2 = "[FULLVALIDATIONNUMBER]"
                    str3 = "NA"

                    '20190220 LEE:
                Case 3
                    str1 = "Method Validation-Long-term Storage Stability"
                    str2 = "[CHARLTSTORSTAB]"
                    str3 = "NA"
                Case 4
                    str1 = "Field Code that returns the Long-term Storage Stability item from the Method Validation table"
                    str2 = "[METHODLONGTERMSTORAGESTABILITYINMATRIX]"
                    str3 = "NA"

            End Select

            strF = "CHARFIELDCODE = '" & str2 & "'"
            Dim rows2() As DataRow = tblFieldCodes.Select(strF)
            If rows2.Length = 0 Then
            Else
                Try
                    rows2(0).BeginEdit()
                    rows2(0).Item("CHARDESCRIPTION") = str1
                    rows2(0).Item("CHAREXAMPLE") = str3
                    rows2(0).EndEdit()
                Catch ex As Exception
                    var1 = var1
                End Try
                boolSave = True

            End If

        Next


        '20180828 LEE:
        'add some records
        intMaxID = GetMaxID("TBLFIELDCODES", 1, False)
        boolHit = False

        For Count1 = 1 To 38

            boolHit = False
            Select Case Count1

                Case Is = 1
                    str1 = "CHARDEMONSTRATEDFREEZETHAW"
                    str2 = "Method Validation-Freeze/Thaw Stability in Matrix"
                Case Is = 2
                    str1 = "CHARMAXNUMBERFREEZETHAW"
                    str2 = "Method Validation-Maximum # of Freeze/thaw Cycles"
                Case Is = 3
                    str1 = "CHARSTABILITYUNDERSTORAGECOND"
                    'str2 = "Method Validation-Stability under Storage Conditions"
                    '20181110 LEE:
                    str2 = "Bench-top Stability"
                Case Is = 4
                    str1 = "CHARSTABILITYMAXSTORAGEDUR"
                    str2 = "Method Validation-Is Stability >= Maximum Storage Duration"
                Case Is = 5
                    str1 = "CHARCORPORATESTUDYID"
                    str2 = "Method Validation-Validation Corporate Study/Project Number"
                Case Is = 6
                    str1 = "CHARPROTOCOLNUMBER"
                    str2 = "Method Validation-Validation Protocol Number"
                Case Is = 7
                    str1 = "CHARMETHODVALIDATIONTITLE"
                    str2 = "Method Validation-Validation Report Title"
                Case Is = 8
                    str1 = "CHARSPONSORMETHODVALIDATIONID"
                    str2 = "Method Validation-Sponsor Method Validation Study Number"
                Case Is = 9
                    str1 = "CHARSPONSORMETHVALTITLE"
                    str2 = "Method Validation-Sponsor Method Validation Title"
                Case Is = 10
                    str1 = "CHARASSAYDESCRIPTION"
                    str2 = "Method Validation-Extraction Procedure Description"
                Case Is = 11
                    str1 = "CHARLMTITLE"
                    str2 = "Method Validation-Lab Method Title"
                Case Is = 12
                    str1 = "CHARLMNUMBER"
                    str2 = "Method Validation-Lab Method Number"
                Case Is = 13
                    str1 = "NUMSAMPLESIZE"
                    str2 = "Method Validation-Sample Size"
                Case Is = 14
                    str1 = "CHARSAMPLESIZEUNITS"
                    str2 = "Method Validation-Sample Size Units"
                Case Is = 15
                    str1 = "CHARANTICOAGULANT"
                    str2 = "Method Validation-Anticoagulant/Preservative"
                Case Is = 16
                    str1 = "CHARSPECIES"
                    str2 = "Method Validation-Species"
                Case Is = 17
                    str1 = "CHARMATRIX"
                    str2 = "Method Validation-Matrix"
                Case Is = 18
                    str1 = "CHARMAXRUNSIZE"
                    str2 = "Method Validation-Maximum Run Size"
                Case Is = 19
                    str1 = "CHARANALMETHODTYPE"
                    str2 = "Method Validation-Analytical Method Type"
                    '20190212 LEE: This is confusing. I should say Method Validation-Assay Technique Type
                    str2 = "Method Validation-Assay Technique"
                Case Is = 20
                    str1 = "CHARQCCONC"
                    str2 = "Method Validation-QC Concentrations"
                Case Is = 21
                    str1 = "CHARCALIBRCONC"
                    str2 = "Method Validation-Standard Curve Concentrations"
                Case Is = 22
                    str1 = "CHARLLOQ"
                    str2 = "Method Validation-Lower Limit of Quantification"
                Case Is = 23
                    str1 = "CHARULOQ"
                    str2 = "Method Validation-Upper Limit of Quantification"
                Case Is = 24
                    str1 = "CHARAVERECANAL"
                    str2 = "Method Validation-Average Recovery of Analyte (%)"
                Case Is = 25
                    str1 = "CHARAVERECIS"
                    str2 = "Method Validation-Average Recovery of IS (%)"
                Case Is = 26
                    str1 = "CHARINTERQCACCRNG"
                    str2 = "Method Validation-Inter-day QC Accuracy Range (%Bias)"
                Case Is = 27
                    str1 = "CHARINTERQCPRECRNG"
                    str2 = "Method Validation-Inter-day QC Precision Range (%CV)"
                Case Is = 28
                    str1 = "CHARINTRAQCACCRNG"
                    str2 = "Method Validation-Intra-day QC Accuracy Range (%Bias)"
                Case Is = 29
                    str1 = "CHARINTRAQCPRECRNG"
                    str2 = "Method Validation-Intra-day QC Precision Range (%CV)"
                Case Is = 30
                    str1 = "CHARPROCSTABILITY"
                    str2 = "Method Validation-Process Stability"
                Case Is = 31
                    str1 = "CHARREFRSTAB"
                    'str2 = "Method Validation-Refrigerated Stability in Matrix" 'deprecated now Reinjection Stability 20181110
                    str2 = "Reinjection Stability"
                Case Is = 32
                    str1 = "CHARLTSTORSTAB"
                    'str2 = "Method Validation-Long-term Storage Stability in Matrix"
                    str2 = "Method Validation-Long-term Storage Stability" '20190220 LEE:
                Case Is = 33
                    str1 = "CHARDILINTEGR"
                    str2 = "Method Validation-Dilution Integrity"
                Case Is = 34
                    str1 = "CHARANALSELECT"
                    str2 = "Method Validation-Analyte Selectivity"
                Case Is = 35
                    str1 = "CHARISSELECT"
                    str2 = "Method Validation-Internal Standard Selectivity"
                Case Is = 36
                    str1 = "CHARVALREPORTNUM"
                    str2 = "Method Validation-Validation Report Number"
                Case Is = 37
                    str1 = "CHARFTSTORCOND"
                    str2 = "Method Validation-Freeze/Thaw Storage Conditions"


                    '20190203 LEE:
                Case Is = 38
                    str1 = "METHODASSAYTECHNIQUE"
                    str2 = "Method Validation - Assay Technique"

                    'Case Is = 39 '20190220 LEE: No. Use CHARVALREPORTNUM
                    '    str1 = "CHARREPORTNUMBER"
                    '    str2 = "Method Validation - Assay Technique"


                    '    '20190109 LEE
                    'Case 38
                    '    str1 = "CHARBLOOD"
                    '    str2 = "Whole Blood Stability"
                    'Case 39
                    '    str1 = "CHARSTOCKSOLUTION"
                    '    str2 = "Stock Solution Stability"
                    'Case 40
                    '    str1 = "CHARSPIKING"
                    '    str2 = "Spiking Solution Stability"
                    'Case 41
                    '    str1 = "CHARAUTOSAMPLER"
                    '    str2 = "Autosampler Stability"
                    'Case 42
                    '    str1 = "CHARBATCHREINJECTION"
                    '    str2 = "Batch Reinjection Stability"

                    '    '20190110 LEE: Add some more
                    'Case 43
                    '    str1 = "CHARFREEZETHAW"
                    '    str2 = "Freeze/Thaw Stability"
                    'Case 44
                    '    str1 = "CHARBENCHTOP"
                    '    str2 = "Bench Top Stability"
                    'Case 45
                    '    str1 = "CHARPROCESS"
                    '    str2 = "Extraction (Process) Stability"
                    'Case 46
                    '    str1 = "CHARREINJECTION"
                    '    str2 = "Reinjection Stability"
                    'Case 47
                    '    str1 = "CHARLONGTERM"
                    '    str2 = "Long Term Stability"

            End Select

            str3 = "[" & str1 & "]"
            strF = "CHARFIELDCODE = '" & str3 & "'"
            'Check
            Dim rowsFC() As DataRow = tblFieldCodes.Select(strF)
            If rowsFC.Length = 0 Then
                'add record
                intMaxID = intMaxID + 1

                Try
                    Dim nr As DataRow = tblFieldCodes.NewRow

                    nr.BeginEdit()
                    nr("ID_TBLFIELDCODES") = intMaxID
                    nr("CHARFIELDCODE") = str3
                    nr("CHARDESCRIPTION") = str2
                    nr("CHARTAB") = "NA"
                    nr("CHARTABLE") = "NA"
                    nr("CHAREXAMPLE") = "NA"
                    nr("CHARGROUP") = "Method Validation"
                    nr("UPSIZE_TS") = dtNow
                    nr("BOOLCUSTOM") = 0

                    nr.EndEdit()
                    tblFieldCodes.Rows.Add(nr)

                    boolHit = True

                Catch ex As Exception
                    var1 = var1
                End Try

            End If

        Next

        '20190110 LEE:
        'The following have been added dynamically in Sub AddExtraFieldCodes
        'But should be added once, so deprecate AddExtraFieldCodes and add permanently here

        Dim dtbl1 As DataTable = tblFieldCodes
        Dim strF3 As String
        Dim boolNFC As Boolean
        Dim boolDo As Boolean

        For Count1 = 1 To 23

            str1 = "NA" 'Tab
            str2 = "" 'Group
            str4 = "" 'Table
            boolDo = True

            Select Case Count1

                Case 1
                    str3 = "[UNKNOWNSAMPLEMAXCONC]"
                    str5 = "Field Code that returns the maximum value reported in a Sample Analysis study Sample Concentrations table"
                    str1 = "NA"
                    str2 = "Study Items"
                    str4 = "NA"
                Case 2
                    str3 = "[UNKNOWNSAMPLEMINCONC]"
                    str5 = "Field Code that returns the minimum value (or BQL) reported in a Sample Analysis study Sample Concentrations table"
                    str1 = "NA"
                    str2 = "Study Items"
                    str4 = "NA"
                Case 3
                    str3 = "[METHODPROCESSSTABILITY]"
                    str5 = "Field Code that returns the Process Stability item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 4
                    '20190213 LEE: Deprecate this field code. Now use METHODREINJECTION
                    boolDo = False
                    str3 = "[METHODREFRIGERATEDSTABILITYINMATRIX]"
                    'str5 = "Field Code that returns the Refrigerated Stability in Matrix item from the Method Validation table"'deprecated now Reinjection Stability 20181110
                    str5 = "Field Code that returns the Reinjection Stability in Matrix item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 5
                    str3 = "[METHODLONGTERMSTORAGESTABILITYINMATRIX]"
                    'str5 = "Field Code that returns the Long-term Storage Stability in Matrix item from the Method Validation table"
                    str5 = "Field Code that returns the Long-term Storage Stability item from the Method Validation table" '20190220 LEE:
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 6
                    str3 = "[METHODDILUTIONINTEGRITY]"
                    str5 = "Field Code that returns the Dilution Integrity item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 7
                    str3 = "[METHODANALYTESELECTIVITY]"
                    str5 = "Field Code that returns the Analyte Selectivity item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 8
                    str3 = "[METHODINTERNALSTANDARDSELECTIVITY]"
                    str5 = "Field Code that returns the Internal Standard Selectivity item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table

                Case 9
                    str3 = "[RPTS]"
                    str5 = "Field Code to designate that the beginning of a section to be repeated"
                    str1 = "Repeat" 'Tab
                    str2 = "Repeat" 'Group
                    str4 = "Repeat" 'Table
                Case 10
                    str3 = "[RPTE]"
                    str5 = "Field Code to designate that the end of a section to be repeated"
                    str1 = "Repeat" 'Tab
                    str2 = "Repeat" 'Group
                    str4 = "Repeat" 'Table

                Case 11
                    str3 = "[INTERNALSTANDARDRESP]"
                    str5 = "Field Code adds 'respectively' to the end of the list of Int Std."
                    str1 = "NA" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "NA" 'Table

                Case 12
                    str3 = "[ANALYTERESP]"
                    str5 = "Field Code adds 'respectively' to the end of the list of analytes."
                    str1 = "NA" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "NA" 'Table


                Case 13
                    str3 = "[INITIALANALYSISDATE]"
                    str5 = "Initial Analysis Date (start date of first analytical run)"
                    str1 = "NA" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "NA" 'Table

                Case 14
                    str3 = "[LASTANALYSISDATE]"
                    str5 = "Last Analysis Date (start date of last analytical run)"
                    str1 = "NA" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "NA" 'Table

                Case 15
                    str3 = "[CONTRIBUTINGPERSONNELTITLETABLE]"
                    str5 = "Returns a Contributing Personnel table that includes a tabbed Title for each person."
                    str1 = "NA" 'Tab
                    str2 = "Contributing Personnel" 'Group
                    str4 = "NA" 'Table


                    '20190110 LEE
                Case 16
                    str3 = "[METHODBLOOD]" 'X
                    'str5 = "Field Code that returns the Refrigerated Stability in Matrix item from the Method Validation table"'deprecated now Reinjection Stability 20181110
                    str5 = "Field Code that returns the Whole Blood Stability item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 17
                    str3 = "[METHODSTOCKSOLUTION]" 'X
                    str5 = "Field Code that returns the Stock Solution Stability item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 18
                    str3 = "[METHODSPIKINGSOLUTION]" 'X
                    str5 = "Field Code that returns the Spiking Solution Stability item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 19
                    str3 = "[METHODAUTOSAMPLER]" 'X
                    str5 = "Field Code that returns the Autosampler Stability item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 20
                    str3 = "[METHODREINJECTION]" 'X
                    str5 = "Field Code that returns the Reinjection Stability item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 21
                    str3 = "[METHODBATCHREINJECTION]" 'X
                    str5 = "Field Code that returns the Batch Reinjection Stability item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table


                    '20190110 LEE:
                Case 22
                    boolDo = False 'this is a replicate of CHARDEMONSTARTEDFREEZETHAW
                    str3 = "[METHODFREEZETHAW]" 'X
                    str5 = "Field Code that returns the Freeze/Thaw Stability item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table
                Case 23
                    str3 = "[METHODBENCHTOP]" 'X
                    str5 = "Field Code that returns the Bench Top Stability item from the Method Validation table"
                    str1 = "Method Validation Data" 'Tab
                    str2 = "Study Items" 'Group
                    str4 = "Method Validation" 'Table

                    'Legend:
                    'Case 200
                    '    'strFind = "[METHODPROCESSSTABILITY]"
                    'Case 201
                    '    'strFind = "[METHODREFRIGERATEDSTABILITYINMATRIX]"
                    'Case 202
                    '    'strFind = "[METHODLONGTERMSTORAGESTABILITYINMATRIX]"
                    'Case 203
                    '    'strFind = "[METHODDILUTIONINTEGRITY]"
                    'Case 204
                    '    'strFind = "[METHODANALYTESELECTIVITY]"
                    'Case 205
                    '    'strFind = "[METHODINTERNALSTANDARDSELECTIVITY]"

            End Select

            'see if str3 already exists
            strF3 = "CHARFIELDCODE = '" & str3 & "'"
            'Check
            Dim rowsFC() As DataRow = tblFieldCodes.Select(strF3)

            If rowsFC.Length = 0 And boolDo Then

                boolHit = True
                'Erase rows3
                'rows3 = dtbl1.Select(strF3)
                'int2 = rows3.Length
                'If int2 > 0 Then
                'Else

                'End If

                'str5 = "Field Code to REFERENCE Appendix/Figure: " & NZ(rows2(Count1).Item("CHARTITLE"), "NA") & " (Field Code ID = " & str1 & ")"
                Try
                    Dim newRow As DataRow = dtbl1.NewRow
                    newRow.BeginEdit()
                    intMaxID = intMaxID + 1
                    newRow("ID_TBLFIELDCODES") = intMaxID
                    newRow("CHARFIELDCODE") = str3
                    newRow("CHARDESCRIPTION") = str5 ' & " for Role " & str2
                    newRow("CHARTAB") = str1 'rows1(Count1).Item("CHARTAB")
                    newRow("CHARTABLE") = str4 ' "Unknown Sample Concentration" ' rows1(Count1).Item("CHARTABLE")
                    newRow("CHAREXAMPLE") = "NA" ' rows1(Count1).Item("CHAREXAMPLE")
                    newRow("CHARGROUP") = str2 ' "NA"
                    newRow("UPSIZE_TS") = dtNow
                    newRow("intAdded") = -1
                    newRow("BOOLCUSTOM") = 0
                    newRow.EndEdit()
                    dtbl1.Rows.Add(newRow)
                Catch ex As Exception

                End Try


            End If

        Next

        If boolHit Then
            Call PutMaxID("TBLFIELDCODES", intMaxID)
        End If

        If boolSave Then
            If boolGuWuOracle Then

                Try
                    ta_tblFieldCodes.Update(tblFieldCodes)
                Catch ex As DBConcurrencyException
                    'ds2005.tblTemplateAttributes.Merge('ds2005.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            ElseIf boolGuWuAccess Then

                Try
                    ta_tblFieldCodesAcc.Update(tblFieldCodes)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            ElseIf boolGuWuSQLServer Then

                Try
                    ta_tblFieldCodesSQLServer.Update(tblFieldCodes)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            End If
        End If


        'update a QC item
        Dim tblC As DataTable = tblConfigReportTables
        strF = "ID_tblConfigReportTables = 4"
        Dim rowsC() As DataRow = tblC.Select(strF)
        rowsC(0).BeginEdit()
        rowsC(0).Item("BOOLREQUIRESPERTEMP") = -1
        rowsC(0).EndEdit()

        If boolGuWuOracle Then

            Try
                ta_tblConfigReportTables.Update(tblConfigReportTables)
            Catch ex As DBConcurrencyException
                'ds2005.tblTemplateAttributes.Merge('ds2005.tblTemplateAttributes, True)
                var1 = var1
            End Try

        ElseIf boolGuWuAccess Then

            Try
                ta_tblConfigReportTablesAcc.Update(tblConfigReportTables)
            Catch ex As DBConcurrencyException
                'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                var1 = var1
            End Try

        ElseIf boolGuWuSQLServer Then

            Try
                ta_tblConfigReportTablesSQLServer.Update(tblConfigReportTables)
            Catch ex As DBConcurrencyException
                'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                var1 = var1
            End Try

        End If


        'tblCustomFieldCodes need to be numbered
        Dim boolUpdate As Boolean = False
        Try
            For Count1 = 0 To tblStudies.Rows.Count - 1
                var1 = tblStudies.Rows(Count1).Item("ID_TBLSTUDIES")
                strF = "ID_TBLSTUDIES = " & var1 & " AND INTORDER = 1 AND BOOLINCLUDE = -1"
                Dim rowsCF() As DataRow = tblCustomFieldCodes.Select(strF)
                If rowsCF.Length > 1 Then
                    'renumber
                    strF1 = "ID_TBLSTUDIES = " & var1 & " AND BOOLINCLUDE = -1"
                    STRS = "INTORDER ASC, ID_TBLCUSTOMFIELDCODES ASC"
                    Dim rowsCF1() As DataRow = tblCustomFieldCodes.Select(strF1, STRS)
                    For Count2 = 0 To rowsCF1.Length - 1
                        rowsCF1(Count2).BeginEdit()
                        rowsCF1(Count2).Item("INTORDER") = Count2 + 1
                        rowsCF1(Count2).EndEdit()
                        boolUpdate = True
                    Next
                End If
            Next
        Catch ex As Exception
            var1 = ex.Message
        End Try
      

        If boolUpdate Then
            If boolGuWuOracle Then

                Try
                    ta_tblCustomFieldCodes.Update(tblCustomFieldCodes)
                Catch ex As DBConcurrencyException
                    'ds2005.tblTemplateAttributes.Merge('ds2005.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            ElseIf boolGuWuAccess Then

                Try
                    ta_tblCustomFieldCodesAcc.Update(tblCustomFieldCodes)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            ElseIf boolGuWuSQLServer Then

                Try
                    ta_tblCustomFieldCodesSQLServer.Update(tblCustomFieldCodes)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                    var1 = var1
                End Try

            End If
        End If


        'update tblStudies
        Try
            boolUpdate = False
            strF = "CHARWATSONSTUDYNAME = 'MethodDev'"
            rows = tblStudies.Select(strF)
            If rows.Length = 0 Then
            Else
                rows(0).BeginEdit()
                rows(0).Item("INT_WATSONSTUDYID") = -1
                rows(0).Item("INT_WATSONPROJECTID") = -1
                rows(0).EndEdit()
                boolUpdate = True
            End If


            If rows.Length = 0 Then
            Else
                strF = "CHARWATSONSTUDYNAME = 'SampleAnalysis'"
                rows = tblStudies.Select(strF)
                rows(0).BeginEdit()
                rows(0).Item("INT_WATSONSTUDYID") = -2
                rows(0).Item("INT_WATSONPROJECTID") = -1
                rows(0).EndEdit()
                boolUpdate = True
            End If


            If boolUpdate Then
                If boolGuWuOracle Then

                    Try
                        ta_tblStudies.Update(tblStudies)
                    Catch ex As DBConcurrencyException
                        'ds2005.tblTemplateAttributes.Merge('ds2005.tblTemplateAttributes, True)
                        var1 = var1
                    End Try

                ElseIf boolGuWuAccess Then

                    Try
                        ta_tblStudiesAcc.Update(tblStudies)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                        var1 = var1
                    End Try

                ElseIf boolGuWuSQLServer Then

                    Try
                        ta_tblStudiesSQLServer.Update(tblStudies)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                        var1 = var1
                    End Try

                End If
            End If
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try


        '20181016 LEE:
        'need to ensure tblStudyDocAnalytes has entries in both charUserAnalyte and charUserIS
        Try

            'first look at Analyte
            boolUpdate = False
            strF = "CHARUSERANALYTE IS NULL AND ISINTSTD = 'No'"
            rows = TBLSTUDYDOCANALYTES.Select(strF)
            If rows.Length = 0 Then
            Else
                For Count1 = 0 To rows.Length - 1
                    var1 = NZ(rows(Count1).Item("ORIGINALANALYTEDESCRIPTION"), "NA")
                    rows(Count1).BeginEdit()
                    rows(Count1).Item("CHARUSERANALYTE") = var1
                    rows(Count1).EndEdit()
                    boolUpdate = True
                Next Count1

            End If

            'now look at IntStd
            strF = "CHARUSERIS IS NULL"
            rows = TBLSTUDYDOCANALYTES.Select(strF)
            If rows.Length = 0 Then
            Else
                For Count1 = 0 To rows.Length - 1
                    var1 = NZ(rows(Count1).Item("IntStd"), "NA")
                    rows(Count1).BeginEdit()
                    rows(Count1).Item("CHARUSERIS") = var1
                    rows(Count1).EndEdit()
                    boolUpdate = True
                Next Count1
            End If


            If boolUpdate Then
                If boolGuWuOracle Then

                    'Try
                    '    ta_TBLSTUDYDOCANALYTES.Update(TBLSTUDYDOCANALYTES)
                    'Catch ex As DBConcurrencyException
                    '    'ds2005.tblTemplateAttributes.Merge('ds2005.tblTemplateAttributes, True)
                    '    var1 = var1
                    'End Try

                ElseIf boolGuWuAccess Then

                    Try
                        ta_TBLSTUDYDOCANALYTESAcc.Update(TBLSTUDYDOCANALYTES)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                        var1 = var1
                    End Try

                ElseIf boolGuWuSQLServer Then

                    Try
                        ta_TBLSTUDYDOCANALYTESSQLSERVER.Update(TBLSTUDYDOCANALYTES)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.tblTemplateAttributes.Merge('ds2005Acc.tblTemplateAttributes, True)
                        var1 = var1
                    End Try

                End If
            End If


            'tblSummaryData updates
            'some TBLDATATABLEROWTITLES corrections
            boolSave = False

            For Count1 = 1 To 2

                boolTRCN = False
                boolOrder = False

                Select Case Count1

                    Case 1
                        var1 = 109
                        var2 = "Stability under Storage Conditions"
                        var3 = "Bench-top Stability"

                    Case 2
                        var1 = 228
                        var2 = "Refrigerated Stability in Matrix"
                        var3 = "Reinjection Stability"

                End Select

                strF = "ID_TBLDATATABLEROWTITLES = " & var1

                Try
                    Erase rows
                    rows = tblSummaryData.Select(strF)
                    If rows.Length > 0 Then
                        boolSave = True

                        'strF = "ID_TBLDATATABLEROWTITLES = " & var1
                        'Dim rowsA() As DataRow = tblSummaryData.Select(strF)

                        'For Count2 = 0 To rowsA.Length - 1
                        '    rowsA(Count2).BeginEdit()
                        '    rowsA(Count2).Item("CHARROWNAME") = var3
                        '    rowsA(Count2).EndEdit()
                        'Next Count2

                        For Count2 = 0 To rows.Length - 1
                            rows(Count2).BeginEdit()
                            rows(Count2).Item("CHARROWNAME") = var3
                            rows(Count2).EndEdit()
                        Next Count2

                      
                    End If
                Catch ex As Exception
                    var3 = ex.Message
                End Try

            Next

            '20190109 LEE:
            'Add more items to tblSummaryData
            For Count1 = 1 To 5

                boolTRCN = False
                boolOrder = False

                Select Case Count1

                    Case 1
                        var1 = 611
                        var2 = "Whole Blood Stability"
                        var3 = 35 'INTORDER
                    Case 2
                        var1 = 612
                        var2 = "Stock Solution Stability"
                        var3 = 35 'INTORDER
                    Case 3
                        var1 = 613
                        var2 = "Spiking Solution Stability"
                        var3 = 35 'INTORDER
                    Case 4
                        var1 = 614
                        var2 = "Autosampler Stability"
                        var3 = 35 'INTORDER
                    Case 5
                        var1 = 615
                        var2 = "Batch Reinjection Stability"
                        var3 = 34 'INTORDER

                End Select

                strF = "ID_TBLDATATABLEROWTITLES = " & var1

                Try
                    Erase rows
                    rows = tblSummaryData.Select(strF)
                    If rows.Length > 0 Then
                    Else
                        boolSave = True

                        'now add rows to tblSummaryData
                        Dim tblA As DataTable = tblStudies
                        Dim dt1 As Date = Now
                        For Count2 = 0 To tblStudies.Rows.Count - 1
                            id1 = tblStudies.Rows(Count2).Item("ID_TBLSTUDIES")
                            strF1 = "ID_TBLSTUDIES = " & id1 & " AND ID_TBLDATATABLEROWTITLES = " & var1
                            Dim rowsSD() As DataRow = tblSummaryData.Select(strF1)
                            If rowsSD.Length = 0 Then

                                Dim nr1 As DataRow = tblSummaryData.NewRow
                                nr1.BeginEdit()
                                nr1("ID_TBLSTUDIES") = id1
                                nr1("ID_TBLDATATABLEROWTITLES") = var1
                                nr1("INTORDER") = var3
                                nr1("CHARROWNAME") = var2
                                nr1("BOOLINCLUDE") = -1
                                nr1("UPSIZE_TS") = dt1
                                nr1.EndEdit()

                                tblSummaryData.Rows.Add(nr1)

                            End If
                        Next

                    End If
                Catch ex As Exception
                    var3 = ex.Message
                End Try

            Next


            If boolSave Then
                If boolGuWuOracle Then

                    Try
                        ta_tblSummaryData.Update(tblSummaryData)
                    Catch ex As DBConcurrencyException
                        'ds2005.TBLUSERACCOUNTS.Merge('ds2005.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuAccess Then

                    Try
                        ta_tblSummaryDataAcc.Update(tblSummaryData)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                ElseIf boolGuWuSQLServer Then

                    Try
                        ta_tblSummaryDataSQLServer.Update(tblSummaryData)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLUSERACCOUNTS.Merge('ds2005Acc.TBLUSERACCOUNTS, True)
                    End Try

                End If
            End If

        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try
        
        var1 = var1

    End Sub

    Sub DatabaseUpdatePreConnection(con As ADODB.Connection)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim var1, var2

        Dim rs As New ADODB.Recordset

        '20161217 LEE: correct problem in AddProjects tblAutoassignsamples

        str1 = "SELECT TBLREPORTTABLE.ID_TBLSTUDIES, TBLREPORTTABLE.CHARHEADINGTEXT, TBLAUTOASSIGNSAMPLES.ID_TBLREPORTTABLE, TBLREPORTTABLE.ID_TBLREPORTTABLE, TBLAUTOASSIGNSAMPLES.ID_TBLCONFIGREPORTTABLES, TBLREPORTTABLE.ID_TBLCONFIGREPORTTABLES, IIf([TBLAUTOASSIGNSAMPLES].[ID_TBLCONFIGREPORTTABLES]=[TBLREPORTTABLE].[ID_TBLCONFIGREPORTTABLES],-1,0) AS DIFF "
        str2 = "FROM TBLAUTOASSIGNSAMPLES INNER JOIN TBLREPORTTABLE ON (TBLAUTOASSIGNSAMPLES.ID_TBLREPORTTABLE = TBLREPORTTABLE.ID_TBLREPORTTABLE) AND (TBLAUTOASSIGNSAMPLES.ID_TBLSTUDIES = TBLREPORTTABLE.ID_TBLSTUDIES) "
        str3 = "WHERE (((IIf([TBLAUTOASSIGNSAMPLES].[ID_TBLCONFIGREPORTTABLES]=[TBLREPORTTABLE].[ID_TBLCONFIGREPORTTABLES],-1,0))=0));"

        'str1 = "SELECT TBLREPORTTABLE.ID_TBLSTUDIES, TBLREPORTTABLE.CHARHEADINGTEXT, TBLAUTOASSIGNSAMPLES.ID_TBLREPORTTABLE, TBLREPORTTABLE.ID_TBLREPORTTABLE, TBLAUTOASSIGNSAMPLES.ID_TBLCONFIGREPORTTABLES AS AA_ICT, TBLREPORTTABLE.ID_TBLCONFIGREPORTTABLES AS RT_ICT, IIf([TBLAUTOASSIGNSAMPLES].[ID_TBLCONFIGREPORTTABLES]=[TBLREPORTTABLE].[ID_TBLCONFIGREPORTTABLES],-1,0) AS DIFF "
        'str2 = "FROM TBLAUTOASSIGNSAMPLES INNER JOIN TBLREPORTTABLE ON (TBLAUTOASSIGNSAMPLES.ID_TBLREPORTTABLE = TBLREPORTTABLE.ID_TBLREPORTTABLE) AND (TBLAUTOASSIGNSAMPLES.ID_TBLSTUDIES = TBLREPORTTABLE.ID_TBLSTUDIES) "
        'str3 = "WHERE (((IIf([TBLAUTOASSIGNSAMPLES].[ID_TBLCONFIGREPORTTABLES]=[TBLREPORTTABLE].[ID_TBLCONFIGREPORTTABLES],-1,0))=0));"

        strSQL = str1 & str2 & str3

        'Console.WriteLine(strSQL)

        Try
            rs.CursorLocation = CursorLocationEnum.adUseServer
            rs.Open(strSQL, con, CursorTypeEnum.adOpenDynamic, LockTypeEnum.adLockBatchOptimistic)
            'rs.ActiveConnection = Nothing
        Catch ex As Exception
            rs = Nothing
            GoTo end1
        End Try

        Dim int1 As Int64 = 0

        Try

            Do Until rs.EOF

                int1 = int1 + 1

                'var1 = rs.Fields("AA_ICT").Value
                'var2 = rs.Fields("RT_ICT").Value
                'rs.Fields("AA_ICT").Value = var2

                'TBLAUTOASSIGNSAMPLES.ID_TBLCONFIGREPORTTABLES, TBLREPORTTABLE.ID_TBLCONFIGREPORTTABLES

                var1 = rs.Fields("TBLAUTOASSIGNSAMPLES.ID_TBLCONFIGREPORTTABLES").Value
                var2 = rs.Fields("TBLREPORTTABLE.ID_TBLCONFIGREPORTTABLES").Value
                rs.Fields("TBLAUTOASSIGNSAMPLES.ID_TBLCONFIGREPORTTABLES").Value = var2

                rs.UpdateBatch()
                rs.MoveNext()
            Loop

            var1 = var1

            'rs.ActiveConnection = con
            rs.UpdateBatch()
            rs.Close()
            rs.ActiveConnection = Nothing
            rs = Nothing

            str1 = "SUCCESSFUL:" & ChrW(9) & "rsS.UpdateBatch: TBLREPORTTABLE: Sub DatabaseUpdatePreConnection"

        Catch ex As Exception

            str1 = "UNSUCCESSFUL:" & ChrW(9) & "rsS.UpdateBatch: TBLREPORTTABLE: Sub DatabaseUpdatePreConnection: Error: " & ex.Message
            rs = Nothing
            var1 = ex.Message

        End Try

        Call WriteInstall(str1)

end1:
    

    End Sub

    Sub CorrectOrder01()

        'ReportTemplate Permissions may be out of order
        Dim tbl As DataTable = tblDataTableRowTitles
        Dim strF As String

        strF = "ID_TBLDATATABLEROWTITLES = " & 544
        Dim rows() As DataRow = tbl.Select(strF)

        If rows.Length = 0 Then
        Else
            rows(0).BeginEdit()
            rows(0).Item("INTORDER") = 3
            rows(0).EndEdit()
            tbl.AcceptChanges()
        End If

    End Sub

    Sub SetPermissions(boolContinue As Boolean)

        Dim var1, var2

        Try

            If boolContinue Then
            Else
                GoTo doperm
            End If

            Dim rowsUA() As DataRow
            Dim rowsP() As DataRow
            Dim strF As String
            Dim Count1 As Short
            Dim str1 As String

            strF = "ID_TBLUSERACCOUNTS = " & idU 'id_tblUserAccounts
            rowsUA = tblUserAccounts.Select(strF)

            If rowsUA.Length = 0 Then
                boolContinue = False
            End If

            If boolContinue Then
            Else
                GoTo doperm
            End If

            Dim idPerm As Int64
            idPerm = rowsUA(0).Item("ID_TBLPERMISSIONS")

            strF = "ID_TBLPERMISSIONS = " & idPerm
            rowsP = tblPermissions.Select(strF)

            If rowsP.Length = 0 Then
                boolContinue = False
            End If

            If boolContinue Then
            Else
                GoTo doperm
            End If

DoPerm:

            If boolContinue Then


                For Count1 = 0 To tblPermissions.Columns.Count - 1

                    str1 = tblPermissions.Columns(Count1).ColumnName
                    Select Case str1

                        Case "BOOLHOME"
                            BOOLHOME = rowsP(0).Item(str1)
                        Case "BOOLDATA"
                            BOOLDATA = rowsP(0).Item(str1)
                        Case "BOOLANALRUNSUMMARYTABLE"
                            BOOLANALRUNSUMMARYTABLE = rowsP(0).Item(str1)
                        Case "BOOLSUMMARYTABLE"
                            BOOLSUMMARYTABLE = rowsP(0).Item(str1)
                        Case "BOOLREPORTTABLECONFIGURATION"
                            BOOLREPORTTABLECONFIGURATION = rowsP(0).Item(str1)
                        Case "BOOLREPORTTABLEHEADERCONFIG"
                            BOOLREPORTTABLEHEADERCONFIG = rowsP(0).Item(str1)
                        Case "BOOLANALREFSTANDARD"
                            BOOLANALREFSTANDARD = rowsP(0).Item(str1)
                        Case "BOOLCONTRIBUTINGPERSONNEL"
                            BOOLCONTRIBUTINGPERSONNEL = rowsP(0).Item(str1)
                        Case "BOOLREPORTBODYSECTIONS"
                            BOOLREPORTBODYSECTIONS = rowsP(0).Item(str1)
                        Case "BOOLMETHODVALIDATIONDATA"
                            BOOLMETHODVALIDATIONDATA = rowsP(0).Item(str1)
                        Case "BOOLQAEVENTTABLE"
                            BOOLQAEVENTTABLE = rowsP(0).Item(str1)
                        Case "BOOLSAMPLERECEIPT"
                            BOOLSAMPLERECEIPT = rowsP(0).Item(str1)
                        Case "BOOLAPPENDICES"
                            BOOLAPPENDICES = rowsP(0).Item(str1)
                        Case "BOOLADMINISTRATION"
                            BOOLADMINISTRATION = rowsP(0).Item(str1)
                        Case "BOOLUSERACCOUNTS"
                            BOOLUSERACCOUNTS = rowsP(0).Item(str1)
                        Case "BOOLDROPDOWNBOXCONFIGURATION"
                            BOOLDROPDOWNBOXCONFIGURATION = rowsP(0).Item(str1)
                        Case "BOOLCORPORATEADDRESSES"
                            BOOLCORPORATEADDRESSES = rowsP(0).Item(str1)
                        Case "BOOLREPORTTEMPLATEDEFINITIONS"
                            BOOLREPORTTEMPLATEDEFINITIONS = rowsP(0).Item(str1)
                        Case "BOOLGLOBALPARAMETERS"
                            BOOLGLOBALPARAMETERS = rowsP(0).Item(str1)
                        Case "BOOLALLOWREPORTGENERATION"
                            BOOLALLOWREPORTGENERATION = rowsP(0).Item(str1)
                        Case "BOOLHOOKS"
                            BOOLHOOKS = rowsP(0).Item(str1)
                        Case "BOOLALLOWPDFREPORT"
                            BOOLALLOWPDFREPORT = rowsP(0).Item(str1)
                        Case "BOOLADMINISTRATIONADMIN"
                            BOOLADMINISTRATIONADMIN = rowsP(0).Item(str1)
                        Case "BOOLGLOBALPARAMETERSADMIN"
                            BOOLGLOBALPARAMETERSADMIN = rowsP(0).Item(str1)
                        Case "BOOLSDPROJECTS"
                            BOOLSDPROJECTS = rowsP(0).Item(str1)
                        Case "BOOLSDSTUDIES"
                            BOOLSDSTUDIES = rowsP(0).Item(str1)
                        Case "BOOLSDASSAYS"
                            BOOLSDASSAYS = rowsP(0).Item(str1)
                        Case "BOOLCOMPLIANCEGLOBAL"
                            BOOLCOMPLIANCEGLOBAL = rowsP(0).Item(str1)
                        Case "BOOLASSIGNSAMPLES"
                            BOOLASSIGNSAMPLES = rowsP(0).Item(str1)
                        Case "BOOLADVANCEDTABLE"
                            BOOLADVANCEDTABLE = rowsP(0).Item(str1)
                        Case "BOOLCUSTOMFIELDCODES"
                            BOOLCUSTOMFIELDCODES = rowsP(0).Item(str1)
                        Case "BOOLFORCEWATERMARK"
                            BOOLFORCEWATERMARK = rowsP(0).Item(str1)
                        Case "BOOLPERMISSIONSMANAGER"
                            BOOLPERMISSIONSMANAGER = rowsP(0).Item(str1)
                        Case "BOOLEDITWORDTEMPLATE"
                            BOOLEDITWORDTEMPLATE = rowsP(0).Item(str1)
                        Case "BOOLVIEWWORDTEMPLATE"
                            BOOLVIEWWORDTEMPLATE = rowsP(0).Item(str1)
                        Case "BOOLSAMPLEDETAILS"
                            BOOLSAMPLEDETAILS = rowsP(0).Item(str1)
                        Case "BOOLRWAUDITTRAIL"
                            BOOLRWAUDITTRAIL = rowsP(0).Item(str1)
                        Case "BOOLCONSOLEAUDITTRAIL"
                            BOOLCONSOLEAUDITTRAIL = rowsP(0).Item(str1)
                        Case "BOOLCONSOLERW"
                            BOOLCONSOLERW = rowsP(0).Item(str1)
                        Case "BOOLALLOWRTEMPLATEPRINT"
                            BOOLALLOWRTEMPLATEPRINT = rowsP(0).Item(str1)
                        Case "BOOLALLOWFINALREPORTPRINT"
                            BOOLALLOWFINALREPORTPRINT = rowsP(0).Item(str1)
                        Case "BOOLALLOWFINALREPORTWORD"
                            BOOLALLOWFINALREPORTWORD = rowsP(0).Item(str1)
                        Case "BOOLALLOWREPORTTEMPLATEWORD"
                            BOOLALLOWREPORTTEMPLATEWORD = rowsP(0).Item(str1)
                        Case "BOOLVIEWFINALREPORT"
                            BOOLVIEWFINALREPORT = rowsP(0).Item(str1)
                        Case "BOOLALLOWREPORTTEMPLATEPDF"
                            BOOLALLOWREPORTTEMPLATEPDF = rowsP(0).Item(str1)
                        Case "BOOLEDITFINALREPORT"
                            BOOLEDITFINALREPORT = rowsP(0).Item(str1)
                        Case "BOOLFORCEFINALREPORTPDF"
                            BOOLFORCEFINALREPORTPDF = rowsP(0).Item(str1)
                    End Select
                Next

            Else

                BOOLHOME = False
                BOOLDATA = False
                BOOLANALRUNSUMMARYTABLE = False
                BOOLSUMMARYTABLE = False
                BOOLREPORTTABLECONFIGURATION = False
                BOOLREPORTTABLEHEADERCONFIG = False
                BOOLANALREFSTANDARD = False
                BOOLCONTRIBUTINGPERSONNEL = False
                BOOLREPORTBODYSECTIONS = False
                BOOLMETHODVALIDATIONDATA = False
                BOOLQAEVENTTABLE = False
                BOOLSAMPLERECEIPT = False
                BOOLAPPENDICES = False
                BOOLADMINISTRATION = False
                BOOLUSERACCOUNTS = False
                BOOLDROPDOWNBOXCONFIGURATION = False
                BOOLCORPORATEADDRESSES = False
                BOOLREPORTTEMPLATEDEFINITIONS = False
                BOOLGLOBALPARAMETERS = False
                BOOLALLOWREPORTGENERATION = False
                BOOLHOOKS = False
                BOOLALLOWPDFREPORT = False
                BOOLADMINISTRATIONADMIN = False
                BOOLGLOBALPARAMETERSADMIN = False
                BOOLSDPROJECTS = False
                BOOLSDSTUDIES = False
                BOOLSDASSAYS = False
                BOOLCOMPLIANCEGLOBAL = False
                BOOLASSIGNSAMPLES = False
                BOOLADVANCEDTABLE = False
                BOOLCUSTOMFIELDCODES = False
                BOOLFORCEWATERMARK = False
                BOOLPERMISSIONSMANAGER = False
                BOOLEDITWORDTEMPLATE = False
                BOOLVIEWWORDTEMPLATE = False
                BOOLSAMPLEDETAILS = False
                BOOLRWAUDITTRAIL = False
                BOOLCONSOLEAUDITTRAIL = False
                BOOLCONSOLERW = False
                BOOLALLOWRTEMPLATEPRINT = False
                BOOLALLOWFINALREPORTPRINT = False
                BOOLALLOWFINALREPORTWORD = False
                BOOLALLOWREPORTTEMPLATEWORD = False
                BOOLVIEWFINALREPORT = False
                BOOLALLOWREPORTTEMPLATEPDF = False
                BOOLEDITFINALREPORT = False
                BOOLFORCEFINALREPORTPDF = False

            End If

        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try


    End Sub

    Sub ControlDefaults(frm As Form)

        Dim allC As New List(Of Control)

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim numFSize As Single
        Dim var1
        Dim int1 As Int32
        Dim cmd As Button
        'make all fonts segoe ui

        Dim intRadius As Short = 25

        Call FindAllControlRecursive(allC, frm)

        ''console.writeline(frm.Name)

        Dim boolDo As Boolean

        Try
            int1 = 0
            For Each ctrl As Control In allC

                int1 = int1 + 1
                str1 = ctrl.Name
                str2 = Mid(str1, 1, 2)
                boolDo = True

                If StrComp(frm.Name, "frmConsole", CompareMethod.Text) = 0 Then
                    Select Case UCase(ctrl.Name)

                        Case "LBL1", "LBL1A", "LBL1B"
                            boolDo = False
                    End Select
                    'If StrComp(ctrl.Name, "lbl1", CompareMethod.Text) = 0 Or StrComp(ctrl.Name, "lbl1a", CompareMethod.Text) = 0 Or StrComp(ctrl.Name, "lbl1b", CompareMethod.Text) = 0 Then
                    '    boolDo = False
                    'End If
                ElseIf StrComp(str2, "gb", CompareMethod.Text) = 0 Then
                    boolDo = False 'ignore groupboxes
                Else

                End If

                If boolDo Then
                    If StrComp(str2, "dg", CompareMethod.Text) = 0 Then
                        'make datagrids and datagridviews all 9.75
                        numFSize = 9.75
                    Else
                        numFSize = ctrl.Font.Size
                        If numFSize < 9.75 Then
                            numFSize = 9.75
                        End If
                    End If

                    'Dim f As Font = New Font(ctrl.Font.FontFamily, 20.0F, ctrl.Font.Style)
                    Dim f As Font = New Font("Segoe UI", numFSize, ctrl.Font.Style)
                    Try
                        ctrl.Font = f
                    Catch ex As Exception
                        var1 = ex.Message
                    End Try

                    'check for button

                    'If StrComp(ctrl.GetType.ToString, "Button", CompareMethod.Text) = 0 Then
                    If InStr(ctrl.Name, "cmd", CompareMethod.Text) > 0 And StrComp(str2, "cm", CompareMethod.Text) = 0 Then

                        Select Case UCase(ctrl.Name)

                            Case "CMDOPENEXISTING"
                            Case "CMDINSERTNEW"
                            Case "CMDDATEUPDATE"

                            Case Else
                                cmd = ctrl
                                cmd.FlatStyle = FlatStyle.Flat
                                cmd.FlatAppearance.BorderSize = 0
                                cmd.UseVisualStyleBackColor = True

                                '20190221 LEE: Make round button corners
                                Try
                                    'Call buttonBorderRadius(cmd, intRadius)
                                Catch ex As Exception
                                    var1 = var1
                                End Try

                                Select Case UCase(ctrl.Name)

                                    Case "CMDLOGIN", "CMDCHANGEPASSWORD", "CMDABOUT"
                                        'boolDo = False
                                    Case Else
                                        cmd.BackColor = Color.Gainsboro
                                End Select

                                'If StrComp(cmd.Name, "cmdLogin", CompareMethod.Text) = 0 Or StrComp(cmd.Name, "cmdChangePassword", CompareMethod.Text) = 0 Then
                                'Else
                                '    cmd.BackColor = Color.Gainsboro
                                'End If
                        End Select

     

                    End If

                End If

            Next
        Catch ex As Exception
            var1 = ex.Message
        End Try

        Select Case UCase(frm.Name)
            Case "FRMHOME_01"
                Dim a
                a = frmH.gbRound5.Width
                frmH.gbCritPrecision.Width = a
                frmH.gbMeanComp.Width = a
        End Select

        var1 = int1

    End Sub

    Public Sub FindAllControlRecursive(ByRef list As List(Of Control), ByVal parent As Control)

        Dim var1

        Try
            If parent Is Nothing Then
                'Exit Sub
                var1 = var1
            Else
                list.Add(parent)
                ''console.writeline(parent.Name)
                For Each child As Control In parent.Controls
                    ''console.writeline(child.Name)
                    Call FindAllControlRecursive(list, child)
                Next
            End If
        Catch ex As Exception
            var1 = ex.Message
        End Try
        

    End Sub


    Public Function FindControlRecursive(ByVal list As List(Of Control), ByVal parent As Control, ByVal ctrlType As System.Type) As List(Of Control)

        If parent Is Nothing Then Return list
        If parent.GetType Is ctrlType Then
            list.Add(parent)
        End If
        For Each child As Control In parent.Controls
            FindControlRecursive(list, child, ctrlType)
        Next
        Return list

    End Function



    Sub LockSectionCheck()

        '20160416 LEE:
        'it was noticed that there are more than one instance of LOCKSECTION and UNLOCKSECTION in the StudyDoc database
        'AddRecords_TBLFIELDCODES_LOCKSECTION failed to check for the existance of the records before adding
        'AddRecords_TBLFIELDCODES_LOCKSECTION has been fixed
        'this sub will clear TBLFIELDCODES of the excess # of entries

        Dim dtbl As System.Data.DataTable = tblFieldCodes
        Dim Count1 As Short
        Dim Count2 As Short
        Dim str1 As String
        Dim strF As String
        Dim strS As String
        Dim intRecs As Short
        Dim rows() As DataRow
        Dim boolHit As Boolean = False
        Dim var1

        For Count1 = 1 To 2

            Select Case Count1
                Case 1
                    str1 = "[LOCKSECTION]"
                Case 2
                    str1 = "[UNLOCKSECTION]"
            End Select

            strF = "CHARFIELDCODE = '" & str1 & "'"
            strS = "ID_TBLFIELDCODES DESC"
            Try
                rows = dtbl.Select(strF, strS)
            Catch ex As Exception
                var1 = var1
            End Try


            intRecs = rows.Length

            If intRecs = 1 Then
            Else
                'should be one record
                'delete excess records
                boolHit = True
                For Count2 = intRecs To 2 Step -1
                    rows(Count2 - 1).Delete()
                Next
            End If

        Next

        If boolHit Then
            If boolGuWuOracle Then
                Try
                    ta_tblFieldCodes.Update(tblFieldCodes)
                Catch ex As DBConcurrencyException
                    'ds2005.TBLMAXID.Merge('ds2005.TBLMAXID, True)
                End Try
            ElseIf boolGuWuAccess Then
                Try
                    ta_tblFieldCodesAcc.Update(tblFieldCodes)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.TBLMAXID.Merge('ds2005Acc.TBLMAXID, True)
                End Try
            ElseIf boolGuWuSQLServer Then
                Try
                    ta_tblFieldCodesSQLServer.Update(tblFieldCodes)
                Catch ex As DBConcurrencyException
                    'ds2005Acc.TBLMAXID.Merge('ds2005Acc.TBLMAXID, True)
                End Try
            End If

        End If


    End Sub

    Sub EnableOVstuffReportTemplate(ov As AxEDOfficeLib.AxEDOffice)

        ov.DisableFileCommand(1, True) 'wdUIDisableOfficeButton 'v8
        ov.DisableFileCommand(2, True) 'wdUIDisableNew 'v8
        ov.DisableFileCommand(4, True) 'wdUIDisableOpen 'v8
        ov.DisableFileCommand(16, True) 'wdUIDisableSave
        ov.DisableFileCommand(32, True) 'wdUIDisableSaveAs

        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisablePrint, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableClose, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableOfficeButton, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableSendAsAttachment, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableSendMenu, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableClose, True)

        'ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisablePrintPreview, True)
        'ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisablePrint, True)

    End Sub

    Sub EnableOVstuffFinalReport(ov As AxEDOfficeLib.AxEDOffice)

        ov.DisableFileCommand(1, True) 'wdUIDisableOfficeButton 'v8
        ov.DisableFileCommand(2, True) 'wdUIDisableNew 'v8
        ov.DisableFileCommand(4, True) 'wdUIDisableOpen 'v8
        ov.DisableFileCommand(16, True) 'wdUIDisableSave
        ov.DisableFileCommand(32, True) 'wdUIDisableSaveAs

        'printing
        '20160614 LEE: Don't allow printing from the officeviewer object
        'Print exposes the File menu, which exposes functions we don't want to expose:
        '   Recent, New, Save and Send
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisablePrint, True)
        'ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisablePrintQuick, False)
        'ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisablePrintPreview, False)
        'allowing printpreview brings up file tab
        'must disable:
        'Save as PDF
        'Recent
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableOpen, True)
        'New
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableNew, True)
        'Save and Send
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableSaveAsMenu, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableSave, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableSendAsAttachment, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableSendMenu, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableSendAsAttachment, True)


        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableClose, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableOfficeButton, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableSendAsAttachment, True)
        ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisableSendMenu, True)


        'ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisablePrintPreview, True)
        'ov.DisableFileCommand(EDOfficeLib.WdUIType.wdUIDisablePrint, True)

        'From Edraw OfficeViewer v8.0 Users Guide:
        'wdUIDisableOfficeButton = 0x00000001,
        'wdUIDisableNew = 0x00000002,
        'wdUIDisableOpen = 0x00000004,
        'wdUIDisableUpgradeDocument = 0x00000008,
        'wdUIDisableSave = 0x00000010,
        'wdUIDisableSaveAs= 0x00000020,
        'wdUIDisableSendAsAttachment = 0x00000040,
        'wdUIDisableClose = 0x00000100,
        'wdUIDisablePrint = 0x00000200,
        'wdUIDisablePrintQuick = 0x00000400,
        'wdUIDisablePrintPreview = 0x00000800,
        'wdUIDisableSaveAsMenu = 0x00001000,
        'wdUIDisablePrepareMenu = 0x00002000,
        'wdUIDisablePermissionRestrictMenu = 0x00004000,
        'wdUIDisableSendMenu = 0x00008000,
        'wdUIDisablePublishMenu = 0x00010000,
        'wdUIDisableServerTasksMenu = 0x00020000,
        'wdUIDisableCopyButton = 0x00040000,
        'wdUIDisableCutButton = 0x00080000,
        'wdUIHideMenuHome = 0x01000000,
        'wdUIHideMenuInsert = 0x02000000,
        'wdUIHideMenuPageLayout = 0x04000000,
        'wdUIHideMenuReferences = 0x08000000,
        'wdUIHideMenuMailings = 0x10000000,
        'wdUIHideMenuReview = 0x20000000,
        'wdUIHideMenuView = 0x40000000,
        'wdUIHideMenuDeveloper = 0x80000000,
        'wdUIHideMenuAddIns = 0x00100000,
        'wdUIHideMenuFormat = 0x00200000,
        'wdUIHideMenuEdit = 0x00400000,
        'wdUIHideMenuTool = 0x00800000,



    End Sub

    Sub UpdateRSW()

        'updates dgvReportStatementWord for Active/Inactive
        Dim dgv As DataGridView = frmH.dgvReportStatementWord
        Dim dv As DataView = dgv.DataSource
        Dim strF As String = "CHARWORDSTATEMENT = 'Active'"
        dv.RowFilter = strF

    End Sub
    Sub CorrectActive()

        'change incorrect values in CHARWORDSTATEMENT
        Dim strF As String

        strF = "CHARWORDSTATEMENT <> 'Active' AND CHARWORDSTATEMENT <> 'Inactive'"

        Dim rows() As DataRow = tblWordStatements.Select(strF)

        If rows.Length = 0 Then
            GoTo end1
        End If

        'change values to 'Active'
        Dim Count1 As Int32
        Dim str1 As String = "Active"
        For Count1 = 0 To rows.Length - 1
            rows(Count1).BeginEdit()
            rows(Count1).Item("CHARWORDSTATEMENT") = str1
            rows(Count1).EndEdit()
        Next

        'update database

        If boolGuWuOracle Then
            Try
                ta_tblWordStatements.Update(tblWordStatements)
            Catch ex As DBConcurrencyException
                'ds2005.TBLWORDSTATEMENTS.Merge('ds2005.TBLWORDSTATEMENTS, True)
            End Try
        ElseIf boolGuWuAccess Then
            Try
                ta_tblWordStatementsAcc.Update(tblWordStatements)
            Catch ex As DBConcurrencyException
                'ds2005Acc.TBLWORDSTATEMENTS.Merge('ds2005Acc.TBLWORDSTATEMENTS, True)
            End Try
        ElseIf boolGuWuSQLServer Then
            Try
                ta_tblWordStatementsSQLServer.Update(tblWordStatements)
            Catch ex As DBConcurrencyException
                'ds2005Acc.TBLWORDSTATEMENTS.Merge('ds2005Acc.TBLWORDSTATEMENTS, True)
            End Try
        End If


end1:

    End Sub

    Sub WordWindow(wd As Microsoft.Office.Interop.Word.Application, strType As String)

        Dim vt
        Select Case strType
            Case "Normal"
                vt = Microsoft.Office.Interop.Word.WdViewType.wdNormalView
            Case "Print"
                vt = Microsoft.Office.Interop.Word.WdViewType.wdPrintView
        End Select

        wd.ActiveWindow.ActivePane.View.Type = vt


    End Sub

    Sub CheckAssSamples(intCt As Short) 'debug

        Exit Sub

        Dim Count1 As Int32
        Dim Count2 As Int32
        Dim var1, var2, var3
        Dim tbl1 As DataTable = tblAssignedSamples

        var1 = ""

        'console.writeline("Start CheckAssSamples: " & intCt)
        For Count1 = 0 To tbl1.Columns.Count - 1
            var2 = tbl1.Columns(Count1).ColumnName
            'console.writeline(var2)
        Next
        'console.writeline("End CheckAssSamples: " & intCt)

    End Sub

    Sub DoubleBufferControl(frm As Form, strControl As String)

        Dim strC As String
        Dim strC2 As String
        Dim strC3 As String
        Dim ctrl As Control
        Dim ctrlT As Control
        Dim strCT As String
        Dim tb As TabControl
        Dim tbp As TabPage
        Dim pan As Panel
        Dim panC As Control
        Dim intL As Short = Len(strControl)
        Dim strCtrlName As String

        For Each ctrl In frm.Controls
            strCtrlName = ctrl.Name
            strC = Mid(ctrl.Name, 1, intL)
            strC2 = Mid(ctrl.Name, 1, 2)
            strC3 = Mid(ctrl.Name, 1, 3)
            If StrComp(strC, strControl, CompareMethod.Text) = 0 Then
                Call modExtensionMethods.DoubleBufferedControl(ctrl, True)
            Else
                'check for pan or groupbox
                Select Case strC2
                    Case "gb"
                        Call DoubleBufferIterate(ctrl, strControl)
                End Select
                Select Case strC3
                    Case "pan", "tab"
                        Call DoubleBufferIterate(ctrl, strControl)
                End Select
                'If StrComp(strC2, "gb", CompareMethod.Text) = 0 Then
                '    Call DoubleBufferIterate(ctrl, strControl)
                'ElseIf StrComp(strC3, "pan", CompareMethod.Text) = 0 Then
                '    Call DoubleBufferIterate(ctrl, strControl)
                'ElseIf StrComp(strC3, "tab", CompareMethod.Text) = 0 Then
                '    Call DoubleBufferIterate(ctrl, strControl)
                'End If
            End If
        Next

    End Sub

    Sub DoubleBufferIterate(ctrl As Control, strControl As String)

        Dim strC As String
        Dim strC2 As String
        Dim strC3 As String
        Dim ctrlT As Control
        Dim strCT As String
        Dim tb As TabControl
        Dim tbp As TabPage
        Dim pan As Panel
        Dim panC As Control
        Dim intL As Short = Len(strControl)
        Dim strCtrlName As String

        Dim str1 As String = ctrl.Name


        For Each ctrlT In ctrl.Controls
            strCtrlName = ctrlT.Name
            strC = Mid(ctrlT.Name, 1, intL)
            strC2 = Mid(ctrlT.Name, 1, 2)
            strC3 = Mid(ctrlT.Name, 1, 3)
            If StrComp(strC, strControl, CompareMethod.Text) = 0 Then
                Call modExtensionMethods.DoubleBufferedControl(ctrlT, True)
            Else
                'check for pan or groupbox
                If StrComp(strC2, "gb", CompareMethod.Text) = 0 Then
                    Call DoubleBufferIterate(ctrlT, strControl)
                ElseIf StrComp(strC2, "gr", CompareMethod.Text) = 0 Then
                    Call DoubleBufferIterate(ctrlT, strControl)
                ElseIf StrComp(strC3, "pan", CompareMethod.Text) = 0 Then
                    Call DoubleBufferIterate(ctrlT, strControl)
                ElseIf StrComp(strC2, "tp", CompareMethod.Text) = 0 Then
                    Call DoubleBufferIterate(ctrlT, strControl)
                ElseIf StrComp(strC3, "tab", CompareMethod.Text) = 0 Then
                    Call DoubleBufferIterate(ctrlT, strControl)
                ElseIf StrComp(strC3, "dgv", CompareMethod.Text) = 0 Then '20180809 LEE: Added. dgv embedded in panel not getting set
                    Call DoubleBufferIterate(ctrlT, strControl)
                End If
            End If

        Next

    End Sub

    Sub dgvSetGroups(dgv As DataGridView)


        'Dim dgv As DataGridView = Me.dgvFormGroups
        Dim dtbl As DataTable = tblAnalyteGroups

        Dim dv As DataView = New DataView(dtbl, "", "", DataViewRowState.CurrentRows)

        dv.AllowDelete = False
        dv.AllowEdit = False
        dv.AllowNew = False

        dgv.DataSource = dv

        Dim Count1 As Short

        For Count1 = 1 To dgv.Columns.Count
            dgv.Columns(Count1 - 1).Visible = False
        Next

        '"ANALYTEDESCRIPTION", "ANALYTEID", "INTSTD", "INTGROUP", "ANALYTEDESCRIPTION_C", "MATRIX", "INTCALSET", "CALIBRSET"
        dgv.Columns("ANALYTEDESCRIPTION_C").Visible = True
        dgv.Columns("ANALYTEDESCRIPTION_C").HeaderText = "Analyte"
        dgv.Columns("ANALYTEDESCRIPTION_C").AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells
        dgv.Columns("ANALYTEDESCRIPTION_C").DisplayIndex = 1

        dgv.Columns("INTSTD").Visible = True
        dgv.Columns("INTSTD").HeaderText = "Int Std"
        dgv.Columns("INTSTD").AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells
        dgv.Columns("INTSTD").DisplayIndex = 2

        dgv.Columns("MATRIX").Visible = True
        dgv.Columns("MATRIX").HeaderText = "Matrix"
        dgv.Columns("MATRIX").AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells
        dgv.Columns("MATRIX").DisplayIndex = 3

        dgv.Columns("CALIBRSET").Visible = True
        dgv.Columns("CALIBRSET").HeaderText = "Calibration Set (Level Number)"
        dgv.Columns("CALIBRSET").AutoSizeMode = DataGridViewAutoSizeColumnMode.Fill
        dgv.Columns("CALIBRSET").DisplayIndex = 4



        dgv.DefaultCellStyle.WrapMode = DataGridViewTriState.False
        'dgv.RowsDefaultCellStyle.WrapMode = DataGridViewTriState.False
        dgv.RowsDefaultCellStyle.WrapMode = DataGridViewTriState.True
        dgv.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill
        dgv.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.AllCells
        dgv.AllowUserToResizeColumns = True
        dgv.AllowUserToResizeRows = True
        dgv.AutoResizeRows()
        dgv.AutoResizeColumns()


    End Sub

    Sub SaveLoginAttempt(arr1 As Array, con As ADODB.Connection, intAtt As Short, boolLogOff As Boolean, boolExit As Boolean)


        'arr1
        '1=UserIDAtt, 2=id_Userid (-1 if none), 3=dtAttempt, 4=boolSucUID (-1 or 0), 5=boolSucPswd (-1 or 0), 6=boolSucLogin (-1 or 0), 7=Comments

        Dim cmd As New ADODB.Command

        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String
        Dim intUB As Short
        Dim Count1 As Short
        Dim id1 As Int64
        Dim id2 As Int64
        Dim dt1 As Date
        Dim bool1 As Short
        Dim bool2 As Short
        Dim bool3 As Short
        Dim strC As String
        Dim strUID As String
        Dim strIP As String = ""
        Dim dtNow As Date = Now
        'ID_TBLLOGIN
        'ID_TBLUSERACCOUNTS
        'DTATTEMPT
        'CHARCOMPUTER
        'IPADDRESS
        'CHARATTUSERID
        'BOOLSUCCESSUID
        'BOOLSUCCESSPSWD
        'BOOLSUCCESSLOGIN
        'CHARCOMMENTS
        'DTTIMESTAMP

        id1 = GetMaxID("TBLLOGIN", 1, True) 'this number is max + 1

        With cmd
            .ActiveConnection = con
            If boolLogOff Or boolExit Then

                strUID = GetUserID() ' NZ(arrAtt(1, Count1), "None")
                id2 = idU ' id_tblUserAccounts ' idU ' NZ(arrAtt(2, Count1), -1)
                If id2 = 0 Then
                    id2 = -1
                End If
                dt1 = dtNow ' arrAtt(3, Count1)
                If id2 < 1 Then
                    bool1 = 0 ' arrAtt(4, Count1)
                    bool2 = 0 ' arrAtt(5, Count1)
                    bool3 = 0 ' arrAtt(6, Count1)
                Else
                    bool1 = -1 ' arrAtt(4, Count1)
                    bool2 = -1 ' arrAtt(5, Count1)
                    bool3 = -1 ' arrAtt(6, Count1)
                End If

                If boolExit Then
                    strC = "Exit StudyDoc" ' NZ(arrAtt(7, Count1), "No comments")
                Else
                    strC = "Logged out" ' NZ(arrAtt(7, Count1), "No comments")
                End If

                'If boolGuWuAccess Then
                '    str1 = "INSERT INTO TBLLOGIN VALUES (" & id1 & "," & id2 & ", NULL, '" & gWorkstation & "', '" & strIP & "', '" & strUID & "', " & bool1 & ", " & bool2 & ", " & bool3 & ", '" & strC & "',  #" & dtNow & "#, #" & dtNow & "#);"
                'ElseIf boolGuWuSQLServer Then
                '    str1 = "INSERT INTO TBLLOGIN VALUES (" & id1 & "," & id2 & ", NULL, '" & gWorkstation & "', '" & strIP & "', '" & strUID & "', " & bool1 & ", " & bool2 & ", " & bool3 & ", '" & strC & "',  #" & dtNow.ToString & "#, '" & dtNow.ToString & "');"
                'ElseIf boolGuWuOracle Then

                'End If

                str1 = "INSERT INTO TBLLOGIN VALUES (" & id1 & "," & id2 & ", NULL, '" & gWorkstation & "', '" & strIP & "', '" & strUID & "', " & bool1 & ", " & bool2 & ", " & bool3 & ", '" & strC & "',  " & ReturnDate(dtNow) & ", " & ReturnDate(dtNow) & ");"

                .CommandText = str1
                .CommandType = ADODB.CommandTypeEnum.adCmdText
                .Execute()

            Else
                For Count1 = 1 To intAtt

                    strUID = NZ(arr1(1, Count1), "None")
                    id2 = NZ(arr1(2, Count1), -1)
                    dt1 = arr1(3, Count1)
                    bool1 = arr1(4, Count1)
                    bool2 = arr1(5, Count1)
                    bool3 = arr1(6, Count1)
                    strC = NZ(arr1(7, Count1), "No comments")

                    'If boolGuWuAccess Then
                    '    str1 = "INSERT INTO TBLLOGIN VALUES (" & id1 & "," & id2 & ", #" & dt1 & "#, '" & gWorkstation & "', '" & strIP & "', '" & strUID & "', " & bool1 & ", " & bool2 & ", " & bool3 & ", '" & strC & "', NULL, #" & dtNow & "#);"
                    'ElseIf boolGuWuSQLServer Then
                    '    str1 = "INSERT INTO TBLLOGIN VALUES (" & id1 & "," & id2 & ", '" & dt1.ToString & "', '" & gWorkstation & "', '" & strIP & "', '" & strUID & "', " & bool1 & ", " & bool2 & ", " & bool3 & ", '" & strC & "', NULL, '" & dtNow.ToString & "');"
                    'ElseIf boolGuWuOracle Then

                    'End If

                    str1 = "INSERT INTO TBLLOGIN VALUES (" & id1 & "," & id2 & ", #" & dt1 & "#, '" & gWorkstation & "', '" & strIP & "', '" & strUID & "', " & bool1 & ", " & bool2 & ", " & bool3 & ", '" & strC & "', NULL, " & ReturnDate(dtNow) & ");"

                    .CommandText = str1
                    .CommandType = ADODB.CommandTypeEnum.adCmdText
                    .Execute()

                    id1 = id1 + 1

                Next
            End If


        End With

        cmd.ActiveConnection = Nothing

        Call PutMaxID("TBLLOGIN", id1)


    End Sub

    Sub SetDisplayAttachment()

        gboolDisplayAttachments = False

        Dim tbl1 As DataTable
        Dim strF As String
        Dim rowsS() As DataRow
        Dim intS As Short
        Dim var1

        'Word document template
        tbl1 = tblReports
        strF = "id_tblStudies = " & id_tblStudies
        rowsS = tbl1.Select(strF)
        intS = rowsS.Length

        If intS = 0 Then
        Else

            var1 = NZ(rowsS(0).Item("BOOLDISPLAYATTACHMENTS"), 0)
            If var1 = 0 Then
                gboolDisplayAttachments = False
            Else
                gboolDisplayAttachments = True
            End If

        End If

end1:


    End Sub

    Sub SetWordStuff(wdD As Microsoft.Office.Interop.Word.Document)

        'Dim wdDoc As Microsoft.Office.Interop.Word.Document
        wdD.Application.ShowWindowsInTaskbar = True
        wdD.Application.CustomizationContext = wdD.Application.NormalTemplate
        'KeyBindings.Add KeyCode:=BuildKeyCode(wdKeyS, wdKeyControl), KeyCategory:=wdKeyCategoryCommand, Command:="AddDigitalSignature"
        'wdDoc.Application.KeyBindings.Add(KeyCode:=BuildKeyCode(Microsoft.Office.Interop.Word.WdKey.wdKeyS, Microsoft.Office.Interop.Word.WdKey.wdKeyControl), KeyCategory:=Microsoft.Office.Interop.Word.WdKeyCategory.wdKeyCategoryCommand, Command:="AddDigitalSignature")
        'wdDoc.Application.KeyBindings.Add(KeyCode:=KeyBindings(Microsoft.Office.Interop.Word.WdKey.wdKeyS, Microsoft.Office.Interop.Word.WdKey.wdKeyControl), KeyCategory:=Microsoft.Office.Interop.Word.WdKeyCategory.wdKeyCategoryCommand, Command:="AddDigitalSignature")

        Dim bkc As Office.Interop.Word.KeyBindings
        bkc = wdD.Application.KeyBindings
        Dim bkb As Integer ' Office.Interop.Word.KeyBinding
        bkb = wdD.Application.BuildKeyCode(Office.Interop.Word.WdKey.wdKeyS, Office.Interop.Word.WdKey.wdKeyControl)
        'wdD.ApplicationKeyBindings.Add(KeyCode:=bkb, KeyCategory:=Microsoft.Office.Interop.Word.WdKeyCategory.wdKeyCategoryCommand, Command:="AddDigitalSignature")

    End Sub



    Sub RecordReportPrelim(frm As Form, strModule As String)

        Dim intR As Integer
        Dim strM As String

        strM = "This action will record the current settings for this form/window and apply these settings when opening the this form/window in the future."
        strM = strM & ChrW(10) & ChrW(10) & "Do you wish to continue?"
        intR = MsgBox(strM, vbInformation + vbYesNo, "Record settings...")

        If intR = 6 Then 'continue

            Call RecordReportTemplate(frm, strModule)

        End If


    End Sub


    Sub RecordReportTemplate(frm As Form, charModule As String)

        Dim var1, var2, var3
        Dim Count1 As Integer
        Dim Count2 As Integer
        Dim MaxID As Long
        Dim strF As String
        Dim strO As String
        Dim ctl As Windows.Forms.Control ' Control
        Dim str1 As String
        Dim str2 As String
        Dim boolOpt As Boolean
        Dim boolChk As Boolean
        Dim boolCbx As Boolean
        Dim boolStr As Boolean
        Dim con As New ADODB.Connection
        Dim rs As New ADODB.Recordset
        Dim boolGo As Boolean
        Dim gbx As Windows.Forms.GroupBox
        Dim chk As Windows.Forms.CheckBox


        Dim int1 As Short
        Dim int2 As Short

        Cursor.Current = Cursors.WaitCursor

        strO = "ID_TBLSECTIONTEMPLATES ASC"

        Dim dtbl As DataTable = TBLSECTIONTEMPLATES

        MaxID = GetMaxID("TBLSECTIONTEMPLATES", 1, True)

        'remove all items
        strF = "charModule = '" & charModule & "'"
        Dim rows() As DataRow = dtbl.Select(strF, strO)

        'delete all rows
        For Count1 = rows.Length - 1 To 0 Step -1

            rows(Count1).Delete()

        Next

        'add new data
        Dim strMatrix As String
        Dim boolIsIndex As Boolean
        Dim intIndex As Integer

        'chkExcludeEntireTableTitle
        'chkAdvSettings

        Select Case charModule

            Case "Report Prelim"

                'has 1 groupboxe full of checkboxes

                boolCbx = True
                boolGo = True
                intIndex = -1

                For Count1 = 1 To 1
                    Select Case Count1
                        Case 1
                            gbx = frm.Controls("gb1")
                    End Select

                    For Each ctl In gbx.Controls

                        'everything in here is a checkbox
                        Try
                            chk = ctl

                            MaxID = MaxID + 1
                            str1 = ctl.Name
                            str2 = Mid(str1, 1, 3)

                            If StrComp(str2, "chk", CompareMethod.Text) = 0 Then
                                var1 = ""
                                var2 = chk.Checked

                                Dim nr As DataRow = dtbl.NewRow
                                nr("ID_TBLSECTIONTEMPLATES") = MaxID
                                nr("CHARMODULE") = charModule
                                nr("CHARCONTROL") = str1
                                nr("NUMVALUE") = var2
                                nr("CHARSTRING") = var1
                                nr("INTINDEX") = 1
                                dtbl.Rows.Add(nr)

                                var2 = chk.CheckState

                            End If
                        Catch ex As Exception

                        End Try

next1:

                    Next

                Next

                'now do form itself
                For Each ctl In frm.Controls

                    Try
                        chk = ctl
                        MaxID = MaxID + 1
                        str1 = ctl.Name
                        str2 = Mid(str1, 1, 3)

                        If StrComp(str2, "chk", CompareMethod.Text) = 0 Then
                            var1 = ""
                            var2 = chk.Checked
                            Dim nr As DataRow = dtbl.NewRow
                            nr("ID_TBLSECTIONTEMPLATES") = MaxID
                            nr("CHARMODULE") = charModule
                            nr("CHARCONTROL") = str1
                            nr("NUMVALUE") = var2
                            nr("CHARSTRING") = var1
                            nr("INTINDEX") = 0
                            dtbl.Rows.Add(nr)
                        End If
                    Catch ex As Exception

                    End Try

next2:

                Next

            Case "Word Compare"

                gbx = frm.Controls("gbSettings")
                For Each ctl In gbx.Controls

                    'everything in here is a checkbox
                    Try
                        chk = ctl

                        MaxID = MaxID + 1
                        str1 = ctl.Name
                        str2 = Mid(str1, 1, 3)

                        If StrComp(str2, "chk", CompareMethod.Text) = 0 Then
                            var1 = ""
                            var2 = chk.Checked

                            Dim nr As DataRow = dtbl.NewRow
                            nr("ID_TBLSECTIONTEMPLATES") = MaxID
                            nr("CHARMODULE") = charModule
                            nr("CHARCONTROL") = str1
                            nr("NUMVALUE") = var2
                            nr("CHARSTRING") = var1
                            nr("INTINDEX") = 1
                            dtbl.Rows.Add(nr)

                            var2 = chk.CheckState

                        End If
                    Catch ex As Exception

                    End Try

                Next

        End Select

        Call PutMaxID("TBLSECTIONTEMPLATES", MaxID)

        'update database

        'TBLSECTIONTEMPLATES.AcceptChanges()

        Call FillAuditTrailTemp(TBLSECTIONTEMPLATES)

        If boolGuWuOracle Then
            'Try
            '    ta_TBLSECTIONTEMPLATES.Update(TBLSECTIONTEMPLATES)
            'Catch ex As DBConcurrencyException
            '    'ds2005Acc.TBLCONFIGURATION.Merge('ds2005Acc.TBLCONFIGURATION, True)
            'End Try
        ElseIf boolGuWuAccess Then
            Try
                ta_TBLSECTIONTEMPLATESAcc.Update(TBLSECTIONTEMPLATES)
            Catch ex As DBConcurrencyException
                'ds2005Acc.TBLCONFIGURATION.Merge('ds2005Acc.TBLCONFIGURATION, True)
            End Try
        ElseIf boolGuWuSQLServer Then
            Try
                ta_TBLSECTIONTEMPLATESSQLServer.Update(TBLSECTIONTEMPLATES)
            Catch ex As DBConcurrencyException
                'ds2005Acc.TBLCONFIGURATION.Merge('ds2005Acc.TBLCONFIGURATION, True)
            End Try
        End If

        Cursor.Current = Cursors.Default

        'MsgBox("Settings Saved", vbInformation, "Settings Saved...")


    End Sub

    Sub OpenWordDocs(id As Int64, intV As Int64)

        Dim rs As New ADODB.Recordset
        Dim con As New ADODB.Connection
        Dim constr As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strSQL As String

        If boolGuWuAccess Then
            constr = constrIni
        ElseIf boolGuWuSQLServer Then
            constr = constrIni ' "Provider=SQLOLEDB;" & constrIni
        ElseIf boolGuWuOracle Then
            constr = constrIniGuWuODBC
        End If

        con.Open(constr)

        If boolGuWuAccess Or boolGuWuSQLServer Or boolGuWuOracle Then
            str1 = "SELECT * FROM TBLWORDDOCS "
            str2 = "WHERE ID_TBLWORDSTATEMENTS = " & id & " AND INTWORDVERSION = " & intV
        End If

        strSQL = str1 & str2

        'clear tbl
        tblWorddocs.Clear()

        rs.CursorLocation = CursorLocationEnum.adUseClient
        rs.Open(strSQL, con, CursorTypeEnum.adOpenStatic, LockTypeEnum.adLockReadOnly)
        rs.ActiveConnection = Nothing
        tblWorddocs.Clear()
        tblWorddocs.AcceptChanges()
        tblWorddocs.BeginLoadData()
        daDoPr.Fill(tblWorddocs, rs)
        tblWorddocs.EndLoadData()
        rs.Close()

        rs = Nothing

        con.Close()
        con = Nothing

        Dim intL As Int64
        intL = tblWorddocs.Rows.Count 'debug
        intL = intL


    End Sub

    Sub ClearTemp()

        Try
            Dim var1, var2, var3

            Dim strPath As String
            strPath = "C:\LabIntegrity\StudyDoc\Temp\"

            If Directory.Exists(strPath) Then

                'do main directory
                Dim fileEntries As String() = Directory.GetFiles(strPath)
                ' Process the list of files found in the directory. 
                Dim fileName As String
                For Each fileName In fileEntries
                    Dim fi2 As FileInfo = New FileInfo(fileName)
                    'Ensure that the target does not exist.
                    Try
                        fi2.Delete()
                    Catch ex As Exception
                        'show message when debugging
                        'MsgBox(ex.Message)
                        var1 = ex.Message
                    End Try

                Next fileName

                'now do subdirectories
                Dim subdirectoryEntries As String() = Directory.GetDirectories(strPath)
                ' Recurse into subdirectories of this directory. 
                Dim subdirectory As String
                For Each subdirectory In subdirectoryEntries
                    Dim fileEntries1 As String() = Directory.GetFiles(subdirectory)
                    For Each fileName In fileEntries1
                        Dim fi2 As FileInfo = New FileInfo(fileName)
                        'Ensure that the target does not exist.
                        Try
                            fi2.Delete()
                        Catch ex As Exception

                        End Try

                    Next fileName
                Next subdirectory

            End If

            'do the same for TempReport
            strPath = "C:\LabIntegrity\StudyDoc\TempReport\"
            If Directory.Exists(strPath) Then

                'do main directory
                Dim fileEntries As String() = Directory.GetFiles(strPath)
                ' Process the list of files found in the directory. 
                Dim fileName As String
                For Each fileName In fileEntries
                    Dim fi2 As FileInfo = New FileInfo(fileName)
                    'Ensure that the target does not exist.
                    Try
                        fi2.Delete()
                    Catch ex As Exception
                        'show message when debugging
                        'MsgBox(ex.Message)
                        var1 = ex.Message
                    End Try

                Next fileName

                'now do subdirectories
                Dim subdirectoryEntries As String() = Directory.GetDirectories(strPath)
                ' Recurse into subdirectories of this directory. 
                Dim subdirectory As String
                For Each subdirectory In subdirectoryEntries
                    Dim fileEntries1 As String() = Directory.GetFiles(subdirectory)
                    For Each fileName In fileEntries1
                        Dim fi2 As FileInfo = New FileInfo(fileName)
                        'Ensure that the target does not exist.
                        Try
                            fi2.Delete()
                        Catch ex As Exception

                        End Try

                    Next fileName
                Next subdirectory

            End If
        Catch ex As Exception

        End Try
        

    End Sub


    Sub InsertLegend(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal idCRT As Int16, ByVal idRT As Int16, ByVal boolIsIS As Boolean, AnalyteID As Int64)


        Dim wrdSelection As Microsoft.Office.Interop.Word.Selection
        Dim strFirst As String
        Dim strNum As String
        Dim strDenom As String
        Dim intRows As Integer
        Dim tbl As System.Data.DataTable
        Dim rows() As DataRow
        Dim strF As String
        Dim boolNone As Boolean
        Dim numCols As Short
        Dim intLegText As Short
        Dim boolDoPF As Boolean = False 'Pass/Fail
        Dim boolDoPD As Boolean = False '%Difference
        Dim Count1 As Short
        Dim Count2 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String

        Dim intCol As Short
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short

        Dim BOOLCALCINTSTDNMF As Boolean = False '20180803 LEE: re-using BOOLCALCINTSTDNMF as Denominator choice

        'If (boolNONELEG And boolCUSTOMLEG = False) And idCRT <> 30 Then '30 = ISR
        ''20190108 LEE:
        ''MF table now has boolNoneLeg
        ''And ISR has option

        'If boolNONELEG And idCRT <> 30 Then '30 = ISR


        '    'If idCRT = 15 Then
        '    '    'check if matrix factor
        '    '    If BOOLMFTABLE Then
        '    '        'matrix factor has mandatory legend
        '    '    Else
        '    '        Exit Sub
        '    '    End If
        '    'Else
        '    '    Exit Sub
        '    'End If

        '    Exit Sub

        'End If

        If boolNONELEG Then
            Exit Sub
        End If

        Dim var1
        var1 = "a" 'debugging


        'If boolNONELEG Then
        '    Exit Sub
        'End If

        'wdd.visible = True

        tbl = tblTableProperties
        strF = "ID_TBLREPORTTABLE = " & idRT
        rows = tbl.Select(strF)

        Select Case idCRT
            Case 15 'Suppression/Enhancement
                intRows = 4
            Case 30 'ISR

                boolDoPF = HasISRPassFail(AnalyteID.ToString, idRT)

                If boolDoPF Then
                    intRows = 9 ' 8
                Else
                    intRows = 5 '4
                End If

                boolDoPD = HasISRPDifference(AnalyteID.ToString, idRT) '%Difference
                If boolDoPD Then
                Else
                    'skip entirely
                    GoTo end1
                End If
            Case Else
                intRows = 2
        End Select

        strFirst = StringRepDegC(NZ(rows(0).Item("CHARTITLELEG"), ""))
        strNum = StringRepDegC(NZ(rows(0).Item("CHARNUMLEG"), ""))
        strDenom = StringRepDegC(NZ(rows(0).Item("CHARDENLEG"), ""))

        Select Case idCRT
            Case 30 'ISR
                numCols = 4
                intLegText = 2
            Case Else
                If Len(strDenom) = 0 Then
                    intLegText = 2
                    numCols = 2
                Else
                    intLegText = 3
                    numCols = 4
                End If
        End Select

        'first add a paragraph return to separate from table
        'must do this because Word 2007 has a spaz if you don't
        Call SetNormalTable(wd)
        wd.Selection.TypeParagraph()
        Call SetNormalTable(wd)

        wrdSelection = wd.Selection()

        'wdd.visible = True

        Select Case idCRT
            Case 15
                If BOOLMFTABLE Then
                    If BOOLINCLMFCOLS Then
                        If BOOLINCLINTSTDNMF Then
                            'If BOOLCALCINTSTDNMF Then
                            '    'intEnd = 3
                            '    intRows = intRows + 6
                            'Else
                            '    '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated
                            '    intRows = intRows
                            'End If

                            'intEnd = 3
                            intRows = intRows + 6

                        Else
                            If BOOLCALCINTSTDNMF Then
                                'intEnd = 2
                                intRows = intRows + 3
                            Else

                                '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated

                                intRows = 0
                            End If

                        End If
                    Else
                        If BOOLINCLINTSTDNMF Then
                            If BOOLCALCINTSTDNMF Then
                                'intEnd = 2 'need a section to describe Matrix Factor
                                intRows = intRows + 3
                            Else

                                '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated

                                intRows = intRows
                            End If

                        Else
                            'intEnd = 0
                            intRows = 0 ' intRows
                        End If
                    End If
                Else
                    intRows = intRows
                End If
            Case Else
                intRows = intRows
        End Select

        If intRows = 0 Then
            GoTo end1
        End If

        With wd

            .ActiveDocument.Tables.Add(Range:=wrdSelection.Range, NumRows:=intRows, NumColumns:=numCols, AutoFitBehavior:=Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitFixed)

            With .Selection.Tables.Item(1)
                '.TopPadding = 0 'InchesToPoints(0)
                '.BottomPadding = 0 ' InchesToPoints(0)
                '.LeftPadding = 0 'InchesToPoints(0)
                '.RightPadding = 5.76 'InchesToPoints(0.08)
                '.Spacing = 0
                .AllowPageBreaks = False
                .AllowAutoFit = True
            End With

            .Selection.Tables.Item(1).Select()

            Call SetCellPadding(.Selection.Tables.Item(1))

            Call SetNormalTable(wd)
            Call removeAllBorders(wd, False)

            '.Selection.Font.Size = 9
            .Selection.Rows.AllowBreakAcrossPages = False

            ''do some line keeping together
            'If StrComp(strType, "Suppression", CompareMethod.Text) = 0 Then
            '    .Selection.Tables.Item(1).Cell(1, 1).Select()
            '    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
            '    .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=intRows - 2, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
            'Else
            '    .Selection.Tables.Item(1).Cell(1, 1).Select()
            '    .Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdRow, Extend:=True)
            '    .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=intRows - 2, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)

            'End If
            'With .Selection.ParagraphFormat
            '    .WidowControl = True
            '    .KeepWithNext = True
            '    .KeepTogether = True
            'End With

            Dim intEnd As Short = 1
            Select Case idCRT
                Case 30 'ISR
                    GoTo GoToISR
                Case 15
                    If BOOLMFTABLE Then
                        If BOOLINCLMFCOLS Then

                            '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated

                            If BOOLCALCINTSTDNMF Then
                                If BOOLINCLINTSTDNMF Then
                                    intEnd = 3
                                Else
                                    intEnd = 2
                                End If
                            Else

                                '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated

                                '20181015 LEE:
                                If BOOLINCLINTSTDNMF Then
                                    intEnd = 3
                                Else
                                    intEnd = 2
                                End If

                                'If BOOLINCLINTSTDNMF Then
                                '    intEnd = 1
                                'Else
                                '    intEnd = 0
                                'End If

                            End If

                        Else
                            If BOOLINCLINTSTDNMF Then
                                intEnd = 1
                            Else
                                intEnd = 0
                            End If
                        End If
                    End If
                Case Else

            End Select

            Dim boolOther As Boolean = False
            Dim intRow As Short = 1
            For Count1 = 1 To intEnd

                boolOther = False
                Select Case idCRT
                    Case 15
                        If BOOLMFTABLE Then
                            boolOther = True

                            If BOOLINCLMFCOLS Then
                                If BOOLINCLINTSTDNMF Then
                                    'intEnd = 3

                                    '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated
                                    Select Case Count1
                                        Case 1
                                            strFirst = "Matrix Factor (Analyte) ="
                                            If BOOLDOINDREC Then
                                                strNum = "Analyte Peak Area Post Extraction Spiking Solution"
                                                '20181202 LEE:
                                                If boolMeanRS Then
                                                    strDenom = "Mean Analyte Peak Area Recovery Solution"
                                                Else
                                                    strDenom = "Analyte Peak Area Recovery Solution"
                                                End If

                                            Else
                                                strNum = "Mean Analyte Peak Area Post Extraction Spiking Solution"
                                                strDenom = "Mean Analyte Peak Area Recovery Solution"
                                            End If
                                        Case 2
                                            strFirst = "Matrix Factor (Internal Standard) ="
                                            If BOOLDOINDREC Then
                                                strNum = "Internal Standard Peak Area Post Extraction Spiking Solution"
                                                If boolMeanRS Then
                                                    strDenom = "Mean Internal Standard Peak Area Recovery Solution"
                                                Else
                                                    strDenom = "Internal Standard Peak Area Recovery Solution"
                                                End If

                                            Else
                                                strNum = "Mean Internal Standard Peak Area Post Extraction Spiking Solution"
                                                strDenom = "Mean Internal Standard Peak Area Recovery Solution"
                                            End If
                                        Case 3
                                            strFirst = "Internal Standard-Normalized Matrix Factor ="
                                            If BOOLDOINDREC Then
                                                strNum = "Matrix Factor Analyte"
                                                strDenom = "Matrix Factor Internal Standard"
                                            Else
                                                strNum = "Mean Matrix Factor Analyte"
                                                strDenom = "Mean Matrix Factor Internal Standard"
                                            End If
                                    End Select

                                    'If BOOLCALCINTSTDNMF Then

                                    '    Select Case Count1
                                    '        Case 1
                                    '            strFirst = "Matrix Factor (Analyte) ="
                                    '            If BOOLDOINDREC Then
                                    '                strNum = "(Analyte Peak Area Post Extraction Spiking Solution)"
                                    '                strDenom = "(Analyte Peak Area Recovery Solution)"
                                    '            Else
                                    '                strNum = "(Mean Analyte Peak Area Post Extraction Spiking Solution)"
                                    '                strDenom = "(Mean Analyte Peak Area Recovery Solution)"
                                    '            End If
                                    '        Case 2
                                    '            strFirst = "Matrix Factor (Internal Standard) ="
                                    '            If BOOLDOINDREC Then
                                    '                strNum = "(Internal Standard Peak Area Post Extraction Spiking Solution)"
                                    '                strDenom = "(Internal Standard Peak Area Recovery Solution)"
                                    '            Else
                                    '                strNum = "(Mean Internal Standard Peak Area Post Extraction Spiking Solution)"
                                    '                strDenom = "(Mean Internal Standard Peak Area Recovery Solution)"
                                    '            End If
                                    '        Case 3
                                    '            strFirst = "Internal Standard-Normalized Matrix Factor ="
                                    '            If BOOLDOINDREC Then
                                    '                strNum = "(Matrix Factor Analyte)"
                                    '                strDenom = "(Matrix Factor Internal Standard)"
                                    '            Else
                                    '                strNum = "(Mean Matrix Factor Analyte)"
                                    '                strDenom = "(Mean Matrix Factor Internal Standard)"
                                    '            End If
                                    '    End Select
                                    '    'If Count1 = intEnd Then
                                    '    '    strFirst = NZ(rows(0).Item("CHARTITLELEG"), "")
                                    '    '    strNum = NZ(rows(0).Item("CHARNUMLEG"), "")
                                    '    '    strDenom = NZ(rows(0).Item("CHARDENLEG"), "")
                                    '    'End If
                                    'Else

                                    '    '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated

                                    '    strFirst = StringRepDegC(NZ(rows(0).Item("CHARTITLELEG"), ""))
                                    '    strNum = StringRepDegC(NZ(rows(0).Item("CHARNUMLEG"), ""))
                                    '    strDenom = StringRepDegC(NZ(rows(0).Item("CHARDENLEG"), ""))
                                    'End If

                                Else
                                    'intEnd = 2
                                    Select Case Count1
                                        Case 1
                                            strFirst = "Matrix Factor (Analyte) ="
                                            If BOOLDOINDREC Then
                                                strNum = "Analyte Peak Area Post Extraction Spiking Solution"
                                                If boolMeanRS Then
                                                    strDenom = "Mean Analyte Peak Area Recovery Solution"
                                                Else
                                                    strDenom = "Analyte Peak Area Recovery Solution"
                                                End If

                                            Else
                                                strNum = "Mean Analyte Peak Area Post Extraction Spiking Solution"
                                                strDenom = "Mean Analyte Peak Area Recovery Solution"
                                            End If

                                        Case 2
                                            strFirst = "Matrix Factor (Internal Standard) ="
                                            If BOOLDOINDREC Then
                                                strNum = "Internal Standard Peak Area Post Extraction Spiking Solution"
                                                If boolMeanRS Then
                                                    strDenom = "Mean Internal Standard Peak Area Recovery Solution"
                                                Else
                                                    strDenom = "Internal Standard Peak Area Recovery Solution"
                                                End If

                                            Else
                                                strNum = "Mean Internal Standard Peak Area Post Extraction Spiking Solution"
                                                strDenom = "Mean Internal Standard Peak Area Recovery Solution"
                                            End If

                                    End Select

                                End If

                            Else

                                If BOOLDOINDREC Then
                                    'intEnd = 2
                                    Select Case Count1
                                        Case 1
                                            strFirst = "Internal Standard-Normalized Matrix Factor ="
                                            strNum = "Peak Area Ratio Post Extraction Spiking Solution"
                                            If boolMeanRS Then
                                                strDenom = "Mean Peak Area Ratio Recovery Solution"
                                            Else
                                                strDenom = "Peak Area Ratio Recovery Solution"
                                            End If


                                    End Select
                                Else
                                    'intEnd = 2
                                    Select Case Count1
                                        Case 1
                                            strFirst = "Internal Standard-Normalized Matrix Factor ="
                                            strNum = "Mean Peak Area Ratio Post Extraction Spiking Solution"
                                            strDenom = "Mean Peak Area Ratio Recovery Solution"

                                    End Select
                                End If

                                'If BOOLINCLINTSTDNMF Then
                                '    If BOOLCALCINTSTDNMF Then

                                '        If BOOLDOINDREC Then
                                '            'intEnd = 2
                                '            Select Case Count1
                                '                Case 1
                                '                    strFirst = "Internal Standard-Normalized Matrix Factor ="
                                '                    strNum = "Peak Area Ratio Post Extraction Spiking Solution"
                                '                    strDenom = "Peak Area Ratio Recovery Solution"

                                '            End Select
                                '        Else
                                '            'intEnd = 2
                                '            Select Case Count1
                                '                Case 1
                                '                    strFirst = "Internal Standard-Normalized Matrix Factor ="
                                '                    strNum = "Mean Peak Area Ratio Post Extraction Spiking Solution"
                                '                    strDenom = "Mean Peak Area Ratio Recovery Solution"

                                '            End Select
                                '        End If

                                '    Else

                                '        '20161203 LEE: BOOLCALCINTSTDNMF = False has been deprecated

                                '        strFirst = StringRepDegC(NZ(rows(0).Item("CHARTITLELEG"), ""))
                                '        strNum = StringRepDegC(NZ(rows(0).Item("CHARNUMLEG"), ""))
                                '        strDenom = StringRepDegC(NZ(rows(0).Item("CHARDENLEG"), ""))
                                '    End If

                                'Else
                                '    'intEnd = 0
                                'End If

                            End If

                        Else
                            strFirst = StringRepDegC(NZ(rows(0).Item("CHARTITLELEG"), ""))
                            strNum = StringRepDegC(NZ(rows(0).Item("CHARNUMLEG"), ""))
                            strDenom = StringRepDegC(NZ(rows(0).Item("CHARDENLEG"), ""))
                        End If
                    Case Else
                        strFirst = StringRepDegC(NZ(rows(0).Item("CHARTITLELEG"), ""))
                        strFirst = Replace(strFirst, " =", fNBSP() & "=", 1, -1, CompareMethod.Text)
                        'Select Case idCRT
                        '    Case 32
                        '        strFirst = Replace(strFirst, " =", fNBSP() & "=", 1, -1, CompareMethod.Text)
                        'End Select
                        strNum = StringRepDegC(NZ(rows(0).Item("CHARNUMLEG"), ""))
                        strDenom = StringRepDegC(NZ(rows(0).Item("CHARDENLEG"), ""))
                End Select

                If boolOther Then
                Else

                    If Len(strNum) = 0 Then
                    Else
                        If boolIsIS Then
                            strNum = Replace(strNum, "Peak Response Ratio", "Peak Response", 1, -1, CompareMethod.Text)
                            strNum = Replace(strNum, "Peak Area Ratio", "Peak Area", 1, -1, CompareMethod.Text)

                            strNum = Replace(strNum, "Analyte/IS", "IS", 1, -1, CompareMethod.Text)
                            strNum = Replace(strNum, "Analyte/IntStd", "IntStd", 1, -1, CompareMethod.Text)
                            strNum = Replace(strNum, "Analyte/Internal Standard", "Internal Standard", 1, -1, CompareMethod.Text)

                        End If
                    End If

                    If Len(strDenom) = 0 Then
                    Else
                        If boolIsIS Then
                            strDenom = Replace(strDenom, "Peak Response Ratio", "Peak Response", 1, -1, CompareMethod.Text)
                            strDenom = Replace(strDenom, "Peak Area Ratio", "Peak Area", 1, -1, CompareMethod.Text)

                            strDenom = Replace(strDenom, "Analyte/IS", "IS", 1, -1, CompareMethod.Text)
                            strDenom = Replace(strDenom, "Analyte/IntStd", "IntStd", 1, -1, CompareMethod.Text)
                            strDenom = Replace(strDenom, "Analyte/Internal Standard", "Internal Standard", 1, -1, CompareMethod.Text)

                        End If
                    End If

                End If

                .Selection.Tables.Item(1).Cell(intRow, 1).Select()
                .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                If Len(strDenom) = 0 Then
                Else
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter
                End If

                Dim strSS As String
                strSS = ChrW(96 + Count1)
                Select Case idCRT
                    Case 15
                        If BOOLMFTABLE Then
                            Call typeInSuperscriptFontSize12NoSpace(wd, strSS)
                            .Selection.TypeText(Text:="  ")
                        End If
                    Case Else

                End Select
                .Selection.TypeText(Text:=strFirst)

                .Selection.Tables.Item(1).Cell(intRow, 2).Select()
                .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                If Len(strDenom) = 0 Then
                Else
                    .Selection.Font.Size = 20
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter
                    .Selection.TypeText(Text:="(")
                End If

                .Selection.Tables.Item(1).Cell(intRow, intLegText).Select()
                .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                '.Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter
                .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom

                .Selection.TypeText(Text:=strNum)

                ''I don't think this is needed
                'With .Selection.Cells(1)
                '    .TopPadding = 0 'InchesToPoints(0)
                '    .BottomPadding = 0 ' InchesToPoints(0)
                '    .LeftPadding = 5.76 'InchesToPoints(0.08)
                '    .RightPadding = 5.76 'InchesToPoints(0.08)
                '    .WordWrap = True
                '    .FitText = False
                'End With

                If Len(strDenom) = 0 Then
                Else
                    With .Selection.Borders(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                        .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                    End With
                End If

                If Len(strDenom) = 0 Then
                Else
                    .Selection.Tables.Item(1).Cell(intRow + 1, intLegText).Select()
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalTop
                    .Selection.TypeText(Text:=strDenom)
                    'With .Selection.Cells(1)
                    '    .TopPadding = 0 'InchesToPoints(0)
                    '    .BottomPadding = 0 ' InchesToPoints(0)
                    '    .LeftPadding = 5.76 'InchesToPoints(0.08)
                    '    .RightPadding = 5.76 'InchesToPoints(0.08)
                    '    .WordWrap = True
                    '    .FitText = False
                    'End With
                End If

                If Len(strDenom) = 0 Then
                Else
                    .Selection.Tables.Item(1).Cell(intRow, 4).Select()
                    .Selection.Font.Size = 20
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter
                    .Selection.TypeText(Text:=")")
                End If

                'size columns before merge to prevent movedown errors
                Call AutoFitTable(wd, True)


                'now merge
                If Len(strDenom) = 0 Then
                Else

                    'wdd.visible = True

                    'if the legend starts on the next page, then the first line.movedown action has a problem
                    'try sleeping for 1/2 second
                    System.Threading.Thread.Sleep(500)
                    'Hey! It worked!!

                    Try
                        .Selection.Tables.Item(1).Cell(intRow, 1).Select()
                        .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)

                        .Selection.Cells.Merge()
                    Catch ex As Exception
                        'MsgBox("1: " & ex.Message)
                    End Try

                    Try
                        .Selection.Tables.Item(1).Cell(intRow, 2).Select()
                        .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        .Selection.Cells.Merge()
                    Catch ex As Exception
                        'MsgBox("2: " & ex.Message)
                    End Try

                    Try

                        .Selection.Tables.Item(1).Cell(intRow, 4).Select()
                        .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        .Selection.Cells.Merge()

                        '.Selection.Tables.Item(1).cell(introw, 5).Select()
                        '.Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        '.Selection.Cells.Merge()
                    Catch ex As Exception
                        'MsgBox("3: " & ex.Message)
                    End Try

                End If

                If Count1 = intEnd Then
                Else
                    'Select Case idCRT
                    '    Case 15
                    '        If BOOLMFTABLE Then
                    '            intRow = intRow + 3
                    '        End If
                    '    Case Else
                    '        intRow = intRow + 3
                    'End Select
                    intRow = intRow + 3
                End If

            Next Count1


GoToISR:

            .Selection.Tables.Item(1).Select()




            Try

                Select Case idCRT
                    Case 15 'Supp/Enh
                        Dim c1 As Short
                        Dim c2 As Short
                        If BOOLMFTABLE Then
                            c1 = intRow + 2
                            c2 = c1 + 1
                        Else
                            c1 = 3
                            c2 = c1 + 1
                        End If
                        .Selection.Tables.Item(1).Cell(c1, 1).Select()
                        .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=2, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        .Selection.Cells.Merge()

                        .Selection.TypeText(Text:="Values > 1.00 indicate enhancement")

                        .Selection.Tables.Item(1).Cell(c2, 1).Select()
                        .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=2, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                        .Selection.Cells.Merge()

                        .Selection.TypeText(Text:="Values < 1.00 indicate suppression")

                        Call AutoFitTable(wd, True)

                    Case 30 'ISR

                        'only do if pass/fail column is shown
                        Dim numCrit As Decimal
                        numCrit = ReturnISRCrit1(CStr(AnalyteID), idRT)

                        If boolDoPF Then

                            'Start from bottom because row numbers get goofy when 1st cells are merged

                            'skip a row

                            'do %Difference
                            .Selection.Tables.Item(1).Cell(5, 4).Select()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="x 100")

                            .Selection.Tables.Item(1).Cell(6, intLegText).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalTop
                            strDenom = "(ISR Result + Original Result)/2"
                            .Selection.TypeText(Text:=strDenom)

                            .Selection.Tables.Item(1).Cell(5, intLegText).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                            strDenom = "ISR Result  Original Result"
                            .Selection.TypeText(Text:=strDenom)
                            With .Selection.Borders(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                            End With


                            .Selection.Tables.Item(1).Cell(5, 1).Select()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="%Difference" & fNBSP() & "=")


                            '***End % Difference

                            'do Pass/Fail
                            'skip a row
                            'enter text in reverse order because column and row numbers change upon merge

                            .Selection.Tables.Item(1).Cell(8, 4).Select()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="x 100")

                            .Selection.Tables.Item(1).Cell(9, intLegText).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalTop
                            strDenom = "Total Number of ISR Samples"
                            .Selection.TypeText(Text:=strDenom)

                            .Selection.Tables.Item(1).Cell(8, intLegText).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                            strDenom = "Total Number of ISR Samples That Pass"
                            .Selection.TypeText(Text:=strDenom)
                            With .Selection.Borders(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                            End With

                            .Selection.Tables.Item(1).Cell(8, 1).Select()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="ISR % Pass =")

                            'now do first rows

                            '.Selection.Tables.Item(1).Cell(1, 3).Select()
                            .Selection.Tables.Item(1).Cell(1, numCols).Select()

                            '.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            '.Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                            .Selection.TypeText(Text:=ChrW(8804) & numCrit)

                            .Selection.Tables.Item(1).Cell(1, 1).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=numCols - 1 - 1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="ISR acceptance for individual samples (%Difference):")
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom

                            .Selection.Tables.Item(1).Cell(2, 3).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:=ChrW(8805) & "2/3 (" & Format(RoundToDecimalRAFZ(2 / 3 * 100, 1), "0.0") & "%) of the individual ISR results pass")
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom

                            .Selection.Tables.Item(1).Cell(2, 1).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="Overall ISR Acceptance Criteria:")

                            .Selection.Tables.Item(1).Cell(3, 3).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            str1 = ctISRPass.ToString & "/" & ctISRTot.ToString & " = " & Format(RoundToDecimalRAFZ(numISRPercent, 1), strQCDec) & "%"
                            var1 = RoundToDecimalRAFZ(2 / 3 * 100, 1) 'debug
                            If numISRPercent >= RoundToDecimalRAFZ(2 / 3 * 100, 1) Then
                                str1 = str1 & ":  Pass"
                            Else
                                str1 = str1 & ":  Fail"
                            End If
                            .Selection.TypeText(Text:=str1)


                            .Selection.Tables.Item(1).Cell(3, 1).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="Overall ISR Acceptance Results:")


                            'now merge rows
                            'row 7 now only has 3 cols
                            .Selection.Tables.Item(1).Cell(8, 3).Select()
                            .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter

                            .Selection.Tables.Item(1).Cell(8, 1).Select()
                            .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter


                            'now merge rows
                            'row 4 now only has 3 cols
                            .Selection.Tables.Item(1).Cell(5, 3).Select()
                            .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter

                            .Selection.Tables.Item(1).Cell(5, 1).Select()
                            .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter

                        Else

                            'Start from bottom because row numbers get goofy when 1st cells are merged

                            'skip a row


                            'do %Difference
                            .Selection.Tables.Item(1).Cell(3, 4).Select()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="x 100")

                            .Selection.Tables.Item(1).Cell(4, intLegText).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalTop
                            strDenom = "(ISR Result + Original Result)/2"
                            .Selection.TypeText(Text:=strDenom)

                            .Selection.Tables.Item(1).Cell(3, intLegText).Select()
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                            strDenom = "ISR Result  Original Result"
                            .Selection.TypeText(Text:=strDenom)
                            With .Selection.Borders(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom)
                                .LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
                            End With


                            .Selection.Tables.Item(1).Cell(3, 1).Select()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="%Difference" & fNBSP() & "=")


                            '***End % Difference

                            'now do first rows



                            '.Selection.Tables.Item(1).Cell(1, 3).Select()
                            .Selection.Tables.Item(1).Cell(1, numCols).Select()

                            '.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            '.Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:=ChrW(8804) & numCrit)

                            .Selection.Tables.Item(1).Cell(1, 1).Select()
                            '.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=numCols - 1 - 1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.TypeText(Text:="ISR acceptance for individual samples (%Difference):")
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom

                            'now merge rows
                            'row 4 now only has 3 cols
                            .Selection.Tables.Item(1).Cell(3, 3).Select()
                            .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter

                            .Selection.Tables.Item(1).Cell(3, 1).Select()
                            .Selection.MoveDown(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdLine, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)
                            .Selection.Cells.Merge()
                            .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphLeft
                            .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalCenter


                        End If


                    Case Else

                        Call AutoFitTable(wd, True)

                End Select

            Catch ex As Exception

                'MsgBox(ex.Message)

            End Try



        End With

        '20180531 LEE:
        'Remove excess rows
        Try
            Call RemoveRows(wd, 1)
        Catch ex As Exception

        End Try

        '20180531 LEE:
        'RemoveRows adds an underline on last row that we don't want
        wd.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone


        Try
            Call MoveOneCellDown(wd)

        Catch ex As Exception

        End Try

end1:

    End Sub

    Sub DeleteRows(ByVal ctExp As Short, ByVal wd As Microsoft.Office.Interop.Word.Application)

        Dim count1 As Short
        Dim int1 As Short
        Dim int2 As Short

        Dim intR1 As Short
        Dim intR2 As Short

        intR2 = wd.Selection.Tables.Item(1).Rows.Count
        intR1 = intR2 - ctExp + 1
        'For count1 = 1 To ctExp
        '    int1 = wd.Selection.Tables.Item(1).Rows.Count
        '    wd.Selection.Tables.Item(1).Rows(int1).Delete()
        'Next

        Dim tbl As Microsoft.Office.Interop.Word.Table

        tbl = wd.Selection.Tables.Item(1)

        Dim myCells As Microsoft.Office.Interop.Word.Range
        With wd
            myCells = .ActiveDocument.Range(Start:=.Selection.Tables(1).Cell(intR1, 1).Range.Start, End:=.Selection.Tables(1).Cell(intR2, 1).Range.End)

            myCells.Rows.Delete()

            'myCells.Select()
            '.Selection.Rows.Delete()
            'delete will take the cursor out of the table
            'put it back in
            tbl.Cell(intR2 - 1, 1).Select()
        End With

        wd.Selection.SelectRow()



    End Sub

    Sub ChemFormula(ByVal wdRng As Microsoft.Office.Interop.Word.Range, ByVal wd As Microsoft.Office.Interop.Word.Application)

        Dim strFind As String
        Dim str1 As String
        Dim str2 As String
        Dim wdSel As Microsoft.Office.Interop.Word.Selection
        Dim Count1 As Integer
        Dim int1 As Integer

        'find a bunch of stuff

        strFind = "-d3"
        wdRng.Select()
        wdSel = wd.Selection

        'wdd.visible = True

        With wdSel.Find
            .ClearFormatting()
            .Forward = True
            .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
            .Format = True
            .MatchCase = True
            Do While .Execute(FindText:=strFind)
                If .Found Then
                    With wd
                        .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                        'enter -d
                        str2 = NBH & "d"
                        .Selection.TypeText(Text:=str2)
                        'subscript on
                        .Selection.Font.Subscript = True
                        'enter 3
                        str2 = "3"
                        .Selection.TypeText(Text:=str2)
                        'subscript off
                        .Selection.Font.Subscript = False
                    End With
                End If
            Loop
            .ClearFormatting()

        End With

        strFind = "-D3"
        With wdSel.Find
            .ClearFormatting()
            .Forward = True
            .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
            .Format = True
            .MatchCase = True
            Do While .Execute(FindText:=strFind)
                If .Found Then
                    With wd
                        .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                        'enter -d
                        str2 = NBH & "D"
                        .Selection.TypeText(Text:=str2)
                        'subscript on
                        .Selection.Font.Subscript = True
                        'enter 3
                        str2 = "3"
                        .Selection.TypeText(Text:=str2)
                        'subscript off
                        .Selection.Font.Subscript = False
                    End With
                End If
            Loop
            .ClearFormatting()

        End With

        strFind = "-D4"
        With wdSel.Find
            .ClearFormatting()
            .Forward = True
            .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
            .Format = True
            .MatchCase = True
            Do While .Execute(FindText:=strFind)
                If .Found Then
                    With wd
                        .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                        'enter -d
                        str2 = NBH & "D"
                        .Selection.TypeText(Text:=str2)
                        'subscript on
                        .Selection.Font.Subscript = True
                        'enter 3
                        str2 = "4"
                        .Selection.TypeText(Text:=str2)
                        'subscript off
                        .Selection.Font.Subscript = False
                    End With
                End If
            Loop
        End With

        strFind = "-d4"
        wdRng.Select()
        wdSel = wd.Selection

        With wdSel.Find
            .ClearFormatting()
            .Forward = True
            .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
            .Format = True
            .MatchCase = True
            Do While .Execute(FindText:=strFind)
                If .Found Then
                    With wd
                        .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                        'enter -d
                        str2 = NBH & "d"
                        .Selection.TypeText(Text:=str2)
                        'subscript on
                        .Selection.Font.Subscript = True
                        'enter 3
                        str2 = "4"
                        .Selection.TypeText(Text:=str2)
                        'subscript off
                        .Selection.Font.Subscript = False
                    End With
                End If
            Loop
            .ClearFormatting()
        End With

        strFind = "K2"
        wdRng.Select()
        wdSel = wd.Selection
        With wdSel.Find
            .ClearFormatting()
            .Forward = True
            .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
            .Format = True
            .MatchCase = True
            Do While .Execute(FindText:=strFind)
                If .Found Then
                    With wd
                        .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                        'enter -K
                        str2 = "K"
                        .Selection.TypeText(Text:=str2)
                        'subscript on
                        .Selection.Font.Subscript = True
                        'enter 2
                        str2 = "2"
                        .Selection.TypeText(Text:=str2)
                        'subscript off
                        .Selection.Font.Subscript = False
                    End With
                End If
            Loop
            .ClearFormatting()
        End With

        strFind = "K3"
        wdRng.Select()
        wdSel = wd.Selection
        With wdSel.Find
            .ClearFormatting()
            .Forward = True
            .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
            .Format = True
            .MatchCase = True
            .Execute(FindText:=strFind)
            If .Found Then
                With wd
                    .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                    'enter K
                    str2 = "K"
                    .Selection.TypeText(Text:=str2)
                    'subscript on
                    .Selection.Font.Subscript = True
                    'enter 2
                    str2 = "3"
                    .Selection.TypeText(Text:=str2)
                    'subscript off
                    .Selection.Font.Subscript = False
                End With
            End If
            .ClearFormatting()
        End With

        'superscript carbon
        int1 = 50
        For Count1 = int1 To 1 Step -1
            'strFind = "13C6"
            strFind = Count1 & "C"
            With wdSel.Find
                .ClearFormatting()
                .Forward = True
                .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                .Format = True
                .MatchCase = True

                Do While .Execute(FindText:=strFind)
                    If .Found Then
                        With wd
                            .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                            's-script on
                            .Selection.Font.Superscript = True
                            str2 = CStr(Count1)
                            .Selection.TypeText(Text:=str2)
                            's-script off
                            .Selection.Font.Superscript = False
                            str2 = "C"
                            .Selection.TypeText(Text:=str2)
                            .Selection.Font.Superscript = False

                        End With
                    End If
                Loop
                .ClearFormatting()
            End With

        Next

        'subscript carbon
        int1 = 50
        For Count1 = int1 To 1 Step -1
            'strFind = "13C6"
            strFind = "C" & Count1
            With wdSel.Find
                .ClearFormatting()
                .Forward = True
                .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                .Format = True
                .MatchCase = True
                Do While .Execute(FindText:=strFind)
                    If .Found Then
                        With wd
                            .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                            .Selection.Font.Superscript = False
                            .Selection.Font.Subscript = False
                            str2 = "C"
                            .Selection.TypeText(Text:=str2)
                            .Selection.Font.Subscript = True
                            str2 = CStr(Count1)
                            .Selection.TypeText(Text:=str2)
                            's-script off
                            .Selection.Font.Subscript = False

                        End With
                    End If
                Loop
                .ClearFormatting()
            End With

        Next

        'strFind = "13C6"
        'With wdSel.Find
        '    .ClearFormatting()
        '    .Forward = True
        '    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
        '    .Format = True
        '    .MatchCase = True
        '    .Execute(FindText:=strFind)
        '    If .Found Then
        '        With wd
        '            .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
        '            's-script on
        '            .Selection.Font.Superscript = True
        '            'enter 13
        '            str2 = "13"
        '            .Selection.TypeText(Text:=str2)
        '            's-script off
        '            .Selection.Font.Superscript = False
        '            str2 = "C"
        '            .Selection.TypeText(Text:=str2)
        '            .Selection.Font.Subscript = True
        '            'enter 6
        '            str2 = "6"
        '            .Selection.TypeText(Text:=str2)
        '            'subscript off
        '            .Selection.Font.Subscript = False
        '        End With
        '    End If
        'End With

        'strFind = "13C4"
        'With wdSel.Find
        '    .ClearFormatting()
        '    .Forward = True
        '    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
        '    .Format = True
        '    .MatchCase = True
        '    .Execute(FindText:=strFind)
        '    If .Found Then
        '        With wd
        '            .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
        '            's-script on
        '            .Selection.Font.Superscript = True
        '            'enter 13
        '            str2 = "13"
        '            .Selection.TypeText(Text:=str2)
        '            's-script off
        '            .Selection.Font.Superscript = False
        '            str2 = "C"
        '            .Selection.TypeText(Text:=str2)
        '            .Selection.Font.Subscript = True
        '            'enter 6
        '            str2 = "4"
        '            .Selection.TypeText(Text:=str2)
        '            'subscript off
        '            .Selection.Font.Subscript = False
        '        End With
        '    End If
        'End With

        'strFind = "13C"
        'With wdSel.Find
        '    .ClearFormatting()
        '    .Forward = True
        '    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
        '    .Format = True
        '    .MatchCase = True
        '    .Execute(FindText:=strFind)
        '    If .Found Then
        '        With wd
        '            .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
        '            's-script on
        '            .Selection.Font.Superscript = True
        '            'enter 13
        '            str2 = "13"
        '            .Selection.TypeText(Text:=str2)
        '            's-script off
        '            .Selection.Font.Superscript = False
        '            str2 = "C"
        '            .Selection.TypeText(Text:=str2)
        '        End With
        '    End If
        'End With

        strFind = "2H"
        With wdSel.Find
            .ClearFormatting()
            .Forward = True
            .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
            .Format = True
            .MatchCase = True
            Do While .Execute(FindText:=strFind)
                If .Found Then
                    With wd
                        .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                        's-script on
                        .Selection.Font.Superscript = True
                        'enter 2
                        str2 = "2"
                        .Selection.TypeText(Text:=str2)
                        's-script off
                        .Selection.Font.Superscript = False
                        str2 = "H"
                        .Selection.TypeText(Text:=str2)
                    End With
                End If
            Loop
            .ClearFormatting()
        End With

    End Sub

    Sub NBSP(ByVal wd As Microsoft.Office.Interop.Word.Application, boolTable As Boolean)

        With wd

            '20160124 LEE: Added for new NBSP logic: place nbsp in caption rather than in reference
            If BOOLTABLELABELSECTION Then
                .Selection.MoveLeft(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdWord, Count:=3)
            Else
                .Selection.MoveLeft(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdWord, Count:=1)
            End If

            .Selection.MoveLeft(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1, Extend:=Microsoft.Office.Interop.Word.WdMovementType.wdExtend)

            .Selection.TypeText(Text:=ChrW(160))

            If BOOLTABLELABELSECTION Then
                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdWord, Count:=3)
            Else
                .Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdWord, Count:=1)
            End If

        End With

    End Sub



    Sub PageSetup(ByVal wd As Word.Application, ByVal x As String)

        With wd
            If StrComp(x, "L", vbTextCompare) = 0 Then
                With .Selection.PageSetup
                    .Orientation = Microsoft.Office.Interop.Word.WdOrientation.wdOrientLandscape
                End With
            Else

                With .Selection.PageSetup
                    .Orientation = Microsoft.Office.Interop.Word.WdOrientation.wdOrientPortrait
                End With
            End If

            'check previous. If different orientation, then change linkage
            Dim intS As Short
            Dim strO1 As String
            Dim strO2 As String

            Try
                intS = .Selection.Information(Word.WdInformation.wdActiveEndSectionNumber)
                strO1 = .ActiveDocument.Sections(intS - 1).PageSetup.Orientation.ToString()
                strO2 = .ActiveDocument.Sections(intS).PageSetup.Orientation.ToString()

                If StrComp(strO1, strO2, CompareMethod.Text) = 0 Then
                    '.ActiveDocument.Sections(intS).Headers.Item(Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).LinkToPrevious = True
                Else
                    '.Selection.HeaderFooter.LinkToPrevious = False
                    '.ActiveDocument.Sections(intS).Headers.Item(Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).LinkToPrevious = False
                End If
            Catch ex As Exception

            End Try


        End With

    End Sub

    Sub LinkPrevious(ByVal wd As Word.Application, ByVal boolTrue As Boolean, boolOverRide As Boolean)

        System.Windows.Forms.Application.DoEvents()

        If intTableSection = 0 And boolOverRide = False Then
            GoTo end1
        End If

        Dim intEnd As Int32

        If boolOverRide Then
            intEnd = 3
        Else
            intEnd = intTableSection
        End If

        Dim intSecs As Short
        Dim Count1 As Short
        Dim strO1 As String
        Dim strO2 As String
        Dim rm, lm, ph, pw
        Dim rt
        Dim boolLTP As Boolean
        Dim oVal, oMax

        oMax = frmH.pb1.Maximum
        oVal = frmH.pb1.Value

        Try
            With wd
                '
                intSecs = .ActiveDocument.Sections.Count

                frmH.lblProgress.Text = "Configuring Report Header/Footers..."
                frmH.lblProgress.Refresh()
                frmH.pb1.Maximum = intSecs
                frmH.pb1.Value = 1
                frmH.pb1.Refresh()

                Dim iCt As Short
                iCt = 0

                '20170227 LEE: This is old logic. The document should already have configured linktoprevious



                If boolTrue Then

                    'GoTo skip1

                    'For Count1 = intSecs To 3 Step -1
                    For Count1 = intSecs To intEnd Step -1

                        iCt = iCt + 1
                        frmH.lblProgress.Text = "Configuring Report Header/Footer LinkToPrevious_a (Section " & iCt & " of " & intSecs & ")..."
                        frmH.lblProgress.Refresh()

                        frmH.pb1.Value = iCt 'Count1
                        frmH.pb1.Refresh()

                        Try
                            .ActiveDocument.Sections(Count1).Headers.Item(Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).LinkToPrevious = True
                        Catch ex As Exception

                        End Try

                        Try
                            .ActiveDocument.Sections(Count1).Footers.Item(Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).LinkToPrevious = True
                        Catch ex As Exception

                        End Try
                    Next

skip1:


                Else

                    'GoTo skip2

                    ' For Count1 = intSecs to 3 step -1
                    For Count1 = intSecs To intEnd Step -1

                        iCt = iCt + 1
                        frmH.lblProgress.Text = "Configuring Report Header/Footer LinkToPrevious_b (Section " & iCt & " of " & intSecs & ")..."
                        frmH.lblProgress.Refresh()

                        frmH.pb1.Value = iCt 'Count1
                        frmH.pb1.Refresh()

                        strO1 = .ActiveDocument.Sections(Count1 - 1).PageSetup.Orientation.ToString()
                        strO2 = .ActiveDocument.Sections(Count1).PageSetup.Orientation.ToString()

                        If StrComp(strO1, strO2, CompareMethod.Text) = 0 Then
                            Try
                                .ActiveDocument.Sections(Count1).Headers.Item(Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).LinkToPrevious = True
                            Catch ex As Exception

                            End Try

                            Try
                                .ActiveDocument.Sections(Count1).Footers.Item(Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).LinkToPrevious = True
                            Catch ex As Exception

                            End Try
                        Else

                            Try
                                .ActiveDocument.Sections(Count1).Headers.Item(Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).LinkToPrevious = False
                            Catch ex As Exception

                            End Try

                            Try
                                .ActiveDocument.Sections(Count1).Footers.Item(Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).LinkToPrevious = False
                            Catch ex As Exception

                            End Try
                        End If

                    Next

skip2:

                    If boolFlipHeader Then
                        Call FlipHeader(wd)
                    Else

                        '20170227 LEE: Don't do this anymore. Recommend to user to use tables
                        GoTo skip3

                        frmH.lblProgress.Text = "Configuring Report Header/Footer tab stops..."
                        frmH.lblProgress.Refresh()
                        frmH.pb1.Maximum = intSecs
                        frmH.pb1.Value = 1
                        frmH.pb1.Refresh()

                        For Count1 = 1 To intSecs

                            rm = .ActiveDocument.Sections(Count1).PageSetup.RightMargin
                            lm = .ActiveDocument.Sections(Count1).PageSetup.LeftMargin
                            ph = .ActiveDocument.Sections(Count1).PageSetup.PageHeight
                            pw = .ActiveDocument.Sections(Count1).PageSetup.PageWidth

                            Try
                                boolLTP = .ActiveDocument.Sections(Count1).Headers.Item(Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).LinkToPrevious
                            Catch ex As Exception
                                boolLTP = False
                            End Try
                            If boolLTP And Count1 <> 1 Then
                            Else

                                frmH.lblProgress.Text = "Configuring Report Header/Footer tab stops (Section " & Count1 & " of " & intSecs & ")..."
                                frmH.lblProgress.Refresh()
                                frmH.pb1.Value = Count1
                                frmH.pb1.Refresh()

                                '.Selection.WholeStory()
                                If .ActiveDocument.Sections(Count1).PageSetup.Orientation = Microsoft.Office.Interop.Word.WdOrientation.wdOrientLandscape Then
                                    rt = pw - lm - rm
                                Else
                                    rt = pw - lm - rm
                                End If
                                'wd.Selection.WholeStory()
                                .ActiveDocument.Sections(Count1).Headers.Item(Microsoft.Office.Interop.Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).Range.ParagraphFormat.TabStops.ClearAll()
                                .ActiveDocument.Sections(Count1).Headers.Item(Microsoft.Office.Interop.Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).Range.ParagraphFormat.TabStops.Add(Position:=rt, Alignment:=Microsoft.Office.Interop.Word.WdTabAlignment.wdAlignTabRight, Leader:=Microsoft.Office.Interop.Word.WdTabLeader.wdTabLeaderSpaces)

                                .ActiveDocument.Sections(Count1).Footers.Item(Microsoft.Office.Interop.Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).Range.ParagraphFormat.TabStops.ClearAll()
                                .ActiveDocument.Sections(Count1).Footers.Item(Microsoft.Office.Interop.Word.WdHeaderFooterIndex.wdHeaderFooterPrimary).Range.ParagraphFormat.TabStops.Add(Position:=rt, Alignment:=Microsoft.Office.Interop.Word.WdTabAlignment.wdAlignTabRight, Leader:=Microsoft.Office.Interop.Word.WdTabLeader.wdTabLeaderSpaces)

                            End If

                        Next

                        frmH.lblProgress.Text = "Configuring Report Header/Footer tab stops (Section " & intSecs & " of " & intSecs & ")..."
                        frmH.lblProgress.Refresh()
                        'frmH.pb1.Value = intSecs
                        frmH.pb1.Maximum = intSecs
                        frmH.pb1.Value = intSecs
                        frmH.pb1.Refresh()

skip3:

                    End If



                End If
            End With

        Catch ex As Exception

        End Try

        frmH.pb1.Value = 1
        frmH.pb1.Maximum = oMax
        frmH.pb1.Value = oVal

end1:


    End Sub

    Sub RemoveBookmark(strB As String)


    End Sub

    Sub NAR(ByVal o As Object)
        Try
            System.Runtime.InteropServices.Marshal.ReleaseComObject(o)
        Catch
            ''''''''''''''console.writeline("Crap")
        Finally
            o = Nothing
        End Try
    End Sub

    Sub fgKeyDown(ByVal fg As DataGridView)
        Try
            Clipboard.Clear()
        Catch ex As Exception

        End Try
        Try
            Clipboard.SetDataObject(fg.GetClipboardContent())
        Catch ex As Exception

        End Try
    End Sub


    Public Sub FilllbxSymbol(ByVal lbxSymbol As ListBox, ByVal lbl1 As Label)

        Dim Count1 As Short
        Dim var1

        'fill lbxsymbol
        Dim achr
        For Count1 = 1 To 100
            var1 = ""
            Select Case Count1
                Case 1
                    achr = ChrW(177) '+/- good
                    var1 = achr
                Case 2
                    achr = ChrW(8805) '>=
                    var1 = achr
                Case 3
                    achr = ChrW(8804) '<=
                    var1 = achr
                Case 4
                    achr = ChrW(8800) 'not equal to
                    var1 = achr
                Case 5
                    achr = "<>" 'not equal to
                    var1 = achr
                Case 6
                    achr = ChrW(176) 'degree good
                    var1 = achr
                Case 7
                    achr = ChrW(945) 'alpha
                    var1 = achr
                Case 8
                    achr = ChrW(946) 'beta
                    var1 = achr
                Case 9
                    achr = ChrW(181) 'micro
                    var1 = achr
                Case 10
                    achr = "nbh" 'NBH 'nonbreaking hyphen
                    var1 = achr
                Case 11
                    achr = "nbsp" 'ChrW(160) 'nonbreaking space
                    var1 = achr
                Case 12
                    achr = ChrW(247) 'divided by
                    var1 = achr
                Case 13
                    achr = ChrW(215) 'multiply
                    var1 = achr
                Case 14
                    achr = ChrW(8730) 'square root
                    var1 = achr
                Case 15
                    achr = ChrW(169) 'Copywrite good
                    var1 = achr
                Case 16
                    achr = ChrW(8482) 'Trademark good
                    var1 = achr
                Case 17
                    achr = ChrW(174) 'Registered good
                    var1 = achr
                Case 18
                    achr = ChrW(178) 'superscript 2 good
                    var1 = achr
                Case 19
                    achr = ChrW(179) 'superscript 3 good
                    var1 = achr
                Case 20
                    achr = "CR" 'Line feed
                    var1 = achr

            End Select
            If Len(var1) = 0 Then
            Else
                lbxSymbol.Items.Add(var1)
            End If
        Next

        lbl1.Text = "(nbh = nonbreaking hyphen" & ChrW(10) & ChrW(10) & "nbsp = nonbreaking space" & ChrW(10) & ChrW(10) & "CR = Carriage Return)"

    End Sub

    Sub SavePswdHistory(ByVal id_UID As Int64, ByVal strPswd As String, ByVal dt As DateTime)

        Dim maxID As Int64

        maxID = GetMaxID("TBLPASSWORDHISTORY", 1, True)
        maxID = maxID + 1

        Dim nr As DataRow = tblPasswordHistory.NewRow
        nr.BeginEdit()
        nr.Item("id_tblPasswordHistory") = maxID
        nr.Item("id_tblUserAccounts") = id_UID ' CLng(Me.txtID.Text)
        nr.Item("charPassword") = strPswd 'Decode(Coding(varP2, True), False)
        nr.Item("dtPassword") = dt
        nr.EndEdit()
        tblPasswordHistory.Rows.Add(nr)

        If boolGuWuOracle Then
            Try
                ta_tblPasswordHistory.Update(tblPasswordHistory)
            Catch ex As DBConcurrencyException
                'ds2005.TBLPASSWORDHISTORY.Merge('ds2005.TBLPASSWORDHISTORY, True)

            End Try
        ElseIf boolGuWuAccess Then
            Try
                ta_tblPasswordHistoryAcc.Update(tblPasswordHistory)
            Catch ex As DBConcurrencyException
                'ds2005Acc.TBLPASSWORDHISTORY.Merge('ds2005Acc.TBLPASSWORDHISTORY, True)

            End Try
        ElseIf boolGuWuSQLServer Then
            Try
                ta_tblPasswordHistorySQLServer.Update(tblPasswordHistory)
            Catch ex As DBConcurrencyException
                'ds2005Acc.TBLPASSWORDHISTORY.Merge('ds2005Acc.TBLPASSWORDHISTORY, True)

            End Try
        End If

        Call PutMaxID("TBLPASSWORDHISTORY", maxID)

    End Sub

    Sub SetDecs()

        intQCDec = GetQCDec()
        strQCDec = GetQCDecStr()
        strRegrDec = GetRegrDecStr(LRegrSigFigs)
        strR2Dec = GetRegrDecStr(LR2SigFigs)
        strAreaDec = GetAreaDecStr()
        strAreaDecAreaRatio = GetAreaRatioDecStr()

    End Sub

    Sub UpdateProjectClick063()


        Dim var1
        Dim strCaption As String
        Dim dt As Date
        Dim tbl As System.Data.DataTable

        Dim bool As Boolean

        '*****
        Dim tUserID As String
        Dim tUserName As String

        tUserID = gUserID
        tUserName = gUserName

        strRFC = GetDefaultRFC()
        strMOS = GetDefaultMOS()

        gATAdds = 0
        gATDeletes = 0
        gATMods = 0

        If gboolAuditTrail And gboolESig Then

            Dim frm As New frmESig

            frm.ShowDialog()

            If frm.boolCancel Then
                frm.Dispose()
                GoTo end1
            End If

            gUserID = frm.tUserID
            gUserName = frm.tUserName

            frm.Dispose()

        End If

        Dim dt1 As DateTime
        dt1 = Now

        '*****

        'Display an hourglass
        Cursor.Current = Cursors.WaitCursor

        Call UpdateProject()

        'update tblProjectUpdate
        'dt = Now
        'tbl = tblProjectUpdate

        boolRefresh = True
        Call GetStudyInfo()
        Call SetDecs()
        boolRefresh = False

        Call Set_idtblReports()

        intOTables = 0

        Dim strM As String
        strM = "You will now be asked to apply a Study Template to this study..."
        'strM = strM & ChrW(10) & ChrW(10)
        'strM = strM & "(You will be given a chance to Cancel if you wish to not apply a Study Template.)"
        MsgBox(strM, MsgBoxStyle.Information, "Apply a Study Template...")

        Call ApplyTemplateMaster(True)

        '20180321: LEE
        'need to do some table specific stuff
        Try
            Call AddAnalyteColReportTableAnalytes()

        Catch ex As Exception
            'MsgBox("There was a problem executing AddAnalyteColReportTableAnalytes." & ChrW(10) & ChrW(10) & ex.Message, MsgBoxStyle.Information, "Problem...")
        End Try


        'for some reason, the following isn't happening in normal code. Call it again
        Call FillMethValExistingGuWu()

        'id_tblStudies
        MsgBox("Study Configuration Complete!", MsgBoxStyle.Information, "Project Complete...")

end1:
        'Switch back to the users default cursor
        Cursor.Current = Cursors.Default

        gConfigStudy = ""

        'SendKeys.Send("%")


    End Sub

    Sub ApplyTemplateMaster(boolApply As Boolean)

        Dim frm As New frmAssignTemplate
        Dim var1

        'ensure study is configured
        If id_tblStudies = 0 Then
            MsgBox("The study must first be configured before a template can be applied.", MsgBoxStyle.Information, "Configure study first...")
            Exit Sub
        End If

        Dim strM As String
        strM = "Choose 'Apply Study Template...' to apply a Study Template to the underlying study."
        frm.lbl1.Text = strM

        If boolApply Then
            frm.rbApply.Checked = True
        End If

        frm.ShowDialog()
        If frm.boolCancel Then
            Exit Sub
        End If

        Dim var2
        'var2 = frm.lbxTemplates.SelectedItem

        Dim dgv As DataGridView = frm.dgvTemplates
        Dim dgr As DataGridViewRow = dgv.SelectedRows(0)
        var2 = dgr.Cells("charStudyTemplate").Value
        frm.Dispose()

        Try
            Call ApplyTemplate(var2)
        Catch ex As Exception
            var1 = var1
        End Try



        ''annoying!
        'Call ViewSections(False)

    End Sub



    Sub ClearHeaderFooter(wd As Microsoft.Office.Interop.Word.Application)

        If boolExcludeHeaderFooter Then
        Else
            Exit Sub
        End If

        Dim doc As Microsoft.Office.Interop.Word.Document
        doc = wd.ActiveDocument
        Dim sec As Microsoft.Office.Interop.Word.Section
        Dim intSec As Integer

        With wd

            For Each sec In doc.Sections

                intSec = sec.Index
                .Selection.GoTo(What:=Microsoft.Office.Interop.Word.WdGoToItem.wdGoToSection, Which:=Microsoft.Office.Interop.Word.WdGoToDirection.wdGoToFirst, Count:=intSec, Name:="")

                If wd.ActiveWindow.ActivePane.View.Type = Microsoft.Office.Interop.Word.WdViewType.wdNormalView Or wd.ActiveWindow.ActivePane.View.Type = Microsoft.Office.Interop.Word.WdViewType.wdOutlineView Then
                    wd.ActiveWindow.ActivePane.View.Type = Microsoft.Office.Interop.Word.WdViewType.wdPrintView
                End If
                wd.ActiveWindow.ActivePane.View.SeekView = Microsoft.Office.Interop.Word.WdSeekView.wdSeekCurrentPageHeader
                .Selection.WholeStory()
                .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)

                .ActiveWindow.ActivePane.View.SeekView = Microsoft.Office.Interop.Word.WdSeekView.wdSeekCurrentPageFooter
                .Selection.WholeStory()
                .Selection.Delete(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)

                .ActiveWindow.ActivePane.View.SeekView = Microsoft.Office.Interop.Word.WdSeekView.wdSeekMainDocument

            Next

        End With

        wd.Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)


    End Sub


    Sub CheckMaxID()

        Dim tblM As System.Data.Datatable = tblMaxID
        Dim Count1 As Short
        Dim strT As String
        Dim numM As Int64
        Dim strID As String
        Dim con As New ADODB.Connection
        Dim cmd As New ADODB.Command
        Dim constr As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim strSQL As String
        Dim numR As Int64
        Dim boolHit As Boolean = False
        Dim strM As String
        Dim var1

        'boolGuWuAccess, boolGuWuOracle, boolGuWuSQLServer

        If boolGuWuAccess Then
            constr = constrIni
        ElseIf boolGuWuSQLServer Then
            constr = constrIni '"Provider=SQLOLEDB;" & constrIni
        ElseIf boolGuWuOracle Then
            constr = constrIniGuWuODBC
        End If

        con.Open(constr)

        For Count1 = 0 To tblM.Rows.Count - 1

            If Count1 = 55 Then
                strT = strT
            End If

            strT = tblM.Rows(Count1).Item("CHARTABLE")
            numM = tblM.Rows(Count1).Item("NUMMAXID")

            strID = "ID_" & strT

            str1 = "SELECT MAX(" & strID & ") as numM "
            str2 = "FROM " & strT & ";"
            strSQL = str1 & str2

            Dim rs As New ADODB.Recordset

            Try
                With cmd
                    .ActiveConnection = con
                    .CommandText = strSQL
                    .CommandType = ADODB.CommandTypeEnum.adCmdText
                    rs = .Execute
                End With
                numR = NZ(rs.Fields("numM").Value, 1)
                rs.Close()
            Catch ex As Exception
                numR = numM
                strM = ex.Message
                strM = strM
            End Try

            rs = Nothing

            If numR > numM Then
                boolHit = True
                tblM.Rows(Count1).BeginEdit()
                tblM.Rows(Count1).Item("NUMMAXID") = numR
                tblM.Rows(Count1).EndEdit()
            End If

        Next

        If boolHit Then
            Try
                If boolGuWuOracle Then
                    Try
                        ta_tblMaxID.Update(tblMaxID)
                    Catch ex As DBConcurrencyException
                        'ds2005.TBLMAXID.Merge('ds2005.TBLMAXID, True)
                    End Try
                ElseIf boolGuWuAccess Then
                    Try
                        ta_tblMaxIDAcc.Update(tblMaxID)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLMAXID.Merge('ds2005Acc.TBLMAXID, True)
                    End Try
                ElseIf boolGuWuSQLServer Then
                    Try
                        ta_tblMaxIDSQLServer.Update(tblMaxID)
                    Catch ex As DBConcurrencyException
                        'ds2005Acc.TBLMAXID.Merge('ds2005Acc.TBLMAXID, True)
                    End Try
                End If

            Catch ex As Exception
                var1 = ex.Message
                var1 = var1
            End Try

        Else
            var1 = var1
        End If

        If con.State = ADODB.ObjectStateEnum.adStateOpen Then
            con.Close()
        End If

        con = Nothing

    End Sub


    Sub ModifyTOC(ByVal wd As Microsoft.Office.Interop.Word.Application)

        '20170603 LEE: I don't think this should be done. The style font should be as defined by Normal.dot

        Exit Sub

        Dim Count1 As Short
        Dim strName As String

        With wd

            If boolTOC Then
                Try
                    For Count1 = 1 To 5

                        strName = "TOC " & Count1

                        With .ActiveDocument.Styles(strName).Font
                            .Name = ftNormal
                        End With
                        'With .ActiveDocument.Styles("TOC 1")
                        '    .AutomaticallyUpdate = True
                        '    .BaseStyle = "Body Text"
                        '    .NextParagraphStyle = "TOC 1"
                        'End With
                    Next
                Catch ex As Exception

                End Try
            End If

            If boolTOF Or boolTOA Or boolTOT Then
                Try
                    With .ActiveDocument.Styles("Table of Figures").Font
                        .Name = ftNormal
                    End With
                Catch ex As Exception

                End Try
            End If

        End With

    End Sub


    Sub DoCompliance()

        Dim tblC As System.Data.Datatable

        tblC = tblConfigCompliance

        'first find out if 

    End Sub

    Sub SetAuditESig()

        Dim dtbl As System.Data.Datatable = tblConfigCompliance
        Dim var1

        var1 = dtbl.Rows(0).Item("BOOLAUDITTRAIL")
        If var1 = 0 Then
            gboolAuditTrail = False
        Else
            gboolAuditTrail = True
        End If

        var1 = dtbl.Rows(0).Item("BOOLESIG")
        If var1 = 0 Then
            gboolESig = False
        Else
            gboolESig = True
        End If

    End Sub

    Sub FillAuditTrailTemp(ByVal tbl As System.Data.DataTable)

        If gboolAuditTrail Then
        Else
            Exit Sub
        End If

        Dim strTName As String
        Dim strColName As String
        Dim tblM As System.Data.DataTable
        Dim intRowsM As Int16
        Dim tblD As System.Data.DataTable
        Dim intRowsD As Int16
        Dim tblA As System.Data.DataTable
        Dim intRowsA As Int16
        Dim dr As DataRow
        Dim col As DataColumn
        Dim var1, var2
        Dim Count1 As Short
        Dim idS As Double
        'Dim idSE As Double
        Dim charLink1 As String
        Dim charLink2 As String
        Dim strLink1 As String
        Dim strLink2 As String
        Dim strLink1Value As String
        Dim strLink2Value As String
        Dim strF As String
        Dim strS As String
        Dim strItem As String
        Dim strTblDescr As String
        'Dim strAuditType As String'this is now global public
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String

        Dim tblAT As System.Data.DataTable

        Dim tblDR As System.Data.DataTable
        Dim dvDR As System.Data.DataView
        Dim strCol As String

        tblDR = tblDataTableRowTitles
        dvDR = New DataView(tblDR)
        dvDR.Sort = "CHARTABLEREFCOLUMNNAME ASC"

        Dim tblRHC As System.Data.DataTable
        Dim dvRHC As System.Data.DataView

        Dim tblS As System.Data.DataTable
        Dim rowsS() As DataRow
        Dim strStudyName As String

        Dim boolDiffLink As Boolean = False

        Dim boolStudies2 As Boolean = False

        Dim boolDidSampleW As Boolean = False
        Dim boolDidSampleM As Boolean = False
        Dim boolDidSampleTS As Boolean = False

        Dim strAction As String

        Dim varOld, varNew

        strTName = tbl.TableName

        tblS = tblStudies
        rowsS = tblS.Select("ID_TBLSTUDIES = " & id_tblStudies)
        If Len(gConfigStudy) = 0 Then
            If rowsS.Length = 0 Then
                'Exit Sub
                strStudyName = "Not Applicable"
            Else
                strStudyName = NZ(rowsS(0).Item("CHARWATSONSTUDYNAME"), "Not Applicable")
            End If
        Else
            strStudyName = gConfigStudy
        End If



        tblRHC = tblReportTableHeaderConfig
        dvRHC = New DataView(tblRHC)

        tblAT = tblAuditTrailTemp

        'from TBLDATATABLEROWTITLES
        'CHARDATATABLENAME
        'tblCompanyAnalRefTable
        'tblCompanyData
        'tblMethodValidationData
        'tblPermissions
        'tblPermissionsAdmin
        'tblReportStatementsGuWu' NOTE: this table has been deprecated
        'tblSummaryData' NOTE: this table is not editable by the user
        'tblWatsonAnalRefTable' NOTE: this table is not editable by the user
        'tblWatsonData' NOTE: this table is not editable by the user

        strLink1 = ""
        strLink2 = ""
        strLink1Value = ""
        strLink2Value = ""

        'legend:
        'Me.cbxFilterSource.Items.Add("Study Name")
        'Me.cbxFilterSource.Items.Add("User Name")
        'Me.cbxFilterSource.Items.Add("Report Writer Administration")
        'Me.cbxFilterSource.Items.Add("GuWu Administration")

        charLink1 = ""
        charLink2 = ""
        strTblDescr = "Not Applicable"

        strAuditType = "Report Writer Study"
        'strAuditType = "GuWu Administration"
        'strAuditType = "Report Writer Administration"
        'strAuditType = "Study Design"
        'strAuditType = "Study Design Administration"

        Select Case strTName

            Case "TBLSTUDIES"
                charLink1 = "CHARWATSONSTUDYNAME"
                charLink2 = ""
                'strTblDescr = "Report Writer - Home Tab - 'Configure Study in StudyDoc' Button"
                '20171113 LEE:
                strTblDescr = "Report Writer - Home Tab - 'Retrieve Watson Study' Button"
                strAuditType = "Report Writer Study"

                'Report Writer Stuff
            Case "TBLREPORTS"
                charLink1 = "CHARREPORTNUMBER"
                charLink2 = "CHARREPORTTITLE"
                strTblDescr = "Report Writer - Home Tab - Configured Reports Table"
                strAuditType = "Report Writer Study"

            Case "TBLANALREFSTANDARDS" ' "tblAnalRefStandards"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARANALYTENAME"
                charLink2 = "CHARLOTNUMBER"
                strTblDescr = "Report Writer - Analytical Reference Standard Tab - Analytical Reference Standard Table"
                strAuditType = "Report Writer Study"

            Case "TBLINCLUDEDROWS" '"tblIncludedRows"
                'Needs special handling
                'this table records if a Analytical Ref Std item is included/excluded
                'so linked to tblAnalRefStandards
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Analytical Reference Standard Tab - Analytical Reference Standard Table"
                strAuditType = "Report Writer Study"

            Case "TBLMETHODVALIDATIONDATA" ' "tblMethodValidationData"
                'need to get item from TBLDATATABLEROWTITLES
                'NOTE: Primary key: id_tblstudies and intColumnNumber
                'NOTE: must reflect Analyte column in which change was made
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Method Validation Data Tab"
                strAuditType = "Report Writer Study"

                'NOTE: If study is Sample Analysis, then ignore all items except id_tblstudies2 this because it is read-only for Sample Analysis
                strF = "ID_TBLSTUDIES = " & id_tblStudies
                Dim rowsR() As DataRow
                strF = "ID_TBLSTUDIES = " & id_tblStudies
                rowsR = tblReports.Select(strF)
                If rowsR.Length = 0 Then
                    boolStudies2 = False
                Else
                    str1 = NZ(rowsR(0).Item("CHARREPORTTYPE"), "Sample Analysis")
                    If InStr(1, str1, "Sample", CompareMethod.Text) > 0 Then
                        boolStudies2 = True
                    Else
                        boolStudies2 = False
                    End If
                End If

            Case "TBLDATA", "tblData"
                'need to get item from TBLDATATABLEROWTITLES
                'looks at tblCompanyData
                'if rounding conventions, need something different
                charLink1 = ""
                charLink2 = ""
                boolDiffLink = True
                strTblDescr = "Report Writer - Data Tab - Data Information/Configuration"
                strLink1 = "Study"
                strLink1Value = frmH.cbxStudy.Text
                strAuditType = "Report Writer Study"



            Case "TBLCUSTOMFIELDCODES", "tblCustomFieldCodes"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARVALUE"
                charLink2 = ""
                strTblDescr = "Report Writer - Data Tab - Custom Field Code"
                strAuditType = "Report Writer Study"

            Case "TBLAPPFIGS", "tblAppFigs"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARTITLE"
                charLink2 = "INTORDER"
                strTblDescr = "Report Writer - Appendices and Figures Tab"
                strAuditType = "Report Writer Study"

            Case "TBLANALYTICALRUNSUMMARY" ' "tblAnalyticalRunSummary"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARANALYTE"
                charLink2 = ""
                strTblDescr = "Report Writer - Analytical Run Summary Tab"
                strAuditType = "Report Writer Study"

            Case "TBLCONTRIBUTINGPERSONNEL" ' "tblContributingPersonnel"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARCPNAME"
                charLink2 = "CHARCPROLE"
                strTblDescr = "Report Writer - Contributing Personnel Tab"
                strAuditType = "Report Writer Study"

            Case "TBLREPORTTABLE"
                'need to get item from TBLDATATABLEROWTITLES
                'hmm. I think 'INTEGNUM' is for replicate tables
                'NOTE: CHARSTABILITYPERIOD is in Advanced Config Window - Stability Conditions Tab
                charLink1 = "CHARHEADINGTEXT"
                charLink2 = ""
                strTblDescr = "Report Writer - Report Table Configuration Tab"
                strAuditType = "Report Writer Study"

            Case "TBLREPORTTABLEHEADERCONFIG"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = ""
                charLink2 = ""
                'strTblDescr = "Report Writer - Report Table Header Configuration Tab"
                strTblDescr = "Report Writer - Configure Column Headings Tab"
                strAuditType = "Report Writer Study"

            Case "TBLREPORTTABLEANALYTES"
                'need to get item from TBLDATATABLEROWTITLES
                'linked to TBLREPORTTABLE
                'need to determine which analyte is included, excluded
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Report Table Configuration Tab"
                strAuditType = "Report Writer Study"

            Case "TBLTABLEPROPERTIES"
                'need to get item from TBLDATATABLEROWTITLES
                'NOTE: has some fields (NUMISCRIT1, NUMISCRIT1VALUE, NUMISCRIT2) for incurred samples in frmIncSmplCrit
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Report Table Configuration Tab - Advanced Table Configuration Window"
                strAuditType = "Report Writer Study"

            Case "TBLAUTOASSIGNSAMPLES"
                'need to get item from TBLDATATABLEROWTITLES
                'NOTE: has some fields (NUMISCRIT1, NUMISCRIT1VALUE, NUMISCRIT2) for incurred samples in frmIncSmplCrit
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Report Table Configuration Tab - Advanced Table Configuration Window"
                strAuditType = "Report Writer Study"

            Case "TBLASSIGNEDSAMPLES"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Report Table Configuration Tab - Assign Samples Window"
                strAuditType = "Report Writer Study"

            Case "TBLINCLUDEDROWS"
                'need to get item from TBLDATATABLEROWTITLES
                'NOTE: part of Analytical Reference Stanadard Tab
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Analytical Reference Stanadard Tab - Analytical Reference Standard Table"
                strAuditType = "Report Writer Study"

            Case "TBLQATABLES"
                'need to get item from TBLDATATABLEROWTITLES
                'NOTE: get column headers from TBLREPORTTABLEHEADERCONFIG
                'NOTE: INTORDER of tblQATables I think comes from TBLREPORTTABLEHEADERCONFIG
                charLink1 = ""
                charLink2 = "INTORDER"
                strTblDescr = "Report Writer - QA Event Table Tab"
                strAuditType = "Report Writer Study"

            Case "TBLREPORTSTATEMENTS"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Report Template Configuration Tab - Assigned Report Table"
                strAuditType = "Report Writer Study"

            Case "TBLSAMPLERECEIPT"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "INTORDER"
                charLink2 = "DTSHIPMENTRECEIVED"
                strTblDescr = "Report Writer - Sample Receipt Tab - StudyDoc Sample Receipt Table"
                strAuditType = "Report Writer Study"

            Case "TBLSUMMARYDATA"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARROWNAME"
                charLink2 = ""
                strTblDescr = "Report Writer - Summary Table Tab - Summary Table"
                strAuditType = "Report Writer Study"

            Case "TBLSTUDYDOCANALYTES"
                charLink1 = "AnalyteDescription"
                charLink2 = ""

                strLink1Value = "Analyte Sort"

                strTblDescr = "Report Writer - Data Tab - Analyte Sort"
                strAuditType = "Report Writer Study"

            Case "TBLWORDSTATEMENTS"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARTITLE"
                charLink2 = ""

                strLink1Value = "Report Template Title"

                strTblDescr = "Report Writer - Report Template Configuration Tab - Configure Report Templates"
                strAuditType = "Word Report Template"

                strStudyName = "Not Applicable" 'Word Templates are not applicable to StudyName

                'Report Writer Administration

            Case "TBLCORPORATEADDRESSES"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Administration - Corporate Addresses Tab - Address Table"
                strAuditType = "Report Writer Administration"
                strStudyName = "Not Applicable"

            Case "TBLCORPORATENICKNAMES"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARNICKNAME"
                charLink2 = ""
                strTblDescr = "Report Writer - Administration - Corporate Addresses Tab - NickNames Table"
                strAuditType = "Report Writer Administration"
                strStudyName = "Not Applicable"

            Case "TBLDROPDOWNBOXCONTENT"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = ""
                charLink2 = "CHARVALUE"
                strTblDescr = "Report Writer - Administration - Dropdownbox Configuration - Dropdown Box Contents Table"
                strAuditType = "Report Writer Administration"
                strStudyName = "Not Applicable"

            Case "TBLTEMPLATES"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARTEMPLATENAME"
                charLink2 = ""
                strTblDescr = "Report Writer - Administration - Study Template Definitions Tab - Templates Table"
                strAuditType = "Report Writer Administration"
                strStudyName = "Not Applicable"

            Case "TBLTEMPLATEATTRIBUTES"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "Report Writer - Administration - Study Template Definitions Tab - Template Attributes Table"
                strAuditType = "Report Writer Administration"
                strStudyName = "Not Applicable"

            Case "TBLFIELDCODES", "tblFieldCodes"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARFIELDCODE"
                charLink2 = ""
                strTblDescr = "Report Writer - Administration - Custom Field Code"
                strAuditType = "Report Writer Administration"
                strStudyName = "Not Applicable"

                'GuWu Administration

            Case "TBLCONFIGURATION"
                'NOTE: if CHARCONFIGCATEGORY = 'PASSWORD SETTINGS' THEN
                '           strTblDescr = 'GuWu Administration - Global Parameters Tab - Password Settings'
                '      else
                '           strTblDescr = 'Report Writer Administration - Global Parameters Tab - Directory Paths'
                '           strTblDescr = 'Report Writer Administration - Global Parameters Tab - Global Seettings'
                '      endif
                charLink1 = "CHARCONFIGTITLE"
                charLink2 = ""
                'strTblDescr = "StudyDoc Administration - Global Parameters Tab - Password Settings"
                strTblDescr = "StudyDoc Administration - Global Parameters"
                strAuditType = "StudyDoc Administration"
                strStudyName = "Not Applicable"

            Case "TBLCONFIGCOMPLIANCE" '
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "StudyDoc Administration - Compliance Tab"
                strAuditType = "StudyDoc Administration"
                strStudyName = "Not Applicable"

            Case "TBLPERMISSIONS" ' "tblPermissions"
                'need to get item from TBLDATATABLEROWTITLES
                'NOTE: something funny with tblPermissionsAdmin
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "StudyDoc Administration - Permissions Manager Tab - Permissions Groups"
                strAuditType = "StudyDoc Administration"
                strStudyName = "Not Applicable"

            Case "TBLHOOKS"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "StudyDoc Administration - Hooks Tab - Hooks Table"
                strAuditType = "StudyDoc Administration"
                strStudyName = "Not Applicable"

            Case "TBLMEANINGOFSIG"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARMEANINGOFSIG"
                charLink2 = ""
                strTblDescr = "StudyDoc Administration - Compliance Tab - Meaning of Signature Table" 'still need to get this
                strAuditType = "StudyDoc Administration"
                strStudyName = "Not Applicable"

            Case "TBLREASONFORCHANGE"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "CHARREASONFORCHANGE"
                charLink2 = ""
                strTblDescr = "StudyDoc Administration - Compliance Tab - Reason For Change Table" 'still need to get this
                strAuditType = "StudyDoc Administration"
                strStudyName = "Not Applicable"

            Case "TBLPASSWORDHISTORY"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "User ID Password Change Window"
                strAuditType = "StudyDoc Administration"
                strStudyName = "Not Applicable"

            Case "TBLPERSONNEL"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = "User Name"
                charLink2 = ""
                strTblDescr = "StudyDoc Administration - User Accounts Tab - User Names Table"
                strAuditType = "StudyDoc Administration"
                strStudyName = "Not Applicable"

            Case "TBLUSERACCOUNTS"
                'need to get item from TBLDATATABLEROWTITLES
                charLink1 = ""
                charLink2 = ""
                strTblDescr = "StudyDoc Administration - User Accounts Tab - User ID's Table and User ID Password Attributes"
                strAuditType = "StudyDoc Administration"
                strStudyName = "Not Applicable"

            Case "TBLWORDSTATEMENTSVERSIONS"
                charLink1 = "ID_TBLWORDSTATEMENTS"
                charLink2 = "ID_TBLWORDSTATEMENTSVERSRIONS"

                strTblDescr = "Report Writer - Edit Report Template"
                strAuditType = "Report Writer Report Template"

            Case ""
                charLink1 = ""
                charLink2 = ""
                strTblDescr = ""

        End Select

        Dim CountT As Short
        Dim tblX As System.Data.DataTable

        'var1 = tblM.TableName 'debug

        For CountT = 1 To 3

            Select Case CountT
                Case 1
                    tblM = tbl.GetChanges(DataRowState.Modified)
                    strAction = "RECORD MODIFIED"
                Case 2
                    tblM = tbl.GetChanges(DataRowState.Added)
                    strAction = "RECORD ADDED"
                Case 3
                    tblM = tbl.GetChanges(DataRowState.Deleted)
                    strAction = "RECORD DELETED"
                    Select Case strTName
                        Case "TBLWORDDOCS"
                            Exit For
                    End Select
            End Select

            If tblM Is Nothing Or (CountT = 2 And StrComp(strTName, "TBLCORPORATEADDRESSES", CompareMethod.Text) = 0) Then
                intRowsM = 0
            Else

                If CountT > 1 Then
                    var1 = "a"
                End If

                intRowsM = tblM.Rows.Count

                Dim strTM1 As String
                Dim idTM1 As Short
                Dim idTM2 As Short
                Dim boolGo As Boolean
                Dim var3, var4, var5, var6
                Dim ctRow As Int64
                Dim tblT As System.Data.DataTable
                Dim rowsT() As DataRow

                ctRow = tblM.Rows.Count 'debug
                ctRow = 0

                Dim intEnd
                Dim intStart

                Select Case CountT
                    Case 1 'modified
                        intStart = 1 'start with 1 to skip id_tbl
                        intEnd = tblM.Columns.Count - 1
                    Case 2 'added
                        intStart = 1
                        intEnd = 1
                    Case 3 'deleted
                        intStart = 1
                        intEnd = 1
                End Select
                For Each dr In tblM.Rows
                    ctRow = ctRow + 1
                    'idS = dr(0)

                    Select Case strTName
                        Case "TBLWORDDOCS"
                            If ctRow > 1 Then
                                'exit
                                GoTo Next1
                            End If

                    End Select

                    For Count1 = intStart To intEnd ' tblM.Columns.Count - 1

                        Select Case CountT
                            Case 1 'modified
                                var1 = NZ(dr(Count1, DataRowVersion.Original), "LABIntegrity101")
                                var2 = NZ(dr(Count1, DataRowVersion.Current), "LABIntegrity101")

                                idS = dr(0)
                            Case 2 'added
                                Select Case strTName
                                    Case "TBLPERMISSIONS"
                                        var1 = var1 'debug
                                    Case "TBLWORDSTATEMENTS"
                                        var1 = "Not Applicable" ' NZ(dr(Count1, DataRowVersion.Original), "LABIntegrity101")
                                        var2 = NZ(dr("CHARTITLE", DataRowVersion.Current), "LABIntegrity101")
                                    Case "TBLWORDDOCS"
                                        var1 = "Old: Contents of Report Template modified"
                                        var2 = "New: Contents of Report Template modified"
                                    Case Else
                                        var1 = 1
                                        var2 = 2
                                End Select

                                idS = dr(0)
                            Case 3 'deleted
                                var1 = 1
                                var2 = 2
                                idS = NZ(dr(0, DataRowVersion.Original), -1)
                        End Select

                        varOld = var1
                        varNew = var2

                        strCol = tblM.Columns(Count1).ColumnName
                        strLink1 = ""
                        strLink2 = ""
                        strLink1Value = "Not Applicable"
                        strLink2Value = "Not Applicable"
                        boolGo = True

                        'check for special exclusions
                        Select Case strTName
                            Case "TBLSTUDIES"
                                Select Case CountT
                                    Case 3
                                        strCol = "ID_TBLSTUDIES"
                                        strTblDescr = "Report Writer - Home Tab - 'Clear Study' Button"
                                End Select
                            Case "TBLCUSTOMFIELDCODES"
                                If Count1 > 4 Then
                                    boolGo = False
                                End If
                            Case "TBLSAMPLERECEIPT"

                                Select Case strCol

                                    Case "BOOLUSEWATSON", "BOOLUSEMANUAL", "NUMTOTALSAMPLENUM"
                                        strTblDescr = "Report Writer - Sample Receipt Tab - StudyDoc Sample Receipt Window"
                                        charLink1 = ""
                                        charLink2 = ""
                                    Case Else
                                        strTblDescr = "Report Writer - Sample Receipt Tab - StudyDoc Sample Receipt Table"
                                        charLink1 = "INTORDER"
                                        charLink2 = "DTSHIPMENTRECEIVED"
                                End Select

                                'Legend
                                'Dim boolDidSampleW As Boolean = False
                                'Dim boolDidSampleM As Boolean = False
                                'Dim boolDidSampleTS As Boolean = False

                                Select Case strCol

                                    Case "BOOLUSEWATSON"
                                        If boolDidSampleW Then
                                            boolGo = False
                                        Else
                                            boolDidSampleW = True
                                        End If
                                    Case "BOOLUSEMANUAL"
                                        If boolDidSampleM Then
                                            boolGo = False
                                        Else
                                            boolDidSampleM = True
                                        End If
                                    Case "NUMTOTALSAMPLENUM"
                                        If boolDidSampleTS Then
                                            boolGo = False
                                        Else
                                            boolDidSampleTS = True
                                        End If
                                End Select

                            Case "TBLTABLEPROPERTIES"
                                'var3 = NZ(dr("ID_TBLCONFIGREPORTTABLES"), 1)
                                Try
                                    var3 = NZ(dr("ID_TBLCONFIGREPORTTABLES"), 1)
                                Catch ex As Exception
                                    var3 = 1
                                End Try
                                If var3 = 1 Then
                                    boolGo = False
                                End If

                            Case "TBLAUTOASSIGNSAMPLES"
                                'var3 = NZ(dr("ID_TBLCONFIGREPORTTABLES"), 1)
                                Try
                                    var3 = NZ(dr("ID_TBLCONFIGREPORTTABLES"), 1)
                                Catch ex As Exception
                                    var3 = 1
                                End Try
                                If var3 = 1 Then
                                    boolGo = False
                                End If

                            Case "TBLCONFIGURATION"
                                'NOTE: if CHARCONFIGCATEGORY = 'PASSWORD SETTINGS' THEN
                                '           strTblDescr = 'StudyDoc Administration - Global Parameters Tab - Password Settings'
                                '      else
                                '           strTblDescr = 'Report Writer Administration - Global Parameters Tab - Directory Paths'
                                '           strTblDescr = 'Report Writer Administration - Global Parameters Tab - Global Seettings'
                                '      endif
                                var3 = NZ(dr("CHARCONFIGCATEGORY"), "Global Settings")
                                Select Case var3
                                    Case "Password Settings"
                                        strTblDescr = "StudyDoc Administration - Global Parameters Tab - Password Settings"
                                        strAuditType = "StudyDoc Administration"
                                    Case "Directory Paths"
                                        strTblDescr = "Report Writer Administration - Global Parameters Tab - Directory Paths"
                                        strAuditType = "Report Writer Administration"
                                    Case "Global Settings"
                                        strTblDescr = "Report Writer Administration - Global Parameters Tab - Global Settings"
                                        strAuditType = "Report Writer Administration"
                                    Case "Global LDAP"
                                        strTblDescr = "StudyDoc Administration - Global Windows Authentication Type"
                                        strAuditType = "StudyDoc Administration"
                                End Select
                                strLink1 = "Values Table"
                                strLink1Value = NZ(dr(charLink1), "")


                        End Select

                        If boolGo Then

                            strCol = tblM.Columns(Count1).ColumnName
                            Select Case strTName

                                Case "TBLSTUDIES"
                                    Select Case CountT
                                        Case 3
                                            strCol = "ID_TBLSTUDIES"
                                    End Select
                            End Select

                            If StrComp(strCol, "INTORDER", CompareMethod.Text) = 0 Then
                                strCol = "a"
                            End If
                            If StrComp(CStr(var1), CStr(var2), CompareMethod.Text) = 0 Then
                            Else

                                'look for [None] and nulls
                                Dim boolNone As Boolean = False
                                Select Case strTName
                                    Case "TBLDATA"
                                        Select Case strCol
                                            Case "charCorporateStudyID"
                                                boolNone = True
                                            Case "charProtocolNumber"
                                                boolNone = True
                                            Case "charDataArchivalLocation"
                                                boolNone = True
                                            Case "charSponsorStudyNumber"
                                                boolNone = True
                                            Case "charSponsorStudyTitle"
                                                boolNone = True
                                            Case "CHAROUTLIERMETHOD"
                                                boolNone = True

                                        End Select

                                        If boolNone Then 'evaluate
                                            If IsDBNull(var1) And StrComp(NZ(var2, ""), "[None]", CompareMethod.Text) = 0 Then
                                                var1 = "[None]"
                                            End If
                                        End If
                                    Case Else

                                End Select
                                'add entry to table

                                strCol = tblM.Columns(Count1).ColumnName
                                Select Case strTName

                                    Case "TBLSTUDIES"
                                        Select Case CountT
                                            Case 3
                                                strCol = "ID_TBLSTUDIES"
                                        End Select
                                End Select
                                If ExcludeItem(strCol, strTName, CountT) Then
                                    var1 = var1
                                Else
                                    'NOTE: DON'T USE VAR1 OR VAR2!!!
                                    Select Case strTName

                                        Case "TBLASSIGNEDSAMPLES"
                                            'charlink1 is OK. Need a combo of runid and runsamplesequencenumber for charlink2
                                            strLink1 = "Report Table"
                                            'need to find table name

                                            Select Case CountT
                                                Case 1, 2
                                                    var3 = NZ(dr.Item("ID_TBLREPORTTABLE"), -1)
                                                    strF = "ID_TBLREPORTTABLE = " & var3
                                                    Erase rowsT
                                                    rowsT = tblReportTable.Select(strF)
                                                    'var3 = rowsT(0).Item("CHARHEADINGTEXT")
                                                    If rowsT.Length = 0 Then
                                                        var3 = "NA"
                                                    Else
                                                        var3 = rowsT(0).Item("CHARHEADINGTEXT")
                                                    End If
                                                    strLink1Value = var3

                                                    strLink2 = "Analyte, Run ID, and Sequence Number"
                                                    var5 = NZ(dr.Item("CHARANALYTE"), "Not Applicable")
                                                    var3 = NZ(dr.Item("RUNID"), "Not Applicable")
                                                    var4 = NZ(dr.Item("RUNSAMPLESEQUENCENUMBER"), "Not Applicable")
                                                    strLink2Value = "Analyte = " & var5 & ", Run ID = " & var3 & ", Sequence Number = " & var4
                                                Case 3
                                                    var3 = NZ(dr.Item("ID_TBLREPORTTABLE", DataRowVersion.Original), -1)
                                                    strF = "ID_TBLREPORTTABLE = " & var3
                                                    Erase rowsT
                                                    rowsT = tblReportTable.Select(strF)
                                                    var3 = rowsT(0).Item("CHARHEADINGTEXT")
                                                    strLink1Value = var3

                                                    strLink2 = "Analyte, Run ID, and Sequence Number"
                                                    var5 = NZ(dr.Item("CHARANALYTE", DataRowVersion.Original), "Not Applicable")
                                                    var3 = NZ(dr.Item("RUNID", DataRowVersion.Original), "Not Applicable")
                                                    var4 = NZ(dr.Item("RUNSAMPLESEQUENCENUMBER", DataRowVersion.Original), "Not Applicable")
                                                    strLink2Value = "Analyte = " & var5 & ", Run ID = " & var3 & ", Sequence Number = " & var4
                                            End Select
                                        Case "TBLWORDSTATEMENTSVERSIONS"

                                            strLink1 = "Where Report Template = "
                                            'FIND TITLE
                                            var3 = NZ(dr.Item("ID_TBLWORDSTATEMENTS"), 0)
                                            strF = "ID_TBLWORDSTATEMENTS = " & var3
                                            Erase rowsT
                                            rowsT = tblWordStatements.Select(strF)
                                            If rowsT.Length = 0 Then
                                                var4 = "NA"
                                            Else
                                                var4 = rowsT(0).Item("CHARTITLE")
                                            End If
                                            strLink1Value = var4

                                            strLink2 = "Where ID = "
                                            var3 = NZ(dr.Item("ID_TBLWORDSTATEMENTS"), 0)
                                            strLink2Value = var3
                                        Case "TBLTEMPLATES"
                                            Dim id As Int64
                                            id = dr.Item("ID_TBLTEMPLATES")
                                            Erase rowsT
                                            strF = "ID_TBLTEMPLATES = " & id
                                            rowsT = tblTemplates.Select(strF)
                                            strLink1 = "Template Name"
                                            strLink1Value = rowsT(0).Item("CHARTEMPLATENAME")

                                        Case "TBLFIELDCODES"
                                            strLink1 = "Custom Field Code"
                                            If CountT = 3 Then
                                                strLink1Value = NZ(dr(charLink1, DataRowVersion.Original), "")
                                            Else
                                                strLink1Value = NZ(dr(charLink1), "")
                                            End If

                                        Case "TBLCUSTOMFIELDCODES"
                                            strLink1 = "Custom Field Code"

                                            '20170306 LEE: strLink1Value should be [FieldCode]
                                            var3 = dr("ID_TBLFIELDCODES")
                                            Erase rowsT
                                            strF = "ID_TBLFIELDCODES = " & var3
                                            rowsT = tblFieldCodes.Select(strF)
                                            strLink1Value = rowsT(0).Item("CHARFIELDCODE")
                                            var1 = var1 'debug


                                        Case "TBLTEMPLATEATTRIBUTES"
                                            'need to find strlink1 from selection
                                            Dim id As Int64
                                            id = dr.Item("ID_TBLTEMPLATES")
                                            Erase rowsT
                                            strF = "ID_TBLTEMPLATES = " & id
                                            rowsT = tblTemplates.Select(strF)
                                            strLink1 = "Template Name"
                                            strLink1Value = rowsT(0).Item("CHARTEMPLATENAME")

                                            strLink2 = "Template Attribute Item"
                                            var3 = dr.Item("ID_TBLTAB1")
                                            Dim rowsTT() As DataRow
                                            strF = "ID_TBLTAB1 = " & var3
                                            rowsTT = tblTab1.Select(strF)
                                            strLink2Value = rowsTT(0).Item("CHARITEM")

                                        Case "TBLCORPORATEADDRESSES"
                                            'need to find strlink1 from selection
                                            Dim id As Int64
                                            id = dr.Item("ID_TBLCORPORATENICKNAMES")
                                            Erase rowsT
                                            strF = "ID_TBLCORPORATENICKNAMES = " & id
                                            rowsT = tblCorporateNickNames.Select(strF)
                                            strLink1 = "Corporate Nickname"
                                            strLink1Value = rowsT(0).Item("CHARNICKNAME")

                                            strLink2 = "Corporate Address Item"
                                            strLink2Value = dr.Item("CHARADDRESSLABEL")

                                        Case "TBLDROPDOWNBOXCONTENT"
                                            'need to find strlink1 from selection
                                            Dim id As Int64
                                            id = dr.Item("ID_TBLDROPDOWNBOXNAME")
                                            Erase rowsT
                                            strF = "ID_TBLDROPDOWNBOXNAME = " & id
                                            rowsT = tblDropdownBoxName.Select(strF)
                                            strLink1 = "Dropdownbox Title"
                                            strLink1Value = rowsT(0).Item("CHARDROPDOWNNAME")

                                            strLink2 = "Dropdownbox Contents Item"
                                            strLink2Value = dr.Item("CHARVALUE")


                                        Case "TBLPERMISSIONS"

                                            var1 = var1 'debug
                                            Select Case CountT
                                                Case 1, 2
                                                    strLink1Value = dr.Item("CHARPERMISSIONSNAME") ' arrPI(1)
                                                    strLink2Value = "Not Applicable" ' arrPI(2)
                                                Case 3
                                                    var3 = NZ(dr.Item("CHARPERMISSIONSNAME", DataRowVersion.Original), "Not Applicable")
                                                    strLink1Value = var3
                                                    strLink2Value = "Not Applicable" ' arrPI(2)
                                            End Select

                                        Case "TBLUSERACCOUNTS"

                                            'need to find User Account and UserID
                                            'get user id from tblPermissions
                                            Dim idUA As Int64
                                            idUA = dr.Item("ID_TBLUSERACCOUNTS")

                                            Dim arrPI()
                                            arrPI = GetNameID(idUA)
                                            strLink1Value = arrPI(1)
                                            strLink2Value = arrPI(2)

                                            strLink1 = "User Name"
                                            strLink2 = "User ID"

                                        Case "TBLPERSONNEL"

                                            Dim idPers As Int64
                                            Dim strPers As String
                                            idPers = dr.Item("ID_TBLPERSONNEL")
                                            Erase rowsT
                                            strF = "ID_TBLPERSONNEL = " & idPers
                                            rowsT = tblPersonnel.Select(strF)
                                            str1 = NZ(rowsT(0).Item("CHARFIRSTNAME"), "")
                                            str2 = NZ(rowsT(0).Item("CHARMIDDLENAME"), "")
                                            str3 = NZ(rowsT(0).Item("CHARLASTNAME"), "")

                                            If Len(str2) = 0 Then
                                                strPers = str1 & " " & str3
                                            Else
                                                strPers = str1 & " " & str2 & " " & str3
                                            End If

                                            strLink1 = "User Name: "
                                            strLink1Value = strPers

                                        Case "TBLQATABLES"

                                            'find column item from tblreporttableheaderconfig
                                            'var3 = dr.Item("id_tblreporttableheaderconfig")
                                            Select Case CountT
                                                Case 1, 2
                                                    var3 = dr.Item("id_tblreporttableheaderconfig")
                                                Case 3
                                                    var3 = dr.Item("id_tblreporttableheaderconfig", DataRowVersion.Original)
                                            End Select
                                            strF = "id_tblreporttableheaderconfig = " & var3 & " AND ID_TBLSTUDIES = " & id_tblStudies
                                            Erase rowsT
                                            rowsT = tblReportTableHeaderConfig.Select(strF)
                                            If rowsT.Length = 0 Then
                                                strLink1Value = "Not Applicable"
                                            Else
                                                strLink1Value = NZ(rowsT(0).Item("CHARUSERLABEL"), "Not Applicable")
                                            End If

                                            'find column item from
                                            var3 = Mid(strCol, 1, 2)
                                            If StrComp(var3, "DT", CompareMethod.Text) = 0 Then

                                                var4 = Mid(strCol, Len(strCol), 1)
                                                strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLCONFIGREPORTTABLES = 1000 AND INTORDER = " & var4
                                                Erase rowsT
                                                rowsT = tblReportTableHeaderConfig.Select(strF)
                                                If rowsT.Length = 0 Then
                                                    strLink2Value = "Not Applicable"
                                                Else
                                                    strLink2Value = NZ(rowsT(0).Item("CHARUSERLABEL"), "Not Applicable")
                                                End If

                                            Else
                                                strLink2Value = "Not Applicable"
                                            End If

                                        Case "TBLMETHODVALIDATIONDATA"
                                            'look for analyte column
                                            strLink1 = "Analyte"
                                            'strLink1Value = NZ(dr("CHARCOLUMNNAME"), "")
                                            Try
                                                strLink1Value = NZ(dr("CHARCOLUMNNAME"), "")
                                            Catch ex As Exception
                                                strLink1Value = ""
                                            End Try

                                            If Len(strLink2) = 0 Then
                                                If Len(charLink2) = 0 Then
                                                    strLink2Value = "Not Applicable"
                                                Else
                                                    strLink2Value = NZ(dr(charLink2), "")
                                                End If
                                            End If

                                        Case "TBLANALYTICALRUNSUMMARY"

                                            'look for analyte column
                                            If Len(strLink1) = 0 Then
                                                If Len(charLink1) = 0 Then
                                                    strLink1Value = "Not Applicable"
                                                Else
                                                    strLink1Value = NZ(dr(charLink1), "")
                                                End If
                                            End If

                                            strLink2Value = NZ(dr("INTWATSONRUNID"), "")

                                        Case "TBLSUMMARYDATA"


                                            Try
                                                strLink1Value = dr.Item("CHARROWNAME")
                                                strLink2Value = "Not Applicable"
                                            Catch ex As Exception
                                                strLink1Value = "Not Applicable"
                                                strLink2Value = "Not Applicable"
                                            End Try

                                        Case "TBLREPORTSTATEMENTS"

                                            strLink1Value = "Assigned Report Column"
                                            strLink2Value = "Not Applicable"

                                        Case "TBLREPORTTABLEANALYTES"
                                            'get from report tables
                                            var3 = dr.Item("ID_TBLREPORTTABLE")
                                            strF = "ID_TBLREPORTTABLE = " & var3
                                            Erase rowsT
                                            rowsT = tblReportTable.Select(strF)
                                            If rowsT.Length = 0 Then
                                                strLink1Value = "Not Applicable"
                                            Else
                                                strLink1Value = NZ(rowsT(0).Item("CHARHEADINGTEXT"), "Not Applicable")
                                            End If

                                            strLink2Value = "Not Applicable"

                                            Select Case strCol
                                                Case "NUMINCSAMPLECRIT01"
                                                    charLink1 = ""
                                                    charLink2 = ""
                                                    strTblDescr = "Report Writer - Report Table Configuration Tab - Advanced Table Configuration Window"
                                                    strAuditType = "Report Writer Study"
                                                Case Else
                                                    charLink1 = ""
                                                    charLink2 = ""
                                                    strTblDescr = "Report Writer - Report Table Configuration Tab"
                                                    strAuditType = "Report Writer Study"
                                            End Select

                                        Case "TBLREPORTTABLEHEADERCONFIG"
                                            'get from tables
                                            var3 = dr.Item("ID_TBLCONFIGREPORTTABLES")
                                            strF = "ID_TBLCONFIGREPORTTABLES = " & var3
                                            Erase rowsT
                                            rowsT = tblConfigReportTables.Select(strF)
                                            If rowsT.Length = 0 Then
                                                strLink1Value = "Not Applicable"
                                            Else
                                                strLink1Value = NZ(rowsT(0).Item("CHARTABLENAME"), "Not Applicable")
                                            End If

                                            'now get strlink2value from the other table

                                            strLink2Value = NZ(dr("CHARUSERLABEL"), "Not Applicable")

                                        Case "TBLTABLEPROPERTIES"
                                            'get from report tables
                                            var3 = dr.Item("ID_TBLREPORTTABLE")
                                            strF = "ID_TBLREPORTTABLE = " & var3
                                            Erase rowsT
                                            rowsT = tblReportTable.Select(strF)
                                            If rowsT.Length = 0 Then
                                                strLink1Value = "Not Applicable"
                                            Else
                                                strLink1Value = NZ(rowsT(0).Item("CHARHEADINGTEXT"), "Not Applicable")
                                            End If

                                            strLink2Value = "Not Applicable"

                                        Case "TBLAUTOASSIGNSAMPLES"
                                            'get from report tables
                                            var3 = dr.Item("ID_TBLREPORTTABLE")
                                            strF = "ID_TBLREPORTTABLE = " & var3
                                            Erase rowsT
                                            rowsT = tblReportTable.Select(strF)
                                            If rowsT.Length = 0 Then
                                                strLink1Value = "Not Applicable"
                                            Else
                                                strLink1Value = NZ(rowsT(0).Item("CHARHEADINGTEXT"), "Not Applicable")
                                            End If

                                            strLink2Value = "Not Applicable"

                                        Case "TBLINCLUDEDROWS"
                                            var3 = dr.Item("ID_TBLDATATABLEROWTITLES")
                                            strF = "ID_TBLDATATABLEROWTITLES = " & var3
                                            Erase rowsT
                                            rowsT = tblDataTableRowTitles.Select(strF)
                                            If rowsT.Length = 0 Then
                                                strLink1Value = "Not Applicable"
                                            Else
                                                strLink1Value = NZ(rowsT(0).Item("CHARROWNAME"), "Not Applicable")
                                            End If

                                            strLink2Value = "Not Applicable"

                                        Case "TBLWORDSTATEMENTS"
                                            'must put in logic for new 
                                            Select Case CountT
                                                Case 1 'modified

                                                    strLink1 = "Word Report Template"
                                                    strLink1Value = varOld ' NZ(dr(strCol), "Not Applicable")

                                                Case 2 'added new report

                                                    strLink1 = "Word Report Template"

                                                    strLink1Value = varNew ' "Created New Report Template"
                                                    strLink2Value = "Not Applicable"

                                            End Select

                                        Case "TBLSTUDYDOCANALYTES"

                                            strLink1 = "Analyte"
                                            strLink1Value = NZ(dr(charLink1), "")

                                        Case Else
                                            If Len(strLink1) = 0 Then
                                                If Len(charLink1) = 0 Then
                                                    strLink1Value = "Not Applicable"
                                                Else
                                                    'strLink1Value = NZ(dr(charLink1), "")
                                                    Select Case CountT
                                                        Case 3
                                                            strLink1Value = NZ(dr(charLink1, DataRowVersion.Original), "")
                                                        Case Else
                                                            strLink1Value = NZ(dr(charLink1), "")
                                                    End Select
                                                End If
                                            End If

                                            If Len(strLink2) = 0 Then
                                                If Len(charLink2) = 0 Then
                                                    strLink2Value = "Not Applicable"
                                                Else
                                                    'strLink2Value = NZ(dr(charLink2), "")
                                                    Select Case CountT
                                                        Case 3
                                                            strLink2Value = NZ(dr(charLink2, DataRowVersion.Original), "")
                                                        Case Else
                                                            strLink2Value = NZ(dr(charLink2), "")
                                                    End Select

                                                End If
                                            End If
                                    End Select

                                    'Look for special stuff

                                    If StrComp(strTName, "TBLREPORTS", CompareMethod.Text) = 0 And (StrComp(strCol, "BOOLEXCLUDEPSAE", CompareMethod.Text) = 0 Or StrComp(strCol, "INTUSERCOMMENTS", CompareMethod.Text) = 0 Or StrComp(strCol, "BOOLALLAR", CompareMethod.Text) = 0 Or StrComp(strCol, "BOOLACCAR", CompareMethod.Text) = 0 Or StrComp(strCol, "BOOLREJAR", CompareMethod.Text) = 0 Or StrComp(strCol, "BOOLREGRAR", CompareMethod.Text) = 0 Or StrComp(strCol, "BOOLNOREGRAR", CompareMethod.Text) = 0 Or StrComp(strCol, "BOOLINCLPSAE", CompareMethod.Text) = 0) Then
                                        strTblDescr = "Analytical Run Summary Tab - Report Options"
                                        'var1 = GetSpecial(strCol, strTName, var1)
                                        'var2 = GetSpecial(strCol, strTName, var2)
                                    ElseIf StrComp(strTName, "TBLREPORTS", CompareMethod.Text) = 0 And StrComp(strCol, "BOOLMULTIVALSUM", CompareMethod.Text) = 0 Then
                                        strTblDescr = "Summary Table Tab - Report Summary Table Type"
                                    ElseIf StrComp(strTName, "TBLREPORTS", CompareMethod.Text) = 0 And StrComp(strCol, "BOOLDISPLAYATTACHMENTS", CompareMethod.Text) = 0 Then
                                        strTblDescr = "Appendices/Figures Tab"
                                    ElseIf StrComp(strTName, "TBLREPORTTABLE", CompareMethod.Text) = 0 And StrComp(strCol, "CHARHEADINGTEXT", CompareMethod.Text) = 0 Then
                                        strTblDescr = "Advanced Table Configuration"
                                    ElseIf StrComp(strTName, "TBLDATA", CompareMethod.Text) = 0 Then
                                        'var1 = GetSpecial(strCol, strTName, var1)
                                        'var2 = GetSpecial(strCol, strTName, var2)
                                    Else
                                        'var1 = GetSpecial(strCol, strTName, var1)
                                        'var2 = GetSpecial(strCol, strTName, var2)
                                    End If

                                    If StrComp(strTName, "TBLUSERACCOUNTS", CompareMethod.Text) = 0 Then
                                        var1 = var1 'debug
                                    End If

                                    'this is where old and new get established
                                    var1 = GetSpecial(strCol, strTName, var1, strTblDescr) 'old data
                                    var2 = GetSpecial(strCol, strTName, var2, strTblDescr) 'new data

                                    varOld = var1
                                    varNew = var2

                                    'modify bools
                                    If InStr(1, strCol, "BOOL", CompareMethod.Text) > 0 Then

                                        Select Case strCol
                                            Case "BOOLEXCLUDEPSAE", "BOOLMULTIVALSUM", "BOOLA", "boolA", "BOOLI", "boolI", "BOOLAPP", "boolAPP", "BOOLALLAR", "BOOLACCAR", "BOOLREJAR", "BOOLREGRAR", "BOOLNOREGRAR", "BOOLINCLPSAE"
                                                'do nothing
                                            Case Else

                                                If IsNumeric(var1) Then
                                                Else
                                                    var1 = 0
                                                End If
                                                If IsNumeric(var2) Then
                                                Else
                                                    var2 = 0
                                                End If
                                                If var1 = 0 Then
                                                    var1 = "FALSE"
                                                Else
                                                    var1 = "TRUE"
                                                End If
                                                If var2 = 0 Then
                                                    var2 = "FALSE"
                                                Else
                                                    var2 = "TRUE"
                                                End If

                                        End Select

                                    End If

                                    'look for strCol in tbldr
                                    Dim boolDoCol As Boolean = False
                                    Select Case strTName

                                        Case "TBLCORPORATENICKNAMES"
                                            strLink1 = "Corporate Nickname"
                                            strLink2 = "Not Applicable"

                                        Case "TBLQATABLES"

                                            strLink1 = "Critical Phase row"
                                            strLink2 = "Date and Row Number"

                                            Select Case CountT
                                                Case 1, 2
                                                    var3 = dr("ID_TBLREPORTTABLEHEADERCONFIG")
                                                    strF = "ID_TBLREPORTTABLEHEADERCONFIG = " & var3
                                                    Erase rowsT
                                                    rowsT = tblReportTableHeaderConfig.Select(strF)
                                                    If rowsT.Length = 0 Then
                                                        var4 = "Not Applicable"
                                                    Else
                                                        var4 = rowsT(0).Item("CHARUSERLABEL")
                                                    End If
                                                    strLink1Value = var4

                                                    var3 = NZ(dr("DTCOLUMN1"), "Not Applicable")
                                                    var4 = NZ(dr("INTORDER"), "Not Applicable")
                                                    strLink2Value = "Date = " & var3 & ", Row Number = " & var4

                                                Case 3

                                                    var3 = dr("ID_TBLREPORTTABLEHEADERCONFIG", DataRowVersion.Original)
                                                    strF = "ID_TBLREPORTTABLEHEADERCONFIG = " & var3
                                                    Erase rowsT
                                                    rowsT = tblReportTableHeaderConfig.Select(strF)
                                                    If rowsT.Length = 0 Then
                                                        var4 = "Not Applicable"
                                                    Else
                                                        var4 = rowsT(0).Item("CHARUSERLABEL")
                                                    End If
                                                    strLink1Value = var4

                                                    var3 = NZ(dr("DTCOLUMN1", DataRowVersion.Original), "Not Applicable")
                                                    var4 = NZ(dr("INTORDER", DataRowVersion.Original), "Not Applicable")
                                                    strLink2Value = "Date = " & var3 & ", Row Number = " & var4
                                            End Select

                                        Case "TBLREPORTTABLEHEADERCONFIG"

                                            strLink1 = "Report Table"
                                            strLink2 = "Suggested Label"

                                        Case "TBLANALREFSTANDARDS"

                                            'get strLink1
                                            If Len(strLink1) = 0 Then
                                                strF = "CHARTABLEREFCOLUMNNAME = '" & charLink1 & "' AND CHARTABLEREF = 'tblCompanyAnalRefTable'"
                                                dvDR.RowFilter = strF
                                                If dvDR.Count = 0 Then
                                                    strLink1 = "Not Applicable"
                                                Else
                                                    strLink1 = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                                End If
                                            End If

                                            'get strLink2
                                            If Len(strLink2) = 0 Then
                                                strF = "CHARTABLEREFCOLUMNNAME = '" & charLink2 & "' AND CHARTABLEREF = 'tblCompanyAnalRefTable'"
                                                dvDR.RowFilter = strF
                                                If dvDR.Count = 0 Then
                                                    strLink2 = "Not Applicable"
                                                Else
                                                    strLink2 = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                                End If
                                            End If

                                        Case "TBLINCLUDEDROWS"

                                            strLink1 = "Analytical Reference Standard Table"
                                            strLink2 = "Not Applicable"

                                        Case "TBLANALYTICALRUNSUMMARY"

                                            'get strLink1
                                            strLink1 = "Analyte"

                                            'get strLink2
                                            strLink2 = "Run ID"

                                        Case "TBLSUMMARYDATA"

                                            strLink1 = "Item Column"
                                            strLink2 = "Not Applicable"

                                        Case "TBLREPORTSTATEMENTS"

                                            strLink1 = "Assigned Report Table"
                                            strLink2 = "Not Applicable"

                                        Case "TBLREPORTTABLEANALYTES"
                                            strLink1 = "Table Title"
                                            strLink2 = "Not Applicable"

                                        Case "TBLTABLEPROPERTIES"
                                            strLink1 = "Table Title"
                                            strLink2 = "Not Applicable"

                                        Case "TBLAUTOASSIGNSAMPLES"
                                            strLink1 = "Table Title"
                                            strLink2 = "Not Applicable"

                                        Case Else

                                            boolDoCol = True

                                    End Select

                                    If boolDoCol Then

                                        'get strLink1
                                        If Len(strLink1) = 0 Then
                                            strF = "CHARTABLEREFCOLUMNNAME = '" & charLink1 & "' AND CHARTABLEREF = '" & strTName & "'"
                                            dvDR.RowFilter = strF
                                            If dvDR.Count = 0 Then
                                                strLink1 = "Not Applicable"
                                            Else
                                                strLink1 = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                            End If
                                        End If

                                        'get strLink2
                                        If Len(strLink2) = 0 Then
                                            strF = "CHARTABLEREFCOLUMNNAME = '" & charLink2 & "' AND CHARTABLEREF = '" & strTName & "'"
                                            dvDR.RowFilter = strF
                                            If dvDR.Count = 0 Then
                                                strLink2 = "Not Applicable"
                                            Else
                                                strLink2 = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                            End If
                                        End If

                                    End If

                                    'get strItem
                                    Select Case strTName

                                        'Case "TBLCONFIGCOMPLIANCE" ', "TBLREASONFORCHANGE", "TBLMEANINGOFSIG"
                                        '    strItem = strLink1Value
                                        Case "TBLFIELDCODES"
                                            Select Case strCol
                                                Case "CHARFIELDCODE"
                                                    strItem = "Custom Field Code"
                                                Case "CHARDESCRIPTION"
                                                    strItem = "Description"
                                                Case "CHAREXAMPLE"
                                                    strItem = "Example"
                                            End Select
                                        Case "TBLCUSTOMFIELDCODES"
                                            Select Case strCol
                                                Case "CHARVALUE"
                                                    strItem = "Value"
                                                Case "BOOLINCLUDE"
                                                    strItem = "Include"
                                            End Select
                                        Case "TBLCONFIGURATION"
                                            strItem = strLink1Value

                                        Case "TBLQATABLES"

                                            'find column item from
                                            var3 = Mid(strCol, 1, 2)
                                            If StrComp(var3, "DT", CompareMethod.Text) = 0 Then

                                                var4 = Mid(strCol, Len(strCol), 1)
                                                strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLCONFIGREPORTTABLES = 1000 AND INTORDER = " & var4
                                                Erase rowsT
                                                rowsT = tblReportTableHeaderConfig.Select(strF)
                                                If rowsT.Length = 0 Then
                                                    strItem = "Not Applicable"
                                                Else
                                                    strItem = NZ(rowsT(0).Item("CHARUSERLABEL"), "Not Applicable") & " date cell"
                                                End If

                                            Else
                                                strItem = "Not Applicable"
                                            End If

                                        Case "TBLSUMMARYDATA"

                                            Select Case strCol
                                                Case "INTORDER"
                                                    strItem = "Order Column"
                                                Case "BOOLINCLUDE"
                                                    strItem = "'A* = Include in report' Column"
                                                Case Else
                                                    strItem = "Not Applicable"
                                            End Select

                                        Case "TBLREPORTTABLEANALYTES"
                                            var3 = dr.Item("ANALYTEID")
                                            strF = "AnalyteID = " & var3
                                            Erase rowsT
                                            rowsT = tblAnalytesHome.Select(strF)
                                            If rowsT.Length = 0 Then
                                                strItem = "Not Applicable"
                                            Else
                                                Select Case strCol
                                                    Case "NUMINCSAMPLECRIT01"
                                                        strItem = rowsT(0).Item("ANALYTEDESCRIPTION") & " acceptance criteria"
                                                    Case Else
                                                        strItem = rowsT(0).Item("ANALYTEDESCRIPTION") & " column"
                                                End Select

                                            End If
                                            var3 = tblAnalytesHome.Rows.Count 'debug

                                            'Case "TBLREPORTSTATEMENTS"
                                        Case "TBLREPORTSTATEMENTS"
                                            Select Case strCol
                                                Case "ID_TBLWORDSTATEMENTS"
                                                    strItem = "Assigned Report column"
                                            End Select
                                        Case "TBLDATA", "tblData"
                                            Select Case strCol
                                                Case "ID_TBLASSAYTECHNIQUE"
                                                    strItem = "Assay Technique"
                                                Case "ID_TBLANTICOAGULANT"
                                                    strItem = "Anticoagulant"
                                                Case "ID_SUBMITTEDBY"
                                                    strItem = "Submitted By"
                                                Case "ID_SUBMITTEDTO"
                                                    strItem = "Submitted To"
                                                Case "ID_INSUPPORTOF"
                                                    strItem = "In Support Of"
                                                Case "BOOLROUNDFIVEEVEN"
                                                    strItem = "Round 5 to even"

                                                Case "BOOLROUNDFIVEAWAY"
                                                    strItem = "Round 5 away from zero"

                                                Case "BOOLCRITFULLPREC"
                                                    strItem = "Use full precision criteria"

                                                Case "BOOLCRITROUNDED"
                                                    strItem = "Use rounded precision criteria"

                                                Case "BOOLMEANFULLPREC"
                                                    strItem = "Use full precision means"

                                                Case "BOOLMEANROUNDED"
                                                    strItem = "Use rounded precision means"


                                                Case Else
                                                    strF = "CHARTABLEREFCOLUMNNAME = '" & strCol & "' AND CHARTABLEREF = '" & strTName & "'"
                                                    dvDR.RowFilter = strF
                                                    ''''''''console.writeline(strF)
                                                    If dvDR.Count = 0 Then
                                                        strItem = "Not Applicable"
                                                    Else
                                                        strItem = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                                    End If
                                            End Select
                                        Case "TBLANALREFSTANDARDS"
                                            strF = "CHARTABLEREFCOLUMNNAME = '" & strCol & "' AND CHARTABLEREF = 'tblCompanyAnalRefTable'"
                                            dvDR.RowFilter = strF
                                            ''''''''console.writeline(strF)
                                            If dvDR.Count = 0 Then
                                                strItem = "Not Applicable"
                                            Else
                                                strItem = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                            End If

                                        Case "TBLINCLUDEDROWS"
                                            strItem = "'A* = Check to include in report' column"

                                        Case "TBLREPORTS"
                                            Select Case strCol
                                                Case "BOOLMULTIVALSUM"
                                                    strItem = "Report Summary Table Type"
                                                Case "BOOLDISPLAYATTACHMENTS"
                                                    strItem = "Display Appendices as Attachments"
                                                Case Else
                                                    strF = "CHARTABLEREFCOLUMNNAME = '" & strCol & "' AND CHARTABLEREF = '" & strTName & "'"
                                                    dvDR.RowFilter = strF
                                                    ''''''''console.writeline(strF)
                                                    If dvDR.Count = 0 Then
                                                        strItem = "Not Applicable"
                                                    Else
                                                        strItem = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                                    End If
                                            End Select

                                        Case "TBLWORDDOCS"

                                            Select Case strCol
                                                Case "ID_TBLWORDSTATEMENTS"
                                                    Dim varAA
                                                    varAA = tblM.Rows(Count1).Item("ID_TBLWORDSTATEMENTS")

                                                    strF = "ID_TBLWORDSTATEMENTS = " & varAA
                                                    Erase rowsT
                                                    rowsT = tblWordStatements.Select(strF)
                                                    If rowsT.Length = 0 Then
                                                        strItem = "Not Applicable"
                                                    Else
                                                        strItem = NZ(rowsT(0).Item("CHARTITLE"), "Not Applicable")
                                                    End If

                                            End Select

                                        Case "TBLWORDSTATEMENTSVERSIONS"
                                            'strItem = "Report body"
                                            strItem = "Word Template"

                                        Case Else

                                            Select Case strTName
                                                Case "TBLUSERACCOUNTS"
                                                    Select Case strCol

                                                        Case "ID_TBLPERMISSIONS"
                                                            strItem = "Assigned Permissions Group"
                                                            'need to add additional information to var1 and var2
                                                            'var1 = old data, need to append old Permissions Name
                                                            strF = "ID_TBLPERMISSIONS = " & var1
                                                            Erase rowsT
                                                            rowsT = tblPermissions.Select(strF)
                                                            If rowsT.Length = 0 Then
                                                            Else
                                                                var3 = NZ(rowsT(0).Item("CHARPERMISSIONSNAME"), "NA")
                                                                var1 = var1 & " (TBLPERMISSIONS.CHARPERMISSIONSNAME = '" & var3 & "' where TBLPERMISIONS.ID_TBLPERMISSIONS = " & var1 & ")"
                                                            End If


                                                            If var2 = 0 Then
                                                                var2 = id_tblPermissions
                                                            End If
                                                            strF = "ID_TBLPERMISSIONS = " & var2
                                                            Erase rowsT
                                                            rowsT = tblPermissions.Select(strF)
                                                            If rowsT.Length = 0 Then
                                                            Else
                                                                var3 = NZ(rowsT(0).Item("CHARPERMISSIONSNAME"), "NA")
                                                                var2 = var2 & " (TBLPERMISSIONS.CHARPERMISSIONSNAME = '" & var3 & "' where TBLPERMISIONS.ID_TBLPERMISSIONS = " & var2 & ")"
                                                            End If


                                                            'strF = "ID_TBLPERMISSIONS = " & id_tblPermissions
                                                            'Erase rowsT
                                                            'rowsT = tblPermissions.Select(strF)
                                                            'var3 = NZ(rowsT(0).Item("CHARPERMISSIONSNAME"), "")
                                                            'var2 = var2 & " (TBLPERMISSIONS.CHARPERMISSIONSNAME = '" & var3 & "' where TBLPERMISIONS.ID_TBLPERMISSIONS = " & var2 & ")"


                                                        Case Else

                                                            strF = "CHARTABLEREFCOLUMNNAME = '" & strCol & "' AND CHARTABLEREF = '" & strTName & "'"
                                                            dvDR.RowFilter = strF
                                                            ''''''''console.writeline(strF)
                                                            If dvDR.Count = 0 Then
                                                                strItem = "Not Applicable"
                                                            Else
                                                                strItem = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                                            End If

                                                    End Select
                                                Case "TBLMETHODVALIDATIONDATA"
                                                    If boolStudies2 Then
                                                        strItem = "Assigned Watson Study"
                                                    Else
                                                        strF = "CHARTABLEREFCOLUMNNAME = '" & strCol & "' AND CHARTABLEREF = '" & strTName & "'"
                                                        dvDR.RowFilter = strF
                                                        ''''''''console.writeline(strF)
                                                        If dvDR.Count = 0 Then
                                                            strItem = "Not Applicable"
                                                        Else
                                                            strItem = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                                        End If
                                                    End If

                                                Case "TBLSTUDIES"
                                                    Select Case CountT
                                                        Case 1 'Modify
                                                            strItem = strLink1Value ' "Not Applicable"
                                                        Case 2 'Add
                                                            strItem = "Configured new study in StudyDoc"
                                                        Case 3 'delete
                                                            strItem = "Deleted study '" & strLink1Value & "' in StudyDoc"
                                                            strLink1 = "Study Name"
                                                    End Select

                                                Case "TBLPERMISSIONS"
                                                    Select Case CountT
                                                        Case 1 'modify

                                                            strF = "CHARTABLEREFCOLUMNNAME = '" & strCol & "' AND CHARTABLEREF = '" & strTName & "'"
                                                            dvDR.RowFilter = strF
                                                            ''''''''console.writeline(strF)
                                                            If dvDR.Count = 0 Then
                                                                strItem = "No Item Available"
                                                            Else
                                                                strItem = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                                            End If
                                                        Case 2 'add
                                                            strItem = "Permissions Group: " & NZ(dr.Item("CHARPERMISSIONSNAME"), "Not Applicable")
                                                        Case 3 'delete
                                                            strItem = "Permissions Group: " & NZ(dr.Item("CHARPERMISSIONSNAME", DataRowVersion.Original), "Not Applicable")
                                                    End Select

                                                Case "TBLSTUDYDOCANALYTES"
                                                    strItem = "Analyte Sort"

                                                Case Else
                                                    Select Case CountT
                                                        Case 1
                                                            strF = "CHARTABLEREFCOLUMNNAME = '" & strCol & "' AND CHARTABLEREF = '" & strTName & "'"
                                                            dvDR.RowFilter = strF
                                                            ''''''''console.writeline(strF)
                                                            If dvDR.Count = 0 Then
                                                                strItem = "No Item Available"
                                                            Else
                                                                strItem = NZ(dvDR(0).Item("CHARROWNAME"), "Not Applicable")
                                                            End If

                                                        Case 2, 3
                                                            strItem = strLink1 & ": " & strLink1Value ' "Not Applicable"
                                                    End Select

                                            End Select

                                    End Select

                                    Dim nr As DataRow = tblAT.NewRow
                                    idSE = idSE + 1
                                    nr("ID_TBLAUDITTRAIL") = idSE 'this will be updated to true value later
                                    nr("ID_TBLSAVEEVENT") = 1
                                    Select Case CountT
                                        Case 1 'modified
                                            If StrComp(var1, "LABIntegrity101", CompareMethod.Text) = 0 Then
                                                var1 = "Null"
                                            End If
                                            If StrComp(var2, "LABIntegrity101", CompareMethod.Text) = 0 Then
                                                var2 = "Null"
                                            End If

                                            gATMods = gATMods + 1
                                        Case 2 'added
                                            Select Case strTName
                                                Case "TBLWORDSTATEMENTS"
                                                    If StrComp(var1, "LABIntegrity101", CompareMethod.Text) = 0 Then
                                                        var1 = "Null"
                                                    End If
                                                    If StrComp(var2, "LABIntegrity101", CompareMethod.Text) = 0 Then
                                                        var2 = "Null"
                                                    End If
                                                Case "TBLWORDDOCS"
                                                    'this is actually a modification
                                                    If StrComp(var1, "LABIntegrity101", CompareMethod.Text) = 0 Then
                                                        var1 = "Null"
                                                    End If
                                                    If StrComp(var2, "LABIntegrity101", CompareMethod.Text) = 0 Then
                                                        var2 = "Null"
                                                    End If
                                                    strAction = "RECORD MODIFIED"
                                                Case "TBLWORDSTATEMENTSVERSIONS"
                                                    var1 = "Not Applicable"
                                                    var3 = dr.Item("INTWORDVERSION").ToString
                                                    var2 = "Version " & var3 & " created." & ChrW(10) & ChrW(13) & " Use Compare Documents feature to view differences in versions"
                                                Case Else
                                                    var1 = "Not Applicable"
                                                    var2 = "Not Applicable"
                                            End Select

                                            gATAdds = gATAdds + 1
                                        Case 3 'deleted
                                            var1 = "Not Applicable"
                                            var2 = "Not Applicable"
                                            gATDeletes = gATDeletes + 1
                                    End Select
                                    nr("CHAROLDVALUE") = CStr(var1)
                                    nr("CHARNEWVALUE") = CStr(var2)
                                    nr("CHARTABLE") = strTName
                                    Select Case strTName
                                        Case "TBLWORDSTATEMENTS"
                                            nr("CHARCOLUMN") = "CHARTITLE"
                                        Case "TBLWORDDOCS"
                                            nr("CHARCOLUMN") = "CHARXML"
                                        Case "TBLPERMISSIONS"
                                            If CountT > 1 Then
                                                nr("CHARCOLUMN") = "CHARPERMISSIONSNAME"
                                            Else
                                                nr("CHARCOLUMN") = tblM.Columns(Count1).ColumnName
                                            End If
                                        Case "TBLWORDSTATEMENTSVERSIONS"
                                            nr("CHARCOLUMN") = tblM.Columns(0).ColumnName
                                        Case "TBLSTUDIES"
                                            If CountT = 3 Then
                                                nr("CHARCOLUMN") = "ID_TBLSTUDIES"
                                            Else
                                                nr("CHARCOLUMN") = tblM.Columns(Count1).ColumnName
                                            End If
                                        Case Else
                                            nr("CHARCOLUMN") = tblM.Columns(Count1).ColumnName
                                    End Select

                                    nr("CHARACTION") = strAction
                                    nr("ID_SOURCETABLE") = idS
                                    nr("CHARLINK1") = strLink1
                                    nr("CHARLINK2") = strLink2
                                    nr("CHARACTUALITEM") = strItem
                                    nr("CHARLINK1VALUE") = strLink1Value
                                    nr("CHARLINK2VALUE") = strLink2Value
                                    nr("CHARTABLEDESCRIPTION") = strTblDescr
                                    nr("CHARAUDITTYPE") = strAuditType
                                    If InStr(1, strAuditType, "Administration", CompareMethod.Text) > 0 Then
                                        nr("ID_TBLSTUDIES") = -1
                                        nr("CHARWATSONSTUDYNAME") = "Not Applicable"
                                    Else

                                        If id_tblStudies = 0 Then
                                            nr("ID_TBLSTUDIES") = -1
                                            nr("CHARWATSONSTUDYNAME") = strStudyName
                                        Else
                                            Select Case strTName
                                                Case "TBLSTUDIES"
                                                    If CountT = 3 Then
                                                        nr("ID_TBLSTUDIES") = gIDDeleteStudy
                                                        nr("CHARWATSONSTUDYNAME") = strLink1Value
                                                    Else
                                                        nr("ID_TBLSTUDIES") = id_tblStudies
                                                        nr("CHARWATSONSTUDYNAME") = strStudyName
                                                    End If
                                                Case Else
                                                    nr("ID_TBLSTUDIES") = id_tblStudies
                                                    nr("CHARWATSONSTUDYNAME") = strStudyName
                                            End Select

                                        End If
                                        'nr("CHARWATSONSTUDYNAME") = strStudyName
                                    End If

                                    nr("CHARWORKSTATION") = gWorkstation
                                    nr("CHARUSERNAME") = gUserName
                                    nr("CHARUSERID") = gUserID


                                    tblAT.Rows.Add(nr)

                                End If

                            End If

                        End If

                    Next

                Next
Next1:
            End If

        Next

end1:


    End Sub

    Sub CreateAuditTrailTemp()

        Dim tbl As System.Data.Datatable
        Dim str1 As String
        Dim str2 As String

        tbl = tblAuditTrailTemp

        Dim col1 As New DataColumn
        str1 = "ID_TBLAUDITTRAIL" 'X
        str2 = "ID"
        col1.ColumnName = str1
        col1.Caption = str2
        col1.DataType = System.Type.GetType("System.Double")
        col1.DefaultValue = 0
        col1.AllowDBNull = True
        tbl.Columns.Add(col1)

        Dim col2 As New DataColumn
        str1 = "ID_TBLSAVEEVENT" 'X
        str2 = "Foreign Key"
        col2.ColumnName = str1
        col2.Caption = str2
        col2.DataType = System.Type.GetType("System.Double")
        col2.DefaultValue = 0
        col2.AllowDBNull = True
        tbl.Columns.Add(col2)

        Dim col3 As New DataColumn
        str1 = "CHAROLDVALUE" 'X
        str2 = "Old Value"
        col3.ColumnName = str1
        col3.Caption = str2
        col3.DataType = System.Type.GetType("System.String")
        'col3.DefaultValue = 0
        col3.AllowDBNull = True
        tbl.Columns.Add(col3)

        Dim col4 As New DataColumn
        str1 = "CHARNEWVALUE" 'X
        str2 = "New Value"
        col4.ColumnName = str1
        col4.Caption = str2
        col4.DataType = System.Type.GetType("System.String")
        'col4.DefaultValue = 0
        col4.AllowDBNull = True
        tbl.Columns.Add(col4)

        Dim col5 As New DataColumn
        str1 = "CHARTABLE" 'X
        str2 = "Database Table"
        col5.ColumnName = str1
        col5.Caption = str2
        col5.DataType = System.Type.GetType("System.String")
        'col5.DefaultValue = 0
        col5.AllowDBNull = True
        tbl.Columns.Add(col5)

        Dim col6 As New DataColumn
        str1 = "CHARCOLUMN" 'X
        str2 = "Table Column"
        col6.ColumnName = str1
        col6.Caption = str2
        col6.DataType = System.Type.GetType("System.String")
        'col6.DefaultValue = 0
        col6.AllowDBNull = True
        tbl.Columns.Add(col6)

        Dim col7 As New DataColumn
        str1 = "CHARACTION" 'X
        str2 = "Action"
        col7.ColumnName = str1
        col7.Caption = str2
        col7.DataType = System.Type.GetType("System.String")
        'col7.DefaultValue = 0
        col7.AllowDBNull = True
        tbl.Columns.Add(col7)

        Dim col8 As New DataColumn
        str1 = "ID_SOURCETABLE" 'X
        str2 = "Record ID"
        col8.ColumnName = str1
        col8.Caption = str2
        col8.DataType = System.Type.GetType("System.Double")
        col8.DefaultValue = 0
        col8.AllowDBNull = True
        tbl.Columns.Add(col8)

        Dim col9 As New DataColumn
        str1 = "CHARLINK1" 'X
        str2 = "Link 1"
        col9.ColumnName = str1
        col9.Caption = str2
        col9.DataType = System.Type.GetType("System.String")
        'col9.DefaultValue = 0
        col9.AllowDBNull = True
        tbl.Columns.Add(col9)

        Dim col10 As New DataColumn
        str1 = "CHARLINK2" 'X
        str2 = "Link 2"
        col10.ColumnName = str1
        col10.Caption = str2
        col10.DataType = System.Type.GetType("System.String")
        'col10.DefaultValue = 0
        col10.AllowDBNull = True
        tbl.Columns.Add(col10)

        Dim col11 As New DataColumn
        str1 = "CHARACTUALITEM" 'X
        str2 = "Item"
        col11.ColumnName = str1
        col11.Caption = str2
        col11.DataType = System.Type.GetType("System.String")
        'col11.DefaultValue = 0
        col11.AllowDBNull = True
        tbl.Columns.Add(col11)

        Dim col12 As New DataColumn
        str1 = "DTSAVEDATE" 'X
        str2 = "Save Date"
        col12.ColumnName = str1
        col12.Caption = str2
        col12.DataType = System.Type.GetType("System.DateTime")
        'col12.DefaultValue = 0
        col12.AllowDBNull = True
        tbl.Columns.Add(col12)

        Dim col13 As New DataColumn
        str1 = "CHARUSERNAME" 'X
        str2 = "User Name"
        col13.ColumnName = str1
        col13.Caption = str2
        col13.DataType = System.Type.GetType("System.String")
        'col13.DefaultValue = 0
        col13.AllowDBNull = True
        tbl.Columns.Add(col13)

        Dim col14 As New DataColumn
        str1 = "CHARUSERID" 'X
        str2 = "User ID"
        col14.ColumnName = str1
        col14.Caption = str2
        col14.DataType = System.Type.GetType("System.String")
        'col14.DefaultValue = 0
        col14.AllowDBNull = True
        tbl.Columns.Add(col14)

        Dim col15 As New DataColumn
        str1 = "CHARTBLREASONFORCHANGE" 'X
        str2 = "Reason For Change"
        col15.ColumnName = str1
        col15.Caption = str2
        col15.DataType = System.Type.GetType("System.String")
        'col15.DefaultValue = 0
        col15.AllowDBNull = True
        tbl.Columns.Add(col15)

        Dim col16 As New DataColumn
        str1 = "CHARTBLCHARMEANINGOFSIG" 'X
        str2 = "Meaning of Signature"
        col16.ColumnName = str1
        col16.Caption = str2
        col16.DataType = System.Type.GetType("System.String")
        'col16.DefaultValue = 0
        col16.AllowDBNull = True
        tbl.Columns.Add(col16)

        Dim col17 As New DataColumn
        str1 = "ID_TBLSTUDIES" 'X
        str2 = "StudyDoc Study ID"
        col17.ColumnName = str1
        col17.Caption = str2
        col17.DataType = System.Type.GetType("System.Double")
        col17.DefaultValue = 0
        col17.AllowDBNull = True
        tbl.Columns.Add(col17)

        Dim col18 As New DataColumn
        str1 = "CHARWORKSTATION" 'X
        str2 = "Workstation Name"
        col18.ColumnName = str1
        col18.Caption = str2
        col18.DataType = System.Type.GetType("System.String")
        'col18.DefaultValue = 0
        col18.AllowDBNull = True
        tbl.Columns.Add(col18)

        Dim col19 As New DataColumn
        str1 = "CHARTABLEDESCRIPTION" 'X
        str2 = "Table Description"
        col19.ColumnName = str1
        col19.Caption = str2
        col19.DataType = System.Type.GetType("System.String")
        'col19.DefaultValue = 0
        col19.AllowDBNull = True
        tbl.Columns.Add(col19)

        Dim col20 As New DataColumn
        str1 = "CHARLINK1Value" 'X
        str2 = "Link 1 Value"
        col20.ColumnName = str1
        col20.Caption = str2
        col20.DataType = System.Type.GetType("System.String")
        'col20.DefaultValue = 0
        col20.AllowDBNull = True
        tbl.Columns.Add(col20)

        Dim col21 As New DataColumn
        str1 = "CHARLINK2VALUE" 'X
        str2 = "Link 2 Value"
        col21.ColumnName = str1
        col21.Caption = str2
        col21.DataType = System.Type.GetType("System.String")
        'col10.DefaultValue = 0
        col21.AllowDBNull = True
        tbl.Columns.Add(col21)

        Dim col22 As New DataColumn
        str1 = "CHARWATSONSTUDYNAME"
        str2 = "Study Name"
        col22.ColumnName = str1
        col22.Caption = str2
        col22.DataType = System.Type.GetType("System.String")
        'col10.DefaultValue = 0
        col22.AllowDBNull = True
        tbl.Columns.Add(col22)

        Dim col23 As New DataColumn
        str1 = "CHARAUDITTYPE"
        str2 = "Audit Type"
        col23.ColumnName = str1
        col23.Caption = str2
        col23.DataType = System.Type.GetType("System.String")
        'col10.DefaultValue = 0
        col23.AllowDBNull = True
        tbl.Columns.Add(col23)

        ' Case 1
        'strSQL = "alter table " & strT & " ADD ID_TBLSAVEEVENT double"'X
        'strID = "ID_TBLSAVEEVENT"
        '                    Case 2
        'strSQL = "alter table " & strT & " ADD CHAROLDVALUE memo"'X
        '                    Case 3
        'strSQL = "alter table " & strT & " ADD CHARNEWVALUE memo"'X
        '                    Case 4
        'strSQL = "alter table " & strT & " ADD CHARTABLE text(50)"'X
        '                    Case 5
        'strSQL = "alter table " & strT & " ADD CHARCOLUMN text(50)"'X
        '                    Case 6
        'strSQL = "alter table " & strT & " ADD CHARACTION text(25)"'X
        '                    Case 7
        'strSQL = "alter table " & strT & " ADD ID_SOURCETABLE double"'X
        '                    Case 8
        'strSQL = "alter table " & strT & " ADD CHARLINK1 text(255)"'X
        '                    Case 9
        'strSQL = "alter table " & strT & " ADD CHARLINK2 text(255)"'X
        '                    Case 10
        'strSQL = "alter table " & strT & " ADD CHARACTUALITEM text(255)"'X

        '                    Case 11
        'strSQL = "alter table " & strT & " ADD DTSAVEDATE date"'X
        '                    Case 12
        'strSQL = "alter table " & strT & " ADD CHARUSERNAME text(255)"'X
        '                    Case 13
        'strSQL = "alter table " & strT & " ADD CHARUSERID text(255)"'X
        '                    Case 14
        'strSQL = "alter table " & strT & " ADD CHARTBLREASONFORCHANGE text(255)"'X
        '                    Case 15
        'strSQL = "alter table " & strT & " ADD CHARTBLCHARMEANINGOFSIG text(255)"'X
        '                    Case 16
        'strSQL = "alter table " & strT & " ADD ID_TBLSTUDIES double"'X
        'strID = "ID_TBLSTUDIES"
        '                    Case 17
        'strSQL = "alter table " & strT & " ADD CHARWORKSTATION text(255)"'X
        '                    Case 18
        'strSQL = "alter table " & strT & " ADD CHARTABLEDESCRIPTION text(255)"'X
        '                    Case 19
        'strSQL = "alter table " & strT & " ADD CHARLINK1VALUE text(255)"'X
        '                    Case 20
        'strSQL = "alter table " & strT & " ADD CHARLINK2VALUE text(255)"'X
        '                    Case 21
        'strSQL = "alter table " & strT & " ADD CHARSTANDARDTIMEZONE text(50)"
        '                    Case 22
        'strSQL = "alter table " & strT & " ADD CHARDAYLIGHTSAVINGZONE text(50)"
        '                    Case 23
        'strSQL = "alter table " & strT & " ADD CHARDAYLIGHTSAVINGTIME text(50)"
        '                    Case 24
        'strSQL = "alter table " & strT & " ADD CHARCOORUNIVTIME text(50)"
        '                    Case 25
        'strSQL = "alter table " & strT & " ADD CHARUTCOFFSET text(50)"
        '                    Case 26
        'strSQL = "alter table " & strT & " ADD CHARWATSONSTUDYNAME text(255)"
        '                    Case 27
        'strSQL = "alter table " & strT & " ADD DTCOORUNIVTIME date"

    End Sub


    Sub SetNormalTable(ByVal wd As Microsoft.Office.Interop.Word.Application)

        With wd

            Try

                With .Selection.ParagraphFormat
                    '.LeftIndent = InchesToPoints(0)
                    '.RightIndent = InchesToPoints(0)
                    .SpaceBefore = 0
                    '.SpaceBeforeAuto = False
                    .SpaceAfter = 0
                    '.SpaceAfterAuto = False
                    .LineSpacingRule = Microsoft.Office.Interop.Word.WdLineSpacing.wdLineSpaceSingle ' wdLineSpaceSingle
                    '.Alignment = wdAlignParagraphLeft
                    .WidowControl = True
                    .KeepWithNext = False
                    .KeepTogether = False
                    .PageBreakBefore = False
                    .NoLineNumber = False
                    .Hyphenation = True
                    '.FirstLineIndent = 0 ' InchesToPoints(0)
                    '.OutlineLevel = Microsoft.Office.Interop.Word.WdOutlineLevel.wdOutlineLevelBodyText ' Microsoft.Office.Interop.Word.WdOutlineLevel.wdOutlineLevelBodyText
                    '.OutlineLevel = Microsoft.Office.Interop.Word.WdOutlineLevel.wdOutlineLevelBodyText ' Microsoft.Office.Interop.Word.WdOutlineLevel.wdOutlineLevelBodyText
                    Try
                        .OutlineLevel = Microsoft.Office.Interop.Word.WdOutlineLevel.wdOutlineLevelBodyText ' Microsoft.Office.Interop.Word.WdOutlineLevel.wdOutlineLevelBodyText
                    Catch ex As Exception

                    End Try
                    .CharacterUnitLeftIndent = 0
                    .CharacterUnitRightIndent = 0
                    .CharacterUnitFirstLineIndent = 0
                    Try
                        .LineUnitBefore = 0
                        .LineUnitAfter = 0
                    Catch ex As Exception

                    End Try
                End With


            Catch ex As Exception

            End Try

        End With

    End Sub

    Sub SetNormal(ByVal wd As Microsoft.Office.Interop.Word.Application)

        Exit Sub

        With wd

            Try

                With .ActiveDocument.Styles("Normal").ParagraphFormat
                    '.LeftIndent = InchesToPoints(0)
                    '.RightIndent = InchesToPoints(0)
                    .SpaceBefore = 0
                    '.SpaceBeforeAuto = False
                    .SpaceAfter = 12
                    '.SpaceAfterAuto = False
                    .LineSpacingRule = Microsoft.Office.Interop.Word.WdLineSpacing.wdLineSpace1pt5 ' Microsoft.Office.Interop.Word.wdlinespacing.wdLineSpaceSingle ' wdLineSpaceSingle
                    '.Alignment = wdAlignParagraphLeft
                    .WidowControl = True
                    .KeepWithNext = False
                    .KeepTogether = False
                    .PageBreakBefore = False
                    .NoLineNumber = False
                    .Hyphenation = True
                    .FirstLineIndent = 0 ' InchesToPoints(0)
                    '.OutlineLevel = Microsoft.Office.Interop.Word.WdOutlineLevel.BodyText ' Microsoft.Office.Interop.Word.WdOutlineLevel.wdOutlineLevelBodyText
                    Try
                        .OutlineLevel = Microsoft.Office.Interop.Word.WdOutlineLevel.wdOutlineLevelBodyText ' Microsoft.Office.Interop.Word.WdOutlineLevel.wdOutlineLevelBodyText
                    Catch ex As Exception

                    End Try
                    .CharacterUnitLeftIndent = 0
                    .CharacterUnitRightIndent = 0
                    .CharacterUnitFirstLineIndent = 0
                    Try
                        .LineUnitBefore = 0
                        .LineUnitAfter = 0
                    Catch ex As Exception

                    End Try

                End With
                'ActiveDocument.Styles("Normal").NoSpaceBetweenParagraphsOfSameStyle = False
                With .ActiveDocument.Styles("Normal")
                    .AutomaticallyUpdate = False
                    .BaseStyle = ""
                    .NextParagraphStyle = "Normal"
                End With

            Catch ex As Exception

            End Try

        End With

    End Sub

    Function DoResetFieldCodes() As Boolean

        DoResetFieldCodes = False

        Dim rows1() As DataRow = tblAppFigs.Select("", "", DataViewRowState.ModifiedOriginal)
        If rows1.Length = 0 Then
            DoResetFieldCodes = False
        Else
            DoResetFieldCodes = True
        End If


        If DoResetFieldCodes Then
        Else
            Dim rows2() As DataRow = tblFieldCodes.Select("", "", DataViewRowState.ModifiedOriginal)
            If rows2.Length = 0 Then
                DoResetFieldCodes = False
            Else
                DoResetFieldCodes = True
            End If
        End If

        If DoResetFieldCodes Then
        Else
            Dim rows2() As DataRow = tblReportTable.Select("", "", DataViewRowState.ModifiedOriginal)
            If rows2.Length = 0 Then
                DoResetFieldCodes = False
            Else
                DoResetFieldCodes = True
            End If
        End If

        If DoResetFieldCodes Then
        Else
            Dim rows2() As DataRow = tblContributingPersonnel.Select("", "", DataViewRowState.ModifiedOriginal)
            If rows2.Length = 0 Then
                DoResetFieldCodes = False
            Else
                DoResetFieldCodes = True
            End If
        End If

    End Function

    Sub ResetFieldCodes(boolDoAll As Boolean)

        Dim str1 As String
        Dim str2 As String
        If tblFieldCodes.Columns.Contains("intAdded") Then
        Else
            Dim col1 As New DataColumn
            str1 = "intAdded"
            str2 = str1
            col1.ColumnName = str1
            col1.Caption = str2
            col1.DataType = System.Type.GetType("System.Int16")
            col1.DefaultValue = 0
            col1.AllowDBNull = True
            tblFieldCodes.Columns.Add(col1)
        End If
        'If tblFieldCodes.Columns.Contains("intAddedStatic") Then
        'Else
        '    Dim col1 As New DataColumn
        '    str1 = "intAddedStatic"
        '    str2 = str1
        '    col1.ColumnName = str1
        '    col1.Caption = str2
        '    col1.DataType = System.Type.GetType("System.Int16")
        '    col1.DefaultValue = 0
        '    col1.AllowDBNull = True
        '    tblFieldCodes.Columns.Add(col1)
        'End If

        'first remove all rows that have been added
        Dim Count1 As Short
        Dim strF As String
        Dim rows() As DataRow
        Dim var1

        '20180829 LEE:
        'only do if needed
        Dim boolDo As Boolean
        If boolDoAll Then
            boolDo = True
        Else

            Dim rows1() As DataRow = tblAppFigs.Select("", "", DataViewRowState.ModifiedOriginal)
            If rows1.Length = 0 Then
                boolDo = False
            Else
                boolDo = True
            End If


            If boolDo Then
            Else
                Dim rows2() As DataRow = tblFieldCodes.Select("", "", DataViewRowState.ModifiedOriginal)
                If rows2.Length = 0 Then
                    boolDo = False
                Else
                    boolDo = True
                End If
            End If

            If boolDo Then
            Else
                Dim rows2() As DataRow = tblReportTable.Select("", "", DataViewRowState.ModifiedOriginal)
                If rows2.Length = 0 Then
                    boolDo = False
                Else
                    boolDo = True
                End If
            End If

            If boolDo Then
            Else
                Dim rows2() As DataRow = tblContributingPersonnel.Select("", "", DataViewRowState.ModifiedOriginal)
                If rows2.Length = 0 Then
                    boolDo = False
                Else
                    boolDo = True
                End If
            End If

        End If


        '20160926 LEE: Don't do this anymore. Implemented boolNeedsFC function

        'strF = "intAdded = -1"
        'rows = tblFieldCodes.Select(strF)

        'For Count1 = 0 To rows.Length - 1
        '    rows(Count1).Delete()
        'Next
        'tblFieldCodes.AcceptChanges()

        If boolDo Then
            Call AddSigBlocks()
            If boolIgnoreFC Then
            Else
                Call AddReportTemplates()
            End If

            'Call AddTables()
            Call AddAppFigs()
            'Call AddExtraFieldCodes()'20190213 LEE: Deprecated

            var1 = var1

            ''set dgvFC
            'Call FillFC()
        End If

    End Sub

    'Sub AddExtraFieldCodes()

    '    '20190110 LEE:
    '    'deprecated

    '    Dim dtbl1 As System.Data.DataTable
    '    Dim dtbl2 As System.Data.DataTable
    '    Dim dtbl3 As System.Data.DataTable
    '    Dim rows1() As DataRow
    '    Dim rows2() As DataRow
    '    Dim rows3() As DataRow
    '    Dim strF1 As String
    '    Dim strF2 As String
    '    Dim strF3 As String
    '    Dim strS As String
    '    Dim int1 As Short
    '    Dim int2 As Short
    '    Dim int3 As Short
    '    Dim Count1 As Short
    '    Dim Count2 As Short
    '    Dim Count3 As Short
    '    Dim intMaxID As Int64
    '    Dim str1 As String
    '    Dim str2 As String
    '    Dim str3 As String
    '    Dim str4 As String
    '    Dim str5 As String
    '    Dim dt As Date
    '    Dim intRowsAF As Short

    '    Dim boolNFC As Boolean = False

    '    dt = Now

    '    dtbl1 = tblFieldCodes
    '    'find intMaxID
    '    strF1 = "ID_TBLFIELDCODES > -1"
    '    strS = "ID_TBLFIELDCODES ASC"
    '    rows1 = dtbl1.Select(strF2, strS)
    '    intMaxID = rows1(rows1.Length - 1).Item("ID_TBLFIELDCODES")

    '    Dim var1

    '    For Count1 = 1 To 23

    '        str1 = "NA" 'Tab
    '        str2 = "" 'Group
    '        str4 = "" 'Table

    '        Select Case Count1

    '            Case 1
    '                str3 = "[UNKNOWNSAMPLEMAXCONC]"
    '                str5 = "Field Code that returns the maximum value reported in a Sample Analysis study Sample Concentrations table"
    '                str1 = "NA"
    '                str2 = "Study Items"
    '                str4 = "NA"
    '            Case 2
    '                str3 = "[UNKNOWNSAMPLEMINCONC]"
    '                str5 = "Field Code that returns the minimum value (or BQL) reported in a Sample Analysis study Sample Concentrations table"
    '                str1 = "NA"
    '                str2 = "Study Items"
    '                str4 = "NA"
    '            Case 3
    '                str3 = "[METHODPROCESSSTABILITY]"
    '                str5 = "Field Code that returns the Process Stability item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 4
    '                str3 = "[METHODREFRIGERATEDSTABILITYINMATRIX]"
    '                'str5 = "Field Code that returns the Refrigerated Stability in Matrix item from the Method Validation table"'deprecated now Reinjection Stability 20181110
    '                str5 = "Field Code that returns the Reinjection Stability in Matrix item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 5
    '                str3 = "[METHODLONGTERMSTORAGESTABILITYINMATRIX]"
    '                str5 = "Field Code that returns the Long-term Storage Stability in Matrix item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 6
    '                str3 = "[METHODDILUTIONINTEGRITY]"
    '                str5 = "Field Code that returns the Dilution Integrity item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 7
    '                str3 = "[METHODANALYTESELECTIVITY]"
    '                str5 = "Field Code that returns the Analyte Selectivity item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 8
    '                str3 = "[METHODINTERNALSTANDARDSELECTIVITY]"
    '                str5 = "Field Code that returns the Internal Standard Selectivity item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table

    '            Case 9
    '                str3 = "[RPTS]"
    '                str5 = "Field Code to designate that the beginning of a section to be repeated"
    '                str1 = "Repeat" 'Tab
    '                str2 = "Repeat" 'Group
    '                str4 = "Repeat" 'Table
    '            Case 10
    '                str3 = "[RPTE]"
    '                str5 = "Field Code to designate that the end of a section to be repeated"
    '                str1 = "Repeat" 'Tab
    '                str2 = "Repeat" 'Group
    '                str4 = "Repeat" 'Table

    '            Case 11
    '                str3 = "[INTERNALSTANDARDRESP]"
    '                str5 = "Field Code adds 'respectively' to the end of the list of Int Std."
    '                str1 = "NA" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "NA" 'Table

    '            Case 12
    '                str3 = "[ANALYTERESP]"
    '                str5 = "Field Code adds 'respectively' to the end of the list of analytes."
    '                str1 = "NA" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "NA" 'Table


    '            Case 13
    '                str3 = "[INITIALANALYSISDATE]"
    '                str5 = "Initial Analysis Date (start date of first analytical run)"
    '                str1 = "NA" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "NA" 'Table

    '            Case 14
    '                str3 = "[LASTANALYSISDATE]"
    '                str5 = "Last Analysis Date (start date of last analytical run)"
    '                str1 = "NA" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "NA" 'Table

    '            Case 15
    '                str3 = "[CONTRIBUTINGPERSONNELTITLETABLE]"
    '                str5 = "Returns a Contributing Personnel table that includes a tabbed Title for each person."
    '                str1 = "NA" 'Tab
    '                str2 = "Contributing Personnel" 'Group
    '                str4 = "NA" 'Table


    '                '20190110 LEE
    '            Case 16
    '                str3 = "[METHODBLOOD]"
    '                'str5 = "Field Code that returns the Refrigerated Stability in Matrix item from the Method Validation table"'deprecated now Reinjection Stability 20181110
    '                str5 = "Field Code that returns the Whole Blood Stability item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 17
    '                str3 = "[METHODSTOCKSOLUTION]"
    '                str5 = "Field Code that returns the Stock Solution Stability item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 18
    '                str3 = "[METHODSPIKINGSOLUTION]"
    '                str5 = "Field Code that returns the Spiking Solution Stability item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 19
    '                str3 = "[METHODAUTOSAMPLER]"
    '                str5 = "Field Code that returns the Autosampler Stability item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 20
    '                str3 = "[METHODREINJECTION]"
    '                str5 = "Field Code that returns the Reinjection Stability item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 21
    '                str3 = "[METHODBATCHREINJECTION]"
    '                str5 = "Field Code that returns the Batch Reinjection Stability item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table


    '                '20190110 LEE:
    '            Case 22
    '                str3 = "[METHODFREEZETHAW]"
    '                str5 = "Field Code that returns the Freeze/Thaw Stability item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table
    '            Case 23
    '                str3 = "[METHODBENCHTOP]"
    '                str5 = "Field Code that returns the Bench Top Stability item from the Method Validation table"
    '                str1 = "Method Validation Data" 'Tab
    '                str2 = "Study Items" 'Group
    '                str4 = "Method Validation" 'Table

    '                'Legend:
    '                'Case 200
    '                '    'strFind = "[METHODPROCESSSTABILITY]"
    '                'Case 201
    '                '    'strFind = "[METHODREFRIGERATEDSTABILITYINMATRIX]"
    '                'Case 202
    '                '    'strFind = "[METHODLONGTERMSTORAGESTABILITYINMATRIX]"
    '                'Case 203
    '                '    'strFind = "[METHODDILUTIONINTEGRITY]"
    '                'Case 204
    '                '    'strFind = "[METHODANALYTESELECTIVITY]"
    '                'Case 205
    '                '    'strFind = "[METHODINTERNALSTANDARDSELECTIVITY]"

    '        End Select

    '        'see if str3 already exists
    '        strF3 = "CHARFIELDCODE = '" & str3 & "'"

    '        boolNFC = boolNeedsFC(str3, str5, 0, dtbl1)
    '        If boolNFC Then


    '            'Erase rows3
    '            'rows3 = dtbl1.Select(strF3)
    '            'int2 = rows3.Length
    '            'If int2 > 0 Then
    '            'Else

    '            'End If

    '            'str5 = "Field Code to REFERENCE Appendix/Figure: " & NZ(rows2(Count1).Item("CHARTITLE"), "NA") & " (Field Code ID = " & str1 & ")"
    '            Dim newRow As DataRow = dtbl1.NewRow
    '            newRow.BeginEdit()
    '            intMaxID = intMaxID + 1
    '            newRow("ID_TBLFIELDCODES") = intMaxID
    '            newRow("CHARFIELDCODE") = str3
    '            newRow("CHARDESCRIPTION") = str5 ' & " for Role " & str2
    '            newRow("CHARTAB") = str1 'rows1(Count1).Item("CHARTAB")
    '            newRow("CHARTABLE") = str4 ' "Unknown Sample Concentration" ' rows1(Count1).Item("CHARTABLE")
    '            newRow("CHAREXAMPLE") = "NA" ' rows1(Count1).Item("CHAREXAMPLE")
    '            newRow("CHARGROUP") = str2 ' "NA"
    '            newRow("UPSIZE_TS") = dt
    '            newRow("intAdded") = -1
    '            newRow("BOOLCUSTOM") = 0
    '            newRow.EndEdit()
    '            dtbl1.Rows.Add(newRow)

    '        End If

    '    Next

    '    dtbl1.AcceptChanges()


    'End Sub

    Sub AddAppFigs()

        Dim dtbl1 As System.Data.DataTable
        Dim dtbl2 As System.Data.DataTable
        Dim dtbl3 As System.Data.DataTable
        Dim rows1() As DataRow
        Dim rows2() As DataRow
        Dim rows3() As DataRow
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim strS As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim intMaxID As Int64
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim dt As Date
        Dim intRowsAF As Short

        Dim boolNFC As Boolean = False

        dt = Now

        dtbl1 = tblFieldCodes
        'find intMaxID
        strF1 = "ID_TBLFIELDCODES > -1"
        strS = "ID_TBLFIELDCODES ASC"
        rows1 = dtbl1.Select(strF2, strS)
        intMaxID = rows1(rows1.Length - 1).Item("ID_TBLFIELDCODES")

        dtbl2 = tblAppFigs

        strS = "ID_TBLAPPFIGS ASC"
        strF2 = "ID_TBLSTUDIES = " & id_tblStudies ' & " AND CHARFCID IS NOT NULL"
        Erase rows1
        rows2 = dtbl2.Select(strF2, strS)
        intRowsAF = rows2.Length

        Dim var1


        If intRowsAF = 0 Then
        Else

            For Count1 = 0 To intRowsAF - 1

                str1 = NZ(rows2(Count1).Item("CHARFCID"), "")
                If Len(str1) = 0 Then
                Else

                    str3 = "[APPFIGREF_" & str1 & "]"

                    'see if str3 already exists



                    'strF3 = "CHARFIELDCODE = '" & str3 & "'"
                    'Erase rows3
                    'rows3 = dtbl1.Select(strF3)
                    'int2 = rows3.Length
                    'If int2 > 0 Then
                    'Else

                    'End If

                    str5 = "Field Code to REFERENCE Appendix/Figure: " & NZ(rows2(Count1).Item("CHARTITLE"), "NA") & " (Field Code ID = " & str1 & ")"
                    boolNFC = boolNeedsFC(str3, str5, 0, dtbl1)
                    If boolNFC Then

                        Dim newRow As DataRow = dtbl1.NewRow
                        newRow.BeginEdit()
                        intMaxID = intMaxID + 1
                        newRow("ID_TBLFIELDCODES") = intMaxID
                        newRow("CHARFIELDCODE") = str3
                        newRow("CHARDESCRIPTION") = str5 ' & " for Role " & str2
                        newRow("CHARTAB") = "Appendix/Figures" 'rows1(Count1).Item("CHARTAB")
                        newRow("CHARTABLE") = "Appendix/Figures" ' rows1(Count1).Item("CHARTABLE")
                        newRow("CHAREXAMPLE") = "NA" ' rows1(Count1).Item("CHAREXAMPLE")
                        newRow("CHARGROUP") = "Appendix/Figures"
                        newRow("UPSIZE_TS") = dt
                        newRow("intAdded") = -1
                        newRow.EndEdit()
                        dtbl1.Rows.Add(newRow)

                    End If

                    str3 = "[APPFIGINSERT_" & str1 & "]"
                    str5 = "Field Code to INSERT Appendix/Figure: " & NZ(rows2(Count1).Item("CHARTITLE"), "NA") & " (Field Code ID = " & str1 & ")"
                    boolNFC = boolNeedsFC(str3, str5, 0, dtbl1)
                    If boolNFC Then

                        Dim newRow1 As DataRow = dtbl1.NewRow
                        newRow1.BeginEdit()
                        intMaxID = intMaxID + 1
                        newRow1("ID_TBLFIELDCODES") = intMaxID
                        newRow1("CHARFIELDCODE") = str3
                        newRow1("CHARDESCRIPTION") = str5 ' & " for Role " & str2
                        newRow1("CHARTAB") = "Appendix/Figures" 'rows1(Count1).Item("CHARTAB")
                        newRow1("CHARTABLE") = "Appendix/Figures" ' rows1(Count1).Item("CHARTABLE")
                        newRow1("CHAREXAMPLE") = "NA" ' rows1(Count1).Item("CHAREXAMPLE")
                        newRow1("CHARGROUP") = "Appendix/Figures"
                        newRow1("UPSIZE_TS") = dt
                        newRow1("intAdded") = -1
                        newRow1.EndEdit()
                        dtbl1.Rows.Add(newRow1)

                        If StrComp(str3, "ANALYTE1", CompareMethod.Text) = 0 Then 'debug
                            var1 = var1
                        End If

                    End If

                End If

            Next

            dtbl1.AcceptChanges()

        End If



    End Sub

    Sub AddSigBlocks()

        Dim dtbl1 As System.Data.DataTable
        Dim dtbl2 As System.Data.DataTable
        Dim dtbl3 As System.Data.DataTable
        Dim rows1() As DataRow
        Dim rows2() As DataRow
        Dim rows3() As DataRow
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim strS As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim Count1 As Int32
        Dim Count2 As Int32
        Dim Count3 As Int32
        Dim Count4 As Int32
        Dim intMaxID As Int64
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim dt As Date

        Dim boolNFC As Boolean = False

        dt = Now

        dtbl1 = tblFieldCodes
        'find intMaxID
        strF1 = "ID_TBLFIELDCODES > -1"
        strS = "ID_TBLFIELDCODES ASC"
        rows1 = dtbl1.Select(strF2, strS)
        intMaxID = rows1(rows1.Length - 1).Item("ID_TBLFIELDCODES")

        strS = "CHARCPROLE ASC"
        If id_tblStudies = 0 Then
            strF2 = "ID_TBLDROPDOWNBOXNAME = 7"
            strS = "CHARVALUE ASC"
            dtbl2 = tblDropdownBoxContent
        Else
            strF2 = "ID_TBLSTUDIES = " & id_tblStudies
            strS = "CHARCPROLE ASC"
            dtbl2 = tblContributingPersonnel
        End If

        Dim dv2 As system.data.dataview = New DataView(dtbl2, strF2, strS, DataViewRowState.CurrentRows)

        If id_tblStudies = 0 Then
            dtbl3 = dv2.ToTable("a", True, "CHARVALUE")
        Else
            dtbl3 = dv2.ToTable("a", True, "CHARCPROLE")
        End If
        int3 = dtbl3.Rows.Count

        'pull out sig blocks from tblFieldCodes
        '20170509 LEE: Deprecated

        strF1 = "CHARFIELDCODE LIKE '*role*'"
        strS = "CHARFIELDCODE ASC"
        Erase rows1
        rows1 = dtbl1.Select(strF1, strS)

        int1 = rows1.Length

        '[roleSIGBLOCKTITLECOMP]
        '[roleSIGBLOCKTITLE]
        '[roleSIGBLOCKTITLEINLINE]
        '[roleSIGBLOCK]
        '[roleNAME]
        '[roleNAMECOLUMN]
        '[roleWSIGBLOCK]
        '[roleWSIGBLOCKROLE]

        int1 = 8

        Dim strA As String
        Dim strB As String

        For Count1 = 0 To int1 - 1

            'str1 = rows1(Count1).Item("CHARFIELDCODE")

            Select Case Count1
                Case 0
                    str1 = "[roleSIGBLOCKTITLECOMP]"
                    strA = "Where 'role' is a role configured in StudyDoc" & ChrW(10) & "Returns a signature block that contains the persons name, degree (if configured), title, and company as a signature block"
                    strB = "Larry E. Elvebak, Ph.D. / Date" & ChrW(10) & "Study Director" & ChrW(10) & "LabIntegrity" & ChrW(10) & "Preclinical Studies"
                Case 1
                    str1 = "[roleSIGBLOCKTITLE]"
                    strA = "Where 'role' is a role configured in StudyDoc" & ChrW(10) & "Returns a signature block that contains the persons name, degree (if configured) and title as a signature block"
                    strB = "Larry E. Elvebak, Ph.D." & ChrW(10) & "Study Director"
                Case 2
                    str1 = "[roleSIGBLOCK]"
                    strA = " Where 'role' is a role configured in StudyDoc" & ChrW(10) & "Returns a signature block that contains the persons name and degree (if configured) as a signature block"
                    strB = "Larry E. Elvebak, Ph.D. / Date"
                Case 3
                    str1 = "[roleNAME]"
                    strA = "Where 'role' is a role configured in StudyDoc" & ChrW(10) & "Returns a persons name and degree (if configured). If more than one, returns the names in a single line."
                    strB = "Larry E. Elvebak, Ph.D., Mitchell L. Elvebak, MS"
                Case 4
                    str1 = "[roleNAMECOLUMN]"
                    strA = "Where 'role' is a role configured in StudyDoc" & ChrW(10) & "Returns a persons name and degree (if configured). If more than one, returns the names in a column"
                    strB = "Larry E. Elvebak, Ph.D." & ChrW(10) & "Mitchell L. Elvebak, MS"
                Case 5
                    str1 = "[roleWSIGBLOCK]"
                    strA = "Where 'role' is a role configured in StudyDoc" & ChrW(10) & "Returns a signature block that contains the persons name, degree (if configured) and title, as a signature block"
                    strB = "[TIMEZONE]" & ChrW(10) & "Larry E. Elvebak, Ph.D Date Time Other Zone" & ChrW(10) & "Study Director (dd-mmm-yyyy) (24 hour clock)"
                Case 6
                    str1 = "[roleWSIGBLOCKROLE]"
                    strA = "Where 'role' is a role configured in StudyDoc" & ChrW(10) & "Returns a signature block that contains the persons name, degree (if configured), title, and role as a signature block"
                    strB = "[TIMEZONE]" & ChrW(10) & "Larry E. Elvebak, Ph.D Date Time Other Zone" & ChrW(10) & "Study Director (dd-mmm-yyyy) (24 hour clock)" & ChrW(10) & "Bioanalytical R"
                Case 7
                    str1 = "[roleSIGBLOCKTITLEINLINE]"
                    strA = "Where 'role' is a role configured in StudyDoc" & ChrW(10) & "Returns a signature block that contains the persons name, degree (if configured) and inline title"
                    strB = "Larry E. Elvebak, Ph.D., Study Director"
            End Select
            'add distinct items to dtbl1
            For Count3 = 0 To int3 - 1
                intMaxID = intMaxID + 1

                If id_tblStudies = 0 Then
                    str2 = NZ(dtbl3.Rows(Count3).Item("CHARVALUE"), "")
                Else
                    str2 = NZ(dtbl3.Rows(Count3).Item("CHARCPROLE"), "")
                End If

                If Len(str2) = 0 Then
                    GoTo next1
                End If
                str3 = Replace(str1, "role", str2, 1, 1, CompareMethod.Text)
                'str4 = Replace(rows1(Count1).Item("CHARDESCRIPTION"), "role", str2, 1, 1, CompareMethod.Binary)
                str4 = Replace(strA, "role", str2, 1, 1, CompareMethod.Binary)
                str5 = Replace(str4, "role", "Contributing Personnel Role", 1, 1, CompareMethod.Binary)

                'see if str3 already exists
                strF3 = "CHARFIELDCODE = '" & str3 & "'"

                boolNFC = boolNeedsFC(str3, str5, 0, dtbl1)
                If boolNFC Then

                    'Erase rows3
                    'rows3 = dtbl1.Select(strF3)
                    'int2 = rows3.Length
                    'If int2 > 0 Then
                    '    GoTo next1
                    'End If

                    Dim newRow As DataRow = dtbl1.NewRow
                    newRow.BeginEdit()

                    newRow("ID_TBLFIELDCODES") = intMaxID
                    newRow("CHARFIELDCODE") = str3

                    newRow("CHARDESCRIPTION") = str5 ' & " for Role " & str2
                    newRow("CHARTAB") = "Contributing Personnel" ' rows1(Count1).Item("CHARTAB")
                    newRow("CHARTABLE") = "NA" ' rows1(Count1).Item("CHARTABLE")
                    newRow("CHAREXAMPLE") = strB 'rows1(Count1).Item("CHAREXAMPLE")
                    newRow("CHARGROUP") = "Signature Block"
                    newRow("UPSIZE_TS") = dt

                    newRow("intAdded") = -1

                    newRow.EndEdit()

                    dtbl1.Rows.Add(newRow)

                End If

next1:

            Next Count3

        Next Count1

        dtbl1.AcceptChanges()

    End Sub


    Sub SearchReplaceRunID(ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal strFind As String, ByVal varReplace As Object, ByVal boolRng As Boolean) ', ByVal intS, ByVal intE)

        Dim Count1 As Short
        Dim Count2 As Short
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        'Dim myRng As Microsoft.Office.Interop.Word.selection
        Dim myRng As Microsoft.Office.Interop.Word.Range
        Dim strM As String
        Dim strM1 As String
        Dim strM2 As String
        Dim boolFound As Boolean
        Dim mySel As Microsoft.Office.Interop.Word.Selection

        wd.Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
        If boolRng Then
            wd.Selection.WholeStory()
        Else
            wd.Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
        End If
        wd.Selection.WholeStory()
        myRng = wd.Selection.Range
        mySel = wd.Selection

        Dim strR As String

        strM = frmH.lblProgress.Text


        'first determine if there is something to replace
        With mySel.Find
            .ClearFormatting()
            '.Text = strFind
            .Forward = True
            .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
            .Execute(FindText:=strFind)

            If .Found Then
                boolFound = True
            Else
                boolFound = False
            End If

        End With

        If boolRng Then
        Else
            If StrComp(varReplace, "NA", CompareMethod.Text) = 0 Then
                boolRng = False
            Else
                boolRng = True
            End If
        End If

        If InStr(1, strFind, "Back", CompareMethod.Text) > 0 Then 'debugging
            strR = boolFound
            'wdd.visible = True
        End If

        '.selection.SetRange(Start:=0, End:=pos2)


        If boolFound Then

            'varReplace = ReturnSearch(wd, charSectionName, Count1, strFind, myRng)

            If boolRng Then 'use find range

                With myRng.Find
                    .ClearFormatting()
                    .Text = strFind
                    With .Replacement
                        .ClearFormatting()
                        strR = CStr(NZ(varReplace, "NA"))
                        .Text = strR
                    End With
                    .Execute(Replace:=Microsoft.Office.Interop.Word.WdReplace.wdReplaceAll, Format:=True, MatchCase:=False, MatchWholeWord:=True)

                End With
            Else 'use find selection

                'move back one character space or the selected find will be skipped
                wd.Selection.MoveLeft(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)

                With mySel.Find

                    'wdd.visible = True
                    .ClearFormatting()
                    .Text = strFind
                    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindStop ' wdFindContinue
                    With .Replacement
                        .ClearFormatting()
                        strR = CStr(NZ(varReplace, ""))
                        .Text = strR 'varReplace
                    End With
                    Do While .Execute(Replace:=Microsoft.Office.Interop.Word.WdReplace.wdReplaceOne, Format:=True, MatchCase:=False, MatchWholeWord:=True)

                        If StrComp(strR, "NA", CompareMethod.Text) = 0 Then 'make red font

                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed ' wdColorRed
                            wd.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                            '20181015 LEE:
                            wd.Selection.Font.Bold = True

                        End If
                    Loop
                End With

            End If

        End If


    End Sub


    Sub RunIDSearch(ByVal wd As Microsoft.Office.Interop.Word.Application)

        'the routine will create role-base signature items
        Dim dtbl1 As System.Data.DataTable
        Dim dtbl2 As System.Data.DataTable
        Dim dtbl3 As System.Data.DataTable
        Dim rows1() As DataRow
        Dim rows2() As DataRow
        Dim rows3() As DataRow
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim strS As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim Count6 As Short
        Dim intMaxID As Int64
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim dt As Date
        Dim intRows1 As Short
        Dim intRows2 As Short
        Dim intRows3 As Short
        Dim id1 As Int16
        Dim id2 As Int16
        Dim id3 As Int16
        Dim strRepTemplate As String
        Dim strA As String
        Dim strB As String
        Dim strC As String
        Dim varR, var1, var2, var3, var4, var5
        Dim dtblAss As System.Data.DataTable
        Dim varTableR() As String

        Dim idR As Int16
        Dim strF As String
        Dim minPrecision As String
        Dim maxPrecision As String
        Dim minAccuracy As String
        Dim maxAccuracy As String

        Dim intAnalyteIndex As Int64
        Dim intAnalyteID As Int64
        Dim intMasterAssayID As Int64

        Dim intAss As Int16
        Dim boolTable As Boolean = False

        Dim strDel As String = "_"

        dtbl2 = tblTemplates
        dtbl3 = tblReportTable
        dtblAss = tblAssignedSamples
        strF = "ID_TBLSTUDIES = " & id_tblStudies
        Dim dvAss As system.data.dataview = New DataView(dtblAss, strF, "ID_TBLSTUDIES", DataViewRowState.CurrentRows)

        strF2 = "BOOLACTIVE = -1"
        strS = "CHARTEMPLATENAME ASC"
        Dim dv2 As system.data.dataview = New DataView(dtbl2, strF2, strS, DataViewRowState.CurrentRows)
        intRows2 = dv2.Count

        Dim intL As Short
        Dim intLL As Short
        Dim boolIS As Boolean = False

        Dim tblN As System.Data.DataTable
        Dim strN As String
        Dim intRowsN As Short

        Dim rowsAR() As DataRow

        Dim boolRange As Boolean
        Dim intRunID As Int64

        Dim idCR As Int64
        Dim strFCID As String
        Dim idRT As Int64

        tblN = tblTableN

        intL = 0
        intLL = 5

        'For Count1 = 0 To intRows2 - 1

        'str1 = dv2(Count1).Item("CHARTEMPLATENAME")
        id2 = id_tblStudies 'dv2(Count1).Item("ID_TBLSTUDIES")

        strF3 = "ID_TBLSTUDIES = " & id2 & " AND BOOLINCLUDE = -1"
        'strS = "ID_TBLREPORTTABLE ASC"
        strS = "INTORDER ASC"
        Dim dv3 As system.data.dataview = New DataView(dtbl3, strF3, strS, DataViewRowState.CurrentRows)
        intRows3 = dv3.Count

        strRepTemplate = str1

        Dim boolSkip As Boolean
        Dim strAnalyte As String

        'first use dvAss to look for all tables that have been assigned
        'then look elsewhere for tables that exist, but have not been assigned
        For Count4 = 1 To 8
            boolRange = False
            boolIS = False
            Select Case Count4
                Case 1
                    strA = "TableREFTable_"
                    strB = "Tables for Table - "
                    strC = "Field code to insert a reference to table: "
                    boolRange = True
                Case 2
                    strA = "RunIDTable_"
                    strB = "Run IDs of runs for Table - "
                    strC = "Run ID for runs associated with table: "
                    boolRange = True
                Case 3
                    strA = "FirstAnalysisDateTable_"
                    strB = "First Analysis Date of runs for Table - "
                    strC = "First Analysis Date of runs associated with table: "
                    boolRange = True
                Case 4 '
                    strA = "LastAnalysisDateTable_"
                    strB = "Last Analysis Date of runs for Table - "
                    strC = "Last Analysis Date of runs associated with table: "
                    boolRange = True

                Case 5
                    strA = "TableINSERTTable_"
                    strB = "Tables for Table - "
                    strC = "Field code to INSERT table: "
                    boolRange = True
                Case 6
                    strA = "AnalyteREFTable_"
                    strB = "Analyte(s) associated with runs for Table - "
                    strC = "Analyte(s) associated with table: "
                    boolRange = True
                Case 7
                    strA = "(n)Table_"
                    strB = "Number of samples for Table - "
                    strC = "Number of samples associated with table: "
                    boolRange = True


                Case 8
                    strA = "IS_TableREFTable_"
                    strB = "Int Std Tables for Table - "
                    strC = "Field code to insert a reference to table: "
                    boolRange = True
                    boolIS = True


            End Select

            Dim boolIsIS As Boolean
            Dim intPH As Short

            If SearchReplaceRunIDTest(wd, strA) Then

                boolTable = False
                For Count2 = 0 To intRows3 - 1


                    'wdd.visible = True

                    boolSkip = False
                    idCR = dv3(Count2).Item("ID_TBLCONFIGREPORTTABLES")
                    idRT = dv3(Count2).Item("ID_TBLREPORTTABLE")
                    strFCID = NZ(dv3(Count2).Item("CHARFCID"), "LABIntegrityAAA")
                    intPH = NZ(dv3(Count2).Item("BOOLPLACEHOLDER"), 0)
                    'do not make this for placeholder PH
                    str1 = Mid(strFCID, 1, 2)
                    If StrComp(str1, "PH", CompareMethod.Text) = 0 And Count4 <> 1 Then
                        strFCID = "LABIntegrityAAA"
                    End If


                    'No! Must still do placeholders
                    'If intPH <> 0 Then
                    '    strFCID = "LABIntegrityAAA"
                    'End If
                    If StrComp(strFCID, "QCINTRA2", CompareMethod.Text) = 0 And Count4 = 1 Then 'debugging
                        var1 = var1
                    End If

                    Select Case Count4
                        Case 8
                            Select Case idCR
                                Case 13, 14, 15, 22, 31, 32

                                Case Else
                                    strFCID = "LABIntegrityAAA"
                            End Select
                    End Select

                    If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                    Else

                        str1 = dv3(Count2).Item("CHARHEADINGTEXT")
                        str2 = Replace(str1, " ", "_", 1, -1, CompareMethod.Text)
                        'str3 = "[" & strA & str2 & "]"
                        str3 = "[" & strA & strFCID & "]"
                        strN = strA & str2
                        str4 = strC & str1



                        intL = intL + 1
                        If intL >= intLL Then
                            frmH.lblProgress.Text = "Field Code Search:" & ChrW(10) & strN
                            frmH.lblProgress.Refresh()
                            intLL = intLL + 5
                        End If

                        'find replacement value
                        idR = dv3(Count2).Item("ID_TBLREPORTTABLE")
                        strF = "ID_TBLREPORTTABLE = " & idR
                        strS = "RUNSAMPLESEQUENCENUMBER ASC"
                        dvAss.RowFilter = strF
                        dvAss.Sort = strS
                        boolTable = False
                        intRowsN = 0
                        Select Case Count4
                            Case 1, 8 'TableREFTable_

                                'debug
                                If StrComp(strFCID, "BLD01B", CompareMethod.Text) = 0 Then
                                    var1 = var1
                                End If

                                boolTable = True
                                'find tablename in tbln
                                strF = "TableName = '" & str1 & "' AND CHARFCID = '" & strFCID & "'"
                                strS = "TableNumber ASC"
                                Dim rowsN() As DataRow
                                rowsN = tblN.Select(strF, strS)
                                intRowsN = rowsN.Length
                                ReDim varTableR(intRowsN)

                                'for now, use the first one
                                If InStr(1, str3, "Back", CompareMethod.Text) > 0 Then 'debugging
                                    var1 = var2
                                End If

                                If boolDoHyperlinks Then

                                    If intRowsN = 0 Then
                                        varR = "[NA]"
                                    Else
                                        varR = ""
                                        int1 = -1

                                        Dim arrT(intRowsN)
                                        Dim intT As Short = 0
                                        For Count5 = 0 To intRowsN - 1
                                            strAnalyte = rowsN(Count5).Item("AnalyteName")
                                            boolIsIS = DoIntStdDtbl(tblAnalytesHome.Rows.Count, tblAnalytesHome, strAnalyte)
                                            Select Case Count4
                                                Case 1 ' do not include IntStd
                                                    If boolIsIS Then
                                                    Else
                                                        intT = intT + 1
                                                        arrT(intT) = rowsN(Count5).Item("TABLENUMBER")
                                                    End If
                                                Case 8 'do only Int Std
                                                    If boolIsIS Then
                                                        intT = intT + 1
                                                        arrT(intT) = rowsN(Count5).Item("TABLENUMBER")
                                                    End If
                                            End Select

nextCount5a:

                                        Next Count5

                                        If boolUseHyperlinks Then
                                            strDel = "_"
                                        Else
                                            strDel = ChrW(160)
                                        End If

                                        For Count5 = 0 To intT - 1

                                            If Count5 = 0 Then
                                                var1 = arrT(Count5 + 1)
                                                varR = "Table" & strDel & var1
                                            Else
                                                If intT = 2 Then
                                                    var1 = arrT(Count5 + 1)
                                                    varR = varR & " and Table" & strDel & var1
                                                Else
                                                    If Count5 > 0 And Count5 < intT - 1 Then
                                                        var1 = arrT(Count5 + 1)
                                                        varR = varR & ", Table" & strDel & var1
                                                    Else
                                                        var1 = arrT(Count5 + 1)
                                                        varR = varR & ", and Table" & strDel & var1
                                                    End If
                                                End If

                                            End If

nextCount5b:

                                        Next Count5


                                    End If

                                Else

                                    If intRowsN = 0 Then
                                        varR = "[NA]"
                                    Else
                                        varR = ""

                                        Dim arrT(intRowsN)
                                        Dim intT As Short = 0
                                        For Count5 = 0 To intRowsN - 1
                                            strAnalyte = rowsN(Count5).Item("AnalyteName")
                                            boolIsIS = DoIntStd(intRowsN, rowsN, strAnalyte)
                                            Select Case Count4
                                                Case 1 ' do not include IntStd
                                                    If boolIsIS Then
                                                    Else
                                                        intT = intT + 1
                                                        arrT(intT) = rowsN(Count5).Item("TABLENUMBER")
                                                    End If
                                                Case 8 'do only Int Std
                                                    If boolIsIS Then
                                                        intT = intT + 1
                                                        arrT(intT) = rowsN(Count5).Item("TABLENUMBER")
                                                    End If
                                            End Select

                                        Next Count5

                                        If boolUseHyperlinks Then
                                            strDel = "_"
                                        Else
                                            strDel = ChrW(160)
                                        End If

                                        For Count5 = 0 To intT - 1

                                            If Count5 = 0 Then
                                                var1 = arrT(Count5 + 1)
                                                varR = "Table" & strDel & var1
                                            Else
                                                If intT = 2 Then
                                                    var1 = arrT(Count5 + 1)
                                                    varR = varR & " and Table" & strDel & var1
                                                Else
                                                    If Count5 > 0 And Count5 < intT - 1 Then
                                                        var1 = arrT(Count5 + 1)
                                                        varR = varR & ", Table" & strDel & var1
                                                    Else
                                                        var1 = arrT(Count5 + 1)
                                                        varR = varR & ", and Table" & strDel & var1
                                                    End If
                                                End If

                                            End If

                                        Next Count5

                                    End If

                                End If

                            Case 2 'runid
                                varR = "NA"
                                Select Case idCR

                                    Case 1 'AnalRunSummary, 
                                        varR = "[NA]"

                                        Dim dvARS As System.Data.DataView
                                        dvARS = frmH.dgvAnalyticalRunSummary.DataSource

                                        strF = "RUNID > 0"
                                        strS = "RUNID ASC"
                                        'Dim dvRID as system.data.dataview = New DataView(tblRegCon, strF, strS, DataViewRowState.CurrentRows)
                                        Dim tblRID As System.Data.DataTable = dvARS.ToTable("a", True, "Watson Run ID")
                                        Dim rowsAA() As DataRow
                                        strF = "[Watson Run ID] IS NOT NULL"
                                        rowsAA = tblRID.Select(strF, "[Watson Run ID] ASC")
                                        Dim intRID As Short = rowsAA.Length
                                        Dim CountA As Short

                                        Dim intA1 As Short
                                        Dim intE1 As Short

                                        intE1 = intRID - 1
                                        intA1 = -1

                                        If intRID < 3 Then
                                            For CountA = 0 To intRID - 1
                                                var1 = NZ(rowsAA(CountA).Item("Watson Run ID"), "")
                                                If Len(var1) = 0 Then
                                                    intE1 = intE1 - 1
                                                Else
                                                    intA1 = intA1 + 1
                                                    If intA1 = 0 Then
                                                        varR = var1
                                                    Else
                                                        varR = varR & " and " & var1
                                                    End If
                                                End If
                                            Next
                                        Else
                                            For CountA = 0 To intRID - 1
                                                var1 = NZ(rowsAA(CountA).Item("Watson Run ID"), "")
                                                If Len(var1) = 0 Then
                                                    intE1 = intE1 - 1
                                                Else
                                                    intA1 = intA1 + 1
                                                    If intA1 = 0 Then
                                                        varR = var1
                                                    ElseIf intA1 = intE1 Then
                                                        varR = varR & ", and " & var1
                                                    Else
                                                        varR = varR & ", " & var1
                                                    End If
                                                End If
                                            Next
                                        End If


                                    Case 2 'Regression Constants

                                        strF = "RUNID > 0"
                                        strS = "RUNID ASC"
                                        Dim dvRID As System.Data.DataView = New DataView(tblRegCon, strF, strS, DataViewRowState.CurrentRows)
                                        Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                        Dim intRID As Short = tblRID.Rows.Count
                                        Dim CountA As Short

                                        If intRID = 0 Then
                                            varR = "[NA]"
                                        Else
                                            varR = "NA"
                                            If intRID < 3 Then
                                                For CountA = 0 To intRID - 1
                                                    If CountA = 0 Then
                                                        varR = tblRID.Rows(CountA).Item("RUNID")
                                                    Else
                                                        var1 = tblRID.Rows(CountA).Item("RUNID")
                                                        varR = varR & " and " & var1
                                                    End If
                                                Next
                                            Else
                                                For CountA = 0 To intRID - 1
                                                    If CountA = 0 Then
                                                        varR = tblRID.Rows(CountA).Item("RUNID")
                                                    ElseIf CountA = tblRID.Rows.Count - 1 Then
                                                        var1 = tblRID.Rows(CountA).Item("RUNID")
                                                        varR = varR & ", and " & var1
                                                    Else
                                                        var1 = tblRID.Rows(CountA).Item("RUNID")
                                                        varR = varR & ", " & var1
                                                    End If
                                                Next
                                            End If

                                        End If

                                    Case 3 'Calibr Stds

                                        'first determine whether to use normal or assigned samples
                                        strF = "ID_TBLREPORTTABLE = " & idRT
                                        Dim rRT() As DataRow
                                        rRT = tblReportTable.Select(strF)
                                        var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                        If var1 = 0 Then
                                            'look for non-assigned samples
                                            strF = "RUNID > 0"
                                            strS = "RUNID ASC"
                                            Dim dvRIDa As System.Data.DataView = New DataView(tblBCStdConcs, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                            Dim intRIDa As Short = tblRIDa.Rows.Count
                                            Dim CountAa As Short

                                            varR = "NA"
                                            If intRIDa < 3 Then
                                                For CountAa = 0 To intRIDa - 1
                                                    If CountAa = 0 Then
                                                        varR = tblRIDa.Rows(CountAa).Item("RUNID")
                                                    Else
                                                        var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        varR = varR & " and " & var1
                                                    End If
                                                Next
                                            Else
                                                For CountAa = 0 To intRIDa - 1
                                                    If CountAa = 0 Then
                                                        varR = tblRIDa.Rows(CountAa).Item("RUNID")
                                                    ElseIf CountAa = tblRIDa.Rows.Count - 1 Then
                                                        var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        varR = varR & ", and " & var1
                                                    Else
                                                        var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        varR = varR & ", " & var1
                                                    End If
                                                Next
                                            End If

                                        Else

                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "NA"
                                            Else
                                                varR = "NA"
                                                If intRID < 3 Then
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & " and " & var1
                                                        End If
                                                    Next
                                                Else
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        ElseIf CountA = tblRID.Rows.Count - 1 Then
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", and " & var1
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", " & var1
                                                        End If
                                                    Next
                                                End If
                                            End If

                                        End If

                                    Case 4 'QC Stds


                                        'first determine whether to use normal or assigned samples
                                        strF = "ID_TBLREPORTTABLE = " & idRT
                                        Dim rRT() As DataRow
                                        rRT = tblReportTable.Select(strF)
                                        var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                        If var1 = 0 Then

                                            'look for non-assigned samples

                                            strF = "RUNID > 0"
                                            strS = "RUNID ASC"
                                            Dim dvRIDa As System.Data.DataView = New DataView(tblBCQCConcs, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                            Dim intRIDa As Short = tblRIDa.Rows.Count
                                            Dim CountAa As Short

                                            varR = "NA"
                                            If intRIDa < 3 Then
                                                For CountAa = 0 To intRIDa - 1
                                                    If CountAa = 0 Then
                                                        varR = tblRIDa.Rows(CountAa).Item("RUNID")
                                                    Else
                                                        var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        varR = varR & " and " & var1
                                                    End If
                                                Next
                                            Else
                                                For CountAa = 0 To intRIDa - 1
                                                    If CountAa = 0 Then
                                                        varR = tblRIDa.Rows(CountAa).Item("RUNID")
                                                    ElseIf CountAa = tblRIDa.Rows.Count - 1 Then
                                                        var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        varR = varR & ", and " & var1
                                                    Else
                                                        var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        varR = varR & ", " & var1
                                                    End If
                                                Next
                                            End If

                                        Else
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "NA"
                                            Else
                                                varR = "NA"
                                                If intRID < 3 Then
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & " and " & var1
                                                        End If
                                                    Next
                                                Else
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        ElseIf CountA = tblRID.Rows.Count - 1 Then
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", and " & var1
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", " & var1
                                                        End If
                                                    Next
                                                End If

                                            End If
                                        End If

                                    Case 5

                                        'varR = NZ(ctrsSamples(2, Count2), "[NA]")

                                        'first get runid from tblsampledesign
                                        strF = "DESIGNSUBJECTID > 0"
                                        strS = "RUNID ASC"
                                        Dim dvRID As System.Data.DataView = New DataView(tblSampleDesign, strF, strS, DataViewRowState.CurrentRows)
                                        Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                        Dim intRID As Short = tblRID.Rows.Count
                                        'first row is first runid
                                        Dim varRID = tblRID.Rows(0).Item("RUNID")

                                        Try
                                            varR = varRID

                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "NA"
                                            Else
                                                varR = "NA"
                                                If intRID < 3 Then
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & " and " & var1
                                                        End If
                                                    Next
                                                Else
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        ElseIf CountA = tblRID.Rows.Count - 1 Then
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", and " & var1
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", " & var1
                                                        End If
                                                    Next
                                                End If

                                            End If

                                        Catch ex As Exception
                                            varR = "[NA]"
                                        End Try

                                    Case 6 'reassay

                                    Case 7 'repeat

                                    Case 30 'ISR

                                    Case Else

                                        strF = "ID_TBLREPORTTABLE = " & idRT
                                        strS = "RUNID ASC"
                                        Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                        Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                        Dim intRID As Short = tblRID.Rows.Count

                                        If intRID = 0 Then
                                            If idCR < 8 Then
                                                boolSkip = True
                                            End If
                                            varR = "[NA]"
                                        Else
                                            Dim CountA As Short
                                            varR = "NA"
                                            If intRID < 3 Then
                                                For CountA = 0 To intRID - 1
                                                    If CountA = 0 Then
                                                        varR = tblRID.Rows(CountA).Item("RUNID")
                                                    Else
                                                        var1 = tblRID.Rows(CountA).Item("RUNID")
                                                        varR = varR & " and " & var1
                                                    End If
                                                Next
                                            Else
                                                For CountA = 0 To intRID - 1
                                                    If CountA = 0 Then
                                                        varR = tblRID.Rows(CountA).Item("RUNID")
                                                    ElseIf CountA = tblRID.Rows.Count - 1 Then
                                                        var1 = tblRID.Rows(CountA).Item("RUNID")
                                                        varR = varR & ", and " & var1
                                                    Else
                                                        var1 = tblRID.Rows(CountA).Item("RUNID")
                                                        varR = varR & ", " & var1
                                                    End If
                                                Next
                                            End If


                                        End If

                                End Select

                                '*****

                            Case 3 'FirstAnalysisDate

                                Select Case idCR
                                    'Case 1, 2, 3, 4, 6, 7 'these tables don't have assigned samples, except 3 and 4 might

                                    Case 1, 6, 7 'these tables don't have assigned samples, except 3 and 4 might
                                        varR = "[NA]"

                                    Case 2 'regression

                                        strF = "RUNID > 0"
                                        strS = "RUNID ASC"
                                        Dim dvRID As System.Data.DataView = New DataView(tblRegCon, strF, strS, DataViewRowState.CurrentRows)
                                        Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                        Dim intRID As Short = tblRID.Rows.Count
                                        Dim CountA As Short

                                        If intRID = 0 Then
                                            varR = "[NA]"
                                        Else
                                            var2 = tblRID.Rows(0).Item("RUNID")

                                            'get date from runid
                                            strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                            rowsAR = tblAnalRunSum.Select(strF)
                                            If rowsAR.Length = 0 Then
                                                var3 = "[NA]"
                                            Else
                                                var3 = rowsAR(0).Item("Analysis Date")
                                            End If

                                            If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                varR = "[NA]"
                                            Else
                                                varR = Format(CDate(var3), LTextDateFormat)
                                            End If


                                        End If


                                    Case 3 'Calibr Stds

                                        varR = "NA"

                                        'first determine whether to use normal or assigned samples
                                        strF = "ID_TBLREPORTTABLE = " & idRT
                                        Dim rRT() As DataRow
                                        rRT = tblReportTable.Select(strF)
                                        var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                        If var1 = 0 Then

                                            'look for non-assigned samples
                                            strF = "RUNID > 0"
                                            strS = "RUNID ASC"
                                            Dim dvRIDa As System.Data.DataView = New DataView(tblBCStdConcs, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                            Dim intRIDa As Short = tblRIDa.Rows.Count
                                            Dim CountAa As Short

                                            If intRIDa = 0 Then
                                                varR = "NA"
                                            Else
                                                var2 = tblRIDa.Rows(0).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If

                                            End If

                                        Else

                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "[NA]"
                                            Else

                                                var2 = tblRID.Rows(0).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If
                                            End If
                                        End If

                                    Case 4 'QC Stds

                                        varR = "NA"

                                        'first determine whether to use normal or assigned samples
                                        strF = "ID_TBLREPORTTABLE = " & idRT
                                        Dim rRT() As DataRow
                                        rRT = tblReportTable.Select(strF)
                                        var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                        If var1 = 0 Then

                                            'look for non-assigned samples

                                            strF = "RUNID > 0"
                                            strS = "RUNID ASC"
                                            Dim dvRIDa As System.Data.DataView = New DataView(tblBCQCConcs, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                            Dim intRIDa As Short = tblRIDa.Rows.Count
                                            Dim CountAa As Short

                                            If intRIDa = 0 Then
                                                varR = "NA"
                                            Else
                                                var2 = tblRIDa.Rows(0).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If
                                            End If

                                        Else
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "[NA]"
                                            Else

                                                var2 = tblRID.Rows(0).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If

                                            End If
                                        End If


                                    Case 5 'this is Samples
                                        'first get runid from tblsampledesign
                                        strF = "DESIGNSUBJECTID > 0"
                                        strS = "RUNID ASC"
                                        Dim dvRID As System.Data.DataView = New DataView(tblSampleDesign, strF, strS, DataViewRowState.CurrentRows)
                                        Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                        Dim intRID As Short = tblRID.Rows.Count
                                        'first row is first runid
                                        Dim varRID = tblRID.Rows(0).Item("RUNID")
                                        'now get Analysis date of varRID from tblAnalRuns
                                        Dim rowsRID() As DataRow
                                        strF = "[Watson Run ID] = '" & varRID.ToString & "'"
                                        rowsRID = tblAnalRunSum.Select(strF)
                                        Try
                                            var3 = rowsRID(0).Item("Analysis Date")
                                            varR = Format(CDate(var3), LTextDateFormat)
                                        Catch ex As Exception
                                            varR = "[NA]"
                                        End Try

                                    Case Else

                                        If dvAss.Count = 0 Then

                                            varR = "[NA]"
                                            'If idCR < 8 Then
                                            '    'boolSkip = True
                                            'End If
                                            'varR = "[NA]"
                                        Else
                                            'No. Get this from analytical run data
                                            'but save just in case for future use
                                            GoTo skip1
                                            var1 = dvAss(0).Item("ASSAYDATETIME") 'get first item
                                            var2 = NZ(var1, "[NA]") 'get first item
                                            intAss = 0
                                            Do Until StrComp(var2, "[NA]", CompareMethod.Text) <> 0
                                                intAss = intAss + 1
                                                If intAss >= dvAss.Count - 1 Then
                                                    var2 = "[NA]"
                                                    Exit Do
                                                End If
                                                var1 = dvAss(intAss).Item("ASSAYDATETIME") 'get first item
                                                var2 = NZ(var1, "[NA]") 'get first item
                                            Loop
skip1:
                                            var1 = dvAss(0).Item("RUNID") 'get first item
                                            var2 = NZ(var1, "[NA]") 'get first item
                                            strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                            rowsAR = tblAnalRunSum.Select(strF)
                                            If rowsAR.Length = 0 Then
                                                var3 = "[NA]"
                                            Else
                                                var3 = rowsAR(0).Item("Analysis Date")
                                            End If

                                            If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                varR = "[NA]"
                                            Else
                                                varR = Format(CDate(var3), LTextDateFormat)
                                            End If
                                        End If

                                End Select


                            Case 4 'LastAnalysisDate

                                Select Case idCR
                                    'Case 1, 2, 3, 4, 6, 7 'these tables don't have assigned samples, except 3 and 4 might
                                    Case 1, 6, 7 'these tables don't have assigned samples, except 3 and 4 might
                                        varR = "[NA]"

                                    Case 2 'regression

                                        strF = "RUNID > 0"
                                        strS = "RUNID ASC"
                                        Dim dvRID As System.Data.DataView = New DataView(tblRegCon, strF, strS, DataViewRowState.CurrentRows)
                                        Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                        Dim intRID As Short = tblRID.Rows.Count
                                        Dim CountA As Short

                                        If intRID = 0 Then
                                            varR = "[NA]"
                                        Else
                                            var2 = tblRID.Rows(intRID - 1).Item("RUNID")

                                            'get date from runid
                                            strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                            rowsAR = tblAnalRunSum.Select(strF)
                                            If rowsAR.Length = 0 Then
                                                var3 = "[NA]"
                                            Else
                                                var3 = rowsAR(0).Item("Analysis Date")
                                            End If

                                            If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                varR = "[NA]"
                                            Else
                                                varR = Format(CDate(var3), LTextDateFormat)
                                            End If


                                        End If

                                    Case 3 'Calibr Stds

                                        varR = "NA"

                                        'first determine whether to use normal or assigned samples
                                        strF = "ID_TBLREPORTTABLE = " & idRT
                                        Dim rRT() As DataRow
                                        rRT = tblReportTable.Select(strF)
                                        var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                        If var1 = 0 Then

                                            'look for non-assigned samples
                                            strF = "RUNID > 0"
                                            strS = "RUNID ASC"
                                            Dim dvRIDa As System.Data.DataView = New DataView(tblBCStdConcs, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                            Dim intRIDa As Short = tblRIDa.Rows.Count
                                            Dim CountAa As Short

                                            If intRIDa = 0 Then
                                                varR = "NA"
                                            Else
                                                var2 = tblRIDa.Rows(intRIDa - 1).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If
                                            End If

                                        Else
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "[NA]"
                                            Else

                                                var2 = tblRID.Rows(intRID - 1).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If

                                            End If
                                        End If

                                    Case 4 'QC Stds

                                        varR = "NA"

                                        'first determine whether to use normal or assigned samples
                                        strF = "ID_TBLREPORTTABLE = " & idRT
                                        Dim rRT() As DataRow
                                        rRT = tblReportTable.Select(strF)
                                        var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                        If var1 = 0 Then
                                            'look for non-assigned samples

                                            strF = "RUNID > 0"
                                            strS = "RUNID ASC"
                                            Dim dvRIDa As System.Data.DataView = New DataView(tblBCQCConcs, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                            Dim intRIDa As Short = tblRIDa.Rows.Count
                                            Dim CountAa As Short

                                            If intRIDa = 0 Then
                                                varR = "NA"
                                            Else
                                                var2 = tblRIDa.Rows(intRIDa - 1).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If
                                            End If
                                        Else
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "[NA]"
                                            Else

                                                var2 = tblRID.Rows(intRID - 1).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If

                                            End If
                                        End If

                                    Case 5 'this is samples

                                        'first get runid from tblsampledesign
                                        strF = "DESIGNSUBJECTID > 0"
                                        strS = "RUNID ASC"
                                        Dim dvRID As System.Data.DataView = New DataView(tblSampleDesign, strF, strS, DataViewRowState.CurrentRows)
                                        Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                        Dim intRID As Short = tblRID.Rows.Count
                                        'last row is last runid
                                        Dim varRID = tblRID.Rows(intRID - 1).Item("RUNID")
                                        'now get Analysis date of varRID from tblAnalRuns
                                        Dim rowsRID() As DataRow
                                        strF = "[Watson Run ID] = '" & varRID.ToString & "'"
                                        rowsRID = tblAnalRunSum.Select(strF)
                                        Try
                                            var3 = rowsRID(0).Item("Analysis Date")
                                            varR = Format(CDate(var3), LTextDateFormat)
                                        Catch ex As Exception
                                            varR = "[NA]"
                                        End Try

                                    Case Else

                                        If dvAss.Count = 0 Then

                                            varR = "[NA]"
                                            'If idCR < 8 Then
                                            '    'boolSkip = True '???? wtf???
                                            'End If
                                            'varR = "[NA]"
                                        Else
                                            'No. Get this from analytical run data
                                            'but save just in case for future use
                                            GoTo skip2
                                            var1 = dvAss(dvAss.Count - 1).Item("ASSAYDATETIME") 'get last item
                                            var2 = NZ(var1, "[NA]") 'get first item
                                            intAss = 0
                                            Do Until StrComp(var2, "[NA]", CompareMethod.Text) <> 0
                                                intAss = intAss + 1
                                                If intAss >= dvAss.Count - 1 Then
                                                    var2 = "[NA]"
                                                    Exit Do
                                                End If
                                                var1 = dvAss(intAss).Item("ASSAYDATETIME") 'get first item
                                                var2 = NZ(var1, "[NA]") 'get first item
                                            Loop
skip2:

                                            If dvAss.Count = 0 Then
                                                varR = "[NA]"
                                            Else
                                                var1 = dvAss(dvAss.Count - 1).Item("RUNID") 'get first item
                                                var2 = NZ(var1, "[NA]") 'get first item
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If

                                            End If


                                        End If

                                End Select

                                '*****

                            Case 5 'TableINSERT
                                'this is done in Sub InsertTableReferences

                            Case 6 'AnalyteREF

                                varR = GetAnalyteRef(idR, True)

                            Case 7 '(n)Table
                                Select Case idCR
                                    Case 5
                                        varR = ctrsSamples(1, 1)
                                    Case 6
                                        varR = ctrsReassayed(1, 1)
                                    Case 7
                                        varR = ctrsRepeat(1, 1)
                                    Case Else

                                End Select


                        End Select
                        'now execute fieldcode
                        Try
                            boolRange = False
                            If boolSkip Then
                            Else

                                Call SearchReplaceRunID(wd, str3, varR, boolRange)

                            End If
                        Catch ex As Exception

                        End Try

                    End If

                Next

            End If

        Next

        'some of these items are analyte-dependent
        Dim strAnal As String
        Dim intGroup As Short
        Dim strF4 As String

        'Dim arrAnalytes(16, 51) '1=AnalyteDescription, 2=AnalyteID, 3=AnalyteIndex
        '4=BQL, 5=AQL, 6=Conc Units, 7=AcceptedRuns, 8=IsReplicate, 9=IsIntStd
        '10=UseIntStd, 11=IntStd, 12=MasterAssayID, 13=IsCoadminCmpd,14=OriginalAnalyteDescription,15=intGroup,16=MATRIX

        For Count3 = 1 To ctAnalytes

            strAnal = NZ(arrAnalytes(1, Count3), "NA")
            intAnalyteIndex = NZ(arrAnalytes(3, Count3), 0)
            intAnalyteID = NZ(arrAnalytes(2, Count3), 0)
            intMasterAssayID = NZ(arrAnalytes(12, Count3), 0)
            intGroup = NZ(arrAnalytes(15, Count3), 0)

            strF1 = "ANALYTEINDEX = " & intAnalyteIndex & " AND ANALYTEID = " & intAnalyteID & " AND MASTERASSAYID = " & intMasterAssayID
            strF2 = "ANALYTEID = " & intAnalyteID
            strF4 = "ANALYTEINDEX = " & intAnalyteIndex & " AND ANALYTEID = " & intAnalyteID & " AND INTGROUP = " & intGroup

            For Count4 = 1 To 3
                boolRange = False
                Select Case Count4

                    Case 1
                        strA = "RunIDForAnalyte_" & Count3 & "_Table_"
                        strB = "Run IDs of runs for Analyte_" & strAnal & " in Table - "
                        strC = "Run ID for runs associated for Analyte_" & strAnal & " in table: "
                        boolRange = True
                    Case 2
                        strA = "FirstAnalysisDateForAnalyte_" & Count3 & "_Table_"
                        strB = "First Analysis Date of runs for Analyte_" & strAnal & " in Table - "
                        strC = "First Analysis Date of runs for Analyte_" & strAnal & " associated with table: "
                        boolRange = True
                    Case 3 '
                        strA = "LastAnalysisDateForAnalyte_" & Count3 & "_Table_"
                        strB = "Last Analysis Date of runs for Analyte_" & strAnal & " in Table - "
                        strC = "Last Analysis Date of runs for Analyte_" & strAnal & " associated with table: "
                        boolRange = True
                End Select

                ''Legend:
                'dtbl2 = tblTemplates
                'dtbl3 = tblReportTable
                'dtblAss = tblAssignedSamples
                'strF1 = "ANALYTEINDEX = " & intAnalyteIndex & " AND ANALYTEID = " & intAnalyteID & " AND MASTERASSAYID = " & intMasterAssayID
                'strF2 = "ANALYTEID = " & intAnalyteID
                'intRows3=dv3.Count => tblReportTable

                Dim intPH As Short

                If SearchReplaceRunIDTest(wd, strA) Then

                    For Count2 = 0 To intRows3 - 1

                        'wdd.visible = True

                        boolSkip = False
                        idCR = dv3(Count2).Item("ID_TBLCONFIGREPORTTABLES")
                        idRT = dv3(Count2).Item("ID_TBLREPORTTABLE")
                        strFCID = NZ(dv3(Count2).Item("CHARFCID"), "LABIntegrityAAA")
                        intPH = NZ(dv3(Count2).Item("BOOLPLACEHOLDER"), 0)
                        If intPH <> 0 Then
                            strFCID = "LABIntegrityAAA"
                        End If
                        str1 = Mid(strFCID, 1, 2)
                        If StrComp(str1, "PH", CompareMethod.Text) = 0 Then
                            strFCID = "LABIntegrityAAA"
                        End If
                        'debugging
                        If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                        Else

                            str1 = dv3(Count2).Item("CHARHEADINGTEXT")
                            str2 = Replace(str1, " ", "_", 1, -1, CompareMethod.Text)
                            'str3 = "[" & strA & str2 & "]"
                            str3 = "[" & strA & strFCID & "]"
                            strN = strA & str2
                            str4 = strC & str1

                            intL = intL + 1
                            If intL >= intLL Then
                                frmH.lblProgress.Text = "Field Code Search:" & ChrW(10) & strN
                                frmH.lblProgress.Refresh()
                                intLL = intLL + 5
                            End If

                            'find replacement value
                            idR = dv3(Count2).Item("ID_TBLREPORTTABLE")
                            'strF = "ID_TBLREPORTTABLE = " & idR & " AND " & strF1
                            strF = "ID_TBLREPORTTABLE = " & idR & " AND " & strF4
                            strS = "RUNSAMPLESEQUENCENUMBER ASC"
                            Try
                                dvAss.RowFilter = strF
                            Catch ex As Exception
                                var1 = var1
                            End Try

                            dvAss.Sort = strS
                            boolTable = False
                            intRowsN = 0

                            Select Case Count4
                                Case 1 'Run ID

                                    varR = "NA"
                                    Select Case idCR

                                        Case 1 'AnalRunSummary, 
                                            varR = "[NA]"

                                            Dim dvARS As System.Data.DataView
                                            dvARS = frmH.dgvAnalyticalRunSummary.DataSource

                                            strS = "RUNID ASC"
                                            'Dim dvRID as system.data.dataview = New DataView(tblRegCon, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvARS.ToTable("a", True, "Watson Run ID")
                                            Dim rowsAA() As DataRow
                                            strF = "[Watson Run ID] IS NOT NULL"
                                            rowsAA = tblRID.Select(strF, "[Watson Run ID] ASC")

                                            Dim intRID As Short = rowsAA.Length
                                            Dim CountA As Short

                                            Dim intA1 As Short
                                            Dim intE1 As Short

                                            intE1 = intRID - 1
                                            intA1 = -1

                                            If intRID < 3 Then
                                                For CountA = 0 To intRID - 1
                                                    var1 = NZ(rowsAA(CountA).Item("Watson Run ID"), "")
                                                    If Len(var1) = 0 Then
                                                        intE1 = intE1 - 1
                                                    Else
                                                        intA1 = intA1 + 1
                                                        If intA1 = 0 Then
                                                            varR = var1
                                                        Else
                                                            varR = varR & " and " & var1
                                                        End If
                                                    End If
                                                Next
                                            Else
                                                For CountA = 0 To intRID - 1
                                                    var1 = NZ(rowsAA(CountA).Item("Watson Run ID"), "")
                                                    If Len(var1) = 0 Then
                                                        intE1 = intE1 - 1
                                                    Else
                                                        intA1 = intA1 + 1
                                                        If intA1 = 0 Then
                                                            varR = var1
                                                        ElseIf intA1 = intE1 Then
                                                            varR = varR & ", and " & var1
                                                        Else
                                                            varR = varR & ", " & var1
                                                        End If
                                                    End If
                                                Next
                                            End If


                                        Case 2 'Regression Constants

                                            strF = "RUNID > 0 AND " & strF1
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(tblRegCon, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "[NA]"
                                            Else
                                                varR = "NA"
                                                If intRID < 3 Then
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & " and " & var1
                                                        End If
                                                    Next
                                                Else
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        ElseIf CountA = tblRID.Rows.Count - 1 Then
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", and " & var1
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", " & var1
                                                        End If
                                                    Next
                                                End If

                                            End If

                                        Case 3 'Calibr Stds

                                            'first determine whether to use normal or assigned samples
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            Dim rRT() As DataRow
                                            rRT = tblReportTable.Select(strF)
                                            var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                            If var1 = 0 Then
                                                'look for non-assigned samples
                                                strF = "RUNID > 0 AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRIDa As System.Data.DataView = New DataView(tblBCStdConcs, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                                Dim intRIDa As Short = tblRIDa.Rows.Count
                                                Dim CountAa As Short

                                                varR = "NA"
                                                If intRIDa < 3 Then
                                                    For CountAa = 0 To intRIDa - 1
                                                        If CountAa = 0 Then
                                                            varR = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        Else
                                                            var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                            varR = varR & " and " & var1
                                                        End If
                                                    Next
                                                Else
                                                    For CountAa = 0 To intRIDa - 1
                                                        If CountAa = 0 Then
                                                            varR = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        ElseIf CountAa = tblRIDa.Rows.Count - 1 Then
                                                            var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                            varR = varR & ", and " & var1
                                                        Else
                                                            var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                            varR = varR & ", " & var1
                                                        End If
                                                    Next
                                                End If

                                            Else

                                                strF = "ID_TBLREPORTTABLE = " & idRT & " AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                                Dim intRID As Short = tblRID.Rows.Count
                                                Dim CountA As Short

                                                If intRID = 0 Then
                                                    varR = "NA"
                                                Else
                                                    varR = "NA"
                                                    If intRID < 3 Then
                                                        For CountA = 0 To intRID - 1
                                                            If CountA = 0 Then
                                                                varR = tblRID.Rows(CountA).Item("RUNID")
                                                            Else
                                                                var1 = tblRID.Rows(CountA).Item("RUNID")
                                                                varR = varR & " and " & var1
                                                            End If
                                                        Next
                                                    Else
                                                        For CountA = 0 To intRID - 1
                                                            If CountA = 0 Then
                                                                varR = tblRID.Rows(CountA).Item("RUNID")
                                                            ElseIf CountA = tblRID.Rows.Count - 1 Then
                                                                var1 = tblRID.Rows(CountA).Item("RUNID")
                                                                varR = varR & ", and " & var1
                                                            Else
                                                                var1 = tblRID.Rows(CountA).Item("RUNID")
                                                                varR = varR & ", " & var1
                                                            End If
                                                        Next
                                                    End If
                                                End If

                                            End If

                                        Case 4 'QC Stds


                                            'first determine whether to use normal or assigned samples
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            Dim rRT() As DataRow
                                            rRT = tblReportTable.Select(strF)
                                            var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                            If var1 = 0 Then

                                                'look for non-assigned samples

                                                strF = "RUNID > 0 AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRIDa As System.Data.DataView = New DataView(tblBCQCConcs, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                                Dim intRIDa As Short = tblRIDa.Rows.Count
                                                Dim CountAa As Short

                                                varR = "NA"
                                                If intRIDa < 3 Then
                                                    For CountAa = 0 To intRIDa - 1
                                                        If CountAa = 0 Then
                                                            varR = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        Else
                                                            var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                            varR = varR & " and " & var1
                                                        End If
                                                    Next
                                                Else
                                                    For CountAa = 0 To intRIDa - 1
                                                        If CountAa = 0 Then
                                                            varR = tblRIDa.Rows(CountAa).Item("RUNID")
                                                        ElseIf CountAa = tblRIDa.Rows.Count - 1 Then
                                                            var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                            varR = varR & ", and " & var1
                                                        Else
                                                            var1 = tblRIDa.Rows(CountAa).Item("RUNID")
                                                            varR = varR & ", " & var1
                                                        End If
                                                    Next
                                                End If

                                            Else
                                                strF = "ID_TBLREPORTTABLE = " & idRT & " AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                                Dim intRID As Short = tblRID.Rows.Count
                                                Dim CountA As Short

                                                If intRID = 0 Then
                                                    varR = "NA"
                                                Else
                                                    varR = "NA"
                                                    If intRID < 3 Then
                                                        For CountA = 0 To intRID - 1
                                                            If CountA = 0 Then
                                                                varR = tblRID.Rows(CountA).Item("RUNID")
                                                            Else
                                                                var1 = tblRID.Rows(CountA).Item("RUNID")
                                                                varR = varR & " and " & var1
                                                            End If
                                                        Next
                                                    Else
                                                        For CountA = 0 To intRID - 1
                                                            If CountA = 0 Then
                                                                varR = tblRID.Rows(CountA).Item("RUNID")
                                                            ElseIf CountA = tblRID.Rows.Count - 1 Then
                                                                var1 = tblRID.Rows(CountA).Item("RUNID")
                                                                varR = varR & ", and " & var1
                                                            Else
                                                                var1 = tblRID.Rows(CountA).Item("RUNID")
                                                                varR = varR & ", " & var1
                                                            End If
                                                        Next
                                                    End If

                                                End If
                                            End If

                                        Case 5

                                            varR = NZ(ctrsSamples(2, Count3), "[NA]")

                                        Case 6 'reassay

                                        Case 7 'repeat

                                        Case 30 'ISR

                                        Case Else

                                            'strF = "ID_TBLREPORTTABLE = " & idRT & " AND " & strF1
                                            strF = "ID_TBLREPORTTABLE = " & idRT & " AND " & strF4
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count

                                            If intRID = 0 Then
                                                If idCR < 8 Then
                                                    boolSkip = True
                                                End If
                                                varR = "[NA]"
                                            Else
                                                Dim CountA As Short
                                                varR = "NA"
                                                If intRID < 3 Then
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & " and " & var1
                                                        End If
                                                    Next
                                                Else
                                                    For CountA = 0 To intRID - 1
                                                        If CountA = 0 Then
                                                            varR = tblRID.Rows(CountA).Item("RUNID")
                                                        ElseIf CountA = tblRID.Rows.Count - 1 Then
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", and " & var1
                                                        Else
                                                            var1 = tblRID.Rows(CountA).Item("RUNID")
                                                            varR = varR & ", " & var1
                                                        End If
                                                    Next
                                                End If


                                            End If

                                    End Select

                                Case 2 'First Analysis Date

                                    Select Case idCR
                                        'Case 1, 2, 3, 4, 6, 7 'these tables don't have assigned samples, except 3 and 4 might

                                        Case 1, 6, 7 'these tables don't have assigned samples, except 3 and 4 might
                                            varR = "[NA]"

                                        Case 2 'regression table
                                            strF = "RUNID > 0 AND " & strF1
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(tblRegCon, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "[NA]"
                                            Else
                                                var2 = tblRID.Rows(0).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If


                                            End If

                                        Case 3 'Calibr Stds

                                            varR = "NA"

                                            'first determine whether to use normal or assigned samples
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            Dim rRT() As DataRow
                                            rRT = tblReportTable.Select(strF)
                                            var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                            If var1 = 0 Then

                                                'look for non-assigned samples
                                                strF = "RUNID > 0 AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRIDa As System.Data.DataView = New DataView(tblBCStdConcs, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                                Dim intRIDa As Short = tblRIDa.Rows.Count
                                                Dim CountAa As Short

                                                If intRIDa = 0 Then
                                                    varR = "NA"
                                                Else
                                                    var2 = tblRIDa.Rows(0).Item("RUNID")
                                                    'get date from runid
                                                    strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                    rowsAR = tblAnalRunSum.Select(strF)
                                                    If rowsAR.Length = 0 Then
                                                        var3 = "[NA]"
                                                    Else
                                                        var3 = rowsAR(0).Item("Analysis Date")
                                                    End If

                                                    If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                        varR = "[NA]"
                                                    Else
                                                        varR = Format(CDate(var3), LTextDateFormat)
                                                    End If

                                                End If

                                            Else

                                                strF = "ID_TBLREPORTTABLE = " & idRT & " AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                                Dim intRID As Short = tblRID.Rows.Count
                                                Dim CountA As Short

                                                If intRID = 0 Then
                                                    varR = "[NA]"
                                                Else

                                                    var2 = tblRID.Rows(0).Item("RUNID")
                                                    'get date from runid
                                                    strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                    rowsAR = tblAnalRunSum.Select(strF)
                                                    If rowsAR.Length = 0 Then
                                                        var3 = "[NA]"
                                                    Else
                                                        var3 = rowsAR(0).Item("Analysis Date")
                                                    End If

                                                    If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                        varR = "[NA]"
                                                    Else
                                                        varR = Format(CDate(var3), LTextDateFormat)
                                                    End If
                                                End If
                                            End If

                                        Case 4 'QC Stds

                                            varR = "NA"

                                            'first determine whether to use normal or assigned samples
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            Dim rRT() As DataRow
                                            rRT = tblReportTable.Select(strF)
                                            var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                            If var1 = 0 Then

                                                'look for non-assigned samples

                                                strF = "RUNID > 0 AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRIDa As System.Data.DataView = New DataView(tblBCQCConcs, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                                Dim intRIDa As Short = tblRIDa.Rows.Count
                                                Dim CountAa As Short

                                                If intRIDa = 0 Then
                                                    varR = "NA"
                                                Else
                                                    var2 = tblRIDa.Rows(0).Item("RUNID")
                                                    'get date from runid
                                                    strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                    rowsAR = tblAnalRunSum.Select(strF)
                                                    If rowsAR.Length = 0 Then
                                                        var3 = "[NA]"
                                                    Else
                                                        var3 = rowsAR(0).Item("Analysis Date")
                                                    End If

                                                    If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                        varR = "[NA]"
                                                    Else
                                                        varR = Format(CDate(var3), LTextDateFormat)
                                                    End If
                                                End If

                                            Else
                                                strF = "ID_TBLREPORTTABLE = " & idRT & " AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                                Dim intRID As Short = tblRID.Rows.Count
                                                Dim CountA As Short

                                                If intRID = 0 Then
                                                    varR = "[NA]"
                                                Else

                                                    var2 = tblRID.Rows(0).Item("RUNID")
                                                    'get date from runid
                                                    strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                    rowsAR = tblAnalRunSum.Select(strF)
                                                    If rowsAR.Length = 0 Then
                                                        var3 = "[NA]"
                                                    Else
                                                        var3 = rowsAR(0).Item("Analysis Date")
                                                    End If

                                                    If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                        varR = "[NA]"
                                                    Else
                                                        varR = Format(CDate(var3), LTextDateFormat)
                                                    End If

                                                End If
                                            End If


                                        Case 5 'this is Samples

                                            'first get runid from tblsampledesign
                                            strF = "DESIGNSUBJECTID > 0 AND " & strF2
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(tblSampleDesign, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            'first row is first runid
                                            Dim varRID = tblRID.Rows(0).Item("RUNID")
                                            'now get Analysis date of varRID from tblAnalRuns
                                            Dim rowsRID() As DataRow
                                            strF = "[Watson Run ID] = '" & varRID.ToString & "'"
                                            rowsRID = tblAnalRunSum.Select(strF)
                                            Try
                                                var3 = rowsRID(0).Item("Analysis Date")
                                                varR = Format(CDate(var3), LTextDateFormat)
                                            Catch ex As Exception
                                                varR = "[NA]"
                                            End Try

                                        Case Else

                                            If dvAss.Count = 0 Then

                                                varR = "[NA]"
                                                'If idCR < 8 Then
                                                '    'boolSkip = True
                                                'End If
                                                'varR = "[NA]"
                                            Else
                                                'No. Get this from analytical run data
                                                'but save just in case for future use
                                                GoTo skip3
                                                var1 = dvAss(0).Item("ASSAYDATETIME") 'get first item
                                                var2 = NZ(var1, "[NA]") 'get first item
                                                intAss = 0
                                                Do Until StrComp(var2, "[NA]", CompareMethod.Text) <> 0
                                                    intAss = intAss + 1
                                                    If intAss >= dvAss.Count - 1 Then
                                                        var2 = "[NA]"
                                                        Exit Do
                                                    End If
                                                    var1 = dvAss(intAss).Item("ASSAYDATETIME") 'get first item
                                                    var2 = NZ(var1, "[NA]") 'get first item
                                                Loop
skip3:
                                                var1 = dvAss(0).Item("RUNID") 'get first item
                                                var2 = NZ(var1, "[NA]") 'get first item
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If
                                            End If

                                    End Select

                                Case 3 'Last Analysis Date

                                    Select Case idCR
                                        'Case 1, 2, 3, 4, 6, 7 'these tables don't have assigned samples, except 3 and 4 might

                                        Case 1, 6, 7 'these tables don't have assigned samples, except 3 and 4 might
                                            varR = "[NA]"

                                        Case 2 'regression table

                                            strF = "RUNID > 0 AND " & strF1
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(tblRegCon, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            Dim CountA As Short

                                            If intRID = 0 Then
                                                varR = "[NA]"
                                            Else
                                                var2 = tblRID.Rows(intRID - 1).Item("RUNID")
                                                'get date from runid
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If


                                            End If


                                        Case 3 'Calibr Stds

                                            varR = "NA"

                                            'first determine whether to use normal or assigned samples
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            Dim rRT() As DataRow
                                            rRT = tblReportTable.Select(strF)
                                            var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                            If var1 = 0 Then

                                                'look for non-assigned samples
                                                strF = "RUNID > 0 AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRIDa As System.Data.DataView = New DataView(tblBCStdConcs, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                                Dim intRIDa As Short = tblRIDa.Rows.Count
                                                Dim CountAa As Short

                                                If intRIDa = 0 Then
                                                    varR = "NA"
                                                Else
                                                    var2 = tblRIDa.Rows(intRIDa - 1).Item("RUNID")
                                                    'get date from runid
                                                    strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                    rowsAR = tblAnalRunSum.Select(strF)
                                                    If rowsAR.Length = 0 Then
                                                        var3 = "[NA]"
                                                    Else
                                                        var3 = rowsAR(0).Item("Analysis Date")
                                                    End If

                                                    If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                        varR = "[NA]"
                                                    Else
                                                        varR = Format(CDate(var3), LTextDateFormat)
                                                    End If

                                                End If

                                            Else

                                                strF = "ID_TBLREPORTTABLE = " & idRT & " AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                                Dim intRID As Short = tblRID.Rows.Count
                                                Dim CountA As Short

                                                If intRID = 0 Then
                                                    varR = "[NA]"
                                                Else

                                                    var2 = tblRID.Rows(intRID - 1).Item("RUNID")
                                                    'get date from runid
                                                    strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                    rowsAR = tblAnalRunSum.Select(strF)
                                                    If rowsAR.Length = 0 Then
                                                        var3 = "[NA]"
                                                    Else
                                                        var3 = rowsAR(0).Item("Analysis Date")
                                                    End If

                                                    If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                        varR = "[NA]"
                                                    Else
                                                        varR = Format(CDate(var3), LTextDateFormat)
                                                    End If
                                                End If
                                            End If

                                        Case 4 'QC Stds

                                            varR = "NA"

                                            'first determine whether to use normal or assigned samples
                                            strF = "ID_TBLREPORTTABLE = " & idRT
                                            Dim rRT() As DataRow
                                            rRT = tblReportTable.Select(strF)
                                            var1 = rRT(0).Item("BOOLREQUIRESSAMPLEASSIGNMENT")

                                            If var1 = 0 Then

                                                'look for non-assigned samples

                                                strF = "RUNID > 0 AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRIDa As System.Data.DataView = New DataView(tblBCQCConcs, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRIDa As System.Data.DataTable = dvRIDa.ToTable("a", True, "RUNID")
                                                Dim intRIDa As Short = tblRIDa.Rows.Count
                                                Dim CountAa As Short

                                                If intRIDa = 0 Then
                                                    varR = "NA"
                                                Else
                                                    var2 = tblRIDa.Rows(intRIDa - 1).Item("RUNID")
                                                    'get date from runid
                                                    strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                    rowsAR = tblAnalRunSum.Select(strF)
                                                    If rowsAR.Length = 0 Then
                                                        var3 = "[NA]"
                                                    Else
                                                        var3 = rowsAR(0).Item("Analysis Date")
                                                    End If

                                                    If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                        varR = "[NA]"
                                                    Else
                                                        varR = Format(CDate(var3), LTextDateFormat)
                                                    End If
                                                End If

                                            Else
                                                strF = "ID_TBLREPORTTABLE = " & idRT & " AND " & strF1
                                                strS = "RUNID ASC"
                                                Dim dvRID As System.Data.DataView = New DataView(dtblAss, strF, strS, DataViewRowState.CurrentRows)
                                                Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                                Dim intRID As Short = tblRID.Rows.Count
                                                Dim CountA As Short

                                                If intRID = 0 Then
                                                    varR = "[NA]"
                                                Else

                                                    var2 = tblRID.Rows(intRID - 1).Item("RUNID")
                                                    'get date from runid
                                                    strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                    rowsAR = tblAnalRunSum.Select(strF)
                                                    If rowsAR.Length = 0 Then
                                                        var3 = "[NA]"
                                                    Else
                                                        var3 = rowsAR(0).Item("Analysis Date")
                                                    End If

                                                    If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                        varR = "[NA]"
                                                    Else
                                                        varR = Format(CDate(var3), LTextDateFormat)
                                                    End If

                                                End If
                                            End If


                                        Case 5 'this is Samples
                                            'first get runid from tblsampledesign
                                            strF = "DESIGNSUBJECTID > 0 AND " & strF2
                                            strS = "RUNID ASC"
                                            Dim dvRID As System.Data.DataView = New DataView(tblSampleDesign, strF, strS, DataViewRowState.CurrentRows)
                                            Dim tblRID As System.Data.DataTable = dvRID.ToTable("a", True, "RUNID")
                                            Dim intRID As Short = tblRID.Rows.Count
                                            'first row is first runid
                                            Dim varRID = tblRID.Rows(intRID - 1).Item("RUNID")
                                            'now get Analysis date of varRID from tblAnalRuns
                                            Dim rowsRID() As DataRow
                                            strF = "[Watson Run ID] = '" & varRID.ToString & "'"
                                            rowsRID = tblAnalRunSum.Select(strF)
                                            Try
                                                var3 = rowsRID(0).Item("Analysis Date")
                                                varR = Format(CDate(var3), LTextDateFormat)
                                            Catch ex As Exception
                                                varR = "[NA]"
                                            End Try

                                        Case Else

                                            If dvAss.Count = 0 Then

                                                varR = "[NA]"
                                                'If idCR < 8 Then
                                                '    'boolSkip = True
                                                'End If
                                                'varR = "[NA]"
                                            Else
                                                'No. Get this from analytical run data
                                                'but save just in case for future use
                                                GoTo skip4
                                                var1 = dvAss(0).Item("ASSAYDATETIME") 'get first item
                                                var2 = NZ(var1, "[NA]") 'get first item
                                                intAss = 0
                                                Do Until StrComp(var2, "[NA]", CompareMethod.Text) <> 0
                                                    intAss = intAss + 1
                                                    If intAss >= dvAss.Count - 1 Then
                                                        var2 = "[NA]"
                                                        Exit Do
                                                    End If
                                                    var1 = dvAss(intAss).Item("ASSAYDATETIME") 'get first item
                                                    var2 = NZ(var1, "[NA]") 'get first item
                                                Loop
skip4:
                                                var1 = dvAss(dvAss.Count - 1).Item("RUNID") 'get first item
                                                var2 = NZ(var1, "[NA]") 'get first item
                                                strF = "[Watson Run ID] = '" & CStr(var2) & "'"
                                                rowsAR = tblAnalRunSum.Select(strF)
                                                If rowsAR.Length = 0 Then
                                                    var3 = "[NA]"
                                                Else
                                                    var3 = rowsAR(0).Item("Analysis Date")
                                                End If

                                                If StrComp(var3, "[NA]", CompareMethod.Text) = 0 Or IsDate(var3) = False Then
                                                    varR = "[NA]"
                                                Else
                                                    varR = Format(CDate(var3), LTextDateFormat)
                                                End If
                                            End If

                                    End Select
                            End Select

                            Try
                                boolRange = False
                                If boolSkip Then
                                Else

                                    Call SearchReplaceRunID(wd, str3, varR, boolRange)

                                End If
                            Catch ex As Exception

                            End Try

                        End If
                    Next

                End If

            Next


        Next




        'get unique runID's from tblAnalysisResultsHome
        'Note: Can't use dvAss to get information from tables that are not assigned
        Dim intRowsT As Short
        strF = "ID_TBLSTUDIES = " & id_tblStudies
        strS = "ID_TBLSTUDIES ASC"
        Dim dvA As system.data.dataview = New DataView(tblAnalysisResultsHome, strF, strS, DataViewRowState.CurrentRows)
        Dim tblURID As System.Data.DataTable = dvA.ToTable("RA", True, "RUNID")
        intRowsT = tblURID.Rows.Count

        For Count4 = 2 To 4 ' 
            boolRange = False
            Select Case Count4
                Case 2
                    strA = "RunID_"
                    strB = "Run IDs of runs for Report Template - "
                    strC = "Run ID for runs in table: "
                    boolRange = True
                Case 3
                    strA = "FirstAnalysisDate_"
                    strB = "First Analysis Date of runs for Report Template - "
                    strC = "First Analysis Date of runs in table: "
                    boolRange = True
                Case 4
                    strA = "LastAnalysisDate_"
                    strB = "Last Analysis Date of runs for Report Template - "
                    strC = "Last Analysis Date of runs in table: "
                    boolRange = True
            End Select

            Dim intPH As Short

            If SearchReplaceRunIDTest(wd, strA) Then

                For Count2 = 0 To intRows3 - 1

                    boolSkip = False
                    idCR = dv3(Count2).Item("ID_TBLCONFIGREPORTTABLES")


                    '1: Summary of Analytical Runs
                    '2: Summary of Regression Constants
                    '3: Summary of Back-Calculated Calibration Std Conc
                    '4: Summary of Interpolated QC Std Conc
                    '5: Summary of Samples
                    '6: Summary of Reassayed Samples
                    '7: Summary of Repeat Samples

                    'there would be no need to get runids for these tables:
                    '1: Summary of Analytical Runs
                    '2: Summary of Regression Constants
                    '5: Summary of Samples
                    '6: Summary of Reassayed Samples
                    '7: Summary of Repeat Samples

                    If idCR = 3 Or idCR = 4 Then
                    Else
                        GoTo next1
                    End If

                    strFCID = NZ(dv3(Count2).Item("CHARFCID"), "LABIntegrityAAA")
                    intPH = NZ(dv3(Count2).Item("BOOLPLACEHOLDER"), 0)
                    If intPH <> 0 Then
                        strFCID = "LABIntegrityAAA"
                    End If
                    str1 = Mid(strFCID, 1, 2)
                    If StrComp(str1, "PH", CompareMethod.Text) = 0 Then
                        strFCID = "LABIntegrityAAA"
                    End If
                    'debugging
                    If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                    Else

                        str1 = dv3(Count2).Item("CHARHEADINGTEXT")
                        str2 = Replace(str1, " ", "_", 1, -1, CompareMethod.Text)
                        'str3 = "[" & strA & str2 & "]"
                        str3 = "[" & strA & strFCID & "]"
                        strN = strA & str2
                        str4 = strC & str1

                        intL = intL + 1
                        If intL >= intLL Then
                            frmH.lblProgress.Text = "Field Code Search:" & ChrW(10) & strN
                            frmH.lblProgress.Refresh()
                            intLL = intLL + 5
                        End If

                        'find replacement value
                        idR = dv3(Count2).Item("ID_TBLREPORTTABLE")
                        strF = "ID_TBLREPORTTABLE = " & idR
                        strS = "RUNSAMPLESEQUENCENUMBER ASC"

                        'get run id from tblAnalRunSum

                        'get runid
                        dvAss.RowFilter = strF
                        dvAss.Sort = strS

                        Select Case Count4

                            Case 2 'RunID: can't use dvAss. This section for non-assigne samples tables

                                If dvAss.Count = 0 Then 'continue
                                Else 'obtained in previous section
                                    boolSkip = True
                                End If
                                If idCR = 3 Then 'calibr stds
                                    Dim rowsCS() As DataRow
                                    strF = "ID_TBLSTUDIES > 0"
                                    strS = "RUNID ASC"
                                    rowsCS = tblBCStdConcs.Select(strF, strS)
                                    If rowsCS.Length = 0 Then
                                        varR = "[NA]"
                                    Else
                                        varR = rowsCS(0).Item("RUNID")
                                    End If
                                ElseIf idCR = 4 Then 'QC stds
                                    Dim rowsQC() As DataRow
                                    strF = "ID_TBLSTUDIES > 0"
                                    strS = "RUNID ASC"
                                    rowsQC = tblBCQCConcs.Select(strF, strS)
                                    If rowsQC.Length = 0 Then
                                        varR = "[NA]"
                                    Else
                                        varR = rowsQC(0).Item("RUNID")
                                    End If
                                End If


                            Case 3 'First Analysis Date

                                If dvAss.Count = 0 Then 'continue
                                Else 'obtained in previous section
                                    boolSkip = True
                                End If
                                If idCR = 3 Then 'calibr stds
                                    Dim rowsCS() As DataRow
                                    strF = "ID_TBLSTUDIES > 0"
                                    strS = "RUNID ASC"
                                    rowsCS = tblBCStdConcs.Select(strF, strS)
                                    If rowsCS.Length = 0 Then
                                        varR = "[NA]"
                                    Else
                                        var3 = rowsCS(0).Item("ANALYSISDATETIME")
                                        varR = Format(CDate(var3), LTextDateFormat)
                                    End If
                                ElseIf idCR = 4 Then 'QC stds
                                    Dim rowsQC() As DataRow
                                    strF = "ID_TBLSTUDIES > 0"
                                    strS = "RUNID ASC"
                                    rowsQC = tblBCQCConcs.Select(strF, strS)
                                    If rowsQC.Length = 0 Then
                                        varR = "[NA]"
                                    Else
                                        var3 = rowsQC(0).Item("ANALYSISDATETIME")
                                        varR = Format(CDate(var3), LTextDateFormat)
                                    End If
                                End If

                            Case 4 'Last Analysis Date

                                If dvAss.Count = 0 Then 'continue
                                Else 'obtained in previous section
                                    boolSkip = True
                                End If
                                If idCR = 3 Then 'calibr stds
                                    Dim rowsCS() As DataRow
                                    strF = "ID_TBLSTUDIES > 0"
                                    strS = "RUNID ASC"
                                    rowsCS = tblBCStdConcs.Select(strF, strS)
                                    If rowsCS.Length = 0 Then
                                        varR = "[NA]"
                                    Else
                                        var3 = rowsCS(rowsCS.Length - 1).Item("ANALYSISDATETIME")
                                        varR = Format(CDate(var3), LTextDateFormat)
                                    End If
                                ElseIf idCR = 4 Then 'QC stds
                                    Dim rowsQC() As DataRow
                                    strF = "ID_TBLSTUDIES > 0"
                                    strS = "RUNID ASC"
                                    rowsQC = tblBCQCConcs.Select(strF, strS)
                                    If rowsQC.Length = 0 Then
                                        varR = "[NA]"
                                    Else
                                        var3 = rowsQC(rowsQC.Length - 1).Item("ANALYSISDATETIME")
                                        varR = Format(CDate(var3), LTextDateFormat)
                                    End If
                                End If

                        End Select
                        'now execute fieldcode
                        Try
                            boolRange = False
                            If boolSkip Then
                            Else
                                Call SearchReplaceRunID(wd, str3, varR, boolRange)
                            End If
                        Catch ex As Exception

                        End Try

                    End If

next1:
                Next

            End If

        Next

end1:

    End Sub

    Sub InsertTableReferences(ByRef wd As Microsoft.Office.Interop.Word.Application)

        Dim dtbl1 As System.Data.DataTable
        Dim dtbl2 As System.Data.DataTable
        Dim dtbl3 As System.Data.DataTable
        Dim rows1() As DataRow
        Dim rows2() As DataRow
        Dim rows3() As DataRow
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim strS As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim intMaxID As Int64
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim dt As Date
        Dim intRows1 As Short
        Dim intRows2 As Short
        Dim intRows3 As Short
        Dim id1 As Int16
        Dim id2 As Int16
        Dim id3 As Int16
        Dim strRepTemplate As String
        Dim strA As String
        Dim idR As Int16
        Dim strFCID As String
        Dim strTblFC As String
        Dim boolQuit As Boolean
        Dim idTR As Int64
        Dim intT As Int64
        Dim intSave

        dtbl3 = tblReportTable

        strF3 = "ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLINCLUDE = -1"
        strS = "INTORDER ASC"
        Dim dv31 As System.Data.DataView = New DataView(dtbl3, strF3, strS, DataViewRowState.CurrentRows)
        intRows3 = dv31.Count

        strRepTemplate = "Current Report"

        'wdd.visible = True

        Dim boolV As Boolean = wd.Visible

        For Count4 = 1 To 1

            Select Case Count4
                Case 1
                    strA = "TableINSERTTable_"

            End Select

            If SearchReplaceRunIDTest(wd, strA) Then

                For Count2 = 0 To intRows3 - 1

                    wd.Visible = boolV

                    intMaxID = intMaxID + 1
                    idR = dv31(Count2).Item("ID_TBLREPORTTABLE")
                    strFCID = NZ(dv31(Count2).Item("CHARFCID"), "LABIntegrityAAA")

                    If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                    Else

                        strTblFC = "[" & strA & strFCID & "]"

                        Try
                            wd.Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                        Catch ex As Exception
                            boolQuit = True
                            GoTo end1
                        End Try
                        With wd

                            boolQuit = False

                            'If gboolReadOnlyTables Then
                            '    xlROT = New Microsoft.Office.Interop.Excel.Application
                            '    xlROT.Workbooks.Add()

                            'End If

                            Do Until boolQuit

                                With .Selection.Find
                                    .Text = strTblFC
                                    .Execute(Forward:=True)
                                    If .Found Then
                                        wd.Selection.Text = ""
                                        'insert table(s)

                                        '*****

                                        ctPB = 0
                                        ctPBMax = intRows3

                                        frmH.pb1.Value = 0
                                        frmH.pb1.Maximum = intRows3
                                        frmH.pb1.Visible = True
                                        frmH.pb1.Refresh()

                                        'wdd.visible = True

                                        'intRows = 4 'for testing
                                        Try
                                            wd.Options.Pagination = False
                                            intSave = wd.Options.SaveInterval
                                            wd.Options.SaveInterval = 0
                                            wd.Options.CheckGrammarAsYouType = Not wd.Options.CheckGrammarAsYouType
                                            wd.Options.CheckSpellingAsYouType = Not wd.Options.CheckSpellingAsYouType
                                        Catch ex As Exception

                                        End Try

                                        Try

                                            frmH.pb1.Value = Count2
                                            frmH.pb1.Refresh()
                                            idTR = dv31(Count2).Item("ID_TBLREPORTTABLE")
                                            intT = dv31(Count2).Item("ID_TBLCONFIGREPORTTABLES")
                                            str1 = dv31(Count2).Item("CHARHEADINGTEXT")

                                            boolPlaceHolder = dv31(Count2).Item("BOOLPLACEHOLDER") 'global

                                            'must clear tblQCTables before calling
                                            Try
                                                Dim rowsQCT() As DataRow = tblQCTables.Select("ID_TBLREPORTTABLE = " & idTR)
                                                For Count1 = rowsQCT.Length - 1 To 0 Step -1
                                                    rowsQCT(Count1).Delete()
                                                    Try
                                                        rowsQCT(Count1).AcceptChanges()
                                                    Catch ex As Exception

                                                    End Try
                                                Next
                                            Catch ex As Exception

                                            End Try

                                            Try

                                                'set boolTableSectionStart to true
                                                'INSERTTABLE field codes must be within their own page breaks
                                                boolTableSectionStart = True ' False
                                                Call PrepareTable(intT, wd, idTR, intT, Count2, str1)

                                            Catch ex As Exception
                                                Dim strM As String
                                                If intT = 4 Then
                                                    strM = "There was a problem preparing table:"
                                                    strM = strM & ChrW(10) & ChrW(10) & str1 & ChrW(10) & ChrW(10)
                                                    strM = strM & "It is possible there is an inconsistency in QC configuration for this study." & ChrW(10) & ChrW(10)
                                                    strM = strM & "Please activate the 'Sample/QC/Calibr Std Details' tab and inspect the QC Levels section for "
                                                    strM = strM & "QC Level assignment inconsistencies. The user may have to manually assign QC Samples."
                                                    strM = strM & ChrW(10) & ChrW(10) & "The report generation process will continue."
                                                    strM = strM & ChrW(10) & ChrW(10)
                                                    strM = strM & ex.Message
                                                Else
                                                    'strM = "Problem preparing table " & str1 & "."
                                                    'strM = strM & ChrW(10) & ChrW(10) & "The report generation process will continue."
                                                    strM = "There was a problem preparing table:"
                                                    strM = strM & ChrW(10) & ChrW(10) & str1
                                                    strM = strM & ChrW(10) & ChrW(10) & "The report generation process will continue."
                                                    strM = strM & ChrW(10) & ChrW(10)
                                                    strM = strM & ex.Message

                                                End If
                                                MsgBox(strM, MsgBoxStyle.Information, "Problem preparing table...")
                                                frmH.Refresh()
                                                'wdd.visible = True


                                            End Try

                                        Catch ex As Exception

                                        End Try

                                        Try
                                            wd.Options.Pagination = True
                                            wd.Options.SaveInterval = intSave
                                            wd.Options.CheckGrammarAsYouType = Not wd.Options.CheckGrammarAsYouType
                                            wd.Options.CheckSpellingAsYouType = Not wd.Options.CheckSpellingAsYouType
                                        Catch ex As Exception

                                        End Try

                                        '*****


                                        Try
                                            wd.Selection.MoveRight(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdCharacter, Count:=1)
                                        Catch ex As Exception
                                            boolQuit = True
                                        End Try
                                    Else
                                        boolQuit = True
                                    End If
                                End With
                            Loop

                            'Try
                            '    xlROT.ActiveWorkbook.Close(False)
                            '    xlROT.Quit()
                            'Catch ex As Exception

                            'End Try

                        End With

                    End If

NextCount2:

                Next Count2

            End If


        Next


end1:

    End Sub

    Sub ClearQCTable(ByVal tbl As System.Data.DataTable, ByVal strID As String, ByVal id As Int64)

        Dim rows() As DataRow
        Dim strF As String
        Dim intRows As Int16
        Dim Count1 As Int16

        strF = strID & " = " & id
        rows = tbl.Select(strF)
        intRows = rows.Length
        For Count1 = intRows - 1 To 0 Step -1
            rows(Count1).Delete()
        Next

        tbl.AcceptChanges()

    End Sub

    Sub ClearAllQCTables()

        tblANOVATables.Clear()
        tblQCTables.Clear()
        tblStabilityTables.Clear()


    End Sub

    Sub CreateQCTables()

        Dim str1 As String
        Dim str2 As String

        If tblANOVATables.Columns.Contains("ID_TBLANOVATables") Then
        Else

            Dim col1 As New DataColumn
            str1 = "ID_TBLANOVATables"
            str2 = str1
            col1.ColumnName = str1
            col1.Caption = str2
            col1.DataType = System.Type.GetType("System.Int16")
            col1.DefaultValue = -1
            col1.AllowDBNull = True
            tblANOVATables.Columns.Add(col1)

            Dim col2 As New DataColumn
            str1 = "ID_TBLCONFIGREPORTTABLES"
            str2 = str1
            col2.ColumnName = str1
            col2.Caption = str2
            col2.DataType = System.Type.GetType("System.Int16")
            col2.DefaultValue = -1
            col2.AllowDBNull = True
            tblANOVATables.Columns.Add(col2)

            Dim col3 As New DataColumn
            str1 = "ID_TBLREPORTTABLE"
            str2 = str1
            col3.ColumnName = str1
            col3.Caption = str2
            col3.DataType = System.Type.GetType("System.Int16")
            col3.DefaultValue = -1
            col3.AllowDBNull = True
            tblANOVATables.Columns.Add(col3)

            Dim col4 As New DataColumn
            str1 = "CHARFCID"
            str2 = str1
            col4.ColumnName = str1
            col4.Caption = str2
            col4.DataType = System.Type.GetType("System.String")
            col4.DefaultValue = "" ' -1
            col4.AllowDBNull = True
            tblANOVATables.Columns.Add(col4)

            Dim col6 As New DataColumn
            str1 = "BOOLINTER"
            str2 = str1
            col6.ColumnName = str1
            col6.Caption = str2
            col6.DataType = System.Type.GetType("System.Boolean")
            col6.DefaultValue = False
            col6.AllowDBNull = True
            tblANOVATables.Columns.Add(col6)

            Dim col7 As New DataColumn
            str1 = "BOOLINTRA"
            str2 = str1
            col7.ColumnName = str1
            col7.Caption = str2
            col7.DataType = System.Type.GetType("System.Boolean")
            col7.DefaultValue = False
            col7.AllowDBNull = True
            tblANOVATables.Columns.Add(col7)

            Dim col8 As New DataColumn
            str1 = "NUMNOMCONC"
            str2 = str1
            col8.ColumnName = str1
            col8.Caption = str2
            col8.DataType = System.Type.GetType("System.Single")
            col8.DefaultValue = 0
            col8.AllowDBNull = True
            tblANOVATables.Columns.Add(col8)

            Dim col9 As New DataColumn
            str1 = "NUMQCLEVEL" '1,2,3,4,etc
            str2 = str1
            col9.ColumnName = str1
            col9.Caption = str2
            col9.DataType = System.Type.GetType("System.Int16")
            col9.DefaultValue = 0
            col9.AllowDBNull = True
            tblANOVATables.Columns.Add(col9)

            Dim col10 As New DataColumn
            str1 = "CHARTYPE" 'Mean, SD, Precision, Accuracy, n
            str2 = str1
            col10.ColumnName = str1
            col10.Caption = str2
            col10.DataType = System.Type.GetType("System.String")
            col10.DefaultValue = 0
            col10.AllowDBNull = True
            tblANOVATables.Columns.Add(col10)

            Dim col11 As New DataColumn
            str1 = "NUMVALUE"
            str2 = str1
            col11.ColumnName = str1
            col11.Caption = str2
            col11.DataType = System.Type.GetType("System.Single")
            col11.DefaultValue = 0
            col11.AllowDBNull = True
            tblANOVATables.Columns.Add(col11)

            Dim Col12 As New DataColumn
            str1 = "BOOLISNA"
            str2 = str1
            Col12.ColumnName = str1
            Col12.Caption = str2
            Col12.DataType = System.Type.GetType("System.Boolean")
            Col12.DefaultValue = False
            Col12.AllowDBNull = True
            tblANOVATables.Columns.Add(Col12)

            Dim col13 As New DataColumn
            str1 = "BOOLISEXCLUDE"
            str2 = str1
            col13.ColumnName = str1
            col13.Caption = str2
            col13.DataType = System.Type.GetType("System.Boolean")
            col13.DefaultValue = False
            col13.AllowDBNull = True
            tblANOVATables.Columns.Add(col13)

            Dim col14 As New DataColumn
            str1 = "NUMRUNID"
            str2 = str1
            col14.ColumnName = str1
            col14.Caption = str2
            col14.DataType = System.Type.GetType("System.Single")
            col14.DefaultValue = 0
            col14.AllowDBNull = True
            tblANOVATables.Columns.Add(col14)

            Dim col15 As New DataColumn
            str1 = "NUMANALYTE"
            str2 = str1
            col15.ColumnName = str1
            col15.Caption = str2
            col15.DataType = System.Type.GetType("System.Single")
            col15.DefaultValue = 0
            col15.AllowDBNull = True
            tblANOVATables.Columns.Add(col15)

            Dim col16 As New DataColumn
            str1 = "CHARANALYTE"
            str2 = str1
            col16.ColumnName = str1
            col16.Caption = str2
            col16.DataType = System.Type.GetType("System.String")
            col16.DefaultValue = ""
            col16.AllowDBNull = True
            tblANOVATables.Columns.Add(col16)

            Dim col17 As New DataColumn
            str1 = "NUMCRIT1"
            str2 = str1
            col17.ColumnName = str1
            col17.Caption = str2
            col17.DataType = System.Type.GetType("System.Single")
            col17.DefaultValue = 0
            col17.AllowDBNull = True
            tblANOVATables.Columns.Add(col17)

            Dim col18 As New DataColumn
            str1 = "NUMCRIT2"
            str2 = str1
            col18.ColumnName = str1
            col18.Caption = str2
            col18.DataType = System.Type.GetType("System.Single")
            col18.DefaultValue = 0
            col18.AllowDBNull = True
            tblANOVATables.Columns.Add(col18)

            Dim col19 As New DataColumn
            str1 = "BOOLOUTLIER"
            str2 = str1
            col19.ColumnName = str1
            col19.Caption = str2
            col19.DataType = System.Type.GetType("System.Boolean")
            col19.DefaultValue = False
            col19.AllowDBNull = True
            tblANOVATables.Columns.Add(col19)

        End If

        If tblQCTables.Columns.Contains("ID_tblQCTables") Then
        Else

            Dim col1 As New DataColumn
            str1 = "ID_tblQCTables"
            str2 = str1
            col1.ColumnName = str1
            col1.Caption = str2
            col1.DataType = System.Type.GetType("System.Int16")
            col1.DefaultValue = -1
            col1.AllowDBNull = True
            tblQCTables.Columns.Add(col1)

            Dim col2 As New DataColumn
            str1 = "ID_TBLCONFIGREPORTTABLES"
            str2 = str1
            col2.ColumnName = str1
            col2.Caption = str2
            col2.DataType = System.Type.GetType("System.Int16")
            col2.DefaultValue = -1
            col2.AllowDBNull = True
            tblQCTables.Columns.Add(col2)

            Dim col3 As New DataColumn
            str1 = "ID_TBLREPORTTABLE"
            str2 = str1
            col3.ColumnName = str1
            col3.Caption = str2
            col3.DataType = System.Type.GetType("System.Int16")
            col3.DefaultValue = -1
            col3.AllowDBNull = True
            tblQCTables.Columns.Add(col3)

            Dim col4 As New DataColumn
            str1 = "CHARFCID"
            str2 = str1
            col4.ColumnName = str1
            col4.Caption = str2
            col4.DataType = System.Type.GetType("System.String")
            col4.DefaultValue = "" ' -1
            col4.AllowDBNull = True
            tblQCTables.Columns.Add(col4)

            Dim col8 As New DataColumn
            str1 = "NUMNOMCONC"
            str2 = str1
            col8.ColumnName = str1
            col8.Caption = str2
            col8.DataType = System.Type.GetType("System.Single")
            col8.DefaultValue = 0
            col8.AllowDBNull = True
            tblQCTables.Columns.Add(col8)

            Dim col9 As New DataColumn
            str1 = "NUMQCLEVEL" '1,2,3,4,etc
            str2 = str1
            col9.ColumnName = str1
            col9.Caption = str2
            col9.DataType = System.Type.GetType("System.Int16")
            col9.DefaultValue = 0
            col9.AllowDBNull = True
            tblQCTables.Columns.Add(col9)

            Dim col10 As New DataColumn
            str1 = "CHARTYPE" 'Mean, SD, Precision, Accuracy, n
            str2 = str1
            col10.ColumnName = str1
            col10.Caption = str2
            col10.DataType = System.Type.GetType("System.String")
            col10.DefaultValue = 0
            col10.AllowDBNull = True
            tblQCTables.Columns.Add(col10)

            Dim col11 As New DataColumn
            str1 = "NUMVALUE"
            str2 = str1
            col11.ColumnName = str1
            col11.Caption = str2
            col11.DataType = System.Type.GetType("System.Single")
            col11.DefaultValue = 0
            col11.AllowDBNull = True
            tblQCTables.Columns.Add(col11)

            Dim col14 As New DataColumn
            str1 = "NUMRUNID"
            str2 = str1
            col14.ColumnName = str1
            col14.Caption = str2
            col14.DataType = System.Type.GetType("System.Single")
            col14.DefaultValue = 0
            col14.AllowDBNull = True
            tblQCTables.Columns.Add(col14)

            Dim col15 As New DataColumn
            str1 = "NUMANALYTE"
            str2 = str1
            col15.ColumnName = str1
            col15.Caption = str2
            col15.DataType = System.Type.GetType("System.Single")
            col15.DefaultValue = 0
            col15.AllowDBNull = True
            tblQCTables.Columns.Add(col15)

            Dim col16 As New DataColumn
            str1 = "CHARANALYTE"
            str2 = str1
            col16.ColumnName = str1
            col16.Caption = str2
            col16.DataType = System.Type.GetType("System.String")
            col16.DefaultValue = ""
            col16.AllowDBNull = True
            tblQCTables.Columns.Add(col16)

            Dim col17 As New DataColumn
            str1 = "NUMCRIT1"
            str2 = str1
            col17.ColumnName = str1
            col17.Caption = str2
            col17.DataType = System.Type.GetType("System.Single")
            col17.DefaultValue = 0
            col17.AllowDBNull = True
            tblQCTables.Columns.Add(col17)

            Dim col18 As New DataColumn
            str1 = "NUMCRIT2"
            str2 = str1
            col18.ColumnName = str1
            col18.Caption = str2
            col18.DataType = System.Type.GetType("System.Single")
            col18.DefaultValue = 0
            col18.AllowDBNull = True
            tblQCTables.Columns.Add(col18)

            Dim col19 As New DataColumn
            str1 = "BOOLOUTLIER"
            str2 = str1
            col19.ColumnName = str1
            col19.Caption = str2
            col19.DataType = System.Type.GetType("System.Boolean")
            col19.DefaultValue = False
            col19.AllowDBNull = True
            tblQCTables.Columns.Add(col19)


        End If

        If tblStabilityTables.Columns.Contains("ID_tblStabilityTables") Then
        Else

            Dim col1 As New DataColumn
            str1 = "ID_tblStabilityTables"
            str2 = str1
            col1.ColumnName = str1
            col1.Caption = str2
            col1.DataType = System.Type.GetType("System.Int16")
            col1.DefaultValue = -1
            col1.AllowDBNull = True
            tblStabilityTables.Columns.Add(col1)

        End If

    End Sub

    Sub InsertAnovaTables(ByVal idCR As Int64, ByVal idT As Int64, ByVal charFCID As String, ByVal boolInter As Boolean, ByVal boolIntra As Boolean, ByVal numNomConc As Single, ByVal numQCLevel As Single, ByVal charType As String, ByVal numValue As Single, ByVal boolISNA As Boolean, ByVal boolIsExclude As Boolean, ByVal numRunID As Single, ByVal numAnalyte As Int16, ByVal charAnalyte As String, ByVal numCrit1 As Single, ByVal numCrit2 As Single, boolOC As Boolean)

        Dim tbl As System.Data.DataTable

        tbl = tblANOVATables

        Dim rows() As DataRow
        Dim strS As String
        Dim strF As String
        Dim id As Int64

        strS = "ID_TBLCONFIGREPORTTABLES DESC"
        strF = "ID_TBLCONFIGREPORTTABLES > -1"
        rows = tbl.Select(strF, strS)

        If rows.Length = 0 Then
            id = 0
        Else
            id = rows(rows.Length - 1).Item("ID_TBLANOVATABLES")
        End If

        Dim row As DataRow = tbl.NewRow
        id = id + 1
        row.Item("ID_TBLANOVATABLES") = id
        row.Item("ID_TBLCONFIGREPORTTABLES") = idCR
        row.Item("ID_TBLREPORTTABLE") = idT
        row.Item("CHARFCID") = charFCID
        row.Item("BOOLINTER") = boolInter
        row.Item("BOOLINTRA") = boolIntra
        row.Item("NUMNOMCONC") = numNomConc
        row.Item("NUMQCLEVEL") = numQCLevel
        row.Item("CHARTYPE") = charType
        row.Item("numVALUE") = numValue
        row.Item("BOOLISEXCLUDE") = boolIsExclude
        row.Item("BOOLISNA") = boolISNA
        row.Item("NUMRUNID") = numRunID
        row.Item("numAnalyte") = numAnalyte
        row.Item("charAnalyte") = charAnalyte
        row.Item("numCrit1") = numCrit1
        row.Item("numCrit2") = numCrit2
        row.Item("BOOLOUTLIER") = boolOC

        tbl.Rows.Add(row)

        'str1 = "ID_TBLANOVATables"
        'str1 = "ID_TBLCONFIGREPORTTABLES"
        'str1 = "ID_TBLREPORTTABLE"
        'str1 = "CHARFCID"
        'str1 = "BOOLINTER"
        'str1 = "BOOLINTRA"
        'str1 = "NUMNOMCONC"
        'str1 = "NUMQCLEVEL" '1,2,3,4,etc
        'str1 = "CHARTYPE" 'Mean, SD, Precision, Accuracy, n
        'str1 = "numVALUE"
        'str1 = "BOOLISNA"
        'str1 = "BOOLISEXCLUDE"


    End Sub

    Sub InsertQCTables(ByVal idCR As Int64, ByVal idT As Int64, ByVal charFCID As String, ByVal numNomConc As Single, ByVal numQCLevel As Single, ByVal charType As String, ByVal numValue As Single, ByVal numRunID As Single, ByVal numAnalyte As Int16, ByVal charAnalyte As String, ByVal numCrit1 As Single, numCrit2 As Single, boolOC As Boolean)
        'Inserts a Statistical value into the table "tblQCTables"
        'NDL 6-dec-2015: this table is later used to replace FCs in the "ReturnAnovaValues" function

        Dim tbl As System.Data.DataTable

        tbl = tblQCTables

        Dim rows() As DataRow
        Dim strS As String
        Dim strF As String
        Dim id As Int64

        strS = "ID_TBLCONFIGREPORTTABLES DESC"
        strF = "ID_TBLCONFIGREPORTTABLES > -1"
        rows = tbl.Select(strF, strS)

        If rows.Length = 0 Then
            id = 0
        Else
            id = rows(rows.Length - 1).Item("ID_TBLQCTABLES")
        End If

        Dim row As DataRow = tbl.NewRow
        id = id + 1
        row.Item("ID_TBLQCTABLES") = id
        row.Item("ID_TBLCONFIGREPORTTABLES") = idCR
        row.Item("ID_TBLREPORTTABLE") = idT
        row.Item("CHARFCID") = charFCID
        row.Item("NUMNOMCONC") = numNomConc
        row.Item("NUMQCLEVEL") = numQCLevel
        row.Item("CHARTYPE") = charType
        row.Item("numVALUE") = numValue
        row.Item("NUMRUNID") = numRunID
        row.Item("numAnalyte") = numAnalyte
        row.Item("charAnalyte") = charAnalyte
        row.Item("numCrit1") = numCrit1
        row.Item("numCrit2") = numCrit1
        row.Item("BOOLOUTLIER") = boolOC

        tbl.Rows.Add(row)

        'str1 = "ID_TBLANOVATables"
        'str1 = "ID_TBLCONFIGREPORTTABLES"
        'str1 = "ID_TBLREPORTTABLE"
        'str1 = "CHARFCID"
        'str1 = "BOOLINTER"
        'str1 = "BOOLINTRA"
        'str1 = "NUMNOMCONC"
        'str1 = "NUMQCLEVEL" '1,2,3,4,etc
        'str1 = "CHARTYPE" 'Mean, SD, Precision, Accuracy, n
        'str1 = "numVALUE"
        'str1 = "BOOLISNA"
        'str1 = "BOOLISEXCLUDE"


    End Sub


    Sub ReturnAnovaValues(ByVal wd As Microsoft.Office.Interop.Word.Application)

        'NDL 6-Dec-2015 Remember:  ANOVA = Analysis of Variance
        'This function replaces field codes in the report body associated with tables; mostly calculations of variance
        '(e.g. average slope of regression curves, R-squared values, etc)

        Dim tbl1 As System.Data.DataTable
        Dim tbl2 As System.Data.DataTable
        Dim tbl2a As System.Data.DataTable
        Dim intRows As Int16
        Dim rows() As DataRow
        Dim rowsAnal() As DataRow
        Dim intRowsAnal As Short
        Dim strF As String
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim strS As String
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim Count4 As Short
        Dim Count5 As Short
        Dim Count6 As Short
        Dim Count7 As Short
        Dim Count8 As Short
        Dim Count9 As Short
        Dim intAnal As Short
        Dim intQC As Short
        Dim strFCID As String
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim strA As String
        Dim wrdSel As Microsoft.Office.Interop.Word.Selection
        Dim strFind As String
        Dim idT As Int64
        Dim var1, var2, var3, var4

        Dim boolDD As Boolean = True
        Dim boolIsIS As Boolean = False

        Dim int1 As Integer
        Dim idCR As Int64
        Dim intAnalyteID As Int64
        Dim intAnalyteIndex As Int64
        Dim intMasterAssayID As Int64

        Dim strMatrix As String = ""

        Dim v1 As Single
        Dim v2 As Single

        tblANOVATables.AcceptChanges()

        tbl1 = tblANOVATables
        tbl2a = tblAnalytesHome

        Dim boolQuit As Boolean
        Dim num1 As Single
        Dim numRuns As Short
        Dim strAnalyte As String
        Dim intGroup As Short

        Dim strM As String
        strM = "...Searching for table-specific QC-related field codes...."
        frmH.lblProgress.Text = strM
        frmH.Refresh()

        strF = "IsIntStd = 'No' or IsIntStd = 'Yes'"
        '20171128 LEE:
        strS = "IsIntStd ASC, INTORDER ASC"
        Try
            rowsAnal = tbl2a.Select(strF, strS)
        Catch ex As Exception
            GoTo end1
        End Try
        intRowsAnal = rowsAnal.Length

        '20171128 LEE:
        'must now convert sorted rowsAnal to tbl2
        tbl2 = rowsAnal.CopyToDataTable


        Dim strISIS As String
        Dim ctDo As Short = 0

        Dim maxDoCt As Short

        maxDoCt = 93

        Dim boolDoCt(maxDoCt) As Boolean

        Dim intIc As Short
        Dim intIcMax As Short = 50

        Dim strFFF As String
        Dim boolExPSAE As Boolean
        If frmH.chkPSAE.Checked Then
            boolExPSAE = True
        End If

        Dim dvT1 As System.Data.DataView
        If boolExPSAE Then
            dvT1 = New DataView(tblRegConAll)
        Else
            dvT1 = New DataView(tblRegCon)
        End If
        Dim tblRID As DataTable = dvT1.ToTable

        With wd

            Try
                'first look for stuff
                intIc = 0
                For Count6 = 1 To maxDoCt

                    Select Case Count6

                        Case 1
                            strA = "AverageSlopeOfCalibrCurvesTable_"
                        Case 2
                            strA = "AverageInterceptOfCalibrCurvesTable_"
                        Case 3
                            strA = "AverageRSQOfCalibrCurvesTable_"


                        Case 4
                            'do Precision
                            strA = "IntraRunPrecisionForAnalyte_"
                        Case 5
                            'do Accuracy
                            strA = "IntraRunAccuracyForAnalyte_"
                        Case 6
                            strA = "NumberofAcceptedCalibrCurvesTable_"


                        Case 7
                            'do nomconc
                            strA = "NomConcForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                        Case 8
                            'do Precision
                            strA = "InterRunPrecisionForAnalyte_" ' & Count1 + 1 & "_QCLevel" & Count3 + 1 & "_Table_"
                        Case 9
                            'do Accuracy
                            strA = "InterRunAccuracyForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                            ''''''''console.writeline(strA)
                        Case 10
                            'do PrecisionMin
                            strA = "IntraRunPrecisionMinForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                        Case 11
                            'do PrecisionMax
                            strA = "IntraRunPrecisionMaxForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                        Case 12
                            'do AccuracyMin
                            strA = "IntraRunAccuracyMinForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                        Case 13
                            'do AccuracyMax
                            strA = "IntraRunAccuracyMaxForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                        Case 14
                            'do Intra[n]
                            strA = "IntraRun[n]ForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                        Case 15
                            'do Inter[n]
                            strA = "InterRun[n]ForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"

                            'NOTE:  see more Anova table FC after 38
                        Case 39
                            strA = "SummaryIntraRunAccuracyMinForAnalyte_"
                        Case 40
                            strA = "SummaryIntraRunAccuracyMaxForAnalyte_"
                        Case 41
                            strA = "SummaryIntraRunPrecisionMinForAnalyte_"
                        Case 42
                            strA = "SummaryIntraRunPrecisionMaxForAnalyte_"
                        Case 43
                            strA = "SummaryIntraRun[n]ForAnalyte_"
                        Case 44
                            strA = "SummaryInterRunAccuracyMinForAnalyte_"
                        Case 45
                            strA = "SummaryInterRunAccuracyMaxForAnalyte_"
                        Case 46
                            strA = "SummaryInterRunPrecisionMinForAnalyte_"
                        Case 47
                            strA = "SummaryInterRunPrecisionMaxForAnalyte_"
                        Case 48
                            strA = "SummaryIntraRunAccuracyForAnalyte_" 'this has QCLevel
                        Case 49
                            strA = "SummaryIntraRunPrecisionForAnalyte_" 'this has QCLevel


                        Case 16
                            strA = "DiffValueForAnalyte_" ' & Count1 + 1 & "_Table_"
                        Case 17
                            strA = "PrecisionMinForAnalyte_" ' & Count1 + 1 & "_Table_"
                        Case 18
                            strA = "PrecisionMaxForAnalyte_" ' & Count1 + 1 & "_Table_"
                        Case 19
                            strA = "AccuracyMinForAnalyte_" ' & Count1 + 1 & "_Table_"
                        Case 20
                            strA = "AccuracyMaxForAnalyte_" ' & Count1 + 1 & "_Table_"
                        Case 21
                            strA = "AverageRecoveryPrecisionForAnalyte_" ' & Count1 + 1 & "_Table_"
                        Case 22
                            strA = "AverageRecoveryAccuracyForAnalyte_" ' & Count1 + 1 & "_Table_"
                        Case 23
                            strA = "AverageRecoveryForAnalyte_" ' & Count1 + 1 & "_Table_"
                        Case 24
                            strA = "DilutionFactorForAnalyte_" ' & Count1 + 1 & "_Table_"

                        Case 25
                            strA = "MeanSlopeForAnalyte_"
                        Case 26
                            strA = "MeanYintForAnalyte_"
                        Case 27
                            strA = "MeanR2ForAnalyte_"

                        Case 28
                            strA = "NomConcForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                        Case 29
                            strA = "PrecisionForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                        Case 30
                            strA = "AccuracyForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                        Case 31
                            strA = "RecoveryForAnalyte_" ' & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"


                        Case 32
                            strA = "StabilityConditionsForTable_"
                        Case 33
                            strA = "TimePeriodForTable_"
                        Case 34
                            strA = "TimeFrameForTable_"
                        Case 35
                            strA = "PeriodTempForTable_"
                        Case 36
                            strA = "NumberOfFTCyclesForTable_"
                        Case 37
                            strA = "Analyte_" ' & Count1 + 1
                        Case 38
                            strA = "IntStdConcForTable_"

                        Case 50
                            strA = "(n)ForAnalyte_"

                        Case 51
                            strA = "IntraRunPrecisionMinExcludeLLOQForAnalyte"
                        Case 52
                            strA = "IntraRunPrecisionMaxExcludeLLOQForAnalyte"
                        Case 53
                            strA = "IntraRunAccuracyMinExcludeLLOQForAnalyte"
                        Case 54
                            strA = "IntraRunAccuracyMaxExcludeLLOQForAnalyte"

                        Case 55
                            strA = "MeanForAnalyte"

                        Case 56
                            strA = "SummaryInterRun[n]ForAnalyte_"

                        Case 57
                            strA = "RecoveryPrecisionForAnalyte_"

                        Case 58
                            strA = "AccuracyMinIndForAnalyte_"
                        Case 59
                            strA = "AccuracyMaxIndForAnalyte_"


                        Case 60
                            strA = "AccuracyMinLotForAnalyte_"
                        Case 61
                            strA = "AccuracyMaxLotForAnalyte_"


                        Case 62
                            strA = "PrecisionMinLotForAnalyte_"
                        Case 63
                            strA = "PrecisionMaxLotForAnalyte_"

                        Case 64
                            strA = "IS_Analyte_"


                        Case 65 '20161019 LEE: Added
                            strA = "AverageISNMFForAnalyte_"
                        Case 66 '20161019 LEE: Added
                            strA = "AverageSDISNMFForAnalyte_"
                        Case 67 '20161019 LEE: Added
                            strA = "AveragePrecisionISNMFForAnalyte_"
                        Case 68 '20161019 LEE: Added
                            strA = "AveragenISNMFForAnalyte_"

                        Case 69 '20161019 LEE: Added
                            strA = "MatrixFactorOfAnalyteForAnalyte_"
                        Case 70 '20161019 LEE: Added
                            strA = "MatrixFactorOfISForAnalyte_"
                        Case 71 '20161019 LEE: Added
                            strA = "ISNMatrixFactorForAnalyte_"
                        Case 72 '20161019 LEE: Added
                            strA = "MatrixFactorPrecisionOfAnalyteForAnalyte_"
                        Case 73 '20161019 LEE: Added
                            strA = "MatrixFactorPrecisionOfISForAnalyte_"
                        Case 74 '20161019 LEE: Added
                            strA = "ISNMatrixFactorPrecisionForAnalyte_"
                        Case 75 '20161019 LEE: Added
                            strA = "MatrixFactor(n)OfAnalyteForAnalyte_"
                        Case 76 '20161019 LEE: Added
                            strA = "MatrixFactor(n)OfISForAnalyte_"
                        Case 77 '20161019 LEE: Added
                            strA = "ISNMatrixFactor(n)ForAnalyte_"

                        Case 78 '20161019 LEE: Added
                            strA = "MinIndMatrixFactorOfAnalyteForAnalyte_"
                        Case 79 '20161019 LEE: Added
                            strA = "MinIndMatrixFactorOfISForAnalyte_"
                        Case 80 '20161019 LEE: Added
                            strA = "MinIndISNMatrixFactorForAnalyte_"
                        Case 81 '20161019 LEE: Added
                            strA = "MaxIndMatrixFactorOfAnalyteForAnalyte_"
                        Case 82 '20161019 LEE: Added
                            strA = "MaxIndMatrixFactorOfISForAnalyte_"
                        Case 83 '20161019 LEE: Added
                            strA = "MaxIndISNMatrixFactorForAnalyte_"


                        Case 84 '20161021: Added
                            strA = "RecoveryMeanQCForAnalyte_"
                        Case 85 '20161021: Added
                            strA = "RecoveryMinPrecisionQCForAnalyte_"
                        Case 86 '20161021: Added
                            strA = "RecoveryMaxPrecisionQCForAnalyte_"
                        Case 87 '20161021: Added
                            strA = "RecoveryMeanRSForAnalyte_"
                        Case 88 '20161021: Added
                            strA = "RecoveryMinPrecisionRSForAnalyte_"
                        Case 89 '20161021: Added
                            strA = "RecoveryMaxPrecisionRSForAnalyte_"
                        Case 90 '20161021: Added
                            strA = "RecoveryMeanPESForAnalyte_"
                        Case 91 '20161021: Added
                            strA = "RecoveryMinPrecisionPESForAnalyte_"
                        Case 92 '20161021: Added
                            strA = "RecoveryMaxPrecisionPESForAnalyte_"

                            '20190228 LEE: Added
                        Case 93
                            strA = "DilutionReplicateNumberForAnalyte_" ' & Count1 + 1 & "_Table_"
                    End Select

                    intIc = intIc + 1
                    If intIc > intIcMax Then

                        strM = "...Searching for table-specific QC-related field codes...."
                        frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                        frmH.Refresh()

                        intIc = 0
                    End If

                    If SearchReplaceRunIDTest(wd, "[" & strA) Then
                        boolDoCt(Count6) = True
                    Else
                        boolDoCt(Count6) = False
                    End If

                Next
            Catch ex As Exception
                MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Hmmm. Problem...")
            End Try


            'I believe this section is ANOVA tables only

            'var1 = tbl1.Rows.Count 'debug

            Dim strAnalyteO As String
            Dim strAnalyteUser As String
            Dim boolHit As Boolean = False
            Dim intAH1 As Short = 0
            Dim intAH2 As Short = 0

            '20190220 LEE:
            'Find out how many analytes are just analytes
            For Count1 = 0 To intRowsAnal - 1
                strISIS = NZ(tbl2.Rows(Count1).Item("IsIntStd"), "No")
                If StrComp(strISIS, "Yes", CompareMethod.Text) = 0 Then
                Else
                    intAH1 = intAH1 + 1
                End If
            Next

            For Count1 = 0 To intRowsAnal - 1

                Dim dv As System.Data.DataView = New DataView(tbl1)
                Dim tblFCID As System.Data.DataTable = dv.ToTable("a", True, "CHARFCID")
                'Dim tblFCID As System.Data.DataTable = dvR.ToTable("a", True, "CHARFCID")
                Dim intFCID As Short = tblFCID.Rows.Count

                'get numRuns
                strISIS = NZ(tbl2.Rows(Count1).Item("IsIntStd"), "No")
                strAnalyte = NZ(tbl2.Rows(Count1).Item("AnalyteDescription"), "NA")
                strAnalyteUser = NZ(tbl2.Rows(Count1).Item("CHARUSERANALYTE"), "NA")
                strAnalyteO = NZ(tbl2.Rows(Count1).Item("OriginalAnalyteDescription"), "NA")
                intAnalyteID = NZ(tbl2.Rows(Count1).Item("AnalyteID"), 0)
                intAnalyteIndex = NZ(tbl2.Rows(Count1).Item("AnalyteIndex"), 0)
                intMasterAssayID = NZ(tbl2.Rows(Count1).Item("MasterAssayID"), 0)

                '20181128 LEE:
                Try
                    intGroup = tbl2.Rows(Count1).Item("INTGROUP")
                Catch ex As Exception
                    var1 = ex.Message
                End Try


                Try
                    strMatrix = NZ(tbl2.Rows(Count1).Item("Matrix"), "NA")
                Catch ex As Exception
                    var1 = var1
                End Try

                If StrComp(strISIS, "Yes", CompareMethod.Text) = 0 Then
                    boolIsIS = True
                Else
                    boolIsIS = False
                End If

                'check to see if analyte is used

                boolHit = False
                If boolIsIS Then
                    'check to see if related analyte is used
                    boolHit = DoIntStdDtbl(intRowsAnal, tbl2, strAnalyte)
                    If boolHit Then
                    Else
                        GoTo nextCount1
                    End If
                Else
                    If UseAnalyte(strAnalyte) Then
                    Else
                        GoTo nextCount1
                    End If
                End If

                ctDo = 0

                For Count2 = 0 To intFCID - 1

                    If StrComp(strISIS, "Yes", CompareMethod.Text) = 0 Then
                    Else

                        'the following gives QC Levels
                        strFCID = NZ(tblFCID.Rows(Count2).Item("CHARFCID"), "LABIntegrityAAA")
                        str1 = Mid(strFCID, 1, 2)
                        If StrComp(str1, "PH", CompareMethod.Text) = 0 Then
                            strFCID = "LABIntegrityAAA"
                        End If
                        If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                            GoTo nextCount2
                        End If

                        'The following is for Intervet
                        Dim strInt As String
                        Dim intU As Short
                        intU = InStr(1, strFCID, "_", CompareMethod.Text)
                        If intU < 1 Then
                        Else
                            strInt = Mid(strFCID, 1, intU)
                            If StrComp(strInt, "SSS_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2
                            ElseIf StrComp(strInt, "CFQC_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2
                            ElseIf StrComp(strInt, "IBS_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2
                            ElseIf StrComp(strInt, "CFQCNC_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2
                            ElseIf StrComp(strInt, "CT_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2
                            ElseIf StrComp(strInt, "MTIBS_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2

                            End If
                        End If
                        'end Intervet

                        strF = "CHARFCID = '" & strFCID & "'"
                        Dim dvNN As System.Data.DataView = New DataView(tbl1, strF, "ID_TBLANOVATABLES ASC", DataViewRowState.CurrentRows)
                        'wdd.visible = True
                        Dim tblFCID1 As System.Data.DataTable = dvNN.ToTable("a", True, "NUMNOMCONC")
                        Dim intFCID1 As Short = tblFCID1.Rows.Count

                        strF1 = "CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                        Dim dv2 As System.Data.DataView = New DataView(tbl1, strF1, "NUMRUNID ASC", DataViewRowState.CurrentRows)
                        var1 = dv2.Count
                        Dim tblFCID2 As System.Data.DataTable = dv2.ToTable("b", True, "NUMRUNID")
                        Dim intFCID2 As Short = tblFCID2.Rows.Count
                        Dim strC As String
                        Dim boolIsLinear As Boolean = True

                        ctDo = 0

                        For Count4 = 1 To 3

                            Try

                                Select Case Count4
                                    Case 1
                                        ctDo = 1
                                        strA = "AverageSlopeOfCalibrCurvesTable_"
                                    Case 2
                                        ctDo = 2
                                        strA = "AverageInterceptOfCalibrCurvesTable_"
                                    Case 3
                                        ctDo = 3
                                        strA = "AverageRSQOfCalibrCurvesTable_"
                                End Select

                                'ctDo = ctDo + 1
                                If boolDoCt(ctDo) Then

                                    Dim numRunID As Short

                                    Dim TotVal As Single

                                    strFind = "[" & strA & strFCID & "]"


                                    boolQuit = False
                                    Do Until boolQuit

                                        'Exit Do

                                        .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                                        wrdSel = wd.Selection

                                        With wrdSel.Find
                                            .ClearFormatting()
                                            .MatchWholeWord = True
                                            .Forward = True
                                            .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                                            .Execute(FindText:=strFind)
                                            If .Found Then
                                                'get value from tblAnovaTables
                                                TotVal = 0
                                                Select Case Count4
                                                    Case 1 'average slope
                                                        '**
                                                        TotVal = 0
                                                        boolIsLinear = True
                                                        For Count5 = 0 To intFCID2 - 1
                                                            numRunID = tblFCID2.Rows(Count5).Item("NUMRUNID")
                                                            var1 = numRunID

                                                            'may use this later
                                                            'If frmH.rbAnalRunsShowAll.Checked Then
                                                            '    strF = "STUDYID = " & wStudyID & " AND ANALYTEINDEX = " & arrAnalytes(3, Count1) & " AND MASTERASSAYID = " & arrAnalytes(12, Count1) & " AND RUNTYPEID > 0 AND RUNID = " & var1
                                                            'ElseIf frmH.rbAnalRunsExclPSAE.Checked Then
                                                            '    strF = "STUDYID = " & wStudyID & " AND ANALYTEINDEX = " & arrAnalytes(3, Count1) & " AND MASTERASSAYID = " & arrAnalytes(12, Count1) & " AND RUNTYPEID <> 3 AND RUNID = " & var1
                                                            'Else 'Bioanalysis
                                                            '    strF = "STUDYID = " & wStudyID & " AND ANALYTEINDEX = " & arrAnalytes(3, Count1) & " AND MASTERASSAYID = " & arrAnalytes(12, Count1) & " AND RUNTYPEID > 0 AND RUNID = " & var1
                                                            'End If

                                                            'REGRESSIONPARAMETERID(1=Slope, 2=YInt)
                                                            'strF = "STUDYID = " & wStudyID & " AND ANALYTEINDEX = " & arrAnalytes(3, Count1 + 1) & " AND MASTERASSAYID = " & arrAnalytes(12, Count1 + 1) & " AND ANALYTEID = " & arrAnalytes(2, Count1 + 1) & " AND RUNID = " & var1 & " AND REGRESSIONPARAMETERID = 1"
                                                            strF = "STUDYID = " & wStudyID & " AND ANALYTEID = " & arrAnalytes(2, Count1 + 1) & " AND RUNID = " & var1 & " AND REGRESSIONPARAMETERID = 1"

                                                            Dim drows() As DataRow = tblRegCon.Select(strF, "REGRESSIONPARAMETERID ASC")
                                                            int1 = drows.Length
                                                            If int1 = 0 Then

                                                            Else
                                                                var2 = NZ(drows(0).Item("REGRESSIONTEXT"), "aaa")
                                                                If StrComp(var2, "Linear", CompareMethod.Text) = 0 Then
                                                                Else
                                                                    boolIsLinear = False
                                                                    Exit For
                                                                End If
                                                                var4 = NZ(drows(0).Item("PARAMETERVALUE"), 0)

                                                                If boolLUseSigFigsRegr Then
                                                                    If boolLUseRegrSciNot Then
                                                                        var2 = CDbl(SigFigOrDecString(var4, LRegrSigFigs, True)) ' GetScNot(LRegrSigFigs)
                                                                    Else
                                                                        'var2 = SigFigOrDec(var4, LRegrSigFigs, False)
                                                                        var2 = CDbl(SigFigOrDecString(var4, LRegrSigFigs, True))
                                                                    End If
                                                                Else
                                                                    If boolLUseRegrSciNot Then
                                                                        var2 = RoundToDecimalRAFZ(var4, LRegrDec + 1) ' GetScNot(LRegrDec + 1)
                                                                    Else
                                                                        var2 = RoundToDecimalRAFZ(var4, LRegrDec)
                                                                    End If
                                                                End If
                                                                var1 = var2

                                                                TotVal = TotVal + var1
                                                            End If

                                                        Next

                                                        If boolIsLinear Then
                                                            Dim aveTV As Double
                                                            aveTV = TotVal / intFCID2

                                                            If boolLUseSigFigsRegr Then
                                                                If boolLUseRegrSciNot Then
                                                                    var2 = Format(aveTV, GetScNot(LRegrSigFigs))
                                                                Else
                                                                    'var2 = SigFigOrDec(var4, LRegrSigFigs, False)
                                                                    var2 = SigFigOrDecString(aveTV, LRegrSigFigs, True)
                                                                End If
                                                            Else
                                                                If boolLUseRegrSciNot Then
                                                                    var2 = Format(aveTV, GetScNot(LRegrDec + 1))
                                                                Else
                                                                    var2 = Format(aveTV, strRegrDec)
                                                                End If
                                                            End If
                                                            var3 = Replace(CStr(var2), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                            wd.Selection.Text = CStr(var3)
                                                            'wd.Selection.Text = CStr(SigFigOrDecString(aveTV, LRegrSigFigs, True))

                                                        Else
                                                            wd.Selection.Text = "NA for non-linear Regr"
                                                        End If


                                                        '***
                                                    Case 2 'averageIntercept
                                                        '**
                                                        TotVal = 0
                                                        boolIsLinear = True

                                                        For Count5 = 0 To intFCID2 - 1
                                                            numRunID = tblFCID2.Rows(Count5).Item("NUMRUNID")
                                                            var1 = numRunID
                                                            'REGRESSIONPARAMETERID(1=Slope, 2=YInt)
                                                            strF = "STUDYID = " & wStudyID & " AND ANALYTEINDEX = " & arrAnalytes(3, Count1 + 1) & " AND MASTERASSAYID = " & arrAnalytes(12, Count1 + 1) & " AND ANALYTEID = " & arrAnalytes(2, Count1 + 1) & " AND RUNID = " & var1 & " AND REGRESSIONPARAMETERID = 2"

                                                            Dim drows() As DataRow = tblRegCon.Select(strF, "REGRESSIONPARAMETERID ASC")
                                                            int1 = drows.Length

                                                            If int1 = 0 Then

                                                            Else
                                                                var2 = NZ(drows(0).Item("REGRESSIONTEXT"), "aaa")
                                                                If StrComp(var2, "Linear", CompareMethod.Text) = 0 Then
                                                                Else
                                                                    boolIsLinear = False
                                                                    Exit For
                                                                End If
                                                                var4 = NZ(drows(0).Item("PARAMETERVALUE"), 0)

                                                                If boolLUseSigFigsRegr Then
                                                                    If boolLUseRegrSciNot Then
                                                                        var2 = CDbl(SigFigOrDecString(var4, LRegrSigFigs, True)) ' GetScNot(LRegrSigFigs)
                                                                    Else
                                                                        'var2 = SigFigOrDec(var4, LRegrSigFigs, False)
                                                                        var2 = CDbl(SigFigOrDecString(var4, LRegrSigFigs, True))
                                                                    End If
                                                                Else
                                                                    If boolLUseRegrSciNot Then
                                                                        var2 = RoundToDecimalRAFZ(var4, LRegrDec + 1) ' GetScNot(LRegrDec + 1)
                                                                    Else
                                                                        var2 = RoundToDecimalRAFZ(var4, LRegrDec)
                                                                    End If
                                                                End If
                                                                var1 = var2

                                                                TotVal = TotVal + var1
                                                            End If

                                                        Next
                                                        If boolIsLinear Then
                                                            Dim aveTV As Double
                                                            aveTV = TotVal / intFCID2
                                                            If boolLUseSigFigsRegr Then
                                                                If boolLUseRegrSciNot Then
                                                                    var2 = Format(aveTV, GetScNot(LRegrSigFigs))
                                                                Else
                                                                    'var2 = SigFigOrDec(var4, LRegrSigFigs, False)
                                                                    var2 = SigFigOrDecString(aveTV, LRegrSigFigs, True)
                                                                End If
                                                            Else
                                                                If boolLUseRegrSciNot Then
                                                                    var2 = Format(aveTV, GetScNot(LRegrDec + 1))
                                                                Else
                                                                    var2 = Format(aveTV, strRegrDec)
                                                                End If
                                                            End If
                                                            var3 = Replace(CStr(var2), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                            wd.Selection.Text = CStr(var3)

                                                            'wd.Selection.Text = CStr(SigFigOrDecString(aveTV, LRegrSigFigs, True))
                                                        Else
                                                            wd.Selection.Text = "NA for non-linear Regr"
                                                        End If

                                                        '***

                                                    Case 3 'average R2
                                                        '**
                                                        TotVal = 0

                                                        For Count5 = 0 To intFCID2 - 1
                                                            numRunID = tblFCID2.Rows(Count5).Item("NUMRUNID")
                                                            var1 = numRunID

                                                            'strF = "STUDYID = " & wStudyID & " AND ANALYTEINDEX = " & arrAnalytes(3, Count1 + 1) & " AND MASTERASSAYID = " & arrAnalytes(12, Count1 + 1) & " AND ANALYTEID = " & arrAnalytes(2, Count1 + 1) & " AND RUNID = " & var1 & " AND REGRESSIONPARAMETERID = 1"
                                                            strF = "STUDYID = " & wStudyID & " AND ANALYTEID = " & arrAnalytes(2, Count1 + 1) & " AND RUNID = " & var1 & " AND REGRESSIONPARAMETERID = 1"

                                                            Dim drows() As DataRow = tblRegCon.Select(strF, "REGRESSIONPARAMETERID ASC")
                                                            int1 = drows.Length

                                                            If int1 = 0 Then

                                                            Else
                                                                var4 = NZ(drows(0).Item("RSQUARED"), 0)

                                                                If boolLUseSigFigsRegr Then
                                                                    If boolLUseRegrSciNot Then
                                                                        var2 = CDbl(SigFigOrDecString(var4, LR2SigFigs, True)) 'GetScNot(LR2SigFigs)
                                                                    Else
                                                                        'var2 = SigFigOrDec(var4, LRegrSigFigs, False)
                                                                        var2 = CDbl(SigFigOrDecString(var4, LR2SigFigs, True))
                                                                    End If
                                                                Else
                                                                    If boolLUseRegrSciNot Then
                                                                        var2 = RoundToDecimalRAFZ(var4, LRegrDec + 1) 'GetScNot(LRegrDec + 1)
                                                                    Else
                                                                        var2 = RoundToDecimalRAFZ(var4, LRegrDec)
                                                                    End If
                                                                End If
                                                                var1 = var2

                                                                TotVal = TotVal + var1
                                                            End If

                                                        Next
                                                        Dim aveTV As Double
                                                        aveTV = TotVal / intFCID2

                                                        If boolLUseSigFigsRegr Then
                                                            If boolLUseRegrSciNot Then
                                                                var2 = Format(aveTV, GetScNot(LR2SigFigs))
                                                            Else
                                                                'var2 = SigFigOrDec(var4, LRegrSigFigs, False)
                                                                var2 = SigFigOrDecString(aveTV, LR2SigFigs, True)
                                                            End If
                                                        Else
                                                            If boolLUseRegrSciNot Then
                                                                var2 = Format(aveTV, GetScNot(LRegrDec + 1))
                                                            Else
                                                                var2 = Format(aveTV, strRegrDec)
                                                            End If
                                                        End If
                                                        var3 = Replace(CStr(var2), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                        wd.Selection.Text = CStr(var3)
                                                        'wd.Selection.Text = CStr(SigFigOrDecString(aveTV, LRegrSigFigs, True))

                                                        '***
                                                End Select
                                            Else
                                                boolQuit = True
                                            End If

                                        End With
                                    Loop

                                End If
                            Catch ex As Exception
                                MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                            End Try

                            intIc = intIc + 1
                            If intIc > intIcMax Then

                                strM = "...Searching for table-specific QC-related field codes...."
                                frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                                frmH.Refresh()

                                intIc = 0
                            End If

                        Next Count4


                        For Count3 = 0 To intFCID1 - 1

                            For Count5 = 0 To intFCID2 - 1
                                Dim numRunID As Short
                                numRunID = tblFCID2.Rows(Count5).Item("NUMRUNID")

                                ctDo = 3

                                For Count4 = 1 To 3

                                    Try

                                        Select Case Count4
                                            Case 1
                                                'do Precision
                                                ctDo = 4
                                                strA = "IntraRunPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                            Case 2
                                                'do Accuracy
                                                ctDo = 5
                                                strA = "IntraRunAccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                            Case 3
                                                ctDo = 6
                                                strA = "NumberofAcceptedCalibrCurvesTable_"

                                        End Select

                                        'ctDo = ctDo + 1
                                        If boolDoCt(ctDo) Then

                                            strFind = "[" & strA & strFCID & "]"

                                            boolQuit = False
                                            Do Until boolQuit

                                                .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                                                wrdSel = wd.Selection

                                                With wrdSel.Find
                                                    .ClearFormatting()
                                                    .MatchWholeWord = True
                                                    .Forward = True
                                                    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                                                    .Execute(FindText:=strFind)
                                                    If .Found Then
                                                        'get value from tblAnovaTables
                                                        Select Case Count4
                                                            'herehere
                                                            Case 1
                                                                'do Precision
                                                                strF1 = "NUMRUNID = " & numRunID & " AND CHARTYPE = 'Precision' AND BOOLINTRA = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                    If IsNumeric(var1) Then
                                                                        str1 = Format(var1, strQCDec) ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                                    Else
                                                                        str1 = "[NA]"
                                                                    End If
                                                                End If
                                                            Case 2
                                                                'do Accuracy
                                                                strF1 = "NUMRUNID = " & numRunID & " AND CHARTYPE = 'Accuracy' AND BOOLINTRA = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                    If IsNumeric(var1) Then
                                                                        str1 = Format(var1, strQCDec) ' CStr(SigFigOrDecString(var1, LSigFig, True))

                                                                    Else
                                                                        str1 = "[NA]"
                                                                    End If
                                                                End If
                                                            Case 3
                                                                'do Number of Accepted Calibr Curves
                                                                str1 = CStr(intFCID2) ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                        End Select
                                                        If StrComp(str1, "[NA]", CompareMethod.Text) = 0 Then
                                                            'make red font
                                                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                            wd.Selection.TypeText(Text:=str1)
                                                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                        Else
                                                            str2 = Replace(CStr(str1), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                            wd.Selection.Text = str2
                                                        End If

                                                    Else
                                                        boolQuit = True
                                                    End If

                                                End With

                                            Loop

                                        End If
                                    Catch ex As Exception
                                        MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                                    End Try

                                    intIc = intIc + 1
                                    If intIc > intIcMax Then

                                        strM = "...Searching for table-specific QC-related field codes...."
                                        frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                                        frmH.Refresh()

                                        intIc = 0
                                    End If

                                Next Count4
                            Next Count5
                        Next Count3

                    End If

nextCount2:

                Next Count2


                For Count2 = 0 To intFCID - 1

                    If StrComp(strISIS, "Yes", CompareMethod.Text) = 0 Then
                    Else
                        'the following gives QC Levels
                        strFCID = NZ(tblFCID.Rows(Count2).Item("CHARFCID"), "LABIntegrityAAA")
                        str1 = Mid(strFCID, 1, 2)
                        If StrComp(str1, "PH", CompareMethod.Text) = 0 Then
                            strFCID = "LABIntegrityAAA"
                        End If
                        If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                            GoTo nextCount2a
                        End If

                        'The following is for Intervet
                        Dim strInt As String
                        Dim intU As Short
                        intU = InStr(1, strFCID, "_", CompareMethod.Text)
                        If intU < 1 Then
                        Else
                            strInt = Mid(strFCID, 1, intU)
                            If StrComp(strInt, "CFQC_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2a
                            ElseIf StrComp(strInt, "IBS_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2a
                            ElseIf StrComp(strInt, "CFQCNC_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2a
                            ElseIf StrComp(strInt, "CT_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2a
                            ElseIf StrComp(strInt, "MTIBS_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2a
                            ElseIf StrComp(strInt, "SSS_", CompareMethod.Text) = 0 Then
                                GoTo nextCount2a
                            End If
                        End If
                        'end Intervet

                        strF = "CHARFCID = '" & strFCID & "'"
                        Dim dvN As System.Data.DataView = New DataView(tbl1, strF, "ID_TBLANOVATABLES ASC", DataViewRowState.CurrentRows)
                        Dim tblFCID1 As System.Data.DataTable = dvN.ToTable("a", True, "NUMNOMCONC")
                        Dim intFCID1 As Short = tblFCID1.Rows.Count

                        'ctDo = 6
                        For Count3 = 0 To intFCID1 - 1

                            ctDo = 6
                            For Count4 = 1 To 12

                                Try

                                    Select Case Count4
                                        Case 1
                                            'do nomconc
                                            ctDo = 7
                                            strA = "NomConcForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                        Case 2
                                            'do Precision
                                            ctDo = 8
                                            strA = "InterRunPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                        Case 3
                                            'do Accuracy
                                            ctDo = 9
                                            strA = "InterRunAccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                            ''''''''console.writeline(strA)
                                        Case 4
                                            'do PrecisionMin
                                            ctDo = 10
                                            strA = "IntraRunPrecisionMinForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                        Case 5
                                            'do PrecisionMax
                                            ctDo = 11
                                            strA = "IntraRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                        Case 6
                                            'do AccuracyMin
                                            ctDo = 12
                                            strA = "IntraRunAccuracyMinForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                        Case 7
                                            'do AccuracyMax
                                            ctDo = 13
                                            strA = "IntraRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                        Case 8
                                            'do Intra[n]
                                            ctDo = 14
                                            strA = "IntraRun[n]ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                        Case 9
                                            'do Inter[n]
                                            ctDo = 15
                                            strA = "InterRun[n]ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                        Case 10
                                            ctDo = 48
                                            strA = "SummaryIntraRunAccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                        Case 11
                                            ctDo = 49
                                            strA = "SummaryIntraRunPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"

                                        Case 12
                                            ctDo = 43
                                            strA = "SummaryIntraRun[n]ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"



                                    End Select

                                    'wdd.visible = True

                                    'ctDo = ctDo + 1

                                    If boolDoCt(ctDo) Then

                                        For Count6 = 1 To 2
                                            boolDD = True
                                            Select Case Count6
                                                Case 1
                                                    strFind = "[" & strA & strFCID & "]"
                                                Case 2
                                                    If boolIsIS Then
                                                        Select Case Count4
                                                            Case 10, 11, 12
                                                                strFind = "[IS_" & strA & strFCID & "]"
                                                            Case Else
                                                                boolDD = False
                                                        End Select
                                                    Else
                                                        boolDD = False
                                                    End If

                                            End Select

                                            If boolDD Then
                                                boolQuit = False
                                                Do Until boolQuit

                                                    .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                                                    wrdSel = wd.Selection

                                                    With wrdSel.Find
                                                        .ClearFormatting()
                                                        .MatchWholeWord = True
                                                        .Forward = True
                                                        .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                                                        .Execute(FindText:=strFind)
                                                        If .Found Then
                                                            'get value from tblAnovaTables
                                                            Select Case Count4
                                                                Case 1
                                                                    'do nomconc
                                                                    strF1 = "CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        var1 = NZ(rowsA(0).Item("NUMNOMCONC"), "NA")
                                                                        If IsNumeric(var1) Then
                                                                            str1 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                                        Else
                                                                            str1 = "[NA]"
                                                                        End If
                                                                    End If
                                                                Case 2
                                                                    'do Precision
                                                                    strF1 = "CHARTYPE = 'Precision' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                        If IsNumeric(var1) Then
                                                                            str1 = Format(var1, strQCDec) ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                                        Else
                                                                            str1 = "[NA]"
                                                                        End If
                                                                    End If
                                                                Case 3
                                                                    'do Accuracy
                                                                    strF1 = "CHARTYPE = 'Accuracy' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                        If IsNumeric(var1) Then
                                                                            str1 = Format(var1, strQCDec) ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                                        Else
                                                                            str1 = "[NA]"
                                                                        End If
                                                                    End If
                                                                Case 4
                                                                    'do PrecisionMin
                                                                    strF1 = "CHARTYPE = 'Precision' AND BOOLINTRA = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        Dim numMin As Single
                                                                        numMin = 9999999
                                                                        For Count5 = 0 To rowsA.Length - 1
                                                                            var1 = rowsA(Count5).Item("NUMVALUE")
                                                                            If IsNumeric(var1) Then
                                                                                If var1 < numMin Then
                                                                                    numMin = var1
                                                                                End If
                                                                            End If
                                                                        Next
                                                                        str1 = Format(numMin, strQCDec) 'CStr(SigFigOrDec(numMin, LSigFig, False, True))
                                                                    End If
                                                                Case 5
                                                                    'do PrecisionMax
                                                                    strF1 = "CHARTYPE = 'Precision' AND BOOLINTRA = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        Dim numMax As Single
                                                                        numMax = -999999999
                                                                        For Count5 = 0 To rowsA.Length - 1
                                                                            var1 = rowsA(Count5).Item("NUMVALUE")
                                                                            If IsNumeric(var1) Then
                                                                                If var1 > numMax Then
                                                                                    numMax = var1
                                                                                End If
                                                                            End If
                                                                        Next
                                                                        str1 = Format(numMax, strQCDec) ' CStr(SigFigOrDec(numMax, LSigFig, False, True))
                                                                    End If

                                                                Case 6
                                                                    'do AccuracyMin
                                                                    strF1 = "CHARTYPE = 'Accuracy' AND BOOLINTRA = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        Dim numMin As Single
                                                                        numMin = 99999999
                                                                        For Count5 = 0 To rowsA.Length - 1
                                                                            var1 = rowsA(Count5).Item("NUMVALUE")
                                                                            If IsNumeric(var1) Then
                                                                                If var1 < numMin Then
                                                                                    numMin = var1
                                                                                End If
                                                                            End If
                                                                        Next
                                                                        str1 = Format(numMin, strQCDec) ' CStr(SigFigOrDec(numMin, LSigFig, False, True))
                                                                    End If
                                                                Case 7
                                                                    'do AccuracyMax
                                                                    strF1 = "CHARTYPE = 'Accuracy' AND BOOLINTRA = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        Dim numMax As Single
                                                                        numMax = -999999999
                                                                        For Count5 = 0 To rowsA.Length - 1
                                                                            var1 = rowsA(Count5).Item("NUMVALUE")
                                                                            If IsNumeric(var1) Then
                                                                                If var1 > numMax Then
                                                                                    numMax = var1
                                                                                End If
                                                                            End If
                                                                        Next
                                                                        str1 = Format(numMax, strQCDec) ' CStr(SigFigOrDec(numMax, LSigFig, False, True))
                                                                    End If
                                                                Case 8
                                                                    'do Intra[n]
                                                                    strF1 = "CHARTYPE = 'n' AND BOOLINTRA = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                                    Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                                    If tblIntraN.Rows.Count = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        Dim numMax As Single
                                                                        numMax = -999999999
                                                                        For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                            var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                            If IsNumeric(var1) Then
                                                                                If var1 > numMax Then
                                                                                    numMax = var1
                                                                                End If
                                                                            End If
                                                                        Next
                                                                        str1 = Format(numMax, "0")
                                                                    End If

                                                                Case 9
                                                                    'do Inter[n]
                                                                    strF1 = "CHARTYPE = 'n' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                                    Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                                    If tblIntraN.Rows.Count = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        Dim numMax As Single
                                                                        numMax = -999999999
                                                                        For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                            var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                            If IsNumeric(var1) Then
                                                                                If var1 > numMax Then
                                                                                    numMax = var1
                                                                                End If
                                                                            End If
                                                                        Next
                                                                        str1 = Format(numMax, "0")
                                                                    End If

                                                                Case 10

                                                                    ctDo = 48
                                                                    strA = "SummaryIntraRunAccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                                                    strF1 = "CHARTYPE = 'IntraRunAccuracy' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                        If IsNumeric(var1) Then
                                                                            str1 = Format(var1, strQCDec) ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                                        Else
                                                                            str1 = "[NA]"
                                                                        End If
                                                                    End If
                                                                Case 11
                                                                    ctDo = 49
                                                                    strA = "SummaryIntraRunPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                                                    strF1 = "CHARTYPE = 'IntraRunPrecision' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                        If IsNumeric(var1) Then
                                                                            str1 = Format(var1, strQCDec) ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                                        Else
                                                                            str1 = "[NA]"
                                                                        End If
                                                                    End If

                                                                Case 12
                                                                    ctDo = 43
                                                                    strA = "SummaryIntraRun[n]ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_Table_"
                                                                    strF1 = "CHARTYPE = 'IntraRunN' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                                    Dim rowsA() As DataRow = tbl1.Select(strF1)
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                        If IsNumeric(var1) Then
                                                                            str1 = CStr(CInt(var1)) ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                                        Else
                                                                            str1 = "[NA]"
                                                                        End If
                                                                    End If

                                                            End Select
                                                            If StrComp(str1, "[NA]", CompareMethod.Text) = 0 Then
                                                                'make red font
                                                                wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                                wd.Selection.TypeText(Text:=str1)
                                                                wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                            Else
                                                                str2 = Replace(CStr(str1), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                                wd.Selection.Text = str2
                                                            End If
                                                        Else
                                                            boolQuit = True
                                                        End If

                                                    End With

                                                Loop
                                            End If

                                        Next

                                    End If

                                Catch ex As Exception
                                    MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                                End Try

                                intIc = intIc + 1
                                If intIc > intIcMax Then

                                    strM = "...Searching for table-specific QC-related field codes...."
                                    frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                                    frmH.Refresh()

                                    intIc = 0
                                End If

                            Next Count4
                        Next Count3
                    End If

                    'now do some min/max's and n

                    For Count4 = 1 To 18

                        Try

                            Select Case Count4
                                Case 1
                                    strA = "SummaryIntraRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 39
                                Case 2
                                    strA = "SummaryIntraRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 40
                                Case 3
                                    strA = "SummaryIntraRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 41
                                Case 4
                                    strA = "SummaryIntraRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 42
                                Case 5
                                    strA = "SummaryInterRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 44
                                Case 6
                                    strA = "SummaryInterRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 45
                                Case 7
                                    strA = "SummaryInterRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 46
                                Case 8
                                    strA = "SummaryInterRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 47

                                Case 9
                                    strA = "IntraRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 10
                                Case 10
                                    strA = "IntraRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 11
                                Case 11
                                    strA = "IntraRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 12
                                Case 12
                                    strA = "IntraRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 13
                                Case 13
                                    strA = "IntraRunPrecisionMinExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 51
                                Case 14
                                    strA = "IntraRunPrecisionMaxExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 52
                                Case 15
                                    strA = "IntraRunAccuracyMinExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 53
                                Case 16
                                    strA = "IntraRunAccuracyMaxExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 54

                                Case 17
                                    strA = "SummaryIntraRun[n]ForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 43

                                Case 18
                                    strA = "SummaryInterRun[n]ForAnalyte_" & Count1 + 1 & "_Table_"
                                    ctDo = 56

                            End Select

                            For Count6 = 1 To 2

                                boolDD = True
                                Select Case Count6
                                    Case 1
                                        strFind = "[" & strA & strFCID & "]"
                                    Case 2
                                        If boolIsIS Then
                                            Select Case Count4
                                                'Case 1, 2, 3, 4, 5, 6, 7, 8, 17, 18
                                                Case 13, 14, 15, 22, 31, 32
                                                    strFind = "[IS_" & strA & strFCID & "]"
                                                Case Else
                                                    boolDD = False
                                            End Select
                                        Else
                                            boolDD = False
                                        End If

                                End Select

                                If boolDD Then

                                    boolQuit = False

                                    If boolDoCt(ctDo) Then
                                        Do Until boolQuit

                                            .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                                            wrdSel = wd.Selection

                                            With wrdSel.Find
                                                .ClearFormatting()
                                                .MatchWholeWord = True
                                                .Forward = True
                                                .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                                                .Execute(FindText:=strFind)
                                                If .Found Then

                                                    Select Case Count4
                                                        Case 1
                                                            strA = "SummaryIntraRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 39

                                                            strF1 = "CHARTYPE = 'IntraRunAccuracy' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMin As Single
                                                                numMin = 999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMin Then
                                                                            numMin = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMin, strQCDec)

                                                            End If

                                                        Case 2
                                                            strA = "SummaryIntraRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 40

                                                            strF1 = "CHARTYPE = 'IntraRunAccuracy' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single
                                                                numMax = -999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)
                                                            End If

                                                        Case 3
                                                            strA = "SummaryIntraRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 41


                                                            strF1 = "CHARTYPE = 'IntraRunPrecision' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMin As Single
                                                                numMin = 999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMin Then
                                                                            numMin = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMin, strQCDec)

                                                            End If

                                                        Case 4
                                                            strA = "SummaryIntraRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 42


                                                            strF1 = "CHARTYPE = 'IntraRunPrecision' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single
                                                                numMax = -999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)
                                                            End If

                                                        Case 5
                                                            strA = "SummaryInterRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 44


                                                            strF1 = "CHARTYPE = 'Accuracy' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMin As Single
                                                                numMin = 999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMin Then
                                                                            numMin = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMin, strQCDec)
                                                            End If

                                                        Case 6
                                                            strA = "SummaryInterRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 45


                                                            strF1 = "CHARTYPE = 'Accuracy' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single
                                                                numMax = -999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)
                                                            End If

                                                        Case 7
                                                            strA = "SummaryInterRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 46


                                                            strF1 = "CHARTYPE = 'Precision' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMin As Single
                                                                numMin = 999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMin Then
                                                                            numMin = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMin, strQCDec)
                                                            End If

                                                        Case 8
                                                            strA = "SummaryInterRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 47


                                                            strF1 = "CHARTYPE = 'Precision' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single
                                                                numMax = -999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)
                                                            End If

                                                        Case 9
                                                            strA = "IntraRunPrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 10

                                                            strF1 = "CHARTYPE = 'Precision' AND BOOLINTER = " & False & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMin As Single
                                                                numMin = 999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMin Then
                                                                            numMin = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMin, strQCDec)
                                                            End If

                                                        Case 10
                                                            strA = "IntraRunPrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 11

                                                            strF1 = "CHARTYPE = 'Precision' AND BOOLINTER = " & False & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single
                                                                numMax = -999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)
                                                            End If

                                                        Case 11
                                                            strA = "IntraRunAccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 12

                                                            strF1 = "CHARTYPE = 'Accuracy' AND BOOLINTER = " & False & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMin As Single
                                                                numMin = 999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMin Then
                                                                            numMin = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMin, strQCDec)
                                                            End If

                                                        Case 12
                                                            strA = "IntraRunAccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 13

                                                            strF1 = "CHARTYPE = 'Accuracy' AND BOOLINTER = " & False & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single
                                                                numMax = -999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)
                                                            End If

                                                        Case 13
                                                            strA = "IntraRunPrecisionMinExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 51

                                                            strF1 = "CHARTYPE = 'Precision' AND BOOLINTER = " & False & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL <> 1"
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMin As Single
                                                                numMin = 999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMin Then
                                                                            numMin = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMin, strQCDec)

                                                            End If

                                                        Case 14
                                                            strA = "IntraRunPrecisionMaxExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 52

                                                            strF1 = "CHARTYPE = 'Precision' AND BOOLINTER = " & False & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL <> 1"
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single
                                                                numMax = -999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)
                                                            End If

                                                        Case 15
                                                            strA = "IntraRunAccuracyMinExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 53

                                                            strF1 = "CHARTYPE = 'Accuracy' AND BOOLINTER = " & False & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL <> 1"
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMin As Single
                                                                numMin = 999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMin Then
                                                                            numMin = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMin, strQCDec)
                                                            End If

                                                        Case 16
                                                            strA = "IntraRunAccuracyMaxExcludeLLOQForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 54

                                                            strF1 = "CHARTYPE = 'Accuracy' AND BOOLINTER = " & False & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL <> 1"
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim tblIntraN As System.Data.DataTable = dvIntraN.ToTable("din1", True, "NUMVALUE")
                                                            If tblIntraN.Rows.Count = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single
                                                                numMax = -999999999
                                                                For Count5 = 0 To tblIntraN.Rows.Count - 1
                                                                    var1 = tblIntraN.Rows(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)
                                                            End If

                                                        Case 17

                                                            'strA = "SummaryIntraRun[n]ForAnalyte_" & Count1 + 1 & "_Table_"
                                                            strA = "SummaryIntraRun[n]ForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 43

                                                            strF1 = "CHARTYPE = 'IntraRunN' AND BOOLINTER = " & False & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim dvIntraN As System.Data.DataView = New DataView(tbl1, strF1, "CHARFCID ASC", DataViewRowState.CurrentRows)
                                                            Dim rowsAA() As DataRow = tbl1.Select(strF1, "", DataViewRowState.CurrentRows)
                                                            If rowsAA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single = 0
                                                                For Count5 = 0 To rowsAA.Length - 1
                                                                    var1 = rowsAA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        numMax = numMax + var1
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, "0")
                                                            End If

                                                        Case 18

                                                            'strA = "SummaryIntraRun[n]ForAnalyte_" & Count1 + 1 & "_Table_"
                                                            strA = "SummaryInterRun[n]ForAnalyte_" & Count1 + 1 & "_Table_"
                                                            ctDo = 56

                                                            strF1 = "CHARTYPE = 'n' AND BOOLINTER = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsAA() As DataRow = tbl1.Select(strF1, "", DataViewRowState.CurrentRows)
                                                            If rowsAA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                Dim numMax As Single = 0
                                                                For Count5 = 0 To rowsAA.Length - 1
                                                                    var1 = rowsAA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        numMax = numMax + var1
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, "0")
                                                            End If

                                                    End Select

                                                    If StrComp(str1, "[NA]", CompareMethod.Text) = 0 Then
                                                        'make red font
                                                        wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        wd.Selection.TypeText(Text:=str1)
                                                        wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                    Else
                                                        str2 = Replace(CStr(str1), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                        wd.Selection.Text = str2
                                                    End If

                                                Else
                                                    boolQuit = True
                                                End If
                                            End With

                                        Loop
                                    End If
                                End If
                            Next



                        Catch ex As Exception
                            MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                        End Try

                        intIc = intIc + 1
                        If intIc > intIcMax Then

                            strM = "...Searching for table-specific QC-related field codes...."
                            frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                            frmH.Refresh()

                            intIc = 0
                        End If

                    Next Count4

nextCount2a:

                Next Count2

                'ctDo = 15

                'now do TBLQCTABLES
                tblQCTables.AcceptChanges()
                Dim tbl1a = tblQCTables
                'tbl2 = tblAnalytesHome
                Dim tbl3 As System.Data.DataTable = tblReportTable
                Dim tbl4 As System.Data.DataTable = tblTableProperties
                Dim rowsTR() As DataRow

                dv = New DataView(tbl1a)
                Dim dvR As System.Data.DataView
                Try
                    dvR = New DataView(tbl3, "BOOLINCLUDE = -1", "INTORDER ASC", DataViewRowState.CurrentRows)
                Catch ex As Exception
                    var1 = ex.Message
                    dvR = New DataView(tbl3)
                End Try

                Dim boolDo As Boolean

                tblFCID = dv.ToTable("a1", True, "CHARFCID") 'this will return values only if table has samples assigned
                'tblFCID = dvR.ToTable("a1", True, "CHARFCID")'this will return values for all inlcuded tables in tblReportTable
                intFCID = tblFCID.Rows.Count

                str1 = tbl2.Rows(Count1).Item("IsIntStd")
                If StrComp(str1, "Yes", CompareMethod.Text) = 0 Then
                    boolIsIS = True
                Else
                    boolIsIS = False
                End If

                '****

                Dim dvAA As System.Data.DataView
                Dim var8
                Dim varReplace
                Dim boolNum As Boolean = False
                Dim int2 As Short

                For Count2 = 1 To 20
                    boolNum = False

                    Try

                        Select Case Count2
                            Case 1
                                strA = "LLOQForAnalyte_"

                            Case 2
                                strA = "ULOQForAnalyte_"

                            Case 3
                                strA = "CALIBRATIONLEVELSForAnalyte_"

                            Case 4
                                strA = "CALIBRSTANDARDLISTForAnalyte_"

                            Case 5
                                strA = "LLOQUnitsForAnalyte_"

                            Case 6
                                strA = "ULOQUnitsForAnalyte_"

                            Case 7
                                strA = "MINIMUMR2ForAnalyte_"

                            Case 8
                                strA = "WEIGHTINGForAnalyte_"

                            Case 9
                                strA = "QCLEVELSForAnalyte_"

                            Case 10
                                strA = "QCLEVELSVerboseForAnalyte_"

                            Case 11
                                strA = "CALIBRATIONLEVELSVerboseForAnalyte_"

                            Case 12
                                strA = "REGRESSIONForAnalyte_"

                            Case 13
                                strA = "INTEGRATIONTYPEForAnalyte_"

                            Case 14
                                strA = "REGRESSIONLSQForAnalyte_"

                            Case 15
                                strA = "UC_REGRESSIONForAnalyte_"

                            Case 16
                                strA = "LC_REGRESSIONForAnalyte_"

                            Case 17
                                strA = "UC_REGRESSIONLSQForAnalyte_"

                            Case 18
                                strA = "LC_REGRESSIONLSQForAnalyte_"

                                '20190220 LEE:
                            Case 19
                                strA = "CALIBRSTANDARDCOLUMNForAnalyte_"
                            Case 20
                                strA = "QCSTANDARDCOLUMNForAnalyte_"

                        End Select

                        strFind = "[" & strA & Count1 + 1 & "]"

                        boolQuit = False

                        If boolIsIS Then
                        Else

                            Do Until boolQuit

                                .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                                wrdSel = wd.Selection

                                varReplace = "NA"

                                With wrdSel.Find
                                    .ClearFormatting()
                                    .MatchWholeWord = True
                                    .Forward = True
                                    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                                    .Execute(FindText:=strFind)
                                    If .Found Then

                                        Select Case Count2
                                            Case 1
                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("LLOQ", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    num1 = var8 'dv.Item(int1).Item(1)
                                                    num1 = SigFigOrDecString(CDec(num1), LSigFig, False)
                                                    boolNum = True
                                                    varReplace = DisplayNum(var8, LSigFig, False)
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If
                                            Case 2
                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("ULOQ", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    num1 = var8 'dv.Item(int1).Item(1)
                                                    num1 = SigFigOrDecString(CDec(num1), LSigFig, False)
                                                    boolNum = True
                                                    varReplace = DisplayNum(var8, LSigFig, False)
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If

                                            Case 3 'calibration levels
                                                'dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                'int1 = FindRowDV("Calibration Levels", dvAA)
                                                'var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                'If IsDBNull(var8) Then
                                                '    varReplace = "[NA]"
                                                'ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                '    varReplace = "[NA]"
                                                'Else
                                                '    varReplace = var8
                                                'End If

                                                '20181129 LEE:
                                                'Redo previous. Use tblCalStdGroupsAcc
                                                Dim strF4 As String = "INTGROUP = " & intGroup
                                                Dim rows1() As DataRow = tblCalStdGroupsAcc.Select(strF4)
                                                If rows1.Length = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = rows1.Length
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", NBHReal, 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If

                                            Case 4 'Calibr list

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("ULOQ Units", dvAA)
                                                var4 = dvAA.Item(int1).Item(Count1 + 1)

                                                int1 = FindRowDV("Alternate Calibr/QC Std Units", frmH.dgvStudyConfig.DataSource)
                                                str1 = NZ(frmH.dgvStudyConfig(1, int1).Value, "")

                                                If Len(str1) = 0 Or StrComp(str1, "[None]", CompareMethod.Text) = 0 Then
                                                Else
                                                    var4 = str1
                                                End If

                                                If IsDBNull(var4) Then
                                                    var4 = "[NA]"
                                                ElseIf Len(var4) = 0 Or StrComp(NZ(var4, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    var4 = "[NA]"
                                                Else
                                                    var4 = var4
                                                End If

                                                var1 = arrAnalytes(1, Count1 + 1)
                                                var2 = ReturnCalibrStds(CStr(var1), intGroup, False)
                                                str1 = var2 & fNBSP() & var4 ' & " for " & var1
                                                varReplace = str1

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", NBHReal, 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If

                                            Case 5

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("LLOQ Units", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)

                                                int2 = FindRowDV("Alternate Calibr/QC Std Units", frmH.dgvStudyConfig.DataSource)
                                                str1 = NZ(frmH.dgvStudyConfig(1, int2).Value, "")

                                                If Len(str1) = 0 Or StrComp(str1, "[None]", CompareMethod.Text) = 0 Then
                                                Else
                                                    var8 = str1
                                                End If

                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If
                                                str1 = varReplace
                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If
                                            Case 6
                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("ULOQ Units", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)

                                                int2 = FindRowDV("Alternate Calibr/QC Std Units", frmH.dgvStudyConfig.DataSource)
                                                str1 = NZ(frmH.dgvStudyConfig(1, int2).Value, "")

                                                If Len(str1) = 0 Or StrComp(str1, "[None]", CompareMethod.Text) = 0 Then
                                                Else
                                                    var8 = str1
                                                End If

                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If

                                            Case 7 'Minimum R2  [MINIMUMR2ForAnalyte_
                                                'dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                'int1 = FindRowDV("Minimum r^2", dvAA)
                                                'var8 = dvAA.Item(int1).Item(Count1 + 1)

                                                '20170927 LEE: Also need to have SAMPLETYPEID (Matrix) in this filter
                                                'strFFF = GetARSRuns(tblRID, intAnalyteID, strMatrix)
                                                '20181128 LEE:
                                                'This should come from tblCalStdGroupAssayIDsAll
                                                strFFF = GetASSAYIDFilter(intGroup, True, True)
                                                If Len(strFFF) = 0 Then
                                                    str1 = "ANALYTEID = " & intAnalyteID & " AND SAMPLETYPEID = '" & strMatrix & "'"
                                                Else
                                                    str1 = "ANALYTEID = " & intAnalyteID & " AND SAMPLETYPEID = '" & strMatrix & "' AND (" & strFFF & ")"
                                                End If

                                                'Dim rows1() = tblRegCon.Select("ANALYTEID = " & intAnalyteID, "RSQUARED ASC")
                                                Dim rows1() = tblRegCon.Select(str1, "RSQUARED ASC")
                                                If rows1.Length = 0 Then
                                                    var8 = "[None]"
                                                Else
                                                    var8 = rows1(0).item("RSQUARED") ' Format(GetMin(arrRegCon, Count2), str1)
                                                End If

                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else

                                                    var1 = SigFigOrDecString(var8, LR2SigFigs, False)
                                                    str1 = GetRegrDecStr(LR2SigFigs)
                                                    var3 = Format(CDbl(var1), str1)
                                                    varReplace = var3

                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If

                                            Case 8 'Weighting
                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("WEIGHTING", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If

                                            Case 9 'QC levels

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("# of QC Levels", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If

                                            Case 10 'QC levels verbose

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("# of QC Levels", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str1 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    str2 = VerboseNumber(CInt(str1), False)
                                                    wd.Selection.Text = str2
                                                End If


                                            Case 11 'calibration levels verbose

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("Calibration Levels", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str1 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    str2 = VerboseNumber(CInt(str1), False)
                                                    wd.Selection.Text = str2
                                                End If

                                            Case 12 'Regression type

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("REGRESSION", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str1 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str1
                                                End If


                                            Case 13 ''INTEGRATIONTYPEForAnalyte_

                                                'get from tblRegCon
                                                strF = "STUDYID = " & wStudyID & " AND ANALYTEID = " & intAnalyteID
                                                Dim rowsRC() As DataRow = tblRegCon.Select(strF)
                                                varReplace = "[NA]"
                                                If rowsRC.Length = 0 Then
                                                Else
                                                    var1 = NZ(rowsRC(0).Item("HEIGHTORAREA"), "")
                                                    Dim intRC As Int16 = 0
                                                    Do Until Len(var1) <> 0
                                                        intRC = intRC + 1
                                                        If intRC > rowsRC.Length - 1 Then
                                                            Exit Do
                                                        End If
                                                        var1 = NZ(rowsRC(intRC).Item("HEIGHTORAREA"), "")
                                                    Loop
                                                    If Len(var1) = 0 Then
                                                        var8 = "peak area"
                                                    Else
                                                        If IsNumeric(var1) Then
                                                            If var1 = 0 Then
                                                                var8 = "peak area"
                                                            Else
                                                                var8 = "peak height"
                                                            End If
                                                        Else
                                                            var8 = "peak area"
                                                        End If
                                                    End If

                                                End If

                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str1 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str1
                                                End If

                                            Case 14 'Regression type with least squares verbiage

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("REGRESSION", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    If StrComp(var8, "Linear", CompareMethod.Text) = 0 Then
                                                        var8 = "least-squares " & var8
                                                    End If
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str1 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str1
                                                End If




                                                '*****

                                            Case 15
                                                'strA = "UC_REGRESSIONForAnalyte_"

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("REGRESSION", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str1 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    'make lower case
                                                    str1 = CapitAllWords(str1)
                                                    wd.Selection.Text = str1
                                                End If

                                            Case 16
                                                'strA = "LC_REGRESSIONForAnalyte_"

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("REGRESSION", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str1 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    'make lower case
                                                    str1 = LCase(str1)
                                                    wd.Selection.Text = str1
                                                End If

                                            Case 17
                                                'strA = "UC_REGRESSIONLSQForAnalyte_"

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("REGRESSION", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    If StrComp(var8, "Linear", CompareMethod.Text) = 0 Then
                                                        var8 = "least-squares " & var8
                                                    End If
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str1 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    'make lower case
                                                    str1 = CapitAllWords(str1)
                                                    wd.Selection.Text = str1
                                                End If

                                            Case 18
                                                'strA = "LC_REGRESSIONLSQForAnalyte_"

                                                dvAA = frmH.dgvWatsonAnalRef.DataSource
                                                int1 = FindRowDV("REGRESSION", dvAA)
                                                var8 = dvAA.Item(int1).Item(Count1 + 1)
                                                If IsDBNull(var8) Then
                                                    varReplace = "[NA]"
                                                ElseIf Len(var8) = 0 Or StrComp(NZ(var8, "[None]"), "[None]", CompareMethod.Text) = 0 Then
                                                    varReplace = "[NA]"
                                                Else
                                                    If StrComp(var8, "Linear", CompareMethod.Text) = 0 Then
                                                        var8 = "least-squares " & var8
                                                    End If
                                                    varReplace = var8
                                                End If

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str1 = Replace(CStr(varReplace), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                    'make lower case
                                                    str1 = LCase(str1)
                                                    wd.Selection.Text = str1
                                                End If

                                                '*****


                                                '20190220 LEE:
                                            Case 19 'Calibr list column   CALIBRSTANDARDCOLUMNForAnalyte_

                                                var1 = arrAnalytes(1, Count1 + 1)
                                                var2 = ReturnCalibrStds(CStr(var1), intGroup, True)
                                                str1 = var2  ' & " for " & var1

                                                intGroup = arrAnalytes(15, Count1 + 1)
                                                Dim rows4() As DataRow = TBLSTUDYDOCANALYTES.Select("INTGROUP = " & intGroup & " AND ID_TBLSTUDIES = " & id_tblStudies)
                                                If rows4.Length = 0 Then
                                                Else
                                                    var1 = rows4(0).Item("CHARUSERANALYTE")
                                                End If
                                                '20190303 LEE:
                                                'Field code already defines analyte
                                                'remove intAH1 logic
                                                'If intAH1 = 1 Then
                                                '    str1 = var2
                                                'Else
                                                '    str1 = var1 & ":" & ChrW(11) & var2
                                                'End If
                                                str1 = var2

                                                varReplace = str1

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", NBHReal, 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If

                                            Case 20 'QC list column   QCSTANDARDCOLUMNForAnalyte_

                                                var1 = arrAnalytes(1, Count1 + 1)
                                                var2 = ReturnQCStds(CStr(var1), True)
                                                intGroup = arrAnalytes(15, Count1 + 1)
                                                Dim rows4() As DataRow = TBLSTUDYDOCANALYTES.Select("INTGROUP = " & intGroup & " AND ID_TBLSTUDIES = " & id_tblStudies)
                                                If rows4.Length = 0 Then
                                                Else
                                                    var1 = rows4(0).Item("CHARUSERANALYTE")
                                                End If
                                                '20190303 LEE:
                                                'Field code already defines analyte
                                                'remove intAH1 logic
                                                'If intAH1 = 1 Then
                                                '    str1 = var2
                                                'Else
                                                '    str1 = var1 & ":" & ChrW(11) & var2
                                                'End If
                                                str1 = var2

                                                varReplace = str1

                                                If StrComp(varReplace, "[NA]", CompareMethod.Text) = 0 Then
                                                    'make red font
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                    wd.Selection.TypeText(Text:=varReplace)
                                                    wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                Else
                                                    str2 = Replace(CStr(varReplace), "-", NBHReal, 1, -1, CompareMethod.Text)
                                                    wd.Selection.Text = str2
                                                End If


                                        End Select

                                    Else

                                        boolQuit = True

                                    End If

                                End With

                            Loop

                        End If
                    Catch ex As Exception
                        MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                    End Try

                    intIc = intIc + 1
                    If intIc > intIcMax Then

                        strM = "...Searching for table-specific QC-related field codes...."
                        frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                        frmH.Refresh()

                        intIc = 0
                    End If

                Next Count2

                '****

                Dim boolDoIS As Boolean

                For Count2 = 0 To intFCID - 1

                    'the following gives QC Levels
                    strFCID = NZ(tblFCID.Rows(Count2).Item("CHARFCID"), "LABIntegrityAAA")
                    strF = "CHARFCID = '" & strFCID & "'"

                    str1 = Mid(strFCID, 1, 2)
                    If StrComp(str1, "PH", CompareMethod.Text) = 0 Then
                        strFCID = "LABIntegrityAAA"
                    End If
                    If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                        GoTo nextCount2b
                    End If

                    Dim dvNNN As System.Data.DataView = New DataView(tbl1a, strF, "ID_TBLQCTABLES ASC", DataViewRowState.CurrentRows)
                    Dim tblFCID1 As System.Data.DataTable = dvNNN.ToTable("a2", True, "NUMNOMCONC")
                    Dim intFCID1 As Short = tblFCID1.Rows.Count

                    'the following gives number of analytical runs
                    strF1 = "CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                    Dim dv2 As System.Data.DataView = New DataView(tbl1a, strF1, "NUMRUNID ASC", DataViewRowState.CurrentRows)
                    var1 = dv2.Count
                    Dim tblFCID2 As System.Data.DataTable = dv2.ToTable("b1", True, "NUMRUNID")
                    Dim intFCID2 As Short = tblFCID2.Rows.Count
                    Dim strC As String
                    Dim boolIsLinear As Boolean = True

                    'For Count3 = 0 To dvNNN.Count - 1

                    ''wdd.visible = True

                    If dv2.Count > 0 Then
                        idCR = dv2(0).Item("ID_TBLCONFIGREPORTTABLES")
                        idT = dv2(0).Item("ID_TBLREPORTTABLE")
                    End If

                    strF = "ID_TBLREPORTTABLE = " & idT
                    Erase rowsTR
                    rowsTR = tbl4.Select(strF)

                    ctDo = 15
                    For Count4 = 1 To 30
                        boolDo = True
                        boolDoIS = False

                        Try
                            Select Case Count4

                                Case 1

                                    ctDo = 50
                                    strA = "(n)ForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 22, 31, 32
                                            boolDoIS = True
                                            'Case 1, 2, 5, 6, 7
                                        Case 1, 2, 5, 6, 7, 30, 11 'don't do 11 because uses tblAnova
                                            boolDo = False
                                    End Select

                                Case 2
                                    ctDo = 17
                                    strA = "PrecisionMinForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 3, 4, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 3
                                    ctDo = 18
                                    strA = "PrecisionMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 3, 4, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 4
                                    ctDo = 19
                                    strA = "AccuracyMinForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 5
                                    ctDo = 20
                                    strA = "AccuracyMaxForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case Else
                                            boolDo = False
                                    End Select
                                    'debug
                                    If StrComp(strFCID, "MEQCLOTS", CompareMethod.Text) = 0 Then
                                        var1 = var1
                                    End If
                                Case 6

                                    ctDo = 21
                                    strA = "AverageRecoveryPrecisionForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 13, 14, 15
                                            boolDoIS = True
                                            If boolIsIS Then
                                                'modify strA
                                                int1 = FindAnalyteFromIntStdDtbl(intRowsAnal, tbl2, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "AverageRecoveryPrecisionForAnalyte_" & int1 + 1 & "_Table_"
                                                End If

                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select
                                    'depricated
                                    '20161002 LEE: Why?
                                    'boolDo = False
                                Case 7
                                    'depricated
                                    ctDo = 22
                                    strA = "AverageRecoveryAccuracyForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 13, 14, 15
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStdDtbl(intRowsAnal, tbl2, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "AverageRecoveryAccuracyForAnalyte_" & int1 + 1 & "_Table_"
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select
                                    'depricated, Recovery doesn't have accuracy
                                    boolDo = False
                                Case 8

                                    ctDo = 23
                                    strA = "AverageRecoveryForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 13, 14, 15
                                            boolDoIS = True

                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStdDtbl(intRowsAnal, tbl2, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "AverageRecoveryForAnalyte_" & int1 + 1 & "_Table_"
                                                End If
                                            End If

                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 9
                                    ctDo = 24
                                    strA = "DilutionFactorForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 12, 31 '20190228 LEE: Diln table can now be Ad Hoc Stability - 31
                                            If idCR = 12 Then
                                            Else
                                                Dim boolStatsNR As Short = GetStatsNR(idT)
                                                If boolStatsNR = 12 Then
                                                    boolDo = boolDo
                                                Else
                                                    boolDo = False
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select
                                Case 10
                                    ctDo = 25
                                    strA = "MeanSlopeForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 2
                                        Case Else
                                            boolDo = False
                                    End Select
                                Case 11
                                    ctDo = 26
                                    strA = "MeanYIntForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 2
                                        Case Else
                                            boolDo = False
                                    End Select
                                Case 12
                                    ctDo = 27
                                    strA = "MeanR2ForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 2
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 13
                                    ctDo = 24
                                    strA = "DilutionConcentrationForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 12, 31 '20190228 LEE: Diln table can also be Ad Hoc Stability, 
                                            If idCR = 12 Then
                                            Else
                                                Dim boolStatsNR As Short = GetStatsNR(idT)
                                                If boolStatsNR = 12 Then
                                                    boolDo = boolDo
                                                Else
                                                    boolDo = False
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select


                                Case 14
                                    ctDo = 58
                                    strA = "AccuracyMinIndForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 15
                                    ctDo = 59
                                    strA = "AccuracyMaxIndForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 3, 4, 12, 17, 18, 19, 21, 22, 23, 29, 31, 32
                                        Case Else
                                            boolDo = False
                                    End Select



                                Case 16
                                    ctDo = 60
                                    strA = "AccuracyMinLotForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 17
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 17
                                    ctDo = 61
                                    strA = "AccuracyMaxLotForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 17
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 18
                                    ctDo = 62
                                    strA = "PrecisionMinLotForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 17
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 19
                                    ctDo = 63
                                    strA = "PrecisionMaxLotForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 17
                                        Case Else
                                            boolDo = False
                                    End Select


                                Case 20 '20161020 LEE: Added
                                    ctDo = 65
                                    strA = "AverageISNMFForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 15
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 21 '20161020 LEE: Added
                                    ctDo = 66
                                    strA = "AverageSDISNMFForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 15
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 22 '20161020 LEE: Added
                                    ctDo = 67
                                    strA = "AveragePrecisionISNMFForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 15
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 23 '20161020 LEE: Added
                                    ctDo = 68
                                    strA = "AveragenISNMFForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 15
                                        Case Else
                                            boolDo = False
                                    End Select


                                Case 24 '20161021 LEE: Added
                                    ctDo = 85
                                    strA = "RecoveryMinPrecisionQCForAnalyte_" & Count1 + 1 & "_Table_"
                                    boolDoIS = False
                                    Select Case idCR
                                        Case 13, 14
                                            boolDo = True
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rowsAnal, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryMinPrecisionQCForAnalyte_" & int1 + 1 & "_Table_"
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 25
                                    ctDo = 88
                                    strA = "RecoveryMinPrecisionRSForAnalyte_" & Count1 + 1 & "_Table_"
                                    boolDoIS = False
                                    Select Case idCR
                                        Case 13, 15
                                            boolDo = True
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rowsAnal, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryMinPrecisionRSForAnalyte_" & int1 + 1 & "_Table_"
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 26
                                    ctDo = 91
                                    strA = "RecoveryMinPrecisionPESForAnalyte_" & Count1 + 1 & "_Table_"
                                    boolDoIS = False
                                    Select Case idCR
                                        Case 14, 15
                                            boolDo = True
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rowsAnal, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryMinPrecisionPESForAnalyte_" & int1 + 1 & "_Table_"
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 27 '20161021 LEE: Added
                                    ctDo = 86
                                    strA = "RecoveryMaxPrecisionQCForAnalyte_" & Count1 + 1 & "_Table_"
                                    boolDoIS = False
                                    Select Case idCR
                                        Case 13, 14
                                            boolDo = True
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rowsAnal, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryMaxPrecisionQCForAnalyte_" & int1 + 1 & "_Table_"
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 28
                                    ctDo = 89
                                    strA = "RecoveryMaxPrecisionRSForAnalyte_" & Count1 + 1 & "_Table_"
                                    boolDoIS = False
                                    Select Case idCR
                                        Case 13, 15
                                            boolDo = True
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rowsAnal, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryMaxPrecisionRSForAnalyte_" & int1 + 1 & "_Table_"
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select

                                Case 29
                                    ctDo = 92
                                    strA = "RecoveryMaxPrecisionPESForAnalyte_" & Count1 + 1 & "_Table_"
                                    boolDoIS = False
                                    Select Case idCR
                                        Case 14, 15
                                            boolDo = True
                                            boolDoIS = True
                                            If boolIsIS Then
                                                int1 = FindAnalyteFromIntStd(intRowsAnal, rowsAnal, strAnalyte)
                                                If int1 = -1 Then
                                                Else
                                                    strA = "RecoveryMaxPrecisionPESForAnalyte_" & int1 + 1 & "_Table_"
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select


                                    '20190228 LEE
                                Case 30
                                    ctDo = 93
                                    strA = "DilutionReplicateNumberForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 12, 31 '20190228 LEE: Diln table can also be Ad Hoc Stability, 
                                            If idCR = 12 Then
                                            Else
                                                Dim boolStatsNR As Short = GetStatsNR(idT)
                                                If boolStatsNR = 12 Then
                                                Else
                                                    boolDo = False
                                                End If
                                            End If
                                        Case Else
                                            boolDo = False
                                    End Select

                            End Select

                            'ctDo = ctDo + 1
                            If boolDoCt(ctDo) And boolDo Then

                                ''wdd.visible = True
                                Dim numRunID As Short

                                Dim TotVal As Single

                                'If Count4 = 9 Then
                                '    strFind = "[" & strA & "]"
                                'Else
                                '    strFind = "[" & strA & strFCID & "]"
                                'End If
                                strFind = "[" & strA & strFCID & "]"

                                If boolIsIS Then
                                    strFind = "[IS_" & strA & strFCID & "]"
                                    If boolDoIS Then
                                        Try
                                            Call ExecuteA(intGroup, idT, strAnalyteUser, wd, strFind, Count1, Count2, Count4, strFCID, tbl1a, idCR, intAnalyteID, intAnalyteIndex, intMasterAssayID, strAnalyteO)

                                        Catch ex As Exception
                                            var1 = ex.Message
                                        End Try
                                    End If
                                Else
                                    Try
                                        Call ExecuteA(intGroup, idT, strAnalyteUser, wd, strFind, Count1, Count2, Count4, strFCID, tbl1a, idCR, intAnalyteID, intAnalyteIndex, intMasterAssayID, strAnalyteO)

                                    Catch ex As Exception
                                        var1 = ex.Message
                                    End Try
                                End If

                            End If
                        Catch ex As Exception
                            MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                        End Try

                        intIc = intIc + 1
                        If intIc > intIcMax Then

                            strM = "...Searching for table-specific QC-related field codes...."
                            frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                            frmH.Refresh()

                            intIc = 0
                        End If

                    Next Count4

                    '******


                    Select Case idCR
                        Case 29, 32
                            'boolDoIS = True

                            For Count5 = 0 To intFCID2 - 1
                                Dim numRunID As Short
                                numRunID = tblFCID2.Rows(Count5).Item("NUMRUNID")

                                boolDo = True

                                For Count4 = 1 To 2

                                    Try

                                        Select Case Count4
                                            Case 1
                                                'do Precision
                                                ctDo = 58
                                                strA = "AccuracyMinIndForAnalyte_" & Count1 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"

                                            Case 2
                                                'do Accuracy
                                                ctDo = 59
                                                strA = "AccuracyMaxIndForAnalyte_" & Count1 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"

                                        End Select

                                        'ctDo = ctDo + 1
                                        If boolDoCt(ctDo) Then

                                            strFind = "[" & strA & strFCID & "]"

                                            boolQuit = False
                                            Do Until boolQuit

                                                .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                                                wrdSel = wd.Selection

                                                With wrdSel.Find
                                                    .ClearFormatting()
                                                    .MatchWholeWord = True
                                                    .Forward = True
                                                    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                                                    .Execute(FindText:=strFind)
                                                    If .Found Then
                                                        'get value from tblAnovaTables
                                                        Select Case Count4
                                                            'herehere
                                                            Case 1
                                                                'do Accuracy Min
                                                                strF1 = "NUMRUNID = " & numRunID & " AND CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else

                                                                    v1 = rowsA(0).Item("NUMCRIT1")
                                                                    v2 = rowsA(0).Item("NUMCRIT2")
                                                                    strF2 = strF1 & " AND (NUMVALUE >= " & -v1 & " AND NUMVALUE <= " & v2 & ")"
                                                                    Dim rowsB() As DataRow = tbl1a.Select(strF2)

                                                                    Dim numMin As Single = 9999999
                                                                    For Count6 = 0 To rowsB.Length - 1
                                                                        var1 = NZ(rowsB(Count6).Item("NUMVALUE"), "NA")
                                                                        If IsNumeric(var1) Then
                                                                            If var1 < numMin Then
                                                                                numMin = var1
                                                                            End If
                                                                        End If
                                                                    Next
                                                                    If numMin = 9999999 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        str1 = Format(numMin, strQCDec)
                                                                    End If

                                                                    str1 = Replace(str1, "-", ChrW(173), 1, -1, CompareMethod.Text)

                                                                End If
                                                            Case 2
                                                                'do Accuracy Max
                                                                strF1 = "NUMRUNID = " & numRunID & " AND CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else

                                                                    v1 = rowsA(0).Item("NUMCRIT1")
                                                                    v2 = rowsA(0).Item("NUMCRIT2")
                                                                    strF2 = strF1 & " AND (NUMVALUE >= " & -v1 & " AND NUMVALUE <= " & v2 & ")"
                                                                    Dim rowsB() As DataRow = tbl1a.Select(strF2)

                                                                    Dim numMax As Single = -9999999
                                                                    For Count6 = 0 To rowsB.Length - 1
                                                                        var1 = NZ(rowsB(Count6).Item("NUMVALUE"), "NA")
                                                                        If IsNumeric(var1) Then
                                                                            If var1 > numMax Then
                                                                                numMax = var1
                                                                            End If
                                                                            str1 = Format(var1, strQCDec) ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                                        End If
                                                                    Next
                                                                    If numMax = -9999999 Then
                                                                        str1 = "[NA]"
                                                                    Else
                                                                        str1 = Format(numMax, strQCDec)
                                                                    End If

                                                                    str1 = Replace(str1, "-", ChrW(173), 1, -1, CompareMethod.Text)

                                                                End If

                                                        End Select
                                                        If StrComp(str1, "[NA]", CompareMethod.Text) = 0 Then
                                                            'make red font
                                                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                            wd.Selection.TypeText(Text:=str1)
                                                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                        Else
                                                            str2 = Replace(CStr(str1), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                            wd.Selection.Text = str2
                                                        End If

                                                    Else
                                                        boolQuit = True
                                                    End If

                                                End With

                                            Loop

                                        End If
                                    Catch ex As Exception
                                        MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                                    End Try

                                    intIc = intIc + 1
                                    If intIc > intIcMax Then

                                        strM = "...Searching for table-specific QC-related field codes...."
                                        frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                                        frmH.Refresh()

                                        intIc = 0
                                    End If

                                Next Count4

                            Next Count5

                        Case Else
                            boolDo = False
                    End Select



                    For Count3 = 0 To intFCID1 - 1

                        For Count5 = 0 To intFCID2 - 1
                            Dim numRunID As Short
                            numRunID = tblFCID2.Rows(Count5).Item("NUMRUNID")

                            boolDo = True

                            For Count4 = 1 To 3

                                Try

                                    Select Case Count4
                                        Case 1
                                            ctDo = 29
                                            strA = "PrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                            Select Case idCR
                                                Case 22, 23, 29, 32
                                                Case Else
                                                    boolDo = False
                                            End Select
                                        Case 2
                                            ctDo = 30
                                            strA = "AccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                            Select Case idCR
                                                Case 22, 23, 29, 32
                                                Case Else
                                                    boolDo = False
                                            End Select
                                        Case 3
                                            ctDo = 50
                                            strA = "(n)ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count3 + 1 & "_RunNumber_" & Count5 + 1 & "_Table_"
                                            Select Case idCR
                                                Case 22, 23, 29, 32
                                                    boolDo = True
                                                Case Else
                                                    boolDo = False
                                            End Select

                                    End Select

                                    'ctDo = ctDo + 1
                                    If boolDoCt(ctDo) And boolDo Then

                                        strFind = "[" & strA & strFCID & "]"

                                        boolQuit = False
                                        Do Until boolQuit

                                            .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                                            wrdSel = wd.Selection

                                            With wrdSel.Find
                                                .ClearFormatting()
                                                .MatchWholeWord = True
                                                .Forward = True
                                                .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                                                .Execute(FindText:=strFind)
                                                If .Found Then
                                                    'get value from tblAnovaTables
                                                    Select Case Count4
                                                        'herehere
                                                        Case 1
                                                            'do Precision
                                                            'strF1 = "NUMRUNID = " & numRunID & " AND CHARTYPE = 'Precision' AND BOOLINTRA = " & True & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                            strF1 = "NUMRUNID = " & numRunID & " AND CHARTYPE = 'Precision' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1

                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                If IsNumeric(var1) Then
                                                                    str1 = Format(var1, strQCDec) ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                                Else
                                                                    str1 = "[NA]"
                                                                End If
                                                            End If
                                                        Case 2
                                                            'do Accuracy
                                                            strF1 = "NUMRUNID = " & numRunID & " AND CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                If IsNumeric(var1) Then
                                                                    str1 = Format(var1, strQCDec) ' CStr(SigFigOrDecString(var1, LSigFig, True))

                                                                Else
                                                                    str1 = "[NA]"
                                                                End If
                                                            End If
                                                        Case 3
                                                            'do n
                                                            strF1 = "NUMRUNID = " & numRunID & " AND CHARTYPE = 'n' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND NUMQCLEVEL = " & Count3 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = NZ(rowsA(0).Item("NUMVALUE"), "NA")
                                                                If IsNumeric(var1) Then
                                                                    str1 = Format(var1, "0") ' CStr(SigFigOrDecString(var1, LSigFig, True))
                                                                Else
                                                                    str1 = "[NA]"
                                                                End If
                                                            End If
                                                    End Select
                                                    If StrComp(str1, "[NA]", CompareMethod.Text) = 0 Then
                                                        'make red font
                                                        wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        wd.Selection.TypeText(Text:=str1)
                                                        wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                    Else
                                                        str2 = Replace(CStr(str1), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                        wd.Selection.Text = str2
                                                    End If

                                                Else
                                                    boolQuit = True
                                                End If

                                            End With

                                        Loop

                                    End If

                                Catch ex As Exception
                                    MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                                End Try

                                intIc = intIc + 1
                                If intIc > intIcMax Then

                                    strM = "...Searching for table-specific QC-related field codes...."
                                    frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                                    frmH.Refresh()

                                    intIc = 0
                                End If

                            Next Count4
                        Next Count5
                    Next Count3

                    '******

                    For Count6 = 0 To intFCID1 - 1 'counting qc levels

                        ctDo = 24
                        For Count4 = 1 To 26
                            boolDo = True

                            Try
                                Select Case Count4
                                    Case 1
                                        ctDo = 28
                                        strA = "NomConcForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                    Case 2
                                        ctDo = 29
                                        strA = "PrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 22, 23, 29, 32
                                                boolDo = False
                                            Case Else
                                                boolDo = True
                                        End Select
                                    Case 3
                                        ctDo = 30
                                        strA = "AccuracyForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 22, 23, 29, 32
                                                boolDo = False
                                            Case Else
                                                boolDo = True
                                        End Select
                                    Case 4
                                        ctDo = 31
                                        strA = "RecoveryForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 13, 14, 15
                                                boolDo = True
                                                boolDoIS = True

                                                If boolIsIS Then
                                                    int1 = FindAnalyteFromIntStdDtbl(intRowsAnal, tbl2, strAnalyte)
                                                    If int1 = -1 Then
                                                    Else
                                                        strA = "RecoveryForAnalyte_" & int1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                                    End If
                                                End If

                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 5
                                        ctDo = 16
                                        strA = "DiffValueForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        Select Case idCR
                                            Case 29, 23
                                            Case 22, 32
                                                boolDoIS = True
                                            Case Else
                                                boolDo = False
                                        End Select
                                    Case 6
                                        ctDo = 50
                                        strA = "(n)ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        If StrComp(strFCID, "QCINTER", CompareMethod.Text) = 0 Then
                                            var1 = var1
                                        End If

                                        Select Case idCR
                                            Case 1, 2, 3, 5, 6, 7
                                                boolDo = False
                                            Case Else
                                                boolDo = True

                                        End Select
                                    Case 7
                                        ctDo = 55
                                        strA = "MeanForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 22, 23, 29, 32
                                                boolDo = False
                                            Case Else
                                                boolDo = True
                                        End Select

                                    Case 8
                                        ctDo = 57
                                        strA = "RecoveryPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 13, 14, 15
                                                boolDo = True
                                                boolDoIS = True
                                                If boolIsIS Then
                                                    int1 = FindAnalyteFromIntStdDtbl(intRowsAnal, tbl2, strAnalyte)
                                                    If int1 = -1 Then
                                                    Else
                                                        strA = "RecoveryPrecisionForAnalyte_" & int1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                                    End If
                                                End If
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 9 '20161019 LEE: Added
                                        ctDo = 69
                                        strA = "MatrixFactorOfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 10 '20161019 LEE: Added
                                        ctDo = 70
                                        strA = "MatrixFactorOfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 11 '20161019 LEE: Added
                                        ctDo = 71
                                        strA = "ISNMatrixFactorForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 12 '20161019 LEE: Added
                                        ctDo = 72
                                        strA = "MatrixFactorPrecisionOfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 13 '20161019 LEE: Added
                                        ctDo = 73
                                        strA = "MatrixFactorPrecisionOfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 14 '20161019 LEE: Added
                                        ctDo = 74
                                        strA = "ISNMatrixFactorPrecisionForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 15 '20161019 LEE: Added
                                        ctDo = 75
                                        strA = "MatrixFactor(n)OfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 16 '20161019 LEE: Added
                                        ctDo = 76
                                        strA = "MatrixFactor(n)OfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 17 '20161019 LEE: Added
                                        ctDo = 77
                                        strA = "ISNMatrixFactor(n)ForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 18 '20161019 LEE: Added
                                        ctDo = 78
                                        strA = "MinIndMatrixFactorOfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 19 '20161019 LEE: Added
                                        ctDo = 79
                                        strA = "MinIndMatrixFactorOfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 20 '20161019 LEE: Added
                                        ctDo = 80
                                        strA = "MinIndISNMatrixFactorForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 21 '20161019 LEE: Added
                                        ctDo = 81
                                        strA = "MaxIndMatrixFactorOfAnalyteForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 22 '20161019 LEE: Added
                                        ctDo = 82
                                        strA = "MaxIndMatrixFactorOfISForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 23 '20161019 LEE: Added
                                        ctDo = 83
                                        strA = "MaxIndISNMatrixFactorForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 15
                                                boolDo = True
                                                boolDoIS = False
                                            Case Else
                                                boolDo = False
                                        End Select



                                    Case 24 '20161021 LEE: Added
                                        ctDo = 84
                                        strA = "RecoveryMeanQCForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"

                                        boolDoIS = False
                                        Select Case idCR
                                            Case 13, 14
                                                boolDo = True
                                                boolDoIS = True
                                                If boolIsIS Then
                                                    int1 = FindAnalyteFromIntStd(intRowsAnal, rowsAnal, strAnalyte)
                                                    If int1 = -1 Then
                                                    Else
                                                        strA = "RecoveryMeanQCForAnalyte_" & int1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                                    End If
                                                End If
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 25 '20161021 LEE: Added
                                        ctDo = 87
                                        strA = "RecoveryMeanRSForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 13, 15
                                                boolDo = True
                                                boolDoIS = True
                                                If boolIsIS Then
                                                    int1 = FindAnalyteFromIntStd(intRowsAnal, rowsAnal, strAnalyte)
                                                    If int1 = -1 Then
                                                    Else
                                                        strA = "RecoveryMeanRSForAnalyte_" & int1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                                    End If
                                                End If
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Case 26 '20161021 LEE: Added
                                        ctDo = 90
                                        strA = "RecoveryMeanPESForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                        boolDoIS = False
                                        Select Case idCR
                                            Case 14, 15
                                                boolDo = True
                                                boolDoIS = True
                                                If boolIsIS Then
                                                    int1 = FindAnalyteFromIntStd(intRowsAnal, rowsAnal, strAnalyte)
                                                    If int1 = -1 Then
                                                    Else
                                                        strA = "RecoveryMeanPESForAnalyte_" & int1 + 1 & "_QCLevel_" & Count2 + 1 & "_Table_"
                                                    End If
                                                End If
                                            Case Else
                                                boolDo = False
                                        End Select



                                End Select

                                'ctDo = ctDo + 1
                                If boolDoCt(ctDo) And boolDo Then

                                    If boolIsIS Then
                                        If boolDoIS Then
                                            Dim numRunID As Short

                                            Dim TotVal As Single

                                            'strFind = "[" & strA & strFCID & "]"
                                            strFind = "[IS_" & strA & strFCID & "]"

                                            boolQuit = False
                                            Do Until boolQuit

                                                'Exit Do

                                                .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                                                wrdSel = wd.Selection

                                                With wrdSel.Find
                                                    .ClearFormatting()
                                                    .MatchWholeWord = True
                                                    .Forward = True
                                                    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                                                    .Execute(FindText:=strFind)
                                                    If .Found Then
                                                        'get value from tblAnovaTables
                                                        TotVal = 0
                                                        str1 = "[NA]"

                                                        Select Case Count4
                                                            Case 1 'nomconc

                                                                strF1 = "NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = rowsA(0).Item("NUMNOMCONC")
                                                                    If IsNumeric(var1) Then
                                                                        str1 = SigFigOrDecString(var1, LSigFig, False) ' Format(var1, strQCDec)
                                                                    Else
                                                                        str1 = "NA"
                                                                    End If
                                                                End If

                                                            Case 2 'Precision 

                                                                strF1 = "CHARTYPE = 'Precision' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else

                                                                    Dim numMax As Single
                                                                    numMax = -9999999999
                                                                    For Count5 = 0 To rowsA.Length - 1
                                                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                                                        If IsNumeric(var1) Then
                                                                            If var1 > numMax Then
                                                                                numMax = var1
                                                                            End If
                                                                        End If
                                                                    Next
                                                                    str1 = Format(numMax, strQCDec)

                                                                End If

                                                            Case 3 'Accuracy 

                                                                strF1 = "CHARTYPE = 'Accuracy' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else

                                                                        Dim numMax As Single
                                                                        numMax = -9999999999
                                                                        For Count5 = 0 To rowsA.Length - 1
                                                                            var1 = rowsA(Count5).Item("NUMVALUE")
                                                                            If IsNumeric(var1) Then
                                                                                If var1 > numMax Then
                                                                                    numMax = var1
                                                                                End If
                                                                            End If
                                                                        Next
                                                                        str1 = Format(numMax, strQCDec)

                                                                    End If
                                                                End If

                                                            Case 4 'Recovery
                                                                strF1 = "CHARTYPE = 'Recovery' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                    If IsNumeric(var1) Then
                                                                        var3 = var1
                                                                        If BOOLRECSIGFIG Then
                                                                            If boolLUseSigFigs Then
                                                                                var1 = SigFigOrDecString(var3, LSigFig, False)
                                                                            Else
                                                                                var1 = Format(RoundToDecimalRAFZ(var3, LSigFig), strQCDec)
                                                                            End If
                                                                        Else
                                                                            var1 = Format(RoundToDecimalRAFZ(var3, LSigFig), strQCDec) ' RoundToDecimalRAFZ(var3, LSigFig)
                                                                        End If
                                                                        str1 = var1
                                                                    Else
                                                                        str1 = "NA"
                                                                    End If

                                                                    'If IsNumeric(var1) Then
                                                                    '    str1 = SigFigOrDecString(var1, LSigFig, False) ' Format(var1, strQCDec)' Format(var1, strQCDec)
                                                                    'Else
                                                                    '    str1 = "NA"
                                                                    'End If

                                                                End If

                                                            Case 5 'Difference
                                                                strF1 = "CHARTYPE = 'Diff' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                    If IsNumeric(var1) Then
                                                                        str1 = Format(var1, strQCDec)
                                                                    Else
                                                                        str1 = "NA"
                                                                    End If
                                                                End If

                                                            Case 6
                                                                strF1 = "CHARTYPE = 'n' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    If rowsA.Length = 0 Then
                                                                        str1 = "[NA]"
                                                                    Else

                                                                        Dim numMax As Single
                                                                        numMax = -9999999999
                                                                        For Count5 = 0 To rowsA.Length - 1
                                                                            var1 = rowsA(Count5).Item("NUMVALUE")
                                                                            If IsNumeric(var1) Then
                                                                                If var1 > numMax Then
                                                                                    numMax = var1
                                                                                End If
                                                                            End If
                                                                        Next
                                                                        str1 = Format(numMax, "0")

                                                                    End If
                                                                End If

                                                            Case 7 'Mean

                                                                strF1 = "CHARTYPE = 'Mean' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                    If IsNumeric(var1) Then
                                                                        'str1 = Format(var1, strQCDec)
                                                                        str1 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                                    Else
                                                                        str1 = "NA"
                                                                    End If

                                                                End If

                                                            Case 8 'Recovery Precision 

                                                                strF1 = "CHARTYPE = 'Precision' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else

                                                                    Dim numMax As Single
                                                                    numMax = -9999999999
                                                                    For Count5 = 0 To rowsA.Length - 1
                                                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                                                        If IsNumeric(var1) Then
                                                                            If var1 > numMax Then
                                                                                numMax = var1
                                                                            End If
                                                                        End If
                                                                    Next
                                                                    str1 = Format(numMax, strQCDec)

                                                                End If


                                                            Case 24 '20161021 LEE: Added
                                                                'ctDo = 84
                                                                'strA = "RecoveryMeanQCForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                                                strF1 = "CHARTYPE = 'RecMeanQC' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                    If IsNumeric(var1) Then
                                                                        'str1 = Format(var1, strQCDec)
                                                                        str1 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                                    Else
                                                                        str1 = "NA"
                                                                    End If
                                                                End If

                                                            Case 25 '20161021 LEE: Added
                                                                'ctDo = 87
                                                                'strA = "RecoveryMeanRSForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                                                strF1 = "CHARTYPE = 'RecMeanRS' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                    If IsNumeric(var1) Then
                                                                        'str1 = Format(var1, strQCDec)
                                                                        str1 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                                    Else
                                                                        str1 = "NA"
                                                                    End If
                                                                End If

                                                            Case 26 '20161021 LEE: Added
                                                                'ctDo = 90
                                                                'strA = "RecoveryMeanPESForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                                                strF1 = "CHARTYPE = 'RecMeanPES' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                    If IsNumeric(var1) Then
                                                                        'str1 = Format(var1, strQCDec)
                                                                        str1 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                                    Else
                                                                        str1 = "NA"
                                                                    End If
                                                                End If
                                                         



                                                        End Select

                                                        If StrComp(str1, "[NA]", CompareMethod.Text) = 0 Then
                                                            'make red font
                                                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                            wd.Selection.TypeText(Text:=str1)
                                                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                        Else
                                                            str2 = Replace(CStr(str1), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                            wd.Selection.Text = str2
                                                        End If
                                                    Else
                                                        boolQuit = True
                                                    End If

                                                End With
                                            Loop
                                        End If

                                    Else

                                        Dim numRunID As Short

                                        Dim TotVal As Single

                                        strFind = "[" & strA & strFCID & "]"

                                        boolQuit = False
                                        Do Until boolQuit

                                            'Exit Do

                                            .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                                            wrdSel = wd.Selection

                                            With wrdSel.Find
                                                .ClearFormatting()
                                                .MatchWholeWord = True
                                                .Forward = True
                                                .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                                                .Execute(FindText:=strFind)
                                                If .Found Then
                                                    'get value from tblAnovaTables
                                                    TotVal = 0
                                                    str1 = "[NA]"

                                                    Select Case Count4
                                                        Case 1 'nomconc

                                                            strF1 = "NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = rowsA(0).Item("NUMNOMCONC")
                                                                If IsNumeric(var1) Then
                                                                    str1 = SigFigOrDecString(var1, LSigFig, False) ' Format(var1, strQCDec)
                                                                Else
                                                                    str1 = "NA"
                                                                End If
                                                            End If

                                                        Case 2 'Precision 

                                                            strF1 = "CHARTYPE = 'Precision' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = rowsA(0).Item("NUMVALUE")
                                                                If IsNumeric(var1) Then
                                                                    str1 = Format(var1, strQCDec)
                                                                Else
                                                                    str1 = "NA"
                                                                End If
                                                            End If

                                                        Case 3 'Accuracy 

                                                            strF1 = "CHARTYPE = 'Accuracy' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else
                                                                    var1 = rowsA(0).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        str1 = Format(var1, strQCDec)
                                                                    Else
                                                                        str1 = "NA"
                                                                    End If
                                                                End If
                                                            End If

                                                        Case 4 'Recovery
                                                            strF1 = "CHARTYPE = 'Recovery' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                If IsNumeric(var1) Then
                                                                    var3 = var1
                                                                    If BOOLRECSIGFIG Then
                                                                        If boolLUseSigFigs Then
                                                                            var1 = SigFigOrDecString(var3, LSigFig, False)
                                                                        Else
                                                                            var1 = Format(RoundToDecimalRAFZ(var3, LSigFig), strQCDec)
                                                                        End If
                                                                    Else
                                                                        var1 = Format(RoundToDecimalRAFZ(var3, LSigFig), strQCDec) ' RoundToDecimalRAFZ(var3, LSigFig)
                                                                    End If
                                                                    str1 = var1
                                                                Else
                                                                    str1 = "NA"
                                                                End If

                                                                'If IsNumeric(var1) Then
                                                                '    str1 = SigFigOrDecString(var1, LSigFig, False) ' Format(var1, strQCDec)
                                                                'Else
                                                                '    str1 = "NA"
                                                                'End If
                                                            End If

                                                        Case 5 'Difference
                                                            strF1 = "CHARTYPE = 'Diff' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                If IsNumeric(var1) Then
                                                                    str1 = Format(var1, strQCDec)
                                                                Else
                                                                    str1 = "NA"
                                                                End If
                                                            End If

                                                        Case 6 '(n)
                                                            strF1 = "CHARTYPE = 'n' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                If rowsA.Length = 0 Then
                                                                    str1 = "[NA]"
                                                                Else

                                                                    Dim numMax As Single
                                                                    numMax = -9999999999
                                                                    For Count5 = 0 To rowsA.Length - 1
                                                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                                                        If IsNumeric(var1) Then
                                                                            If var1 > numMax Then
                                                                                numMax = var1
                                                                            End If
                                                                        End If
                                                                    Next
                                                                    str1 = Format(numMax, "0")

                                                                End If
                                                            End If
                                                        Case 7 'Mean

                                                            strF1 = "CHARTYPE = 'Mean' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                If IsNumeric(var1) Then
                                                                    'str1 = Format(var1, strQCDec)
                                                                    str1 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                                Else
                                                                    str1 = "NA"
                                                                End If

                                                            End If

                                                        Case 8 'Recovery Precision 

                                                            strF1 = "CHARTYPE = 'Precision' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)

                                                            End If


                                                        Case 9 '9strA = "MatrixFactorOfAnalyteForAnalyte_"

                                                            strF1 = "CHARTYPE = 'AMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = CStr(SigFigOrDecString(numMax, LSigFig, False))
                                                                'str1 = Format(numMax, strQCDec)

                                                            End If

                                                        Case 10 '10strA = "MatrixFactorOfISForAnalyte_"

                                                            strF1 = "CHARTYPE = 'ISMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                'str1 = Format(numMax, strQCDec)
                                                                str1 = CStr(SigFigOrDecString(numMax, LSigFig, False))

                                                            End If

                                                        Case 11 '11strA = "ISNMatrixFactorForAnalyte_"

                                                            strF1 = "CHARTYPE = 'ISNMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                'str1 = Format(numMax, strQCDec)
                                                                str1 = CStr(SigFigOrDecString(numMax, LSigFig, False))
                                                                str1 = str1

                                                            End If

                                                        Case 12 '12strA = "MatrixFactorPrecisionOfAnalyteForAnalyte_"

                                                            strF1 = "CHARTYPE = 'PrecisionAMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)

                                                            End If

                                                        Case 13 '13strA = "MatrixFactorPrecisionOfISForAnalyte_"

                                                            strF1 = "CHARTYPE = 'PrecisionISMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)

                                                            End If

                                                        Case 14 '14strA = "ISNMatrixFactorPrecisionForAnalyte_"

                                                            strF1 = "CHARTYPE = 'PrecisionISNMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, strQCDec)

                                                            End If

                                                        Case 15 '15strA = "MatrixFactor(n)OfAnalyteForAnalyte_"

                                                            strF1 = "CHARTYPE = 'nAMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, "0")

                                                            End If

                                                        Case 16 '16strA = "MatrixFactor(n)OfISForAnalyte_"

                                                            strF1 = "CHARTYPE = 'nISMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, "0")

                                                            End If

                                                        Case 17 '17strA = "ISNMatrixFactor(n)ForAnalyte_"

                                                            strF1 = "CHARTYPE = 'nISNMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                str1 = Format(numMax, "0")

                                                            End If



                                                        Case 18 '18strA = "MinIndMatrixFactorOfAnalyteForAnalyte_"

                                                            strF1 = "CHARTYPE = 'IndAMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = 9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                'str1 = Format(numMax, strQCDec)
                                                                str1 = CStr(SigFigOrDecString(numMax, LSigFig, False))

                                                            End If

                                                        Case 19 '19strA = "MinIndMatrixFactorOfISForAnalyte_"

                                                            strF1 = "CHARTYPE = 'IndISMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = 9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                'str1 = Format(numMax, strQCDec)
                                                                str1 = CStr(SigFigOrDecString(numMax, LSigFig, False))

                                                            End If

                                                        Case 20 '20strA = "MinIndISNMatrixFactorForAnalyte_"

                                                            strF1 = "CHARTYPE = 'IndISNMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = 9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 < numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                'str1 = Format(numMax, strQCDec)
                                                                str1 = CStr(SigFigOrDecString(numMax, LSigFig, False))

                                                            End If

                                                        Case 21 '18strA = "MaxIndMatrixFactorOfAnalyteForAnalyte_"

                                                            strF1 = "CHARTYPE = 'IndAMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                'str1 = Format(numMax, strQCDec)
                                                                str1 = CStr(SigFigOrDecString(numMax, LSigFig, False))

                                                            End If

                                                        Case 22 '19strA = "MaxIndMatrixFactorOfISForAnalyte_"

                                                            strF1 = "CHARTYPE = 'IndISMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                'str1 = Format(numMax, strQCDec)
                                                                str1 = CStr(SigFigOrDecString(numMax, LSigFig, False))

                                                            End If

                                                        Case 23 '20strA = "MaxIndISNMatrixFactorForAnalyte_"

                                                            strF1 = "CHARTYPE = 'IndISNMF' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else

                                                                Dim numMax As Single
                                                                numMax = -9999999999
                                                                For Count5 = 0 To rowsA.Length - 1
                                                                    var1 = rowsA(Count5).Item("NUMVALUE")
                                                                    If IsNumeric(var1) Then
                                                                        If var1 > numMax Then
                                                                            numMax = var1
                                                                        End If
                                                                    End If
                                                                Next
                                                                'str1 = Format(numMax, strQCDec)
                                                                str1 = CStr(SigFigOrDecString(numMax, LSigFig, False))

                                                            End If

                                                            'Case 69 '20161019 LEE: Added
                                                            '9strA = "MatrixFactorOfAnalyteForAnalyte_"
                                                            'Case 70 '20161019 LEE: Added
                                                            '10strA = "MatrixFactorOfISForAnalyte_"
                                                            'Case 71 '20161019 LEE: Added
                                                            '11strA = "ISNMatrixFactorForAnalyte_"
                                                            'Case 72 '20161019 LEE: Added
                                                            '12strA = "MatrixFactorPrecisionOfAnalyteForAnalyte_"
                                                            'Case 73 '20161019 LEE: Added
                                                            '13strA = "MatrixFactorPrecisionOfISForAnalyte_"
                                                            'Case 74 '20161019 LEE: Added
                                                            '14strA = "ISNMatrixFactorPrecisionForAnalyte_"
                                                            'Case 75 '20161019 LEE: Added
                                                            '15strA = "MatrixFactor(n)OfAnalyteForAnalyte_"
                                                            'Case 76 '20161019 LEE: Added
                                                            '16strA = "MatrixFactor(n)OfISForAnalyte_"
                                                            'Case 77 '20161019 LEE: Added
                                                            '17strA = "ISNMatrixFactor(n)ForAnalyte_"


                                                        Case 24 '20161021 LEE: Added
                                                            'ctDo = 84
                                                            'strA = "RecoveryMeanQCForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                                            strF1 = "CHARTYPE = 'RecMeanQC' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                If IsNumeric(var1) Then
                                                                    'str1 = Format(var1, strQCDec)
                                                                    str1 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                                Else
                                                                    str1 = "NA"
                                                                End If
                                                            End If

                                                        Case 25 '20161021 LEE: Added
                                                            'ctDo = 87
                                                            'strA = "RecoveryMeanRSForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                                            strF1 = "CHARTYPE = 'RecMeanRS' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                If IsNumeric(var1) Then
                                                                    'str1 = Format(var1, strQCDec)
                                                                    str1 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                                Else
                                                                    str1 = "NA"
                                                                End If
                                                            End If

                                                        Case 26 '20161021 LEE: Added
                                                            'ctDo = 90
                                                            'strA = "RecoveryMeanPESForAnalyte_" & Count1 + 1 & "_QCLevel_" & Count6 + 1 & "_Table_"
                                                            strF1 = "CHARTYPE = 'RecMeanPES' AND NUMQCLEVEL = " & Count6 + 1 & " AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1
                                                            Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                                            If rowsA.Length = 0 Then
                                                                str1 = "[NA]"
                                                            Else
                                                                var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                                                If IsNumeric(var1) Then
                                                                    'str1 = Format(var1, strQCDec)
                                                                    str1 = CStr(SigFigOrDecString(var1, LSigFig, False))
                                                                Else
                                                                    str1 = "NA"
                                                                End If
                                                            End If


                                                    End Select

                                                    If StrComp(str1, "[NA]", CompareMethod.Text) = 0 Then
                                                        'make red font
                                                        wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                                                        wd.Selection.TypeText(Text:=str1)
                                                        wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                                                    Else
                                                        str2 = Replace(CStr(str1), "-", ChrW(173), 1, -1, CompareMethod.Text)
                                                        wd.Selection.Text = str2
                                                    End If
                                                Else
                                                    boolQuit = True
                                                End If

                                            End With
                                        Loop
                                    End If

                                End If
                            Catch ex As Exception
                                MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                            End Try

                            intIc = intIc + 1
                            If intIc > intIcMax Then

                                strM = "...Searching for table-specific QC-related field codes...."
                                frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                                frmH.Refresh()

                                intIc = 0
                            End If

                        Next Count4

                    Next Count6
                    'Next Count3

nextCount2b:

                Next Count2

                ''now do stuff for sample concentrations: 5,6,7,30
                'Select Case idCR
                '    Case 5 'sample conc
                '        strF1 = "ANALYTEINDEX = " & intAnalyteIndex & " AND ANALYTEID = " & intAnalyteID & " AND MASTERASSAYID = " & intMasterAssayID
                '        strF1 = "ANALYTEID = " & intAnalyteID
                '        Dim rowsA() As DataRow
                '        rowsA = tblSampleDesign.Select(strF1, "ANALYTEID ASC")
                '        int1 = rowsA.Length
                '        Erase rowsA
                '        str1 = CStr(int1)

                '    Case 6 'reassayed samples

                '    Case 7 'repeat samples

                '    Case 30 'ISR
                'End Select

                Dim intPH As Short

                'now do stuff that doesn't require tblQCTables
                strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLINCLUDE = -1"
                strS = "ID_TBLSTUDIES ASC"
                'Legend:
                'Dim tbl3 As System.Data.DataTable = tblReportTable
                Dim dv1 As System.Data.DataView = New DataView(tbl3, strF, strS, DataViewRowState.CurrentRows)

                '20170511 LEE: Need a different counter for [Analyte_
                Dim intCount3 As Int32 = -1
                For Count3 = 0 To dv1.Count - 1

                    idCR = dv1(Count3).Item("ID_TBLCONFIGREPORTTABLES")
                    idT = dv1(Count3).Item("ID_TBLREPORTTABLE")
                    strFCID = NZ(dv1(Count3).Item("CHARFCID"), "AAABBBCCC")
                    intPH = NZ(dv1(Count3).Item("BOOLPLACEHOLDER"), 0)
                    If intPH <> 0 Then
                        strFCID = "LABIntegrityAAA"
                    End If
                    str1 = Mid(strFCID, 1, 2)
                    If StrComp(str1, "PH", CompareMethod.Text) = 0 Then
                        strFCID = "LABIntegrityAAA"
                    End If
                    If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
                        GoTo nextCount3
                    End If

                    intCount3 = intCount3 + 1

                    strF = "ID_TBLREPORTTABLE = " & idT
                    Erase rowsTR
                    rowsTR = tbl4.Select(strF)

                    'ctDo = 28
                    For Count4 = 1 To 9
                        boolDo = True
                        boolDoIS = False

                        Try

                            Select Case Count4
                                Case 1
                                    ctDo = 32
                                    strA = "StabilityConditionsForTable_"
                                    If Count1 = 0 Then
                                        Select Case idCR
                                            Case 4, 18, 19, 21, 22, 23, 29, 31, 32
                                                var1 = ""
                                            Case 32
                                                boolDoIS = True
                                                var1 = ""
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Else
                                        boolDo = False
                                    End If

                                Case 2
                                    ctDo = 33
                                    strA = "TimePeriodForTable_"
                                    If Count1 = 0 Then
                                        Select Case idCR
                                            Case 4, 18, 19, 21, 22, 23, 29
                                                var1 = var1 'debug
                                            Case 31, 32
                                                boolDoIS = True
                                            Case Else
                                                boolDo = False
                                        End Select
                                    Else
                                        boolDo = False
                                    End If


                                Case 3
                                    ctDo = 34
                                    strA = "TimeFrameForTable_"
                                    If Count1 = 0 Then
                                        Select Case idCR
                                            Case 4, 18, 19, 21, 22, 23, 29
                                                var1 = var1 'debug
                                            Case 31, 32
                                                boolDoIS = True
                                            Case Else
                                                boolDo = False
                                        End Select
                                    Else
                                        boolDo = False
                                    End If


                                Case 4
                                    ctDo = 35
                                    strA = "PeriodTempForTable_"
                                    If Count1 = 0 Then
                                        Select Case idCR
                                            Case 4, 18, 19, 21, 22, 23, 29
                                                var1 = var1 'debug
                                            Case 31, 32
                                                boolDoIS = True
                                            Case Else
                                                boolDo = False
                                        End Select
                                    Else
                                        boolDo = False
                                    End If


                                Case 5
                                    ctDo = 36
                                    strA = "NumberOfFTCyclesForTable_"
                                    If Count1 = 0 Then
                                        Select Case idCR
                                            Case 19
                                            Case Else
                                                boolDo = False
                                        End Select

                                    Else
                                        boolDo = False
                                    End If

                                Case 6
                                    ctDo = 37
                                    strA = "Analyte_" & Count1 + 1
                                    If intCount3 = 0 Then
                                        boolDoIS = True
                                    Else
                                        boolDo = False
                                    End If
                                Case 7
                                    ctDo = 38
                                    strA = "IntStdConcForTable_"
                                    If Count1 = 0 Then
                                        Select Case idCR
                                            Case 32
                                            Case 13, 14, 15
                                                boolDoIS = True
                                            Case Else
                                                boolDo = False
                                        End Select
                                    Else
                                        boolDo = False
                                    End If

                                Case 8
                                    ctDo = 50
                                    strA = "(n)ForAnalyte_" & Count1 + 1 & "_Table_"
                                    Select Case idCR
                                        Case 1, 2, 5, 6, 7, 30, 11 'don't do 11 because uses tblAnova
                                            boolDo = False
                                        Case Else

                                    End Select

                                Case 9
                                    ctDo = 64
                                    strA = "IS_Analyte_" & Count1 + 1
                                    If intCount3 = 0 Then
                                        boolDo = True
                                        If boolIsIS Then
                                            boolDo = False
                                        End If
                                        boolDoIS = False
                                    Else
                                        boolDo = False
                                    End If

                            End Select

                            'ctDo = ctDo + 1
                            If boolDoCt(ctDo) And boolDo Then

                                Select Case Count4
                                    Case 6, 9
                                        strFind = "[" & strA & "]"
                                    Case Else
                                        strFind = "[" & strA & strFCID & "]"
                                End Select

                                If boolIsIS Then
                                    strFind = "[IS_" & strA & strFCID & "]"
                                    If boolDoIS Then
                                        Call ExecuteB(strAnalyteUser, rowsTR, dv1, wd, strFind, Count1, Count2, Count3, Count4, strFCID, tbl1a, idCR, intAnalyteID, intAnalyteIndex, intMasterAssayID, strAnalyteO)
                                    End If
                                Else
                                    Call ExecuteB(strAnalyteUser, rowsTR, dv1, wd, strFind, Count1, Count2, Count3, Count4, strFCID, tbl1a, idCR, intAnalyteID, intAnalyteIndex, intMasterAssayID, strAnalyteO)
                                End If

                            End If
                        Catch ex As Exception
                            MsgBox(ex.Message & ChrW(10) & strA, MsgBoxStyle.Information, "Problem...")
                        End Try

                        intIc = intIc + 1
                        If intIc > intIcMax Then

                            strM = "...Searching for table-specific QC-related field codes...."
                            frmH.lblProgress.Text = strM & ChrW(10) & ChrW(10) & "..." & strA & "..."
                            frmH.Refresh()

                            intIc = 0
                        End If

                    Next Count4

nextCount3:

                Next Count3

nextCount1:

            Next Count1

        End With

end1:

        wd.Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)

    End Sub

    Sub ExecuteB(ByVal strAnalyte As String, ByVal rowsTR() As DataRow, ByVal dv1 As System.Data.DataView, ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal strFind As String, ByVal Count1 As Int16, ByVal Count2 As Int16, ByVal Count3 As Int16, ByVal Count4 As Int16, ByVal strFCID As String, ByVal tbl1a As System.Data.DataTable, ByVal idCR As Int64, ByVal intAnalyteID As Int64, ByVal intAnalyteIndex As Int64, ByVal intMasterAssayID As Int64, ByVal strAnalyteO As String)

        Dim boolQuit As Boolean
        Dim wrdSel As Microsoft.Office.Interop.Word.Selection
        Dim TotVal As Double
        Dim strF1 As String
        Dim var1, var2, var3
        Dim str1 As String
        Dim str2 As String
        Dim str3 As Stream
        Dim Count5 As Int64
        Dim int1 As Int16
        Dim intN As Int16

        'modify stranalyte and stranalyteo
        strAnalyte = Replace(strAnalyte, "-", NBHReal, 1, -1, CompareMethod.Text)
        'replace spaces with nbs
        strAnalyte = Replace(strAnalyte, " ", ChrW(160), 1, -1, CompareMethod.Text)

        strAnalyteO = Replace(strAnalyteO, "-", NBHReal, 1, -1, CompareMethod.Text)
        'replace spaces with nbs
        strAnalyteO = Replace(strAnalyteO, " ", ChrW(160), 1, -1, CompareMethod.Text)

        With wd

            boolQuit = False
            Do Until boolQuit

                'Exit Do

                .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                wrdSel = wd.Selection

                With wrdSel.Find
                    .ClearFormatting()
                    .MatchWholeWord = True
                    .Forward = True
                    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                    .Execute(FindText:=strFind)
                    If .Found Then
                        'get value from tblAnovaTables
                        str1 = "[NA]"
                        Select Case Count4
                            Case 1
                                'strA = "StabilityConditionsForTable_"
                                str1 = NZ(dv1(Count3).Item("CHARSTABILITYPERIOD"), "NA")
                            Case 2
                                'strA = "TimePeriodForAnalyte_" & Count1 + 1 & "_Table_"
                                If rowsTR.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = rowsTR(0).Item("CHARTIMEPERIOD")
                                    str1 = NZ(var1, "[NA]")
                                End If
                            Case 3
                                'strA = "TimeFrameForAnalyte_" & Count1 + 1 & "_Table_"
                                If rowsTR.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = rowsTR(0).Item("CHARTIMEFRAME")
                                    str1 = NZ(var1, "[NA]")
                                End If
                            Case 4
                                'strA = "PeriodTempForAnalyte_" & Count1 + 1 & "_Table_"
                                If rowsTR.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = rowsTR(0).Item("CHARPERIODTEMP")
                                    str1 = NZ(var1, "[NA]")
                                End If
                            Case 5
                                'strA = "NumberOfFTCyclesForAnalyte_" & Count1 + 1 & "_Table_"
                                If rowsTR.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = rowsTR(0).Item("INTNUMBEROFCYCLES")
                                    str1 = NZ(var1, "[NA]")
                                End If
                            Case 6
                                'strA = "Analyte_" & Count1 + 1
                                '20170928 LEE: this should be stranalyte, not stranalyteO
                                If Len(strAnalyte) = 0 Then
                                    str1 = "[NA]"
                                Else
                                    str1 = strAnalyte
                                End If
                            Case 7
                                'strA = "IntStdConcForTable_"
                                If rowsTR.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = rowsTR(0).Item("CHARISCONC")
                                    str1 = NZ(var1, "[NA]")
                                End If
                            Case 8
                                Select Case idCR
                                    Case 5 'sample conc
                                        'strF1 = "ANALYTEINDEX = " & intAnalyteIndex & " AND ANALYTEID = " & intAnalyteID & " AND MASTERASSAYID = " & intMasterAssayID
                                        'strF1 = "ANALYTEID = " & intAnalyteID
                                        'Dim rowsA() As DataRow
                                        'rowsA = tblSampleDesign.Select(strF1, "ANALYTEID ASC")
                                        'int1 = rowsA.Length
                                        'Erase rowsA
                                        'str1 = CStr(int1)

                                        str1 = NZ(ctrsSamples(1, Count1 + 1), "[NA]")

                                    Case 6 'reassayed samples
                                        str1 = NZ(ctrsReassayed(1, Count1 + 1), "[NA]")
                                    Case 7 'repeat samples
                                        str1 = NZ(ctrsRepeat(1, Count1 + 1), "[NA]")
                                    Case 30 'ISR
                                        str1 = NZ(ctrsISR(1, Count1 + 1), "[NA]")
                                    Case Else
                                        'get from tbl1a
                                        strF1 = "CHARTYPE = 'n' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                        Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                        intN = rowsA.Length

                                        If intN = 0 Then
                                            str1 = "[NA]"
                                        Else

                                            Dim numMax As Single
                                            numMax = 0
                                            For Count5 = 0 To rowsA.Length - 1
                                                var1 = rowsA(Count5).Item("NUMVALUE")
                                                If IsNumeric(var1) Then
                                                    numMax = numMax + 1
                                                End If
                                            Next
                                            str1 = CStr(numMax)
                                            str1 = Format(numMax, "0")

                                        End If
                                End Select

                            Case 9
                                'strA = "IS_Analyte_" & Count1 + 1
                                If Len(strAnalyte) = 0 Then
                                    str1 = "[NA]"
                                Else
                                    str1 = GetISFromAnalyte(Count1)
                                End If

                        End Select

                        If StrComp(str1, "[NA]", CompareMethod.Text) = 0 Then
                            'make red font
                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                            wd.Selection.TypeText(Text:=str1)
                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                        Else
                            If Count4 = 2 Then
                                'make lowercase
                                str2 = LCase(str1)
                                str1 = str2
                            End If
                            wd.Selection.Text = str1
                        End If

                    Else
                        boolQuit = True
                    End If

                    'wdd.visible = True

                End With
            Loop

        End With

    End Sub

    Sub ExecuteA(ByVal intGroup As Int16, ByVal idTR As Int64, ByVal strAnalyte As String, ByVal wd As Microsoft.Office.Interop.Word.Application, ByVal strFind As String, ByVal Count1 As Int16, ByVal Count2 As Int16, ByVal Count4 As Int16, ByVal strFCID As String, ByVal tbl1a As System.Data.DataTable, ByVal idCR As Int64, ByVal intAnalyteID As Int64, ByVal intAnalyteIndex As Int64, ByVal intMasterAssayID As Int64, ByVal strAnalyteO As String)

        Dim boolQuit As Boolean
        Dim wrdSel As Microsoft.Office.Interop.Word.Selection
        Dim TotVal As Double
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim var1, var2, var3
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim Count1a As Short
        Dim Count5 As Int64
        Dim tblA As System.Data.DataTable

        Dim int1 As Int16
        Dim strF As String
        Dim v1 As Single
        Dim v2 As Single

        boolQuit = False
        With wd
            Do Until boolQuit

                .Selection.HomeKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
                wrdSel = wd.Selection

                With wrdSel.Find
                    .ClearFormatting()
                    .MatchWholeWord = True
                    .Forward = True
                    .Wrap = Microsoft.Office.Interop.Word.WdFindWrap.wdFindContinue
                    .Execute(FindText:=strFind)
                    If .Found Then
                        'get value from tblAnovaTables
                        TotVal = 0
                        str1 = "[NA]"
                        Select Case Count4

                            Case 1 'n
                                Select Case idCR
                                    'Note: 5,6,7,30 won't be called because they don't do tblAnova
                                    Case 5 'sample conc

                                    Case 6 'reassayed samples

                                    Case 7 'repeat samples

                                    Case 30 'ISR

                                    Case Else
                                        strF1 = "CHARTYPE = 'n' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                        Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                        If rowsA.Length = 0 Then
                                            str1 = "[NA]"
                                        Else
                                            Dim numMax As Single
                                            numMax = 0
                                            For Count5 = 0 To rowsA.Length - 1
                                                var1 = rowsA(Count5).Item("NUMVALUE")
                                                If IsNumeric(var1) Then
                                                    numMax = numMax + var1
                                                End If
                                            Next
                                            str1 = CStr(numMax)
                                        End If
                                End Select

                            Case 2 'Precision Min

                                strF1 = "CHARTYPE = 'Precision' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMin As Single
                                    numMin = 9999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 < numMin Then
                                                numMin = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMin, strQCDec)
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 3 'Precision Max

                                strF1 = "CHARTYPE = 'Precision' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMax As Single
                                    numMax = -9999999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 > numMax Then
                                                numMax = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMax, strQCDec)
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 4 'accuracy min 

                                strF1 = "CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMin As Single
                                    numMin = 9999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 < numMin Then
                                                numMin = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMin, strQCDec)
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 5 'accuracy max
                                strF1 = "CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMax As Single
                                    numMax = -999999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 > numMax Then
                                                numMax = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMax, strQCDec)
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 6

                                'strA = "AverageRecoveryPrecisionForAnalyte_" & Count1 + 1 & "_Table_"
                                strF1 = "CHARTYPE = 'AvePrecisionRec' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE" ' & " AND NUMQCLEVEL = 0"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), 0)
                                    If var1 <> 0 Then
                                        str2 = Format(var1, strQCDec)
                                        str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                    Else
                                        str1 = "NA"
                                    End If
                                End If
                            Case 7
                                'deprecated
                                'strA = "AverageRecoveryAccuracyForAnalyte_" & Count1 + 1 & "_Table_"
                                strF1 = "CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE" ' & " AND NUMQCLEVEL = 0"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                    If IsNumeric(var1) Then
                                        str1 = Format(var1, strQCDec)
                                    Else
                                        str1 = "NA"
                                    End If
                                End If
                            Case 8
                                'strA = "AverageRecoveryForAnalyte_" & Count1 + 1 & "_Table_"
                                strF1 = "CHARTYPE = 'AveRecovery' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE" ' & " AND NUMQCLEVEL = 0"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                    If IsNumeric(var1) Then
                                        var3 = var1
                                        If BOOLRECSIGFIG Then
                                            If boolLUseSigFigs Then
                                                var1 = SigFigOrDecString(var3, LSigFig, False)
                                            Else
                                                var1 = Format(RoundToDecimalRAFZ(var3, LSigFig), strQCDec)
                                            End If
                                        Else
                                            var1 = Format(RoundToDecimalRAFZ(var3, LSigFig), strQCDec) ' RoundToDecimalRAFZ(var3, LSigFig)
                                        End If
                                        'str2 = SigFigOrDecString(var1, LSigFig, False)
                                        str2 = var1
                                        str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                    Else
                                        str1 = "NA"
                                    End If
                                End If

                            Case 9
                                'strA = "DilutionFactorForAnalyte_" & Count1 + 1 & "_Table_"

                                '20190228 LEE:
                                str1 = GetDilQCInfo(3, intGroup, idTR)

                                'Dim tbl1 As System.Data.DataTable
                                'Dim tbl2 As System.Data.DataTable
                                'Dim strS As String

                                'tbl1 = tblAssignedSamples
                                'tbl2 = tblAnalysisResultsHome

                                'strF = "ID_TBLCONFIGREPORTTABLES = 12 AND ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND ANALYTEID = " & intAnalyteID
                                'strS = "ID_TBLCONFIGREPORTTABLES ASC"
                                'Dim dv1 As System.Data.DataView = New DataView(tbl1, strF, strS, DataViewRowState.CurrentRows)

                                'If dv1.Count = 0 Then
                                '    str1 = "[NA]"
                                'Else

                                '    Try
                                '        'get unique dilution factors
                                '        Dim tblU As DataTable = dv1.ToTable("aa", True, "ALIQUOTFACTOR")
                                '        For Count1a = 0 To tblU.Rows.Count - 1
                                '            var2 = NZ(tblU.Rows(Count1a).Item("ALIQUOTFACTOR"), "NA")
                                '            If IsNumeric(var2) Then
                                '                var1 = CInt(1 / var2)
                                '            Else
                                '                var1 = var2
                                '            End If
                                '            If Count1a = 0 Then
                                '                str1 = var1
                                '            Else
                                '                If Count1a = tblU.Rows.Count - 1 Then
                                '                    str1 = str1 & " and " & var1
                                '                Else
                                '                    str1 = str1 & ", " & var1
                                '                End If
                                '            End If
                                '        Next
                                '    Catch ex As Exception

                                '    End Try


                                'End If

                            Case 10
                                'strA = "MeanSlopeForAnalyte_" & Count1 + 1 & "_Table_"
                                strF1 = "CHARTYPE = 'Slope' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)

                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = rowsA(0).Item("NUMVALUE")
                                    If boolLUseSigFigsRegr Then
                                        If boolLUseRegrSciNot Then
                                            str1 = Format(var1, GetScNot(LRegrSigFigs))
                                        Else
                                            str1 = CStr(SigFigOrDecString(var1, LRegrSigFigs, True))
                                        End If
                                    Else
                                        If boolLUseRegrSciNot Then
                                            str1 = Format(var1, GetScNot(LRegrDec + 1))
                                        Else
                                            str1 = Format(var1, strRegrDec)
                                        End If
                                    End If
                                    str2 = str1
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If
                            Case 11
                                'strA = "MeanYIntForAnalyte_" & Count1 + 1 & "_Table_"
                                strF1 = "CHARTYPE = 'YInt' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = rowsA(0).Item("NUMVALUE")
                                    If boolLUseSigFigsRegr Then
                                        If boolLUseRegrSciNot Then
                                            str1 = Format(var1, GetScNot(LRegrSigFigs))
                                        Else
                                            str1 = CStr(SigFigOrDecString(var1, LRegrSigFigs, True))
                                        End If
                                    Else
                                        If boolLUseRegrSciNot Then
                                            str1 = Format(var1, GetScNot(LRegrDec + 1))
                                        Else
                                            str1 = Format(var1, strRegrDec)
                                        End If
                                    End If
                                    str2 = str1
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If
                            Case 12
                                'strA = "MeanR2ForAnalyte_" & Count1 + 1 & "_Table_"
                                strF1 = "CHARTYPE = 'R2' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = rowsA(0).Item("NUMVALUE")
                                    If boolLUseSigFigsRegr Then
                                        If boolLUseRegrSciNot Then
                                            str1 = Format(var1, GetScNot(LR2SigFigs))
                                        Else
                                            var2 = SigFigOrDecString(var1, LR2SigFigs, True)
                                            str2 = GetRegrDecStr(LR2SigFigs)
                                            str1 = Format(CDec(var2), str2)
                                            'str1 = CStr(SigFigOrDecString(var1, LR2SigFigs, False))
                                        End If
                                    Else
                                        If boolLUseRegrSciNot Then
                                            str1 = Format(var1, GetScNot(LRegrDec + 1))
                                        Else
                                            str1 = Format(var1, strRegrDec)
                                        End If
                                    End If
                                End If

                            Case 13
                                'strA = "DilutionConcentrationForAnalyte_" & Count1 + 1 & "_Table_"

                                '20190228 LEE:
                                str1 = GetDilQCInfo(2, intGroup, idTR)

                                'Dim tbl1 As System.Data.DataTable
                                'Dim tbl2 As System.Data.DataTable
                                'Dim strS As String

                                'tbl1 = tblAssignedSamples
                                'tbl2 = tblAnalysisResultsHome

                                'strF = "ID_TBLCONFIGREPORTTABLES = 12 AND ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idTR & " AND ANALYTEID = " & intAnalyteID
                                'strS = "ID_TBLCONFIGREPORTTABLES ASC"
                                'Dim dv1 As System.Data.DataView = New DataView(tbl1, strF, strS, DataViewRowState.CurrentRows)
                                'If dv1.Count = 0 Then
                                '    str1 = "[NA]"
                                'Else
                                '    'get unique values
                                '    Dim tblU As DataTable = dv1.ToTable("aa", True, "NOMCONC")
                                '    For Count1a = 0 To tblU.Rows.Count - 1
                                '        var1 = NZ(tblU.Rows(Count1a).Item("NOMCONC"), "NA")
                                '        If Count1a = 0 Then
                                '            str1 = var1
                                '        Else
                                '            If Count1a = tblU.Rows.Count - 1 Then
                                '                str1 = str1 & " and " & var1
                                '            Else
                                '                str1 = str1 & ", " & var1
                                '            End If
                                '        End If
                                '    Next

                                '    'str1 = var1
                                'End If



                            Case 14 'Accuracy Min Individual

                                'filter for acceptable

                                Dim numMin As Single
                                strF1 = "CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else

                                    'get acceptance crit
                                    var1 = rowsA(0).Item("numCrit1")
                                    var2 = rowsA(0).Item("numCrit2")
                                    If IsNumeric(var1) And IsNumeric(var2) Then

                                        v1 = -var1
                                        v2 = var2

                                        strF = strF1 & " AND (numValue >= " & v1 & " AND numValue <= " & v2 & ")"
                                        Dim rowsB() As DataRow = tbl1a.Select(strF)

                                        If rowsB.Length = 0 Then
                                            str1 = "[NA]"
                                        Else
                                            numMin = 9999999
                                            For Count5 = 0 To rowsB.Length - 1
                                                var1 = rowsB(Count5).Item("NUMVALUE")
                                                If IsNumeric(var1) Then
                                                    If var1 < numMin Then
                                                        numMin = var1
                                                    End If
                                                End If
                                            Next
                                        End If
                                        If numMin = 9999999 Then
                                            str1 = "[NA]"
                                        Else
                                            str1 = Format(numMin, strQCDec)
                                        End If
                                    Else
                                        str1 = "[NA]"
                                    End If

                                    str1 = Replace(str1, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 15 'Accuracy Max Individual

                                'filter for acceptable
                                strF1 = "CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else

                                    Dim numMax As Single
                                    'get acceptance crit
                                    var1 = rowsA(0).Item("numCrit1")
                                    var2 = rowsA(0).Item("numCrit2")
                                    If IsNumeric(var1) And IsNumeric(var2) Then

                                        v1 = -var1
                                        v2 = var2

                                        strF = strF1 & " AND (numValue >= " & v1 & " AND numValue <= " & v2 & ")"
                                        Dim rowsB() As DataRow = tbl1a.Select(strF)

                                        If rowsB.Length = 0 Then
                                            str1 = "[NA]"
                                        Else
                                            numMax = -9999999
                                            For Count5 = 0 To rowsB.Length - 1
                                                var1 = rowsB(Count5).Item("NUMVALUE")
                                                If IsNumeric(var1) Then
                                                    If var1 > numMax Then
                                                        numMax = var1
                                                    End If
                                                End If
                                            Next
                                        End If

                                        If numMax = -9999999 Then
                                            str1 = "[NA]"
                                        Else
                                            str1 = Format(numMax, strQCDec)
                                        End If
                                    Else
                                        str1 = "[NA]"
                                    End If

                                    str1 = Replace(str1, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 16, 17, 18, 19 'Unique lots code

                                'Unique Lots has two acceptance criteria, Accuracy and Precision
                                'Must assume that Precision acceptance criteria is the same as Acccuracy
                                '20161210 LEE: Precision acceptance criteria is now NUMPRECCRITLOTS

                                'first must find accepted lots

                                Dim tblQCL As New DataTable
                                Dim col1 As New DataColumn
                                col1.ColumnName = "QCLevel"
                                col1.DataType = System.Type.GetType("System.Single")
                                tblQCL.Columns.Add(col1)


                                'first do Accuracy

                                strF1 = "CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then

                                Else

                                    'get acceptance crit
                                    var1 = rowsA(0).Item("numCrit1")
                                    var2 = rowsA(0).Item("numCrit2")
                                    If IsNumeric(var1) And IsNumeric(var2) Then

                                        v1 = -var1
                                        v2 = var2

                                        strF = strF1 & " AND (numValue >= " & v1 & " AND numValue <= " & v2 & ")"
                                        Dim rowsB() As DataRow = tbl1a.Select(strF)

                                        If rowsB.Length = 0 Then
                                            str1 = "[NA]"
                                        Else

                                            For Count5 = 0 To rowsB.Length - 1
                                                var1 = rowsB(Count5).Item("NUMQCLEVEL")
                                                If IsNumeric(var1) Then
                                                    Dim nRow As DataRow = tblQCL.NewRow
                                                    nRow.BeginEdit()
                                                    nRow.Item("QCLevel") = var1
                                                    nRow.EndEdit()
                                                    tblQCL.Rows.Add(nRow)
                                                End If
                                            Next

                                        End If

                                    Else

                                    End If

                                End If


                                'now do precision

                                strF1 = "CHARTYPE = 'Precision' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsC() As DataRow = tbl1a.Select(strF1)
                                If rowsC.Length = 0 Then

                                Else

                                    'get acceptance crit
                                    var1 = NUMPRECCRITLOTS ' rowsC(0).Item("numCrit1")
                                    var2 = NUMPRECCRITLOTS 'rowsC(0).Item("numCrit2")

                                    If IsNumeric(var1) And IsNumeric(var2) Then

                                        v1 = -var1
                                        v2 = var2

                                        If NUMPRECCRITLOTS = 0 Then
                                            strF = strF1
                                        Else
                                            strF = strF1 & " AND (numValue >= " & v1 & " AND numValue <= " & v2 & ")"
                                        End If

                                        Dim rowsD() As DataRow = tbl1a.Select(strF)

                                        If rowsD.Length = 0 Then
                                            str1 = "[NA]"
                                        Else

                                            For Count5 = 0 To rowsD.Length - 1
                                                var1 = rowsD(Count5).Item("NUMQCLEVEL")
                                                If IsNumeric(var1) Then
                                                    Dim nRow As DataRow = tblQCL.NewRow
                                                    nRow.BeginEdit()
                                                    nRow.Item("QCLevel") = var1
                                                    nRow.EndEdit()
                                                    tblQCL.Rows.Add(nRow)
                                                End If
                                            Next

                                        End If

                                    Else

                                    End If

                                End If

                                'Now combine QCLevels into a unique table
                                Dim dvQCL As DataView = New DataView(tblQCL)
                                Dim tblU As DataTable = dvQCL.ToTable("a", True, "QCLevel")

                                'now delete any rows that do not have a duplicate

                                For Count1a = 0 To tblU.Rows.Count - 1
                                    var1 = tblU.Rows(Count1a).Item("QCLevel")
                                    Dim rowsU() As DataRow = tblQCL.Select("QCLevel = " & var1)
                                    If rowsU.Length = 1 Then
                                        'delete this row
                                        rowsU(0).BeginEdit()
                                        rowsU(0).Delete()
                                        rowsU(0).EndEdit()
                                    End If
                                Next

                                're-establish tblU
                                dvQCL = New DataView(tblQCL)
                                tblU = dvQCL.ToTable("a", True, "QCLevel")

                                If tblU.Rows.Count = 0 Then
                                Else

                                    Select Case Count4

                                        Case 16 'Accuracy Min Lots

                                            'filter for acceptable Accuracy
                                            'then retrieve acceptable Precision
                                            Dim numMin As Single
                                            strF1 = "CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                            For Count2 = 0 To tblU.Rows.Count - 1
                                                var1 = tblU.Rows(Count2).Item("QCLevel")
                                                If Count2 = 0 Then
                                                    strF2 = "(NUMQCLEVEL = " & var1
                                                Else
                                                    strF2 = strF2 & " OR NUMQCLEVEL = " & var1
                                                End If
                                            Next
                                            strF2 = strF2 & ")"
                                            strF = strF1 & " AND " & strF2

                                            Dim rowsCa() As DataRow = tbl1a.Select(strF)
                                            If rowsCa.Length = 0 Then
                                                str1 = "[NA]"
                                            Else

                                                If rowsCa.Length = 0 Then
                                                    str1 = "[NA]"
                                                Else
                                                    numMin = 9999999
                                                    For Count5 = 0 To rowsCa.Length - 1
                                                        var1 = rowsCa(Count5).Item("NUMVALUE")
                                                        If IsNumeric(var1) Then
                                                            If var1 < numMin Then
                                                                numMin = var1
                                                            End If
                                                        End If
                                                    Next
                                                End If

                                                If numMin = 9999999 Then
                                                    str1 = "NA"
                                                Else
                                                    str1 = Format(numMin, strQCDec)
                                                End If

                                                str1 = Replace(str1, "-", ChrW(173), 1, -1, CompareMethod.Text)

                                            End If

                                        Case 17 'Accuracy Max Lots

                                            'filter for acceptable Accuracy
                                            'then retrieve acceptable Precision

                                            Dim arrQCL(20)
                                            Dim intQCL As Short = 0
                                            Dim numMax As Single
                                            strF1 = "CHARTYPE = 'Accuracy' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                            For Count2 = 0 To tblU.Rows.Count - 1
                                                var1 = tblU.Rows(Count2).Item("QCLevel")
                                                If Count2 = 0 Then
                                                    strF2 = "(NUMQCLEVEL = " & var1
                                                Else
                                                    strF2 = strF2 & " OR NUMQCLEVEL = " & var1
                                                End If
                                            Next
                                            strF2 = strF2 & ")"
                                            strF = strF1 & " AND " & strF2

                                            Dim rowsCa() As DataRow = tbl1a.Select(strF)
                                            If rowsCa.Length = 0 Then
                                                str1 = "[NA]"
                                            Else

                                                If rowsCa.Length = 0 Then
                                                    str1 = "[NA]"
                                                Else
                                                    numMax = -9999999
                                                    For Count5 = 0 To rowsCa.Length - 1
                                                        var1 = rowsCa(Count5).Item("NUMVALUE")
                                                        If IsNumeric(var1) Then
                                                            If var1 > numMax Then
                                                                numMax = var1
                                                            End If
                                                        End If
                                                    Next
                                                End If

                                                If numMax = -9999999 Then
                                                    str1 = "NA"
                                                Else
                                                    str1 = Format(numMax, strQCDec)
                                                End If

                                                str1 = Replace(str1, "-", ChrW(173), 1, -1, CompareMethod.Text)

                                            End If


                                        Case 18 'Precision Min Lots


                                            'filter for acceptable Accuracy
                                            'then retrieve acceptable Precision

                                            Dim arrQCL(20)
                                            Dim intQCL As Short = 0
                                            Dim numMin As Single
                                            strF1 = "CHARTYPE = 'Precision' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                            For Count2 = 0 To tblU.Rows.Count - 1
                                                var1 = tblU.Rows(Count2).Item("QCLevel")
                                                If Count2 = 0 Then
                                                    strF2 = "(NUMQCLEVEL = " & var1
                                                Else
                                                    strF2 = strF2 & " OR NUMQCLEVEL = " & var1
                                                End If
                                            Next
                                            strF2 = strF2 & ")"
                                            strF = strF1 & " AND " & strF2

                                            Dim rowsCa() As DataRow = tbl1a.Select(strF)
                                            If rowsCa.Length = 0 Then
                                                str1 = "[NA]"
                                            Else

                                                If rowsCa.Length = 0 Then
                                                    str1 = "[NA]"
                                                Else
                                                    numMin = 9999999
                                                    For Count5 = 0 To rowsCa.Length - 1
                                                        var1 = rowsCa(Count5).Item("NUMVALUE")
                                                        If IsNumeric(var1) Then
                                                            If var1 < numMin Then
                                                                numMin = var1
                                                            End If
                                                        End If
                                                    Next
                                                End If

                                                If numMin = 9999999 Then
                                                    str1 = "NA"
                                                Else
                                                    str1 = Format(numMin, strQCDec)
                                                End If

                                                str1 = Replace(str1, "-", ChrW(173), 1, -1, CompareMethod.Text)

                                            End If

                                        Case 19 'Precision Max Lots


                                            'filter for acceptable Accuracy
                                            'then retrieve acceptable Precision

                                            Dim arrQCL(20)
                                            Dim intQCL As Short = 0
                                            Dim numMax As Single
                                            strF1 = "CHARTYPE = 'Precision' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                            For Count2 = 0 To tblU.Rows.Count - 1
                                                var1 = tblU.Rows(Count2).Item("QCLevel")
                                                If Count2 = 0 Then
                                                    strF2 = "(NUMQCLEVEL = " & var1
                                                Else
                                                    strF2 = strF2 & " OR NUMQCLEVEL = " & var1
                                                End If
                                            Next
                                            strF2 = strF2 & ")"
                                            strF = strF1 & " AND " & strF2
                                            Dim rowsCa() As DataRow = tbl1a.Select(strF)
                                            If rowsCa.Length = 0 Then
                                                str1 = "[NA]"
                                            Else

                                                If rowsCa.Length = 0 Then
                                                    str1 = "[NA]"
                                                Else
                                                    numMax = -9999999
                                                    For Count5 = 0 To rowsCa.Length - 1
                                                        var1 = rowsCa(Count5).Item("NUMVALUE")
                                                        If IsNumeric(var1) Then
                                                            If var1 > numMax Then
                                                                numMax = var1
                                                            End If
                                                        End If
                                                    Next
                                                End If

                                                If numMax = -9999999 Then
                                                    str1 = "NA"
                                                Else
                                                    str1 = Format(numMax, strQCDec)
                                                End If

                                                str1 = Replace(str1, "-", ChrW(173), 1, -1, CompareMethod.Text)

                                            End If

                                    End Select

                                End If


                            Case 20
                                'strA = "AverageISNMFForAnalyte_"
                                strF1 = "CHARTYPE = 'AveISNMF' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE" ' & " AND NUMQCLEVEL = 0"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                    If IsNumeric(var1) Then
                                        'str2 = var1 ' Format(var1, strQCDec)
                                        str2 = SigFigOrDecString(var1, LSigFig, False)
                                        str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                    Else
                                        str1 = "NA"
                                    End If
                                End If

                            Case 21
                                'strA = "AverageSDISNMFForAnalyte_"
                                strF1 = "CHARTYPE = 'AveSDISNMF' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE" ' & " AND NUMQCLEVEL = 0"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), 0)
                                    If var1 <> 0 Then
                                        'str2 = var1 ' Format(var1, strQCDec)
                                        str2 = SigFigOrDecString(var1, LSigFig, False)
                                        str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                    Else
                                        str1 = "NA"
                                    End If
                                End If

                            Case 22
                                'strA = "AveragePrecisionISNMFForAnalyte_"
                                strF1 = "CHARTYPE = 'AvePrecisionISNMF' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE" ' & " AND NUMQCLEVEL = 0"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), 0)
                                    If var1 <> 0 Then
                                        str2 = Format(var1, strQCDec)
                                        str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                    Else
                                        str1 = "NA"
                                    End If
                                End If

                            Case 23
                                'strA = "AveragenISNMFForAnalyte_"
                                strF1 = "CHARTYPE = 'AvenISNMF' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE" ' & " AND NUMQCLEVEL = 0"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    var1 = NZ(rowsA(0).Item("NUMVALUE"), "")
                                    If IsNumeric(var1) Then
                                        str1 = Format(var1, "0")
                                    Else
                                        str1 = "NA"
                                    End If
                                End If

                                'Case 65 '20161019 LEE: Added
                                '    strA = "AverageISNMFForAnalyte_"
                                'Case 66 '20161019 LEE: Added
                                '    strA = "AverageSDISNMFForAnalyte_"
                                'Case 67 '20161019 LEE: Added
                                '    strA = "AveragePrecisionISNMFForAnalyte_"
                                'Case 68 '20161019 LEE: Added
                                '    strA = "AveragenISNMFForAnalyte_"



                            Case 24 'Recovery Precision Min QC 

                                strF1 = "CHARTYPE = 'RecPrecQC' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMin As Single
                                    numMin = 9999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 < numMin Then
                                                numMin = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMin, strQCDec) 'CStr(SigFigOrDec(numMin, LSigFig, False, True))
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 25 'Recovery Precision Min RS 

                                strF1 = "CHARTYPE = 'RecPrecRS' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMin As Single
                                    numMin = 9999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 < numMin Then
                                                numMin = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMin, strQCDec) 'CStr(SigFigOrDec(numMin, LSigFig, False, True))
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 26 'Recovery Precision Min PES

                                strF1 = "CHARTYPE = 'RecPrecPES' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMin As Single
                                    numMin = 9999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 < numMin Then
                                                numMin = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMin, strQCDec) 'CStr(SigFigOrDec(numMin, LSigFig, False, True))
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 27 'Recovery Precision Max QC 

                                strF1 = "CHARTYPE = 'RecPrecQC' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMax As Single
                                    numMax = -9999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 > numMax Then
                                                numMax = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMax, strQCDec) 'CStr(SigFigOrDec(numMin, LSigFig, False, True))
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 28 'Recovery Precision Max RS 

                                strF1 = "CHARTYPE = 'RecPrecRS' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMax As Single
                                    numMax = -9999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 > numMax Then
                                                numMax = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMax, strQCDec) 'CStr(SigFigOrDec(numMin, LSigFig, False, True))
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 29 'Recovery Precision Max PES

                                strF1 = "CHARTYPE = 'RecPrecPES' AND CHARFCID = '" & strFCID & "' AND NUMANALYTE = " & Count1 + 1 & " AND BOOLOUTLIER = FALSE"
                                Dim rowsA() As DataRow = tbl1a.Select(strF1)
                                If rowsA.Length = 0 Then
                                    str1 = "[NA]"
                                Else
                                    Dim numMax As Single
                                    numMax = -9999999
                                    For Count5 = 0 To rowsA.Length - 1
                                        var1 = rowsA(Count5).Item("NUMVALUE")
                                        If IsNumeric(var1) Then
                                            If var1 > numMax Then
                                                numMax = var1
                                            End If
                                        End If
                                    Next
                                    str2 = Format(numMax, strQCDec) 'CStr(SigFigOrDec(numMin, LSigFig, False, True))
                                    str1 = Replace(str2, "-", ChrW(173), 1, -1, CompareMethod.Text)
                                End If

                            Case 30
                                'strA = "DilutionReplicateNumberForAnalyte_" & Count1 + 1 & "_Table_"

                                '20190228 LEE:
                                str1 = GetDilQCInfo(1, intGroup, idTR)

                        End Select

                        If StrComp(str1, "[NA]", CompareMethod.Text) = 0 Then
                            'make red font
                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorRed
                            wd.Selection.TypeText(Text:=str1)
                            wd.Selection.Font.Color = Microsoft.Office.Interop.Word.WdColor.wdColorAutomatic ' wdColorAutomatic
                        Else
                            wd.Selection.Text = str1
                        End If

                    Else
                        boolQuit = True
                    End If

                End With
            Loop

        End With

    End Sub

    Sub AddTables()

        Exit Sub

        Dim dtbl1 As System.Data.DataTable
        Dim dtbl2 As System.Data.DataTable
        Dim dtbl3 As System.Data.DataTable
        Dim rows1() As DataRow
        Dim rows2() As DataRow
        Dim rows3() As DataRow
        Dim strF1 As String
        Dim strF2 As String
        Dim strF3 As String
        Dim strS As String
        Dim int1 As Short
        Dim int2 As Short
        Dim int3 As Short
        Dim Count1 As Short
        Dim Count2 As Short
        Dim Count3 As Short
        Dim intMaxID As Int64
        Dim str1 As String
        Dim str2 As String
        Dim str3 As String
        Dim str4 As String
        Dim str5 As String
        Dim dt As Date
        Dim intRows1 As Short
        Dim intRows2 As Short
        Dim lng1 As Int64
        Dim var1
        Dim strFCID As String

        dt = Now

        dtbl1 = tblFieldCodes

        'find intMaxID
        strF1 = "ID_TBLFIELDCODES > -1"
        strS = "ID_TBLFIELDCODES ASC"

        Dim dv1 as system.data.dataview = New DataView(dtbl1, strF1, strS, DataViewRowState.CurrentRows)
        dv1.AllowNew = True
        dv1.AllowEdit = True
        intMaxID = dv1(dv1.Count - 1).Item("ID_TBLFIELDCODES")
        strS = "CHARFIELDCODE ASC"
        dv1.Sort = strS

        'rows1 = dtbl1.Select(strF1, strS)
        'intMaxID = rows1(rows1.Length - 1).Item("ID_TBLFIELDCODES")
        'intRows1 = rows1.Length

        dtbl2 = tblReportTable
        strS = "INTORDER ASC"
        strF2 = "ID_TBLSTUDIES = " & id_tblStudies ' & " AND BOOLINCLUDE = -1" 'MUST SHOW ALL TABLES!!!
        '20160922 LEE: Don't show placeholders
        strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND BOOLPLACEHOLDER <> 0" 'MUST SHOW ALL TABLES!!!
        rows2 = dtbl2.Select(strF2, strS)
        intRows2 = rows2.Length

        For Count1 = 0 To intRows2 - 1
            lng1 = rows2(Count1).Item("ID_TBLCONFIGREPORTTABLES")
            int1 = NZ(rows2(Count1).Item("INTEGNUM"), 1)
            strFCID = NZ(rows2(Count1).Item("CHARFCID"), "LABIntegrityAAA")
            'debugging
            If StrComp(strFCID, "LABIntegrityAAA", CompareMethod.Text) = 0 Then
            Else

                str1 = "[TABLEI_" & lng1 & "_" & int1 & "]"
                str1 = "[TABLEI_" & strFCID & "]"
                'add distinct items to dtbl1
                'see if str1 already exists
                int2 = dv1.Find(str1)
                If int2 = -1 Then
                    intMaxID = intMaxID + 1
                    str5 = "Field Code for table:  " & NZ(rows2(Count1).Item("CHARHEADINGTEXT"), "")

                    Dim newRow As DataRow = dtbl1.NewRow
                    newRow.BeginEdit()
                    newRow("ID_TBLFIELDCODES") = intMaxID
                    newRow("CHARFIELDCODE") = str1
                    newRow("CHARDESCRIPTION") = str5 ' & " for Role " & str2
                    newRow("CHARTAB") = "Report Table Configuration"
                    newRow("CHARTABLE") = "NA"
                    newRow("CHAREXAMPLE") = "NA"
                    newRow("CHARGROUP") = "Tables - Individual"
                    newRow("UPSIZE_TS") = dt

                    newRow("intAdded") = -1

                    newRow.EndEdit()

                    dtbl1.Rows.Add(newRow)

                End If

            End If

        Next

        dtbl1.AcceptChanges()

    End Sub

    Sub GetGroupSort(ByVal idT As Long)

        Dim dtbl1 As System.Data.DataTable
        Dim dtbl2 As System.Data.DataTable
        Dim rows1() As DataRow
        Dim rows2() As DataRow
        Dim strF As String
        Dim strF1 As String
        Dim strF2 As String
        Dim Count1 As Short
        Dim int1 As Int64
        Dim str1 As String
        Dim str2 As String
        Dim intCt As Short
        Dim idC As Int64
        Dim id1 As Int64
        Dim var1, var2, var3

        int1 = 0

        ReDim arrGroups(3, 4)
        ReDim arrSort(3, 6)
        '1=Column, 2=Sort

        intGroups = 0
        intSort = 0

        dtbl1 = tblConfigHeaderLookup
        dtbl2 = tblTableProperties

        strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idT
        rows2 = dtbl2.Select(strF2) 'should be only 1 row, ID_TBLREPORTTABLE is unique

        '20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
        '20170404 LEE: this hase been corrected
        'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
        '    str2 = "SUBJECTGROUPID"
        '    'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
        '    '    str2 = "DESIGNSUBJECTID"
        'End If

        'get groups
        intCt = 0

        For Count1 = 1 To 4

            int1 = NZ(rows2(0).Item("NUMSAMPLEG" & Count1), 0)
            str1 = NZ(rows2(0).Item("CHARSAMPLEGAD" & Count1), "aa")

            If int1 = 0 Then
            Else
                strF1 = "id_tblConfigHeaderLookup = " & int1
                rows1 = dtbl1.Select(strF1)
                If rows1.Length = 0 Then
                Else
                    str2 = NZ(rows1(0).Item("CHARWATSONFIELD"), "aa")
                    '20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
                    '20170404 LEE: this hase been corrected
                    'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
                    '    str2 = "SUBJECTGROUPID"
                    'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
                    '    str2 = "DESIGNSUBJECTID"
                    'End If
                    intCt = intCt + 1
                    arrGroups(1, intCt) = RetrieveSG(int1)
                    arrGroups(2, intCt) = str1
                    arrGroups(3, intCt) = str2
                End If
             
            End If

        Next

        Try
            intGroups = intCt
        Catch ex As Exception
            MsgBox("intCt: " & NZ(intCt, "aa"))
        End Try

        GoTo end2

        int1 = rows2(0).Item("NUMSAMPLEG1")
        str1 = rows2(0).Item("CHARSAMPLEGAD1")
        If int1 = 0 Then
        Else
            strF1 = "id_tblConfigHeaderLookup = " & int1
            rows1 = dtbl1.Select(strF1)
            str2 = rows1(0).Item("CHARWATSONFIELD")
            '20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
            '20170404 LEE: this hase been corrected
            'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
            '    str2 = "SUBJECTGROUPID"
            'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
            '    str2 = "DESIGNSUBJECTID"
            'End If
            intCt = intCt + 1
            arrGroups(1, intCt) = RetrieveSG(int1)
            arrGroups(2, intCt) = str1
            arrGroups(3, intCt) = str2
        End If

        int1 = rows2(0).Item("NUMSAMPLEG2")
        str1 = rows2(0).Item("CHARSAMPLEGAD2")
        If int1 = 0 Then
        Else
            strF1 = "id_tblConfigHeaderLookup = " & int1
            rows1 = dtbl1.Select(strF1)
            str2 = rows1(0).Item("CHARWATSONFIELD")
            '20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
            'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
            '    str2 = "SUBJECTGROUPID"
            'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
            '    str2 = "DESIGNSUBJECTID"
            'End If
            intCt = intCt + 1
            arrGroups(1, intCt) = RetrieveSG(int1)
            arrGroups(2, intCt) = str1
            arrGroups(3, intCt) = str2
        End If

        int1 = rows2(0).Item("NUMSAMPLEG3")
        str1 = rows2(0).Item("CHARSAMPLEGAD3")
        If int1 = 0 Then
        Else
            strF1 = "id_tblConfigHeaderLookup = " & int1
            rows1 = dtbl1.Select(strF1)
            str2 = rows1(0).Item("CHARWATSONFIELD")
            ''20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
            'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
            '    str2 = "SUBJECTGROUPID"
            'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
            '    str2 = "DESIGNSUBJECTID"
            'End If
            intCt = intCt + 1
            arrGroups(1, intCt) = RetrieveSG(int1)
            arrGroups(2, intCt) = str1
            arrGroups(3, intCt) = str2
        End If

        int1 = rows2(0).Item("NUMSAMPLEG4")
        str1 = rows2(0).Item("CHARSAMPLEGAD4")
        If int1 = 0 Then
        Else
            strF1 = "id_tblConfigHeaderLookup = " & int1
            rows1 = dtbl1.Select(strF1)
            str2 = rows1(0).Item("CHARWATSONFIELD")
            ''20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
            'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
            '    str2 = "SUBJECTGROUPID"
            'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
            '    str2 = "DESIGNSUBJECTID"
            'End If
            intCt = intCt + 1
            arrGroups(1, intCt) = RetrieveSG(int1)
            arrGroups(2, intCt) = str1
            arrGroups(3, intCt) = str2
        End If

        intGroups = intCt

end2:

        'get sort
        Dim str3 As String

        intCt = 0

        For Count1 = 1 To 6

            int1 = NZ(rows2(0).Item("NUMSAMPLES" & Count1), 0)
            str1 = NZ(rows2(0).Item("CHARSAMPLESAD" & Count1), "aa")

            If int1 = 0 Then
            Else
                strF1 = "id_tblConfigHeaderLookup = " & int1
                rows1 = dtbl1.Select(strF1)
                If rows1.Length = 0 Then
                Else
                    str2 = NZ(rows1(0).Item("CHARWATSONFIELD"), "aa")
                    ''20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
                    'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
                    '    str2 = "SUBJECTGROUPID"
                    'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
                    '    str2 = "DESIGNSUBJECTID"
                    'End If
                    intCt = intCt + 1
                    str3 = RetrieveSG(int1)
                    arrSort(1, intCt) = str3
                    arrSort(2, intCt) = str1
                    Select Case str3
                        'Case "Time", "Day"
                        '    str2 = "SERIALENDTIME"
                        'Case "Start Time", "Start Day"
                        '    str2 = "SERIALSTARTTIME"

                        Case "Day"
                            str2 = "ENDDAY"
                        Case "Start Day"
                            str2 = "STARTDAY"

                        Case "Time"
                            str2 = "SERIALENDTIME"
                        Case "Start Time"
                            str2 = "SERIALSTARTTIME"

                    End Select
                    arrSort(3, intCt) = str2

                End If
               
            End If

        Next

        GoTo end1

        intCt = 0
        int1 = rows2(0).Item("NUMSAMPLES1")
        str1 = rows2(0).Item("CHARSAMPLESAD1")
        If int1 = 0 Then
        Else
            strF1 = "id_tblConfigHeaderLookup = " & int1
            rows1 = dtbl1.Select(strF1)
            str2 = rows1(0).Item("CHARWATSONFIELD")
            ''20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
            'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
            '    str2 = "SUBJECTGROUPID"
            'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
            '    str2 = "DESIGNSUBJECTID"
            'End If
            intCt = intCt + 1
            str3 = RetrieveSG(int1)
            arrSort(1, intCt) = str3
            arrSort(2, intCt) = str1
            Select Case str3
                'Case "Time", "Day"
                '    str2 = "SERIALENDTIME"
                'Case "Start Time", "Start Day"
                '    str2 = "SERIALSTARTTIME"

                Case "Day"
                    str2 = "ENDDAY"
                Case "Start Day"
                    str2 = "STARTDAY"

                Case "Time"
                    str2 = "SERIALENDTIME"
                Case "Start Time"
                    str2 = "SERIALSTARTTIME"

            End Select
            arrSort(3, intCt) = str2
        End If

        int1 = rows2(0).Item("NUMSAMPLES2")
        str1 = rows2(0).Item("CHARSAMPLESAD2")
        If int1 = 0 Then
        Else
            strF1 = "id_tblConfigHeaderLookup = " & int1
            rows1 = dtbl1.Select(strF1)
            str2 = rows1(0).Item("CHARWATSONFIELD")
            ''20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
            'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
            '    str2 = "SUBJECTGROUPID"
            'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
            '    str2 = "DESIGNSUBJECTID"
            'End If
            intCt = intCt + 1
            str3 = RetrieveSG(int1)
            arrSort(1, intCt) = str3
            arrSort(2, intCt) = str1
            Select Case str3
                'Case "Time", "Day"
                '    str2 = "SERIALENDTIME"
                'Case "Start Time", "Start Day"
                '    str2 = "SERIALSTARTTIME"

                Case "Day"
                    str2 = "ENDDAY"
                Case "Start Day"
                    str2 = "STARTDAY"

                Case "Time"
                    str2 = "SERIALENDTIME"
                Case "Start Time"
                    str2 = "SERIALSTARTTIME"
            End Select
            arrSort(3, intCt) = str2
        End If

        'legend for debugging
        'dtbl1 = tblConfigHeaderLookup
        'dtbl2 = tblTableProperties
        'strF2 = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idT
        'rows2 = dtbl2.Select(strF2) 'should be only 1 row, ID_TBLREPORTTABLE is unique
        var1 = id_tblStudies
        var2 = idT

        int1 = rows2(0).Item("NUMSAMPLES3")
        str1 = rows2(0).Item("CHARSAMPLESAD3")
        If int1 = 0 Then
        Else
            strF1 = "id_tblConfigHeaderLookup = " & int1
            rows1 = dtbl1.Select(strF1)
            str2 = rows1(0).Item("CHARWATSONFIELD")
            ''20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
            'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
            '    str2 = "SUBJECTGROUPID"
            'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
            '    str2 = "DESIGNSUBJECTID"
            'End If
            intCt = intCt + 1
            str3 = RetrieveSG(int1)
            arrSort(1, intCt) = str3
            arrSort(2, intCt) = str1
            Select Case str3
                Case "Day"
                    str2 = "ENDDAY"
                Case "Start Day"
                    str2 = "STARTDAY"

                Case "Time"
                    str2 = "SERIALENDTIME"
                Case "Start Time"
                    str2 = "SERIALSTARTTIME"
            End Select
            arrSort(3, intCt) = str2
        End If

        int1 = rows2(0).Item("NUMSAMPLES4")
        str1 = rows2(0).Item("CHARSAMPLESAD4")
        If int1 = 0 Then
        Else
            strF1 = "id_tblConfigHeaderLookup = " & int1
            rows1 = dtbl1.Select(strF1)
            str2 = rows1(0).Item("CHARWATSONFIELD")
            ''20160718 LEE: ensure SUBJECTGROUPNAME is now SUBJECTGROUPID
            'If StrComp(str2, "SUBJECTGROUPNAME", CompareMethod.Text) = 0 Then
            '    str2 = "SUBJECTGROUPID"
            'ElseIf StrComp(str2, "DESIGNSUBJECTTAG", CompareMethod.Text) = 0 Then
            '    str2 = "DESIGNSUBJECTID"
            'End If
            intCt = intCt + 1
            str3 = RetrieveSG(int1)
            arrSort(1, intCt) = str3
            arrSort(2, intCt) = str1
            Select Case str3
                'Case "Time", "Day"
                '    str2 = "SERIALENDTIME"
                'Case "Start Time", "Star tDay"
                '    str2 = "SERIALSTARTTIME"

                Case "Day"
                    str2 = "ENDDAY"
                Case "Start Day"
                    str2 = "STARTDAY"

                Case "Time"
                    str2 = "SERIALENDTIME"
                Case "Start Time"
                    str2 = "SERIALSTARTTIME"
            End Select
            arrSort(3, intCt) = str2
        End If

end1:

        Try
            intSort = intCt
        Catch ex As Exception
            MsgBox("intCt: " & NZ(intCt, "aa"))
        End Try


        ReDim Preserve arrGroups(3, intGroups)
        ReDim Preserve arrSort(3, intSort)


    End Sub


    Sub GlobalTableParaFormat(ByRef wd As Microsoft.Office.Interop.Word.Application)

        Dim tbl As Word.Table
        Dim var1

        With wd

            '20180525 LEE
            tbl = .Selection.Tables.Item(1)
            tbl.Select()

            With .Selection.ParagraphFormat
                .SpaceBefore = 0
                '.SpaceBeforeAuto = False
                .SpaceAfter = 0
                '.SpaceAfterAuto = False
                .LineSpacingRule = Microsoft.Office.Interop.Word.WdLineSpacing.wdLineSpaceSingle
                Try
                    .LineUnitBefore = 0
                    .LineUnitAfter = 0
                Catch ex As Exception

                End Try

            End With

            '20171221 LEE: Moved these lines to GlobalTableParaFormat
            ''set fontsize

            Dim fontsize As Single

            Try

                ''20180525 LEE
                ''Do not allow unicode
                Call RemoveUnicode(wd)

                Dim fs1 As Single

                fs1 = .ActiveDocument.Styles("Table Grid").Font.Size

                fontsize = fs1
            Catch ex As Exception
                Dim fs2 As Single = .ActiveDocument.Styles("Normal").Font.Size
                fontsize = fs2 - 1
            End Try

            '20180816 LEE:
            If NUMTABLEFONTSIZE = 0 Then
                .Selection.Font.Size = fontsize
            Else
                .Selection.Font.Size = NUMTABLEFONTSIZE
            End If


        End With

    End Sub

    Sub RemoveUnicode(ByRef wd As Microsoft.Office.Interop.Word.Application)

        Dim strFN As String
        Dim strNFN As String
        Dim rng1 As Word.Range
        Dim sty As Word.Style
        Dim styTG As Word.Style
        Dim str1 As String
        Dim var1
        Dim tbl As Word.Table
        Dim fnRng As String
        Dim boolDo As Boolean = False

        Try

            With wd

                tbl = .Selection.Tables.Item(1)

                sty = .ActiveDocument.Styles("Normal")
                str1 = sty.Font.Name 'debug
                rng1 = .Selection.Range
                fnRng = rng1.Font.Name
                strFN = .ActiveDocument.Styles("Table Grid").Font.Name
                styTG = .ActiveDocument.Styles("Table Grid")

                If InStr(1, fnRng, "Unicode", CompareMethod.Text) > 0 Or InStr(1, strFN, "Unicode", CompareMethod.Text) > 0 Then
                    boolDo = True
                End If

                'wd.Visible = True 'debug

                '20181014 LEE:
                'sometimes the range has a mix of normal and unicode
                'look in each row
                If rng1.Rows.Count < 2 Or boolDo Then
                Else
                    Dim boolU As Boolean = False
                    Dim Count1 As Short
                    Dim rng2 As Word.Range
                    For Count1 = 1 To rng1.Rows.Count
                        rng2 = rng1.Rows(Count1).Range
                        fnRng = rng2.Font.Name
                        If InStr(1, fnRng, "Unicode", CompareMethod.Text) > 0 Or InStr(1, strFN, "Unicode", CompareMethod.Text) > 0 Then
                            boolDo = True
                            Exit For
                        End If
                    Next

                End If



                If boolDo Then

                    styTG.Font.Name = str1
                    styTG.Font.Bold = False

                    '20180530 LEE:
                    'Do not update styles
                    '.ActiveDocument.UpdateStyles()
                    .ActiveDocument.Save()

                    var1 = styTG.Font.Name
                    var1 = var1

                    'rng1.Style = styTG

                    'tbl.Style = styTG

                    'rng1.Style = sty
                    'unbold
                    rng1.Font.Bold = False
                    rng1.Font.Name = str1
                    rng1.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdCellVerticalAlignment.wdCellAlignVerticalBottom
                    .Selection.Tables.Item(1).Rows.AllowBreakAcrossPages = False

                End If

            End With

        Catch ex As Exception

            var1 = ex.Message
            var1 = var1

        End Try

        var1 = var1

    End Sub

    Sub ApplyTableCaption(ByRef wd As Word.Application)

        'ignore if caption has paragraph return
        If StrComp(gstrCAPTIONFOLLOW, "Tab", CompareMethod.Text) = 0 Then
        Else
            Exit Sub
        End If

        Dim numLI As Single
        Dim var1

        Dim rng As Word.Range
        rng = wd.Selection.Range

        Try
            '20180529 LEE:
            'if tab, ensure that caption has hanging indent
            numLI = wd.ActiveDocument.Styles("Caption").ParagraphFormat.LeftIndent
            'if numLI = 0 then make it 72
            If numLI = 0 Then
                numLI = 72
            End If
            With wd.ActiveDocument.Styles("Caption").ParagraphFormat
                .LeftIndent = numLI ' InchesToPoints(1)
                '.RightIndent = 0 'InchesToPoints(0)
                '.SpaceBefore = 0
                '.SpaceBeforeAuto = False
                '.SpaceAfter = 10
                '.SpaceAfterAuto = False
                '.LineSpacingRule = wdLineSpaceSingle
                '.Alignment = wdAlignParagraphLeft
                '.WidowControl = True
                '.KeepWithNext = False
                '.KeepTogether = False
                '.PageBreakBefore = False
                '.NoLineNumber = False
                '.Hyphenation = True
                .FirstLineIndent = -numLI 'InchesToPoints(-1)
                '.OutlineLevel = wdOutlineLevelBodyText
                '.CharacterUnitLeftIndent = 0
                '.CharacterUnitRightIndent = 0
                '.CharacterUnitFirstLineIndent = 0
                '.LineUnitBefore = 0
                '.LineUnitAfter = 0
                '.MirrorIndents = False
                '.TextboxTightWrap = wdTightNone
                '.CollapsedByDefault = False
            End With

            'now evaluate Table Caption row
            Dim tbl As Word.Table
            tbl = wd.Selection.Tables(1)
            tbl.Rows(1).Select()
            wd.Selection.Font.Size = wd.ActiveDocument.Styles("Normal").Font.Size
            var1 = var1
        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

        'select original position
        rng.Select()

    End Sub

    Sub SetTablePropertiesBool(ByVal idRT As Int64, ByVal idCRT As Int64)


        Dim strF As String
        Dim dtbl As System.Data.DataTable
        Dim rows() As DataRow
        Dim str1 As String
        Dim var1
        Dim boolUp As Boolean = False

        strF = "ID_TBLSTUDIES = " & id_tblStudies & " AND ID_TBLREPORTTABLE = " & idRT

        'first do tblAutoAssignSamples
        dtbl = tblAutoAssignSamples
        rows = dtbl.Select(strF)

        If rows.Length = 0 Then
            'enter defaults
            BOOLUSESTDCOLLABELS = False
        Else
            var1 = NZ(rows(0).Item("BOOLUSESTDCOLLABELS"), 0)
            If var1 = 0 Then
                BOOLUSESTDCOLLABELS = False
            Else
                BOOLUSESTDCOLLABELS = True
            End If
        End If

        'now do tblTableProperties
        dtbl = tblTableProperties
        rows = dtbl.Select(strF)

        If rows.Length = 0 Then 'enter some defaults

            boolBQLSHOWCONC = True
            boolCSSHOWREJVALUES = True
            boolCSREPORTACCVALUES = True
            boolQCREPORTACCVALUES = True
            boolSTATSMEAN = True
            boolSTATSSD = True
            boolSTATSCV = True
            boolSTATSBIAS = True
            boolSTATSN = True
            boolSTATSDIFF = False
            boolSTATSDIFFCOL = False
            boolSTATSREGR = False
            boolSTATSNR = True
            boolSTATSLETTER = False
            boolTHEORETICAL = False
            boolINCLANOVA = True
            boolINCLANOVASUMSTATS = True
            boolBQLLEGEND = False
            boolIncludePSAE = False
            boolRCConc = True
            boolRCPA = True
            boolRCPARatio = False
            boolIncludeISTbl = True
            boolNONELEG = True
            boolPOSLEG = True
            boolNEGLEG = False
            boolCUSTOMLEG = False
            boolMEANACCURACY = False
            BOOLDIFFERENCE = True
            boolRECOVERY = True
            BOOLINCLUDEDATE = False
            BOOLINCLUDEWATSONLABELS = False
            BOOLINTRARUNSUMSTATS = False
            BOOLSTATSRE = False

            BOOLDOINDREC = False

            BOOLMFTABLE = False
            BOOLINCLMFCOLS = False
            BOOLINCLINTSTDNMF = False
            BOOLCALCINTSTDNMF = False

            BOOLINTSTDONLY = False

            BOOLISCOMBINELEVELS = False


            If idCRT = 13 Or idCRT = 14 Or idCRT = 15 Or idCRT = 22 Or idCRT = 23 Then
                boolSTATSBIAS = False
                boolTHEORETICAL = False 'theoretical not possible in this table
            End If

            If idCRT <> 12 Then
                boolSTATSREGR = False
            End If

            NUMPRECCRITLOTS = 0
            BOOLREGRULOQ = False
            INTQCLEVELGROUP = 0

            BOOLCONCCOMMENTS = False

            boolAdHocStabCompColumns = False

        Else

            str1 = "BOOLISCOMBINELEVELS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0

            End If
            If var1 = -1 Then
                BOOLISCOMBINELEVELS = True
            Else
                BOOLISCOMBINELEVELS = False
            End If

            str1 = "boolBQLSHOWCONC"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0

            End If
            If var1 = -1 Then
                boolBQLSHOWCONC = True
            Else
                boolBQLSHOWCONC = False
            End If

            str1 = "boolCSSHOWREJVALUES"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolCSSHOWREJVALUES = True
            Else
                boolCSSHOWREJVALUES = False
            End If

            str1 = "boolCSREPORTACCVALUES"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolCSREPORTACCVALUES = True
            Else
                boolCSREPORTACCVALUES = False
            End If

            str1 = "boolQCREPORTACCVALUES"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolQCREPORTACCVALUES = True
            Else
                boolQCREPORTACCVALUES = False
            End If

            str1 = "boolSTATSMEAN"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSMEAN = True
            Else
                boolSTATSMEAN = False
            End If

            str1 = "boolSTATSSD"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSSD = True
            Else
                boolSTATSSD = False
            End If

            str1 = "boolSTATSCV"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSCV = True
            Else
                boolSTATSCV = False
            End If

            str1 = "boolSTATSBIAS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSBIAS = True
            Else
                boolSTATSBIAS = False
            End If

            str1 = "boolSTATSN"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSN = True
            Else
                boolSTATSN = False
            End If

            str1 = "boolSTATSDIFF"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSDIFF = True
            Else
                boolSTATSDIFF = False
            End If

            str1 = "boolSTATSDIFFCOL"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSDIFFCOL = True
            Else
                boolSTATSDIFFCOL = False
            End If

            str1 = "boolSTATSREGR"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSREGR = True
            Else
                boolSTATSREGR = False
            End If

            str1 = "boolSTATSNR"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSNR = True
            Else
                boolSTATSNR = False
            End If

            str1 = "boolSTATSLETTER"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolSTATSLETTER = True
            Else
                boolSTATSLETTER = False
            End If

            str1 = "boolTheoretical"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolTHEORETICAL = True
            Else
                boolTHEORETICAL = False
            End If

            str1 = "boolINCLANOVA"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolINCLANOVA = True
            Else
                boolINCLANOVA = False
            End If

            str1 = "boolINCLANOVASUMSTATS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolINCLANOVASUMSTATS = True
            Else
                boolINCLANOVASUMSTATS = False
            End If

            str1 = "boolBQLLEGEND"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolBQLLEGEND = True
            Else
                boolBQLLEGEND = False
            End If

            str1 = "boolIncludePSAE"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolIncludePSAE = True
            Else
                boolIncludePSAE = False
            End If

            str1 = "boolRCConc"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolRCConc = True
            Else
                boolRCConc = False
            End If

            str1 = "boolRCPA"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolRCPA = True
            Else
                boolRCPA = False
            End If

            str1 = "boolRCPARatio"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolRCPARatio = True
            Else
                boolRCPARatio = False
            End If

            str1 = "boolIncludeISTbl"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolIncludeISTbl = True
            Else
                boolIncludeISTbl = False
            End If

            str1 = "boolNONELEG"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolNONELEG = True
            Else
                boolNONELEG = False
            End If

            str1 = "boolPOSLEG"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolPOSLEG = True
            Else
                boolPOSLEG = False
            End If

            str1 = "boolNEGLEG"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolNEGLEG = True
            Else
                boolNEGLEG = False
            End If

            str1 = "boolCUSTOMLEG"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolCUSTOMLEG = True
            Else
                boolCUSTOMLEG = False
            End If

            str1 = "boolMEANACCURACY"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolMEANACCURACY = True
            Else
                boolMEANACCURACY = False
            End If

            str1 = "BOOLDIFFERENCE"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLDIFFERENCE = True
            Else
                BOOLDIFFERENCE = False
            End If

            str1 = "BOOLRECOVERY"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolRECOVERY = True
            Else
                boolRECOVERY = False
            End If

            str1 = "BOOLINCLUDEDATE"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLINCLUDEDATE = True
            Else
                BOOLINCLUDEDATE = False
            End If

            str1 = "BOOLINCLUDEWATSONLABELS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLINCLUDEWATSONLABELS = True
            Else
                BOOLINCLUDEWATSONLABELS = False
            End If

            str1 = "BOOLINTRARUNSUMSTATS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLINTRARUNSUMSTATS = True
            Else
                BOOLINTRARUNSUMSTATS = False
            End If

            str1 = "BOOLSTATSRE"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLSTATSRE = True
            Else
                BOOLSTATSRE = False
            End If


            str1 = "BOOLDOINDREC"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLDOINDREC = True
            Else
                BOOLDOINDREC = False
            End If


            str1 = "BOOLREASSAYREASLETTERS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLREASSAYREASLETTERS = True
            Else
                BOOLREASSAYREASLETTERS = False
            End If

            str1 = "BOOLMFTABLE"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLMFTABLE = True
            Else
                BOOLMFTABLE = False
            End If

            str1 = "BOOLINCLMFCOLS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLINCLMFCOLS = True
            Else
                BOOLINCLMFCOLS = False
            End If

            str1 = "BOOLINCLINTSTDNMF"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLINCLINTSTDNMF = True
            Else
                BOOLINCLINTSTDNMF = False
            End If

            str1 = "BOOLCALCINTSTDNMF"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLCALCINTSTDNMF = True
            Else
                BOOLCALCINTSTDNMF = False
            End If

            str1 = "NUMPRECCRITLOTS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            NUMPRECCRITLOTS = var1

            str1 = "BOOLREGRULOQ"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLREGRULOQ = True
            Else
                BOOLREGRULOQ = False
            End If


            str1 = "INTQCLEVELGROUP"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            INTQCLEVELGROUP = var1

            str1 = "BOOLCUSTOMLEG" '
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLINTSTDONLY = True
            Else
                BOOLINTSTDONLY = False
            End If

            str1 = "BOOLCONCCOMMENTS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                BOOLCONCCOMMENTS = True
            Else
                BOOLCONCCOMMENTS = False
            End If
            'BOOLCONCCOMMENTS = var1

            str1 = "BOOLADHOCSTABCOMPCOLUMNS"
            var1 = rows(0).Item(str1)
            If IsDBNull(var1) Then
                If boolUp Then
                Else
                    rows(0).BeginEdit()
                    boolUp = True
                End If
                rows(0).Item(str1) = 0
                var1 = 0
            End If
            If var1 = -1 Then
                boolAdHocStabCompColumns = True
            Else
                boolAdHocStabCompColumns = False
            End If

            'BOOLREGRULOQ

            If boolUp Then
                rows(0).EndEdit()
            End If

        End If



    End Sub


    Sub typeStatsLabels(ByRef wd As Microsoft.Office.Interop.Word.Application, ByRef intRowCounter As Integer, ByVal intRowStart As Integer, _
                        ByVal IntCol As Integer, ByVal IncludeAlignment As Boolean)

        'Fill in a column of Statistics labels, depending on value of statistics variables.

        With wd
            If boolSTATSMEAN Then
                intRowCounter = intRowCounter + 1
                .Selection.Tables.Item(1).Cell(intRowStart + intRowCounter, IntCol).Select()
                If (IncludeAlignment) Then
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdVerticalAlignment.wdAlignVerticalBottom
                End If
                .Selection.TypeText("Mean")
            End If
            If boolSTATSSD Then
                intRowCounter = intRowCounter + 1
                .Selection.Tables.Item(1).Cell(intRowStart + intRowCounter, IntCol).Select()
                If (IncludeAlignment) Then
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdVerticalAlignment.wdAlignVerticalBottom
                End If
                .Selection.TypeText("S.D.") '((Mean/NomConc)-1)*100)
            End If
            If boolSTATSCV Then
                intRowCounter = intRowCounter + 1
                .Selection.Tables.Item(1).Cell(intRowStart + intRowCounter, IntCol).Select()
                If (IncludeAlignment) Then
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdVerticalAlignment.wdAlignVerticalBottom
                End If
                .Selection.TypeText(ReturnPrecLabel()) '(sd/mean)*100)
            End If
            If boolSTATSBIAS And boolSTATSMEAN Then
                intRowCounter = intRowCounter + 1
                .Selection.Tables.Item(1).Cell(intRowStart + intRowCounter, IntCol).Select()
                If (IncludeAlignment) Then
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdVerticalAlignment.wdAlignVerticalBottom
                End If
                .Selection.TypeText("%Bias") '((Mean/NomConc)-1)*100)
            End If
            If boolTHEORETICAL And boolSTATSMEAN Then
                intRowCounter = intRowCounter + 1
                .Selection.Tables.Item(1).Cell(intRowStart + intRowCounter, IntCol).Select()
                If (IncludeAlignment) Then
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdVerticalAlignment.wdAlignVerticalBottom
                End If
                .Selection.TypeText("%Theoretical") '((Mean/NomConc)-1)*100)
            End If

            If boolSTATSDIFF And boolSTATSMEAN Then
                intRowCounter = intRowCounter + 1
                .Selection.Tables.Item(1).Cell(intRowStart + intRowCounter, IntCol).Select()
                If (IncludeAlignment) Then
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdVerticalAlignment.wdAlignVerticalBottom
                End If
                .Selection.TypeText("%Diff") '((Mean/NomConc)-1)*100)
            End If

            If BOOLSTATSRE And boolSTATSMEAN Then
                intRowCounter = intRowCounter + 1
                .Selection.Tables.Item(1).Cell(intRowStart + intRowCounter, IntCol).Select()
                If (IncludeAlignment) Then
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdVerticalAlignment.wdAlignVerticalBottom
                End If
                .Selection.TypeText("%RE") '((Mean/NomConc)-1)*100)
            End If

            If boolSTATSN Then
                intRowCounter = intRowCounter + 1
                .Selection.Tables.Item(1).Cell(intRowStart + intRowCounter, IntCol).Select()
                If (IncludeAlignment) Then
                    .Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphRight
                    .Selection.Cells.VerticalAlignment = Microsoft.Office.Interop.Word.WdVerticalAlignment.wdAlignVerticalBottom
                End If
                .Selection.TypeText("n")
            End If
        End With
    End Sub

    Function countNumStatsRowsWithoutTheoretical() As Integer
        'Figure out number of rows of statistics there should be EXCLUDING THEORETICAL.  
        '(Used occasionally to increment ctExp. by number of Runs)
        'NDL: not sure why ctExp excludes theoretical; just making code more efficient here.
        Dim intNumStatsRows As Integer = 0
        intNumStatsRows = countNumStatsRows()
        If boolTHEORETICAL And boolSTATSMEAN Then
            intNumStatsRows = intNumStatsRows - 1
        End If
        countNumStatsRowsWithoutTheoretical = intNumStatsRows
    End Function


    Function countNumStatsRows() As Integer
        'Figure out number of rows of statistics there should be.
        Dim intNumStatsRows As Integer = 0
        If boolSTATSMEAN Then
            intNumStatsRows = intNumStatsRows + 1
        End If
        If boolSTATSSD Then
            intNumStatsRows = intNumStatsRows + 1
        End If
        If boolSTATSCV Then
            intNumStatsRows = intNumStatsRows + 1
        End If
        If boolSTATSBIAS And boolSTATSMEAN Then
            intNumStatsRows = intNumStatsRows + 1
        End If
        If boolTHEORETICAL And boolSTATSMEAN Then
            intNumStatsRows = intNumStatsRows + 1
        End If
        If boolSTATSDIFF And boolSTATSMEAN Then
            intNumStatsRows = intNumStatsRows + 1
        End If
        If BOOLSTATSRE And boolSTATSMEAN Then
            intNumStatsRows = intNumStatsRows + 1
        End If
        If boolSTATSN Then
            intNumStatsRows = intNumStatsRows + 1
        End If
        countNumStatsRows = intNumStatsRows
    End Function

    Sub AutoFitTableLong(ByRef wd As Microsoft.Office.Interop.Word.Application, boolVis As Boolean)

        'if user has chosen Verbose (boolVerbose), then don't minimize anything

        'wd may already be visible
        Dim boolAV As Boolean = wd.Visible

        If boolVerbose Then
        Else
            If boolAV Then
                wd.WindowState = Word.WdWindowState.wdWindowStateMinimize
            Else
                If boolVis Then
                    wd.Visible = True
                    wd.WindowState = Word.WdWindowState.wdWindowStateMinimize
                End If
            End If
        End If

        wd.Selection.Tables.Item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitContent)
        wd.Selection.Tables.Item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitContent)

        Pause(5)

        wd.Selection.Tables.Item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
        wd.Selection.Tables.Item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)

        If boolAV Then
        Else
            If boolVis Then
                wd.Visible = False
            End If
        End If

    End Sub

    Sub AutoFitTable(ByRef wd As Microsoft.Office.Interop.Word.Application, boolVis As Boolean)

        'if user has chosen Verbose (boolVerbose), then don't minimize anything

        'wd may already be visible
        Dim boolAV As Boolean = wd.Visible

        If boolVerbose Then
        Else
            If boolAV Then
                wd.WindowState = Word.WdWindowState.wdWindowStateMinimize
            Else
                If boolVis Then
                    wd.Visible = True
                    wd.WindowState = Word.WdWindowState.wdWindowStateMinimize
                End If
            End If
        End If


        Call autofitContent(wd, 2)

        Pause(0.2)

        Call autofitWindow(wd, 2)

        If boolAV Then
        Else
            If boolVis Then
                wd.Visible = False
            End If
        End If

    End Sub

    Sub autofitContent(ByRef wd As Microsoft.Office.Interop.Word.Application, ByVal numTimes As Integer)

        'Just a more readable autofitcontent routine
        Dim count1 As Integer
        For count1 = 1 To numTimes
            wd.Selection.Tables.Item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitContent)
        Next

        'must pause a bit to allow table fit to complete
        Call Pause(0.2)


    End Sub

    Sub autofitWindow(ByRef wd As Microsoft.Office.Interop.Word.Application, ByVal numTimes As Integer)

        'Just a more readable autofitwindow routine
        Dim count1 As Integer
        For count1 = 1 To numTimes
            wd.Selection.Tables.Item(1).AutoFitBehavior(Microsoft.Office.Interop.Word.WdAutoFitBehavior.wdAutoFitWindow)
        Next

        'must pause a bit to allow table fit to complete
        Call Pause(0.2)


    End Sub

    Sub removeBorderButLeaveTopAndBottom(ByRef wd As Microsoft.Office.Interop.Word.Application)
        'Remove Borders of the Selection, Leave top and bottom

        wd.Selection.Borders.Enable = False
        wd.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle
        wd.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleSingle

        'wd.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderLeft).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
        'wd.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderRight).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
        'wd.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderHorizontal).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
        'wd.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderVertical).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
        'wd.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalDown).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
        'wd.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalUp).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone

        'LEE: should this be here?
        wd.Selection.ParagraphFormat.Alignment = Microsoft.Office.Interop.Word.WdParagraphAlignment.wdAlignParagraphCenter

    End Sub

    Sub typeInSuperscript(ByRef wd As Microsoft.Office.Interop.Word.Application, ByVal strA As String)
        'Type in a superscript
        'Note 1: It adds a space before the superscript.

        wd.Selection.Font.Superscript = True
        wd.Selection.TypeText(strA)
        wd.Selection.Font.Superscript = False
    End Sub

    Sub typeInSuperscriptFontSize12WithSpace(ByRef wd As Microsoft.Office.Interop.Word.Application, ByVal strA As String)
        'Type in a superscript in font size 12
        'Note: It returns font to its original size afterwards

        Dim Fonts

        Fonts = wd.Selection.Font.Size
        wd.Selection.Font.Size = 12
        typeInSuperscript(wd, " " & strA)
        wd.Selection.Font.Size = Fonts
    End Sub

    Sub typeInSuperscriptFontSize12NoSpace(ByRef wd As Microsoft.Office.Interop.Word.Application, ByVal strA As String)
        'Type in a superscript in font size 12
        'Note: It returns font to its original size afterwards

        Dim Fonts

        Fonts = wd.Selection.Font.Size
        wd.Selection.Font.Size = 12
        typeInSuperscript(wd, strA)
        wd.Selection.Font.Size = Fonts
    End Sub

    Function strCalcConcWithDilution(ByVal dblConc As Double, ByVal dblAliquot As Double) As String
        dblConc = NZ(dblConc, 0)
        If boolLUseSigFigs Then
            strCalcConcWithDilution = DisplayNum(SigFigOrDec(dblConc / dblAliquot, LSigFig, False), LSigFig, False)
        Else
            strCalcConcWithDilution = Format(RoundToDecimalRAFZ(dblConc / dblAliquot, LSigFig), GetRegrDecStr(LSigFig))
        End If
    End Function

    Sub removeAllBorders(ByRef wd As Microsoft.Office.Interop.Word.Application, boolCheckForMerge As Boolean)

        '20180418 LEE: Hmmm. For some tables, this removes borders that need to stay
        Dim rng1 As Microsoft.Office.Interop.Word.Range
        Dim rng2 As Microsoft.Office.Interop.Word.Range
        Dim rng3 As Microsoft.Office.Interop.Word.Range

        Dim sel1 As Microsoft.Office.Interop.Word.Selection
        Dim sel2 As Microsoft.Office.Interop.Word.Selection
        Dim sel3 As Microsoft.Office.Interop.Word.Selection

        Dim row1 As Microsoft.Office.Interop.Word.Table


        Dim intCols1 As Short
        Dim intCols2 As Short
        Dim intCols3 As Short

        Dim intRow1 As Int32
        Dim intRow2 As Int32
        Dim intRow3 As Int32

        Dim var1

        Try

            Dim tbl As Microsoft.Office.Interop.Word.Table

            If boolCheckForMerge Then

                tbl = wd.Selection.Tables(1)

                sel1 = wd.Selection

                Try
                    intCols1 = sel1.Columns.Count
                    intRow1 = sel1.Cells(1).RowIndex
                Catch ex As Exception
                    intCols1 = 1
                End Try

                Try
                    intRow2 = intRow1 - 1
                    intCols2 = tbl.Rows(intRow2).Cells.Count

                Catch ex As Exception
                    intCols2 = intCols1
                End Try

                Try
                    intRow3 = intRow1 + 1
                    intCols3 = tbl.Rows(intRow3).Cells.Count
                Catch ex As Exception
                    intCols3 = 1
                End Try

                Dim boolR1 As Boolean = False
                Dim boolR2 As Boolean = False

                If intCols1 <> intCols2 Then
                    boolR1 = True
                End If

                If intCols1 <> intCols2 Then
                    boolR1 = True
                End If

                'Removes all borders from the current selection in the word document

                If boolR1 Or boolR2 Then
                    If boolR1 Then
                        With wd
                            '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderLeft).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderRight).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderHorizontal).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderVertical).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalDown).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalUp).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone

                        End With
                    End If

                    If boolR2 Then
                        With wd
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderLeft).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderRight).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderHorizontal).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderVertical).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalDown).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                            .Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalUp).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
                        End With
                    End If
                Else
                    With wd
                        .Selection.Borders.Enable = False  'This takes about 20% of the time off the generation of legends
                    End With
                End If

            Else
                With wd
                    .Selection.Borders.Enable = False  'This takes about 20% of the time off the generation of legends
                End With
            End If

           

            'With wd
            '    .Selection.Borders.Enable = False  'This takes about 20% of the time off the generation of legends
            '    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderTop).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
            '    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderLeft).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
            '    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderBottom).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
            '    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderRight).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
            '    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderHorizontal).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
            '    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderVertical).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
            '    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalDown).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
            '    '.Selection.Borders.Item(Microsoft.Office.Interop.Word.WdBorderType.wdBorderDiagonalUp).LineStyle = Microsoft.Office.Interop.Word.WdLineStyle.wdLineStyleNone
            'End With

        Catch ex As Exception
            var1 = ex.Message
            var1 = var1
        End Try

    End Sub


    Sub MoveOneCellDown(ByVal wd As Microsoft.Office.Interop.Word.Application)

        Dim bool As Boolean

        Dim int1 As Int32
        Dim intRows As Short
        Dim boolA As Boolean = False
        Dim var1

        With wd
            .Selection.Tables.Item(1).Select()

            bool = .Selection.Information(Microsoft.Office.Interop.Word.WdInformation.wdWithInTable)
            If bool Then
            Else
                GoTo end1
            End If
            int1 = 0
            .Selection.Tables(1).Select()

            '20180529 LEE:
            .Selection.Collapse(Direction:=Microsoft.Office.Interop.Word.WdCollapseDirection.wdCollapseEnd)
            var1 = var1

        End With

end1:

        If boolEntireReport Then
        Else
            wd.Selection.EndKey(Unit:=Microsoft.Office.Interop.Word.WdUnits.wdStory)
        End If

    End Sub

    Private Function dt() As Object
        Throw New NotImplementedException
    End Function

End Module
